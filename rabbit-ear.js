/* Rabbit Ear alpha 3 2021-01-03 (c) Robby Kraft, MIT License */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).ear=t()}(this,(function(){"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _slicedToArray(e,t){return function _arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,o=void 0;try{for(var c,a=e[Symbol.iterator]();!(r=(c=a.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}(e,t)||_unsupportedIterableToArray(e,t)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||_unsupportedIterableToArray(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var e="undefined"!=typeof window&&void 0!==window.document,t="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,n=("object"===("undefined"==typeof self?"undefined":_typeof(self))&&self.constructor&&self.constructor.name,function type_of(e){switch(e.constructor.name){case"vector":case"matrix":case"segment":case"ray":case"line":case"circle":case"ellipse":case"rect":case"polygon":case"junction":return e.constructor.name}if("object"===_typeof(e)){if(null!=e.radius)return"circle";if(null!=e.width)return"rect";if(null!=e.x||"number"==typeof e[0])return"vector";if(null!=e[0]&&e[0].length&&("number"==typeof e[0].x||"number"==typeof e[0][0]))return"segment";if(null!=e.vector&&null!=e.origin)return"line"}}),r=function resize(e,t){return t.length===e?t:Array(e).fill(0).map((function(e,n){return t[n]?t[n]:e}))},i=function resize_up$1(e,t){var n=e.length>t.length?e.length:t.length;return[e,t].map((function(e){return r(n,e)}))},o=function count_places(e){var t="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},c=function clean_number(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;if("number"!=typeof e)return e;var n=parseFloat(e.toFixed(t));return o(n)===Math.min(t,o(e))?e:n},a=function is_iterable(e){return null!=e&&"function"==typeof e[Symbol.iterator]},u=function semi_flatten_arrays(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return a(arguments[0])&&"string"!=typeof arguments[0]?semi_flatten_arrays.apply(void 0,_toConsumableArray(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(e){return a(e)?_toConsumableArray(semi_flatten_arrays(e)):e}))}},s=function flatten_arrays(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return a(arguments[0])&&"string"!=typeof arguments[0]?flatten_arrays.apply(void 0,_toConsumableArray(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(e){return a(e)?_toConsumableArray(flatten_arrays(e)):e})).reduce((function(e,t){return e.concat(t)}),[])}},l=Object.freeze({__proto__:null,resize:r,resize_up:i,resize_down:function resize_down(e,t){var n=e.length>t.length?t.length:e.length;return[e,t].map((function(e){return r(n,e)}))},clean_number:c,semi_flatten_arrays:u,flatten_arrays:s}),v=Object.create(null),p=[1,0,0,1],d=p.concat(0,0),h=function determinant2(e){return e[0]*e[3]-e[1]*e[2]},m=function make_matrix2_rotate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.cos(e),r=Math.sin(e);return[n,r,-r,n,t[0],t[1]]},b=Object.freeze({__proto__:null,identity2x2:p,identity2x3:d,multiply_matrix2_vector2:function multiply_matrix2_vector2(e,t){return[e[0]*t[0]+e[2]*t[1]+e[4],e[1]*t[0]+e[3]*t[1]+e[5]]},multiply_matrix2_line2:function multiply_matrix2_line2(e,t,n){return{vector:[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1]],origin:[e[0]*n[0]+e[2]*n[1]+e[4],e[1]*n[0]+e[3]*n[1]+e[5]]}},multiply_matrices2:function multiply_matrices2(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]},determinant2:h,invert_matrix2:function invert_matrix2(e){var t=h(e);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(e[4])&&isFinite(e[5]))return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[3]*e[4])/t,(e[1]*e[4]-e[0]*e[5])/t]},make_matrix2_translate:function make_matrix2_translate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return p.concat(e,t)},make_matrix2_scale:function make_matrix2_scale(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0];return[e,0,0,t,e*-n[0]+n[0],t*-n[1]+n[1]]},make_matrix2_rotate:m,make_matrix2_reflect:function make_matrix2_reflect(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.atan2(e[1],e[0]),r=Math.cos(n),i=Math.sin(n),o=Math.cos(-n),c=Math.sin(-n),a=r*o+i*c,u=r*-c+i*o,s=i*o+-r*c,l=i*-c+-r*o,v=t[0]+a*-t[0]+-t[1]*s,p=t[1]+u*-t[0]+-t[1]*l;return[a,u,s,l,v,p]}}),k=180/Math.PI,w=Math.PI/180,E=2*Math.PI,M=1e-6,O=Object.freeze({__proto__:null,R2D:k,D2R:w,TWO_PI:E,EPSILON:M}),j=function fn_square(e){return e*e},C=function fn_add(e,t){return e+(t||0)},S=function fn_not_undefined(e){return void 0!==e},P=function magnitude(e){return Math.sqrt(e.map(j).reduce(C,0))},N=function mag_squared(e){return e.map(j).reduce(C,0)},I=function normalize(e){var t=P(e);return 0===t?e:e.map((function(e){return e/t}))},L=function scale(e,t){return e.map((function(e){return e*t}))},q=function add$1(e,t){return e.map((function(e,n){return e+(t[n]||0)}))},T=function subtract(e,t){return e.map((function(e,n){return e-(t[n]||0)}))},F=function dot(e,t){return e.map((function(n,r){return e[r]*t[r]})).reduce(C,0)},V=function midpoint(e,t){return e.map((function(e,n){return(e+t[n])/2}))},G=function average(){var e=arguments;if(0===arguments.length)return[];var t=arguments[0].length>0?arguments[0].length:0,n=Array(t).fill(0);return Array.from(arguments).forEach((function(e){return n.forEach((function(t,r){n[r]+=e[r]||0}))})),n.map((function(t){return t/e.length}))},B=function lerp(e,t,n){var r=1-n;return e.map((function(e,i){return e*r+(t[i]||0)*n}))},D=function cross2(e,t){return e[0]*t[1]-e[1]*t[0]},R=function cross3(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},U=function distance2(e,t){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},Z=function distance(e,t){return Math.sqrt(e.map((function(n,r){return Math.pow(e[r]-t[r],2)})).reduce((function(e,t){return e+t}),0))},X=function flip(e){return e.map((function(e){return-e}))},$=function rotate90(e){return[-e[1],e[0]]},H=function rotate270(e){return[e[1],-e[0]]},Y=function degenerate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return Math.abs(e.reduce(C,0))<t},W=function parallel(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return 1-Math.abs(F(I(e),I(t)))<n},J=function alternating_sum(e){return[0,1].map((function(t){return e.filter((function(e,n){return n%2===t})).reduce(C,0)}))},K=Object.freeze({__proto__:null,magnitude:P,mag_squared:N,normalize:I,scale:L,add:q,subtract:T,dot:F,midpoint:V,average:G,lerp:B,cross2:D,cross3:R,distance2:U,distance3:function distance3(e,t){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)},distance:Z,flip:X,rotate90:$,rotate270:H,degenerate:Y,parallel:W,alternating_sum:J,alternating_deviation:function alternating_deviation(e){var t=e.reduce(C,0)/2;return J(e).map((function(e){return e-t}))}}),Q=Object.freeze([1,0,0,0,1,0,0,0,1]),ee=Object.freeze(Q.concat(0,0,0)),te=function is_identity3x4(e){return ee.map((function(t,n){return Math.abs(t-e[n])<M})).reduce((function(e,t){return e&&t}),!0)},ne=function multiply_matrix3_vector3(e,t){return[e[0]*t[0]+e[3]*t[1]+e[6]*t[2]+e[9],e[1]*t[0]+e[4]*t[1]+e[7]*t[2]+e[10],e[2]*t[0]+e[5]*t[1]+e[8]*t[2]+e[11]]},re=function multiply_matrix3_line3(e,t,n){return{vector:[e[0]*t[0]+e[3]*t[1]+e[6]*t[2],e[1]*t[0]+e[4]*t[1]+e[7]*t[2],e[2]*t[0]+e[5]*t[1]+e[8]*t[2]],origin:[e[0]*n[0]+e[3]*n[1]+e[6]*n[2]+e[9],e[1]*n[0]+e[4]*n[1]+e[7]*n[2]+e[10],e[2]*n[0]+e[5]*n[1]+e[8]*n[2]+e[11]]}},ie=function multiply_matrices3(e,t){return[e[0]*t[0]+e[3]*t[1]+e[6]*t[2],e[1]*t[0]+e[4]*t[1]+e[7]*t[2],e[2]*t[0]+e[5]*t[1]+e[8]*t[2],e[0]*t[3]+e[3]*t[4]+e[6]*t[5],e[1]*t[3]+e[4]*t[4]+e[7]*t[5],e[2]*t[3]+e[5]*t[4]+e[8]*t[5],e[0]*t[6]+e[3]*t[7]+e[6]*t[8],e[1]*t[6]+e[4]*t[7]+e[7]*t[8],e[2]*t[6]+e[5]*t[7]+e[8]*t[8],e[0]*t[9]+e[3]*t[10]+e[6]*t[11]+e[9],e[1]*t[9]+e[4]*t[10]+e[7]*t[11]+e[10],e[2]*t[9]+e[5]*t[10]+e[8]*t[11]+e[11]]},oe=function determinant3(e){return e[0]*e[4]*e[8]-e[0]*e[7]*e[5]-e[3]*e[1]*e[8]+e[3]*e[7]*e[2]+e[6]*e[1]*e[5]-e[6]*e[4]*e[2]},ce=function invert_matrix3(e){var t=oe(e);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(e[9])&&isFinite(e[10])&&isFinite(e[11])){var n=[e[4]*e[8]-e[7]*e[5],-e[1]*e[8]+e[7]*e[2],e[1]*e[5]-e[4]*e[2],-e[3]*e[8]+e[6]*e[5],e[0]*e[8]-e[6]*e[2],-e[0]*e[5]+e[3]*e[2],e[3]*e[7]-e[6]*e[4],-e[0]*e[7]+e[6]*e[1],e[0]*e[4]-e[3]*e[1],-e[3]*e[7]*e[11]+e[3]*e[8]*e[10]+e[6]*e[4]*e[11]-e[6]*e[5]*e[10]-e[9]*e[4]*e[8]+e[9]*e[5]*e[7],e[0]*e[7]*e[11]-e[0]*e[8]*e[10]-e[6]*e[1]*e[11]+e[6]*e[2]*e[10]+e[9]*e[1]*e[8]-e[9]*e[2]*e[7],-e[0]*e[4]*e[11]+e[0]*e[5]*e[10]+e[3]*e[1]*e[11]-e[3]*e[2]*e[10]-e[9]*e[1]*e[5]+e[9]*e[2]*e[4]],r=1/t;return n.map((function(e){return e*r}))}},ae=function make_matrix3_translate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Q.concat(e,t,n)},ue=function single_axis_rotate(e,t,n,r,i){var o=Q.concat([0,1,2].map((function(e){return t[e]||0}))),c=Math.cos(e),a=Math.sin(e);return o[3*n+n]=c,o[3*n+r]=(i?1:-1)*a,o[3*r+n]=(i?-1:1)*a,o[3*r+r]=c,o},se=function make_matrix3_rotateX(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return ue(e,t,1,2,!0)},fe=function make_matrix3_rotateY(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return ue(e,t,0,2,!1)},le=function make_matrix3_rotateZ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return ue(e,t,0,1,!0)},ve=function make_matrix3_rotate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],i=r(3,I(t)),o=[0,1,2].map((function(e){return n[e]||0})),c=_slicedToArray(i,3),a=c[0],u=c[1],s=c[2],l=Math.cos(e),v=Math.sin(e),p=Math.sqrt(i[1]*i[1]+i[2]*i[2]),d=Math.abs(p)<1e-6?0:u/p,h=Math.abs(p)<1e-6?1:s/p,m=Q.concat(-o[0],-o[1],-o[2]),b=Q.concat(o[0],o[1],o[2]),k=[1,0,0,0,h,d,0,-d,h,0,0,0],w=[1,0,0,0,h,-d,0,d,h,0,0,0],E=[p,0,a,0,1,0,-a,0,p,0,0,0],M=[p,0,-a,0,1,0,a,0,p,0,0,0],O=[l,v,0,-v,l,0,0,0,1,0,0,0];return ie(b,ie(w,ie(M,ie(O,ie(E,ie(k,m))))))},pe=function make_matrix3_scale(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return[e,0,0,0,e,0,0,0,e,e*-t[0]+t[0],e*-t[1]+t[1],e*-t[2]+t[2]]},de=function make_matrix3_reflectZ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.atan2(e[1],e[0]),r=Math.cos(n),i=Math.sin(n),o=Math.cos(-n),c=Math.sin(-n),a=r*o+i*c,u=r*-c+i*o,s=i*o+-r*c,l=i*-c+-r*o,v=t[0]+a*-t[0]+-t[1]*s,p=t[1]+u*-t[0]+-t[1]*l;return[a,u,0,s,l,0,0,0,1,v,p,0]},_e=Object.freeze({__proto__:null,identity3x3:Q,identity3x4:ee,is_identity3x4:te,multiply_matrix3_vector3:ne,multiply_matrix3_line3:re,multiply_matrices3:ie,determinant3:oe,invert_matrix3:ce,make_matrix3_translate:ae,make_matrix3_rotateX:se,make_matrix3_rotateY:fe,make_matrix3_rotateZ:le,make_matrix3_rotate:ve,make_matrix3_scale:pe,make_matrix3_reflectZ:de}),ge=function vector_origin_form(e,t){return{vector:e||[],origin:t||[]}},he=function get_vector$1(){if(arguments[0]instanceof v.vector)return arguments[0];var e=s(arguments);return e.length>0&&"object"===_typeof(e[0])&&null!==e[0]&&!isNaN(e[0].x)&&(e=["x","y","z"].map((function(t){return e[0][t]})).filter(S)),e.filter((function(e){return"number"==typeof e}))},me=function get_vector_of_vectors(){return u(arguments).map((function(e){return he(e)}))},ye=function get_segment(){if(arguments[0]instanceof v.segment)return arguments[0];var e=u(arguments);return 4===e.length?[[e[0],e[1]],[e[2],e[3]]]:me(e)},be=function get_line(){var e=u(arguments);return 0===e.length?ge([],[]):e[0]instanceof v.line||e[0]instanceof v.ray||e[0]instanceof v.segment?e[0]:e[0].constructor===Object?ge(e[0].vector||[],e[0].origin||[]):"number"==typeof e[0]?ge(he(e)):ge.apply(void 0,_toConsumableArray(e.map((function(e){return he(e)}))))},xe=be,Ae=function get_rect_params(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{x:e,y:t,width:n,height:r}},ke=function get_rect(){if(arguments[0]instanceof v.rect)return arguments[0];var e=s(arguments);if(e.length>0&&"object"===_typeof(e[0])&&null!==e[0]&&!isNaN(e[0].width))return Ae.apply(void 0,_toConsumableArray(["x","y","width","height"].map((function(t){return e[0][t]})).filter(S)));var t=e.filter((function(e){return"number"==typeof e})),n=t.length<4?[,,].concat(_toConsumableArray(t)):t;return Ae.apply(void 0,_toConsumableArray(n))},we=function get_circle_params(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{radius:e,origin:[].concat(n)}},Ee=function get_circle(){if(arguments[0]instanceof v.circle)return arguments[0];var e=me(arguments),t=s(arguments).filter((function(e){return"number"==typeof e}));if(2===arguments.length){if(1===e[1].length)return we.apply(void 0,[e[1][0]].concat(_toConsumableArray(e[0])));if(1===e[0].length)return we.apply(void 0,[e[0][0]].concat(_toConsumableArray(e[1])));if(e[0].length>1&&e[1].length>1)return we.apply(void 0,[U.apply(void 0,_toConsumableArray(e))].concat(_toConsumableArray(e[0])))}else switch(t.length){case 0:return we(1,0,0,0);case 1:return we(t[0],0,0,0);default:return we.apply(void 0,[t.pop()].concat(_toConsumableArray(t)))}return we(1,0,0,0)},Me=[[0,1,3,4,9,10],[0,1,2,3,4,5,6,7,8,9,10,11],[0,1,2,void 0,3,4,5,void 0,6,7,8,void 0,9,10,11]];[11,7,3].forEach((function(e){return delete Me[2][e]}));var Oe=function matrix_map_3x4(e){return Me[e<8?0:e<13?1:2]},je=function get_matrix_3x4(){var e=s(arguments),t=_toConsumableArray(ee);return Oe(e.length).forEach((function(n,r){null!=e[r]&&(t[n]=e[r])})),t},Ce=Object.freeze({__proto__:null,get_vector:he,get_vector_of_vectors:me,get_segment:ye,get_line:be,get_ray:xe,get_rect_params:Ae,get_rect:ke,get_circle:Ee,get_matrix_3x4:je}),Se=function fEqual(e,t){return e===t},Pe=function fEpsilonEqual(e,t){return Math.abs(e-t)<M},Ne=function array_similarity_test(e,t){return Array.from(Array(e.length-1)).map((function(n,r){return t(e[0],e[r+1])})).reduce((function(e,t){return e&&t}),!0)},ze=function equivalent_vectors(){var e=Array.from(arguments),t=e.map((function(e){return e.length})).reduce((function(e,t){return e>t?e:t})),n=e.map((function(e){return r(t,e)}));return Array.from(Array(arguments.length-1)).map((function(e,t){return n[0].map((function(e,r){return Math.abs(n[0][r]-n[t+1][r])<M})).reduce((function(e,t){return e&&t}),!0)})).reduce((function(e,t){return e&&t}),!0)},Ie=Object.freeze({__proto__:null,equivalent_vec2:function equivalent_vec2(e,t){return Math.abs(e[0]-t[0])<M&&Math.abs(e[1]-t[1])<M},equivalent_numbers:function equivalent_numbers(){return 0!==arguments.length&&(1===arguments.length&&void 0!==arguments[0]?equivalent_numbers.apply(void 0,_toConsumableArray(arguments[0])):Ne(arguments,Pe))},equivalent_vectors:ze,equivalent:function equivalent(){var e=u.apply(void 0,arguments);if(e.length<1)return!1;var t=_typeof(e[0]);if("undefined"===t)return!1;switch(t){case"number":return Ne(e,Pe);case"boolean":case"string":return Ne(e,Se);case"object":return e[0].constructor===Array?ze.apply(void 0,_toConsumableArray(e)):Ne(e,(function(e,t){return JSON.stringify(e)===JSON.stringify(t)}));default:return}}}),Le=function ray_limiter(e){return e<-M?0:e},qe=function segment_limiter(e){return e<-M?0:e>1.000001?1:e},Te=function smallest_comparison_search(e,t,n){for(var r,i=t.map((function(t,r){return{o:t,i:r,d:n(e,t)}})),o=1/0,c=0;c<i.length;c+=1)i[c].d<o&&(r=c,o=i[c].d);return r},Fe=function nearest_point_on_line(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;t=r(e.length,t),n=r(e.length,n);var c=N(e),a=T(n,t),u=F(e,a),s=u/c,l=i(s,o);return q(t,L(e,l))},Ve=function nearest_point_on_polygon(e,t){var n=e.map((function(e,t,n){return T(n[(t+1)%n.length],e)}));return e.map((function(e,r){return Fe(n[r],e,t,qe)})).map((function(e,n){return{point:e,i:n,distance:Z(e,t)}})).sort((function(e,t){return e.distance-t.distance})).shift()},Ge=function nearest_point_on_circle(e,t,n){return q(t,L(I(T(n,t)),e))},Be=Object.freeze({__proto__:null,ray_limiter:Le,segment_limiter:qe,smallest_comparison_search:Te,nearest_point2:function nearest_point2(e,t){var n=Te(e,t,U);return void 0===n?void 0:t[n]},nearest_point:function nearest_point(e,t){var n=Te(e,t,Z);return void 0===n?void 0:t[n]},nearest_point_on_line:Fe,nearest_point_on_polygon:Ve,nearest_point_on_circle:Ge,nearest_point_on_ellipse:function nearest_point_on_ellipse(){return!1}}),De=function include_l(){return!0},Re=function include_r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return e>-t},Ue=function include_s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return e>-t&&e<1+t},Ze=function exclude_l(){return!0},Xe=function exclude_r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return e>t},$e=function exclude_s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return e>t&&e<1-t},He=function intersect_lines(e,t,n,r,i,o){var c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:M,a=D(e,n),u=-a;if(!(Math.abs(D(I(e),I(n)))<c)){var s=D(T(r,t),n),l=D(T(t,r),e),v=s/a,p=l/u;return i(v,c/P(e))&&o(p,c/P(n))?q(t,L(e,v)):void 0}},Ye=Object.freeze({__proto__:null,include_l:De,include_r:Re,include_s:Ue,exclude_l:Ze,exclude_r:Xe,exclude_s:$e,intersect_lines:He}),We=function collinear(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M,o=T(e,n),c=N(t);if(Math.sqrt(c)<i)return!1;var a=Math.sqrt(c),u=D(o,t.map((function(e){return e/a}))),s=F(o,t)/c;return Math.abs(u)<i&&r(s,i/a)},Je=function point_on_line(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return Math.abs(D(T(e,n),I(t)))<r},Ke=Object.freeze({__proto__:null,collinear:We,point_on_line:Je,point_on_ray_inclusive:function point_on_ray_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return We(e,t,n,Re,r)},point_on_ray_exclusive:function point_on_ray_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return We(e,t,n,Xe,r)},point_on_segment_inclusive:function point_on_segment_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return We(e,T(n,t),t,Ue,r)},point_on_segment_exclusive:function point_on_segment_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return We(e,T(n,t),t,$e,r)}}),Qe=function overlap_lines(e,t,n,r,i,o){var c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:M,a=D(e,n),u=-a;if(Math.abs(a)<c)return We(r,e,t,i,c)||We(r,X(e),q(t,e),i,c)||We(t,n,r,o,c)||We(t,X(n),q(r,n),o,c);var s=D(T(r,t),n),l=D(T(t,r),e),v=s/a,p=l/u;return i(v,c/P(e))&&o(p,c/P(n))},et=function overlap_segment_segment_inclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(T(t,e),e,T(r,n),n,Ue,Ue,i)},tt=function overlap_segment_segment_exclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(T(t,e),e,T(r,n),n,$e,$e,i)},nt=Object.freeze({__proto__:null,overlap_lines:Qe,overlap_line_line_inclusive:function overlap_line_line_inclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,n,r,De,De,i)},overlap_line_ray_inclusive:function overlap_line_ray_inclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,n,r,De,Re,i)},overlap_line_segment_inclusive:function overlap_line_segment_inclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,T(r,n),n,De,Ue,i)},overlap_ray_ray_inclusive:function overlap_ray_ray_inclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,n,r,Re,Re,i)},overlap_ray_segment_inclusive:function overlap_ray_segment_inclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,T(r,n),n,Re,Ue,i)},overlap_segment_segment_inclusive:et,overlap_line_line_exclusive:function overlap_line_line_exclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,n,r,Ze,Ze,i)},overlap_line_ray_exclusive:function overlap_line_ray_exclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,n,r,Ze,Xe,i)},overlap_line_segment_exclusive:function overlap_line_segment_exclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,T(r,n),n,Ze,$e,i)},overlap_ray_ray_exclusive:function overlap_ray_ray_exclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,n,r,Xe,Xe,i)},overlap_ray_segment_exclusive:function overlap_ray_segment_exclusive(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,T(r,n),n,Xe,$e,i)},overlap_segment_segment_exclusive:tt}),rt=function point_in_convex_poly_inclusive(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return D(I(T(t[1],t[0])),T(e,t[0]))>-n})).map((function(e,t,n){return e===n[0]})).reduce((function(e,t){return e&&t}),!0)},it=function point_in_convex_poly_exclusive(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return D(I(T(t[1],t[0])),T(e,t[0]))>n})).map((function(e,t,n){return e===n[0]})).reduce((function(e,t){return e&&t}),!0)},ot=function point_in_poly(e,t){for(var n=!1,r=0,i=t.length-1;r<t.length;i=r++)t[r][1]>e[1]!=t[i][1]>e[1]&&e[0]<(t[i][0]-t[r][0])*(e[1]-t[r][1])/(t[i][1]-t[r][1])+t[r][0]&&(n=!n);return n},ct=function overlap_convex_polygons(e,t,n,r,i){for(var o=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})),c=t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})),a=0;a<o.length;a+=1)for(var u=0;u<c.length;u+=1)if(n(o[a][0],o[a][1],c[u][0],c[u][1],i))return!0;return!!r(t[0],e,i)||!!r(e[0],t,i)},at=function overlap_convex_polygons_exclusive(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return ct(e,t,tt,it,n)},ut=Object.freeze({__proto__:null,point_in_convex_poly_inclusive:rt,point_in_convex_poly_exclusive:it,point_in_poly:ot,overlap_convex_polygons_inclusive:function overlap_convex_polygons_inclusive(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return ct(e,t,et,rt,n)},overlap_convex_polygons_exclusive:at,enclose_convex_polygons_inclusive:function enclose_convex_polygons_inclusive(e,t){var n=e.map((function(e){return rt(e,t)})).reduce((function(e,t){return e||t}),!1),r=t.map((function(e){return rt(e,t)})).reduce((function(e,t){return e&&t}),!0);return!n&&r}}),st=function quick_equivalent_2(e,t){return Math.abs(e[0]-t[0])<M&&Math.abs(e[1]-t[1])<M},ft=function intersect_line_seg_include(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return He(e,t,T(r,n),n,De,Ue,i)},lt=function intersect_line_seg_exclude(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return He(e,t,T(r,n),n,Ze,$e,i)},vt=function intersect_ray_seg_include(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return He(e,t,T(r,n),n,Re,Ue,i)},pt=function intersect_ray_seg_exclude(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return He(e,t,T(r,n),n,Xe,$e,i)},dt=function intersect_seg_seg_include(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return He(T(t,e),e,T(r,n),n,Ue,Ue,i)},_t=function intersect_seg_seg_exclude(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return He(T(t,e),e,T(r,n),n,$e,$e,i)},gt=function is_counter_clockwise_between(e,t,n){for(;n<t;)n+=E;for(;e>t;)e-=E;for(;e<t;)e+=E;return e<n},ht=function counter_clockwise_angle_radians(e,t){for(;e<0;)e+=E;for(;t<0;)t+=E;for(;e>E;)e-=E;for(;t>E;)t-=E;var n=t-e;return n>=0?n:E-(e-t)},mt=function clockwise_angle2(e,t){var n=t[0]*e[0]+t[1]*e[1],r=t[0]*e[1]-t[1]*e[0],i=Math.atan2(r,n);return i<0&&(i+=E),i},yt=function counter_clockwise_angle2(e,t){var n=e[0]*t[0]+e[1]*t[1],r=e[0]*t[1]-e[1]*t[0],i=Math.atan2(r,n);return i<0&&(i+=E),i},bt=function clockwise_bisect2(e,t){var n=Math.atan2(e[1],e[0])-mt(e,t)/2;return[Math.cos(n),Math.sin(n)]},xt=function counter_clockwise_bisect2(e,t){var n=Math.atan2(e[1],e[0])+yt(e,t)/2;return[Math.cos(n),Math.sin(n)]},At=function bisect_lines2(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M,o=D(e,n),c=F(e,n),a=o>-i?[xt(e,n)]:[bt(e,n)];a[1]=o>-i?$(a[0]):H(a[0]);var u=(r[0]-t[0])*n[1]-n[0]*(r[1]-t[1]),s=u/o,l=[e,n].map((function(e){return I(e)})),v=Math.abs(D.apply(void 0,_toConsumableArray(l)))<i,p=v?V(t,r):[t[0]+e[0]*s,t[1]+e[1]*s],d=a.map((function(e){return{vector:e,origin:p}}));return v&&delete d[c>-i?1:0],d},kt=function counter_clockwise_radians_order(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.map((function(e,t){return t})).sort((function(e,n){return t[e]-t[n]}));return r.slice(r.indexOf(0),r.length).concat(r.slice(0,r.indexOf(0)))},wt=function kawasaki_solutions_radians(e){return e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return ht.apply(void 0,_toConsumableArray(e))})).map((function(e,t,n){return n.slice(t+1,n.length).concat(n.slice(0,t))})).map((function(e){return J(e).map((function(e){return Math.PI-e}))})).map((function(t,n){return e[n]+t[0]})).map((function(t,n){return gt(t,e[n],e[(n+1)%e.length])?t:void 0}))},Et=Object.freeze({__proto__:null,is_counter_clockwise_between:gt,clockwise_angle_radians:function clockwise_angle_radians(e,t){for(;e<0;)e+=E;for(;t<0;)t+=E;for(;e>E;)e-=E;for(;t>E;)t-=E;var n=e-t;return n>=0?n:E-(t-e)},counter_clockwise_angle_radians:ht,clockwise_angle2:mt,counter_clockwise_angle2:yt,clockwise_bisect2:bt,counter_clockwise_bisect2:xt,bisect_lines2:At,counter_clockwise_radians_order:kt,counter_clockwise_vector_order:function counter_clockwise_vector_order(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return kt.apply(void 0,_toConsumableArray(t.map((function(e){return Math.atan2(e[1],e[0])}))))},interior_angles:function interior_angles(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map((function(e,t,n){return yt(e,n[(t+1)%n.length])}))},kawasaki_solutions_radians:wt,kawasaki_solutions:function kawasaki_solutions(e){var t=e.map((function(e){return Math.atan2(e[1],e[0])}));return wt(t).map((function(e){return void 0===e?void 0:[Math.cos(e),Math.sin(e)]}))}}),Mt=function circumcircle(e,t,n){var r=t[0]-e[0],i=t[1]-e[1],o=n[0]-e[0],c=n[1]-e[1],a=r*(e[0]+t[0])+i*(e[1]+t[1]),u=o*(e[0]+n[0])+c*(e[1]+n[1]),s=2*(r*(n[1]-t[1])-i*(n[0]-t[0]));if(Math.abs(s)<M){var l=Math.min(e[0],t[0],n[0]),v=Math.min(e[1],t[1],n[1]),p=.5*(Math.max(e[0],t[0],n[0])-l),d=.5*(Math.max(e[1],t[1],n[1])-v);return{origin:[l+p,v+d],radius:Math.sqrt(p*p+d*d)}}var h=[(c*a-i*u)/s,(r*u-o*a)/s],m=h[0]-e[0],b=h[1]-e[1];return{origin:h,radius:Math.sqrt(m*m+b*b)}},Ot=function signed_area(e){return.5*e.map((function(e,t,n){var r=n[(t+1)%n.length];return e[0]*r[1]-r[0]*e[1]})).reduce(C,0)},jt=function centroid(e){var t=1/(6*Ot(e));return e.map((function(e,t,n){var r=n[(t+1)%n.length],i=e[0]*r[1]-r[0]*e[1];return[(e[0]+r[0])*i,(e[1]+r[1])*i]})).reduce((function(e,t){return[e[0]+t[0],e[1]+t[1]]}),[0,0]).map((function(e){return e*t}))},Ct=function enclosing_rectangle(e){var t=Array(e[0].length).fill(1/0),n=Array(e[0].length).fill(-1/0);e.forEach((function(e){return e.forEach((function(e,r){e<t[r]&&(t[r]=e),e>n[r]&&(n[r]=e)}))}));var r=n.map((function(e,n){return e-t[n]}));return Ae.apply(void 0,_toConsumableArray(t).concat(_toConsumableArray(r)))},St=function angle_array(e){return Array.from(Array(Math.floor(e))).map((function(t,n){return E*(n/e)}))},Pt=function angles_to_vecs(e,t){return e.map((function(e){return[t*Math.cos(e),t*Math.sin(e)]})).map((function(e){return e.map((function(e){return c(e,14)}))}))},Nt=function make_regular_polygon(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Pt(St(e),t)},zt=function make_regular_polygon_side_aligned(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=Math.PI/e,r=St(e).map((function(e){return e+n}));return Pt(r,t)},It=function split_polygon(){return console.warn("split polygon not done")},Lt=function split_convex_polygon(e,t,n){var r=e.map((function(e,r){return{point:Je(e,t,n)?e:null,at_index:r}})).filter((function(e){return null!=e.point})),i=e.map((function(e,r,i){return{point:lt(t,n,e,i[(r+1)%i.length]),at_index:r}})).filter((function(e){return null!=e.point}));if(2==i.length){var o=i.slice().sort((function(e,t){return e.at_index-t.at_index})),c=e.slice(o[1].at_index+1).concat(e.slice(0,o[0].at_index+1));c.push(o[0].point),c.push(o[1].point);var a=e.slice(o[0].at_index+1,o[1].at_index+1);return a.push(o[1].point),a.push(o[0].point),[c,a]}if(1==i.length&&1==r.length){r[0].type="v",i[0].type="e";var u=r.concat(i).sort((function(e,t){return e.at_index-t.at_index})),s=e.slice(u[1].at_index+1).concat(e.slice(0,u[0].at_index+1));"e"===u[0].type&&s.push(u[0].point),s.push(u[1].point);var l=e.slice(u[0].at_index+1,u[1].at_index+1);return"e"===u[1].type&&l.push(u[1].point),l.push(u[0].point),[s,l]}if(2==r.length){var v=r.slice().sort((function(e,t){return e.at_index-t.at_index}));return[e.slice(v[1].at_index).concat(e.slice(0,v[0].at_index+1)),e.slice(v[0].at_index,v[1].at_index+1)]}return[e.slice()]},qt=function convex_hull(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M,n=1e4,r=e.slice().sort((function(e,n){return Math.abs(e[1]-n[1])<t?e[0]-n[0]:e[1]-n[1]})),i=[];i.push(r[0]);var o=0,c=0,a=function _loop(){c+=1;var e=i.length-1,n=r.filter((function(n){return!(Math.abs(n[0]-i[e][0])<t&&Math.abs(n[1]-i[e][1])<t)})).map((function(t){for(var n=Math.atan2(i[e][1]-t[1],i[e][0]-t[0]);n<o;)n+=2*Math.PI;return{node:t,angle:n,distance:void 0}})).sort((function(e,t){return e.angle<t.angle?-1:e.angle>t.angle?1:0}));if(0===n.length)return{v:void 0};var a=n[0];if(n=n.filter((function(e){return Math.abs(a.angle-e.angle)<t})).map((function(t){var n=Math.sqrt(Math.pow(i[e][0]-t.node[0],2)+Math.pow(i[e][1]-t.node[1],2));return t.distance=n,t})).sort((function(e,t){return e.distance<t.distance?1:e.distance>t.distance?-1:0})),i.filter((function(e){return e===n[0].node})).length>0)return{v:i};i.push(n[0].node),o=Math.atan2(i[e][1]-n[0].node[1],i[e][0]-n[0].node[0])};do{var u=a();if("object"===_typeof(u))return u.v}while(c<n)},Tt=function recurseSkeleton(e,t,n){var r=e.map((function(e,t){return{vector:n[t],origin:e}})).map((function(e,t,n){return He(e.vector,e.origin,n[(t+1)%n.length].vector,n[(t+1)%n.length].origin,Xe,Xe)})),i=t.map((function(e,t){return Fe(e.vector,e.origin,r[t],(function(e){return e}))}));if(3===e.length)return e.map((function(e){return{type:"skeleton",points:[e,r[0]]}})).concat([{type:"perpendicular",points:[i[0],r[0]]}]);var o=r.map((function(e,t){return Z(e,i[t])})),c=0;o.forEach((function(e,t){e<o[c]&&(c=t)}));var a=[{type:"skeleton",points:[e[c],r[c]]},{type:"skeleton",points:[e[(c+1)%e.length],r[c]]},{type:"perpendicular",points:[i[c],r[c]]}],u=bt(X(t[(c+t.length-1)%t.length].vector),t[(c+1)%t.length].vector),s=c===e.length-1;return e.splice(c,2,r[c]),t.splice(c,1),n.splice(c,2,u),s&&(e.splice(0,1),n.splice(0,1),t.push(t.shift())),a.concat(recurseSkeleton(e,t,n))},Ft=function straight_skeleton(e){var t=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return{vector:T(e[1],e[0]),origin:e[0]}})),n=e.map((function(e,t,n){return[(t-1+n.length)%n.length,t,(t+1)%n.length].map((function(e){return n[e]}))})).map((function(e){return[T(e[0],e[1]),T(e[2],e[1])]})).map((function(e){return bt.apply(void 0,_toConsumableArray(e))}));return Tt(e,t,n)},Vt=Object.freeze({__proto__:null,circumcircle:Mt,signed_area:Ot,centroid:jt,enclosing_rectangle:Ct,make_regular_polygon:Nt,make_regular_polygon_side_aligned:zt,make_regular_polygon_inradius:function make_regular_polygon_inradius(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Nt(e,t/Math.cos(Math.PI/e))},make_regular_polygon_inradius_side_aligned:function make_regular_polygon_inradius_side_aligned(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return zt(e,t/Math.cos(Math.PI/e))},make_regular_polygon_side_length:function make_regular_polygon_side_length(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Nt(e,t/2/Math.sin(Math.PI/e))},make_regular_polygon_side_length_side_aligned:function make_regular_polygon_side_length_side_aligned(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return zt(e,t/2/Math.sin(Math.PI/e))},split_polygon:It,split_convex_polygon:Lt,convex_hull:qt,straight_skeleton:Ft}),Gt=function acossafe(e){return e>=1?0:e<=-1?Math.PI:Math.acos(e)},Bt=function rotatePoint(e,t,n){var r=t[0]-e[0],i=t[1]-e[1],o=r*Math.cos(n)+i*Math.sin(n),c=i*Math.cos(n)-r*Math.sin(n);return[e[0]+o,e[1]+c]},Dt=function circle_circle(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M,r=e.radius<t.radius?e.radius:t.radius,i=e.radius<t.radius?t.radius:e.radius,o=e.radius<t.radius?e.origin:t.origin,c=e.radius<t.radius?t.origin:e.origin,a=[o[0]-c[0],o[1]-c[1]],u=Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2));if(!(u<n)){var s=a.map((function(e,t){return e/u*i+c[t]}));if(Math.abs(i+r-u)<n||Math.abs(i-(r+u))<n)return[s];if(!(u+r<i||i+r<u)){var l=Gt((r*r-u*u-i*i)/(-2*u*i)),v=Bt(c,s,+l),p=Bt(c,s,-l);return[v,p]}}},Rt=function intersect_circle_line(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:M,c=Math.pow(n[0],2)+Math.pow(n[1],2),a=Math.sqrt(c),u=0===a?n:n.map((function(e){return e/a})),s=[-u[1],u[0]],l=[r[0]-t[0],r[1]-t[1]],v=l[0]*u[1]-u[0]*l[1];if(!(Math.abs(v)>e+o)){var p=Math.sqrt(Math.pow(e,2)-Math.pow(v,2)),d=function f(e,n){return t[n]-s[n]*v+u[n]*e},h=Math.abs(e-Math.abs(v))<o?[p].map((function(e){return[e,e].map(d)})):[-p,p].map((function(e){return[e,e].map(d)})),m=h.map((function(e){return e.map((function(e,t){return e-r[t]}))})).map((function(e){return e[0]*n[0]+n[1]*e[1]})).map((function(e){return e/c}));return h.filter((function(e,t){return i(m[t],o)}))}},Ut=function line_func(){return!0},Zt=function ray_func(e,t){return e>-t},Xt=function segment_func(e,t){return e>-t&&e<1+t},$t=function circle_line(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return Rt(e.radius,e.origin,t.vector,t.origin,Ut,n)},Ht=function circle_ray(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return Rt(e.radius,e.origin,t.vector,t.origin,Zt,n)},Yt=function circle_segment(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return Rt(e.radius,e.origin,t.vector,t.origin,Xt,n)},Wt=Object.freeze({__proto__:null,circle_circle:Dt,intersect_circle_line:Rt,circle_line:$t,circle_ray:Ht,circle_segment:Yt}),Jt=function cuberoot(e){var t=Math.pow(Math.abs(e),1/3);return e<0?-t:t},Kt=Object.freeze({__proto__:null,axiom1:function axiom1(e,t){return v.line(I(T.apply(void 0,_toConsumableArray(i(t,e)))),e)},axiom2:function axiom2(e,t){return v.line(I($(T.apply(void 0,_toConsumableArray(i(t,e))))),V(e,t))},axiom3:function axiom3(e,t,n,r){return At(e,t,n,r).map(v.line)},axiom4:function axiom4(e,t){return v.line($(I(e)),t)},axiom5:function axiom5(e,t,n,r){return(Rt(Z(n,r),n,e,t,(function(){return!0}))||[]).map((function(e){return v.line(I($(T.apply(void 0,_toConsumableArray(i(e,r))))),V(r,e))}))},axiom7:function axiom7(e,t,n,r){var o=He(e,t,n,r,De,De);return void 0===o?void 0:v.line(I($(T.apply(void 0,_toConsumableArray(i(o,r))))),V(r,o))},axiom6:function axiom6(e,t,n,r,i,o){var c=i[0],a=i[1];if(Math.abs(e[0])>M)var u=e[1]/e[0],s=t[1]-u*t[0];else var l=t[0];var p=o[0],d=o[1];if(Math.abs(n[0])>M)var h=n[1]/n[0],m=r[1]-h*r[0];else var b=r[0];if(void 0!==u&&void 0!==h)var k=u*u+1,w=2*u*s,E=s*s-c*c-a*a,O=h*h+1,j=2*h*m,C=m*m-p*p-d*d,S=h*c+(s-a),P=c*(m-d)-p*(s-a),N=h-u,I=u*p+(m-d),L=u*c+(s-a);else if(void 0===u&&void 0===h)k=1,w=0,E=l*l-c*c-a*a,O=1,j=0,C=b*b-p*p-d*d,P=a*(b-p)-d*(l-c),N=0,I=b-p,L=S=l-c;else{if(void 0===u){var q=c;c=p,p=q;var T=a;a=d,d=T,u=h,h=void 0,s=m,m=void 0,b=l,l=void 0}k=u*u+1,w=2*u*s,E=s*s-c*c-a*a,O=1,j=0,C=b*b-p*p-d*d,S=c,P=(s-a)*(b-p)-c*d,N=1,I=-u*(b-p)-d,L=u*c+(s-a)}var F=function solveCubic(e,t,n,r){if(Math.abs(e)<M){if(e=t,t=n,n=r,Math.abs(e)<M)return e=t,t=n,Math.abs(e)<M?[]:[-t/e];var i=t*t-4*e*n;return Math.abs(i)<M?[-t/(2*e)]:i>0?[(-t+Math.sqrt(i))/(2*e),(-t-Math.sqrt(i))/(2*e)]:[]}var o,c=(3*e*n-t*t)/(3*e*e),a=(2*t*t*t-9*e*t*n+27*e*e*r)/(27*e*e*e);if(Math.abs(c)<M)o=[Jt(-a)];else if(Math.abs(a)<M)o=[0].concat(c<0?[Math.sqrt(-c),-Math.sqrt(-c)]:[]);else{var u=a*a/4+c*c*c/27;if(Math.abs(u)<M)o=[-1.5*a/c,3*a/c];else if(u>0){var s=Jt(-a/2-Math.sqrt(u));o=[s-c/(3*s)]}else{var l=2*Math.sqrt(-c/3),v=Math.acos(3*a/c/l)/3,p=2*Math.PI/3;o=[l*Math.cos(v),l*Math.cos(v-p),l*Math.cos(v-2*p)]}}for(var d=0;d<o.length;d+=1)o[d]-=t/(3*e);return o}(O*N*L,(O*I+j*N)*L-(k*S*S+w*S*N+E*N*N),(j*I+C*N)*L-(2*k*S*P+w*(S*I+P*N)+2*E*N*I),C*I*L-(k*P*P+w*P*I+E*I*I)),V=[];if(null!=F&&F.length>0)for(var G=0;G<F.length;++G){if(void 0!==u&&void 0!==h)var B=F[G],D=h*B+m;else D=F[G],B=b;if(D!=d){var R=-1*(B-p)/(D-d),U=(D*D-d*d+B*B-p*p)/(2*(D-d));V.push(v.line.fromPoints([0,U],[1,R]))}else{var Z=(B+p)/2;V.push(v.line.fromPoints([Z,0],[0,1]))}}return V}}),Qt=function get_unique_pair(e){for(var t=1;t<e.length;t+=1)if(!st(e[0],e[t]))return[e[0],e[t]]},en=function convex_poly_line_intersect(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M,o=t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return e(n,r,t[0],t[1],i)})).filter((function(e){return null!=e}));switch(o.length){case 0:return;case 1:return[o];default:return Qt(o)||[o[0]]}},tn=function poly_include_exclude_func(e,t,n,r,i){var o,c=en(e,t,n,r,i);switch(e){case lt:o=ft;break;case pt:o=vt;break;case _t:o=dt;break;case ft:case vt:case dt:default:return c}var a=en(o,t,n,r,i);if(void 0!==a){var u=Qt(a);if(void 0===u)switch(e){case lt:return;case pt:return it(r,t,i)?a:void 0;case _t:return it(n,t,i)||it(r,t,i)?a:void 0}return it(V.apply(void 0,_toConsumableArray(u)),t,i)?u:c}},nn=function convex_poly_line_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return tn(lt,e,t,n,r)},rn=function convex_poly_ray_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return tn(pt,e,t,n,r)},on=function convex_poly_segment_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return tn(_t,e,t,n,r)},cn=Object.freeze({__proto__:null,convex_poly_line_inclusive:function convex_poly_line_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return tn(ft,e,t,n,r)},convex_poly_line_exclusive:nn,convex_poly_ray_inclusive:function convex_poly_ray_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return tn(vt,e,t,n,r)},convex_poly_ray_exclusive:rn,convex_poly_segment_inclusive:function convex_poly_segment_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return tn(dt,e,t,n,r)},convex_poly_segment_exclusive:on}),an=function convexPolyLine(e,t){return nn(e,t.vector,t.origin)},un=function convexPolyRay(e,t){return rn(e,t.vector,t.origin)},sn=function convexPolySegment(e,t){return on(e,t[0],t[1])},fn=function lineFunc(e,t,n,r,i){return He(e.vector,e.origin,t.vector,t.origin,n,r,i)},ln={polygon:{line:an,ray:un,segment:sn},circle:{circle:Dt,line:$t,ray:Ht,segment:Yt},line:{polygon:function polygon(e,t){return an(t,e)},circle:function circle(e,t){return $t(t,e)},line:function line(e,t,n){return fn(e,t,Ze,Ze,n)},ray:function ray(e,t,n){return fn(e,t,Ze,Xe,n)},segment:function segment(e,t,n){return fn(e,t,Ze,$e,n)}},ray:{polygon:function polygon(e,t){return un(t,e)},circle:function circle(e,t){return Ht(t,e)},line:function line(e,t,n){return fn(t,e,Ze,Xe,n)},ray:function ray(e,t,n){return fn(e,t,Xe,Xe,n)},segment:function segment(e,t,n){return fn(e,t,Xe,$e,n)}},segment:{polygon:function polygon(e,t){return sn(t,e)},circle:function circle(e,t){return Yt(t,e)},line:function line(e,t,n){return fn(t,e,Ze,$e,n)},ray:function ray(e,t,n){return fn(t,e,Xe,$e,n)},segment:function segment(e,t,n){return fn(e,t,$e,$e,n)}}},vn={polygon:"polygon",rect:"polygon",circle:"circle",line:"line",ray:"ray",segment:"segment"},pn=function intersect(e,t){var r,i=vn[n(e)],o=vn[n(t)];return(r=ln[i])[o].apply(r,arguments)},dn=Object.assign(Object.create(null),nt,Ke,ut),_n=function get_unique_pair$1(e){for(var t=1;t<e.length;t+=1)if(!st(e[0],e[t]))return[e[0],e[t]]},gn=function get_unique_points(e){for(var t=[],n=0;n<e.length;n+=1){for(var r=!1,i=0;i<t.length;i+=1)st(e[n],t[i])&&(r=!0);r||t.push(e[n])}return t},hn=function sortPointsAlongVector(e,t){return e.map((function(e){return{point:e,d:e[0]*t[0]+e[1]*t[1]}})).sort((function(e,t){return e.d-t.d})).map((function(e){return e.point}))},mn=function collinear_check(e,t,n){var r=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return T.apply(void 0,_toConsumableArray(e))}));return r.map((function(e,n){return W(e,t)?n:void 0})).filter(S).map((function(t){return Je(n,r[t],e[t])})).reduce((function(e,t){return e||t}),!1)},yn=function clip_intersections(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return e(n,r,t[0],t[1],i)})).filter(S)},bn=function clip_line_in_convex_poly_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,i=(yn(lt,e,t,n,r),yn(ft,e,t,n,r));if(void 0!==i){var o=_n(i);if(void 0!==o)return it(V.apply(void 0,_toConsumableArray(o)),e,r)?o:void 0}},xn=function clip_ray_in_convex_poly_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,i=(yn(pt,e,t,n,r),yn(vt,e,t,n,r));if(void 0!==i){var o=_n(i);return void 0===o?it(n,e,r)?[n,i[0]]:void 0:it(V.apply(void 0,_toConsumableArray(o)),e,r)?o:void 0}},An=function clip_segment_func(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,i=[t,n],o=i.map((function(t){return rt(t,e,r)}));if(!0===o[0]&&!0===o[1])return[_toConsumableArray(t),_toConsumableArray(n)];var c=yn(dt,e,t,n,r),a=gn(c);if(2===a.length)return a;if(a.length>2){var u=hn(a,T(n,t));return[u[0],u[u.length-1]]}if(c.length>0){var s=i.map((function(t){return it(t,e,r)}));if(!0===s[0])return[_toConsumableArray(t),c[0]];if(!0===s[1])return[_toConsumableArray(n),c[0]]}},kn=function clip_segment_in_convex_poly_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,i=T(n,t);if(!mn(e,i,t))return An(e,t,n,r)},wn=Object.freeze({__proto__:null,clip_line_in_convex_poly_inclusive:function clip_line_in_convex_poly_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,i=yn(ft,e,t,n,r);switch(i.length){case 0:case 1:return;default:return _n(i)}},clip_line_in_convex_poly_exclusive:bn,clip_ray_in_convex_poly_inclusive:function clip_ray_in_convex_poly_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,i=yn(vt,e,t,n,r);if(0!==i.length){rt(n,e);return _n(i)||[n,i[0]]}},clip_ray_in_convex_poly_exclusive:xn,clip_segment_in_convex_poly_inclusive:function clip_segment_in_convex_poly_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return An(e,t,n,r)},clip_segment_in_convex_poly_exclusive:kn}),En={preserve:{magnitude:function magnitude(){return P(this)},isEquivalent:function isEquivalent(){return ze(this,he(arguments))},isParallel:function isParallel(){return W.apply(void 0,_toConsumableArray(i(this,he(arguments))))},dot:function dot(){return F.apply(void 0,_toConsumableArray(i(this,he(arguments))))},distanceTo:function distanceTo(){return Z.apply(void 0,_toConsumableArray(i(this,he(arguments))))}},vector:{copy:function copy(){return _toConsumableArray(this)},normalize:function normalize(){return I(this)},scale:function scale(){return L(this,arguments[0])},flip:function flip(){return X(this)},rotate90:function rotate90(){return $(this)},rotate270:function rotate270(){return H(this)},cross:function cross(){return R(r(3,this),r(3,he(arguments)))},transform:function transform(){return ne(je(arguments),r(3,this))},add:function add(){return q(this,r(this.length,he(arguments)))},subtract:function subtract(){return T(this,r(this.length,he(arguments)))},rotateZ:function rotateZ(e,t){return ne(je(m(e,t)),r(3,this))},lerp:function lerp(e,t){return B(this,r(this.length,he(e)),t)},midpoint:function midpoint(){return V.apply(void 0,_toConsumableArray(i(this,he(arguments))))},bisect:function bisect(){return xt(this,he(arguments))}}},Mn={};Object.keys(En.preserve).forEach((function(e){Mn[e]=En.preserve[e]})),Object.keys(En.vector).forEach((function(e){Mn[e]=function(){return v.vector.apply(v,_toConsumableArray(En.vector[e].apply(this,arguments)))}}));var On={fromAngle:function fromAngle(e){return v.vector(Math.cos(e),Math.sin(e))},fromAngleDegrees:function fromAngleDegrees(e){return v.vector.fromAngle(e*w)}},jn={vector:{P:Array.prototype,A:function VectorArgs(){var e=this;he(arguments).forEach((function(t){return e.push(t)}))},G:{x:function x(){return this[0]},y:function y(){return this[1]},z:function z(){return this[2]}},M:Mn,S:On}},Cn={};Cn.prototype=Object.create(Object.prototype),Cn.prototype.constructor=Cn,Cn.prototype.isParallel=function(){var e=i(this.vector,be.apply(void 0,arguments).vector);return W.apply(void 0,_toConsumableArray(e))},Cn.prototype.isCollinear=function(){var e=be(arguments);return Je(e.origin,this.vector,this.origin)&&W.apply(void 0,_toConsumableArray(i(this.vector,e.vector)))},Cn.prototype.isDegenerate=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M;return Y(this.vector,e)},Cn.prototype.reflectionMatrix=function(){return v.matrix(de(this.vector,this.origin))},Cn.prototype.nearestPoint=function(){var e=he(arguments);return v.vector(Fe(this.vector,this.origin,e,this.clip_function))},Cn.prototype.transform=function(){var e=this.dimension,t=re(je(arguments),r(3,this.vector),r(3,this.origin));return this.constructor(r(e,t.vector),r(e,t.origin))},Cn.prototype.translate=function(){var e=q.apply(void 0,_toConsumableArray(i(this.origin,he(arguments))));return this.constructor(this.vector,e)},Cn.prototype.intersect=function(e){return pn(this,e)},Cn.prototype.bisect=function(){var e=be(arguments);return At(this.vector,this.origin,e.vector,e.origin)},Object.defineProperty(Cn.prototype,"dimension",{get:function get(){return[this.vector,this.origin].map((function(e){return e.length})).reduce((function(e,t){return Math.max(e,t)}),0)}});var Sn={fromPoints:function fromPoints(){var e=me(arguments);return this.constructor({vector:T(e[1],e[0]),origin:e[0]})},fromAngle:function fromAngle(){var e=arguments[0]||0;return this.constructor({vector:[Math.cos(e),Math.sin(e)],origin:[0,0]})},perpendicularBisector:function perpendicularBisector(){var e=me(arguments);return this.constructor({vector:$(T(e[1],e[0])),origin:G(e[0],e[1])})}},Pn={line:{P:Cn.prototype,A:function A(){var e=be.apply(void 0,arguments);this.vector=v.vector(e.vector),this.origin=v.vector(r(this.vector.length,e.origin))},G:{length:function length(){return 1/0}},M:{clip_function:function clip_function(e){return e},svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e4,t=this.origin.add(this.vector.scale(-e/2)),n=this.vector.scale(e);return"M".concat(t[0]," ").concat(t[1],"l").concat(n[0]," ").concat(n[1])}},S:Sn}},Nn={ray:{P:Cn.prototype,A:function A(){var e=be.apply(void 0,arguments);this.vector=v.vector(e.vector),this.origin=v.vector(r(this.vector.length,e.origin))},G:{length:function length(){return 1/0}},M:{flip:function flip(){return v.ray(X(this.vector),this.origin)},scale:function scale(e){return v.ray(this.vector.scale(e),this.origin)},normalize:function normalize(){return v.ray(this.vector.normalize(),this.origin)},clip_function:Le,svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,t=this.vector.scale(e);return"M".concat(this.origin[0]," ").concat(this.origin[1],"l").concat(t[0]," ").concat(t[1])}},S:Sn}},zn={segment:{P:Cn.prototype,A:function A(){var e=ye.apply(void 0,arguments);this.points=[v.vector(e[0]),v.vector(e[1])],this.vector=this.points[1].subtract(this.points[0]),this.origin=this.points[0]},G:{0:function _(){return this.points[0]},1:function _(){return this.points[1]},length:function length(){return this.vector.magnitude()}},M:{clip_function:qe,transform:function transform(){for(var e=this.points[0].length,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var o=je(n),c=this.points.map((function(e){return r(3,e)})).map((function(e){return ne(o,e)})).map((function(t){return r(e,t)}));return v.segment(c)},translate:function translate(){var translate=get_vector(arguments),e=this.points.map((function(e){return add.apply(void 0,_toConsumableArray(resize_up(e,translate)))}));return v.segment(e)},midpoint:function midpoint(){return v.vector(G(this.points[0],this.points[1]))},svgPath:function svgPath(){var e=this.points.map((function(e){return"".concat(e[0]," ").concat(e[1])}));return["M","L"].map((function(t,n){return"".concat(t).concat(e[n])})).join("")}},S:{fromPoints:function fromPoints(){return this.constructor.apply(this,arguments)}}}},In=function pointOnEllipse(e,t,n,r,i,o){var c=Math.cos(i),a=Math.sin(i),u=Math.cos(o),s=Math.sin(o);return[e+c*n*u+-a*r*s,t+a*n*u+c*r*s]},Ln=function pathInfo(e,t,n,r,i,o,c){var a=o;if(a<0&&!isNaN(a))for(;a<0;)a+=2*Math.PI;var u=c>2*Math.PI?2*Math.PI:c,s=In(e,t,n,r,i,a),l=In(e,t,n,r,i,a+u/2),v=In(e,t,n,r,i,a+u),p=u/2>Math.PI?1:0,d=u/2>0?1:0;return{x1:s[0],y1:s[1],x2:l[0],y2:l[1],x3:v[0],y3:v[1],fa:p,fs:d}},qn=function cln(e){return c(e,4)},Tn=function ellipticalArcTo(e,t,n,r,i,o,c){return"A".concat(qn(e)," ").concat(qn(t)," ").concat(qn(n)," ").concat(qn(r)," ").concat(qn(i)," ").concat(qn(o)," ").concat(qn(c))},Fn={circle:{A:function CircleArgs(){var e=Ee.apply(void 0,arguments);this.radius=e.radius,this.origin=v.vector.apply(v,_toConsumableArray(e.origin))},G:{x:function x(){return this.origin[0]},y:function y(){return this.origin[1]},z:function z(){return this.origin[2]}},M:{nearestPoint:function nearestPoint(){return v.vector(Ge(this.radius,this.origin,he(arguments)))},intersect:function intersect(e){return pn(this,e)},svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,n=Ln(this.origin[0],this.origin[1],this.radius,this.radius,0,e,t),r=Tn(this.radius,this.radius,0,n.fa,n.fs,n.x2,n.y2),i=Tn(this.radius,this.radius,0,n.fa,n.fs,n.x3,n.y3);return"M".concat(n.x1," ").concat(n.y1).concat(r).concat(i)},points:function points(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(t)).map((function(e,n){return 2*Math.PI/t*n})).map((function(t){return[e.origin[0]+e.radius*Math.cos(t),e.origin[1]+e.radius*Math.sin(t)]}))},polygon:function polygon(){return v.polygon(this.points(arguments[0]))},segments:function segments(){var e=this.points(arguments[0]);return e.map((function(t,n){var r=(n+1)%e.length;return[t,e[r]]}))}},S:{fromPoints:function fromPoints(){if(3===arguments.length){var e=Mt.apply(void 0,arguments);return this.constructor(e.radius,e.origin)}return this.constructor.apply(this,arguments)},fromThreePoints:function fromThreePoints(){var e=Mt.apply(void 0,arguments);return this.constructor(e.radius,e.origin)}}}},Vn=function getFoci(e,t,n,r){var i=t>n,o=i?Math.pow(t,2)-Math.pow(n,2):Math.pow(n,2)-Math.pow(t,2),c=Math.sqrt(o),a=i?Math.cos(r):Math.sin(r),u=i?Math.sin(r):Math.cos(r);return[v.vector(e[0]+c*a,e[1]+c*u),v.vector(e[0]-c*a,e[1]-c*u)]},Gn={ellipse:{A:function A(){var e=s(arguments).filter((function(e){return!isNaN(e)})),t=r(5,e);this.rx=t[0],this.ry=t[1],this.origin=v.vector(t[2],t[3]),this.spin=t[4],this.foci=Vn(this.origin,this.rx,this.ry,this.spin)},G:{x:function x(){return this.origin[0]},y:function y(){return this.origin[1]}},M:{svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,n=Ln(this.origin[0],this.origin[1],this.rx,this.ry,this.spin,e,t),r=Tn(this.rx,this.ry,this.spin/Math.PI*180,n.fa,n.fs,n.x2,n.y2),i=Tn(this.rx,this.ry,this.spin/Math.PI*180,n.fa,n.fs,n.x3,n.y3);return"M".concat(n.x1," ").concat(n.y1).concat(r).concat(i)},points:function points(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(t)).map((function(e,n){return 2*Math.PI/t*n})).map((function(t){return In(e.origin.x,e.origin.y,e.rx,e.ry,e.spin,t)}))},polygon:function polygon(){return v.polygon(this.points(arguments[0]))},segments:function segments(){var e=this.points(arguments[0]);return e.map((function(t,n){var r=(n+1)%e.length;return[t,e[r]]}))}},S:{}}},Bn=function makeClip(e){return void 0===e?void 0:v.segment(e)},Dn={area:function area(){return Ot(this)},centroid:function centroid(){return v.vector(jt(this))},enclosingRectangle:function enclosingRectangle(){return v.rect(Ct(this))},contains:function contains(){return ot(he(arguments),this)},scale:function scale(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jt(this),n=this.map((function(e){return[0,1].map((function(n,r){return e[r]-t[r]}))})).map((function(n){return n.map((function(r,i){return t[i]+n[i]*e}))}));return this.constructor.fromPoints(n)},rotate:function rotate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jt(this),n=this.map((function(n){var r=[n[0]-t[0],n[1]-t[1]],i=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)),o=Math.atan2(r[1],r[0]);return[t[0]+Math.cos(o+e)*i,t[1]+Math.sin(o+e)*i]}));return v.polygon(n)},translate:function translate(){var e=he.apply(void 0,arguments),t=this.map((function(t){return t.map((function(t,n){return t+e[n]}))}));return this.constructor.fromPoints(t)},transform:function transform(){var e=je.apply(void 0,arguments),t=this.map((function(t){return ne(e,r(3,t))}));return v.polygon(t)},nearest:function nearest(){var e=he.apply(void 0,arguments),t=Ve(this,e);return void 0===t?void 0:Object.assign(t,{edge:this.sides[t.i]})},overlaps:function overlaps(){var e=u(arguments);return at(this,e)},split:function split(){var e=be.apply(void 0,arguments),t=this.isConvex?Lt:It;return t(this,e.vector,e.origin).map((function(e){return v.polygon(e)}))},intersectLine:function intersectLine(){var e=be.apply(void 0,arguments);return nn(this,e.vector,e.origin)},intersectRay:function intersectRay(){var e=be.apply(void 0,arguments);return rn(this,e.vector,e.origin)},intersectSegment:function intersectSegment(){var e=ye.apply(void 0,arguments);return on(this,e[0],e[1])},clipLine:function clipLine(){var e=be.apply(void 0,arguments),t=bn(this,e.vector,e.origin);return Bn(t)},clipRay:function clipRay(){var e=be.apply(void 0,arguments),t=xn(this,e.vector,e.origin);return Bn(t)},clipSegment:function clipSegment(){var e=ye.apply(void 0,arguments),t=kn(this,e[0],e[1]);return Bn(t)},clip:function clip(e){switch(n(e)){case"segment":return this.clipSegment(e);case"ray":return this.clipRay(e);case"line":return this.clipLine(e);default:return}},svgPath:function svgPath(){var e=Array(this.length).fill("L");return e[0]="M","".concat(this.map((function(t,n){return"".concat(e[n]).concat(t[0]," ").concat(t[1])})).join(""),"z")},intersect:function intersect(e){return pn(this,e)}},Rn={};Rn.prototype=Object.create(Array.prototype),Rn.prototype.constructor=Rn,Object.keys(Dn).forEach((function(e){Rn.prototype[e]=Dn[e]}));var Un=function rectToPoints(e){return[[e.x,e.y],[e.x+e.width,e.y],[e.x+e.width,e.y+e.height],[e.x,e.y+e.height]]},Zn={rect:{P:Rn.prototype,A:function A(){var e=ke.apply(void 0,arguments);this.width=e.width,this.height=e.height,this.origin=v.vector(e.x,e.y),this.push.apply(this,_toConsumableArray(Un(this)))},G:{x:function x(){return this.origin[0]},y:function y(){return this.origin[1]},center:function center(){return v.vector(this.origin[0]+this.width/2,this.origin[1]+this.height/2)}},M:{area:function area(){return this.width*this.height},segments:function segments(){return function rectToSides(e){return[[[e.x,e.y],[e.x+e.width,e.y]],[[e.x+e.width,e.y],[e.x+e.width,e.y+e.height]],[[e.x+e.width,e.y+e.height],[e.x,e.y+e.height]],[[e.x,e.y+e.height],[e.x,e.y]]]}(this)},svgPath:function svgPath(){return"M".concat(this.origin.join(" "),"h").concat(this.width,"v").concat(this.height,"h").concat(-this.width,"Z")}},S:{fromPoints:function fromPoints(){return v.rect(Ct(me(arguments)))}}}},Xn={polygon:{P:Rn.prototype,A:function A(){this.push.apply(this,_toConsumableArray(u(arguments))),this.sides=this.map((function(e,t,n){return[e,n[(t+1)%n.length]]})),this.vectors=this.sides.map((function(e){return T(e[1],e[0])}))},G:{isConvex:function isConvex(){return!0},points:function points(){return this}},M:{segments:function segments(){return this.sides},straightSkeleton:function straightSkeleton(){return Ft(this)}},S:{fromPoints:function fromPoints(){return this.constructor.apply(this,arguments)},regularPolygon:function regularPolygon(){return this.constructor(Nt.apply(void 0,arguments))},convexHull:function convexHull(){return this.constructor(qt.apply(void 0,arguments))}}}},$n=function assign(e,t){for(var n=0;n<12;n+=1)e[n]=t[n];return e},Hn={matrix:{P:Array.prototype,A:function A(){var e=this;je(arguments).forEach((function(t){return e.push(t)}))},G:{},M:{copy:function copy(){return v.matrix.apply(v,_toConsumableArray(Array.from(this)))},set:function set(){return $n(this,je(arguments))},isIdentity:function isIdentity(){return te(this)},multiply:function multiply(e){return $n(this,ie(this,e))},determinant:function determinant(){return oe(this)},inverse:function inverse(){return $n(this,ce(this))},translate:function translate(e,t,n){return $n(this,ie(this,ae(e,t,n)))},rotateX:function rotateX(e){return $n(this,ie(this,se(e)))},rotateY:function rotateY(e){return $n(this,ie(this,fe(e)))},rotateZ:function rotateZ(e){return $n(this,ie(this,le(e)))},rotate:function rotate(e,t,n){var r=ve(e,t,n);return $n(this,ie(this,r))},scale:function scale(e){return $n(this,ie(this,pe(e)))},reflectZ:function reflectZ(e,t){var n=de(e,t);return $n(this,ie(this,n))},transform:function transform(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return v.vector(ne(this,r(3,he(t))))},transformVector:function transformVector(e){return v.vector(ne(this,r(3,he(e))))},transformLine:function transformLine(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=be(t);return v.line(re(this,r.vector,r.origin))}},S:{}}},Yn=function invert_order_array(e){var t=[];return e.forEach((function(e,n){return t[e]=n})),t},Wn={junction:{A:function A(){var e=me(arguments).map((function(e){return v.vector(e)})),t=e.map((function(e){return Math.atan2(e[1],e[0])})),n=kt.apply(void 0,_toConsumableArray(t));this.vectors=n.map((function(t){return e[t]})),this.radians=n.map((function(e){return t[e]})),this.order=Yn(n)},G:{sectors:function sectors(){return this.radians.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return ht(e[0],e[1])}))}},M:{alternatingAngleSum:function alternatingAngleSum(){return J(this.sectors)}},S:{fromRadians:function fromRadians(){var e=he(arguments);return this.constructor(e.map((function(e){return[Math.cos(e),Math.sin(e)]})))}}}},Jn=Object.assign({},jn,Pn,Nn,zn,Fn,Gn,Zn,Xn,Hn,Wn),Kn=function create(e,t){var n=Object.create(Jn[e].proto);return Jn[e].A.apply(n,t),n};Object.assign(v,{vector:function vector(){return Kn("vector",arguments)},circle:function circle(){return Kn("circle",arguments)},ellipse:function ellipse(){return Kn("ellipse",arguments)},rect:function rect(){return Kn("rect",arguments)},polygon:function polygon(){return Kn("polygon",arguments)},line:function line(){return Kn("line",arguments)},ray:function ray(){return Kn("ray",arguments)},segment:function segment(){return Kn("segment",arguments)},matrix:function matrix(){return Kn("matrix",arguments)},junction:function junction(){return Kn("junction",arguments)}}),Object.keys(Jn).forEach((function(e){var t={};t.prototype=null!=Jn[e].P?Object.create(Jn[e].P):Object.create(Object.prototype),t.prototype.constructor=t,v[e].prototype=t.prototype,v[e].prototype.constructor=v[e],Object.keys(Jn[e].G).forEach((function(n){return Object.defineProperty(t.prototype,n,{get:Jn[e].G[n]})})),Object.keys(Jn[e].M).forEach((function(n){return Object.defineProperty(t.prototype,n,{value:Jn[e].M[n]})})),Object.keys(Jn[e].S).forEach((function(t){return Object.defineProperty(v[e],t,{value:Jn[e].S[t].bind(v[e].prototype)})})),Jn[e].proto=t.prototype}));var Qn=v;Qn.core=Object.assign(Object.create(null),O,K,Ie,Vt,Et,b,_e,Be,Kt,dn,Ce,l,Wt,Ye,cn,wn,{intersect_line_seg_include:ft,intersect_line_seg_exclude:lt,intersect_ray_seg_include:vt,intersect_ray_seg_exclude:pt,intersect_seg_seg_include:dt,intersect_seg_seg_exclude:_t}),Qn.typeof=n,Qn.intersect=pn;var er=Object.create(null),tr=1.1,nr="Rabbit Ear",rr={file:["file_spec","file_creator","file_author","file_title","file_description","file_classes","file_frames"],frame:["frame_author","frame_title","frame_description","frame_attributes","frame_classes","frame_unit","frame_parent","frame_inherit"],graph:["vertices_coords","vertices_vertices","vertices_faces","edges_vertices","edges_faces","edges_assignment","edges_foldAngle","edges_length","faces_vertices","faces_edges","vertices_edges","edges_edges","faces_faces"],orders:["edgeOrders","faceOrders"]},ir=Object.freeze([].concat(rr.file).concat(rr.frame).concat(rr.graph).concat(rr.orders)),or="vertices",cr="edges",ar="faces",ur="vertices_coords",sr="edges_assignment",fr="edges_foldAngle",lr={vertices:"vertex",edges:"edge",faces:"face"},vr={M:-180,m:-180,V:180,v:180,B:0,b:0,F:0,f:0,U:0,u:0},pr=function edge_assignment_to_foldAngle(e){return vr[e]||0},dr=function edge_foldAngle_to_assignment(e){return e>0?"V":e<0?"M":"U"},_r=function filter_keys_with_suffix(e,t){return Object.keys(e).map((function(e){return e.substring(e.length-t.length,e.length)===t?e:void 0})).filter((function(e){return void 0!==e}))},gr=function filter_keys_with_prefix(e,t){return Object.keys(e).map((function(e){return e.substring(0,t.length)===t?e:void 0})).filter((function(e){return void 0!==e}))},hr=function get_graph_keys_with_prefix(e,t){return gr(e,"".concat(t,"_"))},mr=function get_graph_keys_with_suffix(e,t){return _r(e,"_".concat(t))},yr=function transpose_graph_arrays(e,t){var n=hr(e,t);if(0===n.length)return[];var r=Math.max.apply(Math,_toConsumableArray(n.map((function(t){return e[t].length})))),i=Array.from(Array(r)).map((function(){return{}}));return n.forEach((function(t){return i.forEach((function(n,r){i[r][t]=e[t][r]}))})),i},br=function transpose_graph_array_at_index(e,t,n){var r=hr(e,t);if(0!==r.length){var i={};return r.forEach((function(t){i[t]=e[t][n]})),i}},xr=function fold_object_certainty(e){return"object"!==_typeof(e)||null===e?0:ir.filter((function(t){return e[t]})).length},Ar=Object.freeze({__proto__:null,edges_assignment_degrees:vr,edges_assignment_names:{M:"mountain",m:"mountain",V:"valley",v:"valley",B:"boundary",b:"boundary",F:"mark",f:"mark",U:"unassigned",u:"unassigned"},edge_assignment_to_foldAngle:pr,edge_foldAngle_to_assignment:dr,filter_keys_with_suffix:_r,filter_keys_with_prefix:gr,get_graph_keys_with_prefix:hr,get_graph_keys_with_suffix:mr,transpose_graph_arrays:yr,transpose_graph_array_at_index:br,fold_object_certainty:xr}),kr=function implied_count(e,t,n){return Math.max(function max_num_in_array_in_arrays(e){var t=-1;return e.filter((function(e){return void 0!==e})).forEach((function(e){return e.forEach((function(e){return e.forEach((function(e){e>t&&(t=e)}))}))})),t}(mr(e,t).map((function(t){return e[t]}))),e[n]?function max_num_in_orders(e){var t=-1;return e.forEach((function(e){e[0]>t&&(t=e[0]),e[1]>t&&(t=e[1])})),t}(e[n]):-1)+1};kr.vertices=function(e){return kr(e,"vertices")},kr.edges=function(e){return kr(e,"edges","edgeOrders")},kr.faces=function(e){return kr(e,"faces","faceOrders")};var wr=function planar_vertex_walk(e){var t=e.vertices_vertices,n={vertices_vertices:t,vertices_sectors:e.vertices_sectors},r={};return t.map((function(e,t){return e.map((function(e){return function counter_clockwise_walk(e,t,n){for(var r=e.vertices_vertices,i=e.vertices_sectors,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c={},a={vertices:[t],edges:[],angles:[]},u=t,s=n;;){var l=r[s],v=(l.indexOf(u)+l.length-1)%l.length,p=l[v],d="".concat(s," ").concat(p);if(c[d])return Object.assign(o,c),a.vertices.pop(),a;if(c[d]=!0,o[d])return;a.vertices.push(s),a.edges.push(d),a.angles.push(i[s][v]),u=s,s=p}}(n,t,e,r)})).filter((function(e){return void 0!==e}))})).reduce((function(e,t){return e.concat(t)}),[])},Er=Object.freeze({__proto__:null,planar_vertex_walk:wr}),Mr=function sort_vertices_counter_clockwise(e,t,n){var r=e.vertices_coords;return t.map((function(e){return r[e]})).map((function(e){return Qn.core.subtract(e,r[n])})).map((function(e){return Math.atan2(e[1],e[0])})).map((function(e){return e>-Qn.core.EPSILON?e:e+2*Math.PI})).map((function(e,t){return{a:e,i:t}})).sort((function(e,t){return e.a-t.a})).map((function(e){return e.i})).map((function(e){return t[e]}))},Or=function sort_vertices_along_vector(e,t,n){var r=e.vertices_coords;return t.map((function(e){return{i:e,d:Qn.core.dot(r[e],n)}})).sort((function(e,t){return e.d-t.d})).map((function(e){return e.i}))},jr=Object.freeze({__proto__:null,sort_vertices_counter_clockwise:Mr,sort_vertices_along_vector:Or}),Cr=function make_vertices_edges(e){var t=e.edges_vertices,n=[];return t.forEach((function(e,t){return e.forEach((function(e){void 0===n[e]&&(n[e]=[]),n[e].push(t)}))})),n},Sr=function make_vertices_edges_sorted(e){var t=e.edges_vertices,n=e.vertices_vertices,r=Ir({edges_vertices:t});return n.map((function(e,t){return e.map((function(e){return r["".concat(t," ").concat(e)]}))}))},Pr=function make_vertices_vertices(e){var t=e.vertices_coords,n=e.vertices_edges,r=e.edges_vertices;n||(n=Cr({edges_vertices:r}));var i=n.map((function(e,t){return e.map((function(e){return r[e].filter((function(e){return e!==t}))})).reduce((function(e,t){return e.concat(t)}),[])}));return void 0===t?i:i.map((function(e,n){return Mr({vertices_coords:t},e,n)}))},Nr=function make_vertices_faces(e){var t=e.faces_vertices,n=Array.from(Array(kr.vertices({faces_vertices:t}))).map((function(){return[]}));return t.forEach((function(e,t){var r=[];e.forEach((function(e){r[e]=t})),r.forEach((function(e,t){return n[t].push(e)}))})),n},zr=function make_vertices_faces_sorted(e){var t=e.vertices_vertices,n=e.faces_vertices,r=qr({faces_vertices:n});return t.map((function(e,t){return e.map((function(e,n,r){return[r[(n+1)%r.length],t,e].join(" ")}))})).map((function(e){return e.map((function(e){return r[e]})).filter((function(e){return void 0!==e}))}))},Ir=function make_vertices_to_edge_bidirectional(e){var t=e.edges_vertices,n={};return t.map((function(e){return e.join(" ")})).forEach((function(e,t){n[e]=t})),t.map((function(e){return"".concat(e[1]," ").concat(e[0])})).forEach((function(e,t){n[e]=t})),n},Lr=function make_vertices_to_edge(e){var t=e.edges_vertices,n={};return t.map((function(e){return e.join(" ")})).forEach((function(e,t){n[e]=t})),n},qr=function make_vertices_to_face(e){var t=e.faces_vertices,n={};return t.forEach((function(e,t){return e.map((function(t,n){return[0,1,2].map((function(t){return(n+t)%e.length})).map((function(t){return e[t]})).join(" ")})).forEach((function(e){n[e]=t}))})),n},Tr=function make_vertices_vertices_vector(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.edges_vertices,i=e.edges_vector;i||(i=Rr({vertices_coords:t,edges_vertices:r}));var o=Lr({edges_vertices:r});return n.map((function(e,t){return n[t].map((function(e){var n=o["".concat(t," ").concat(e)],r=o["".concat(e," ").concat(t)];return void 0!==n?i[n]:void 0!==r?Qn.core.flip(i[r]):void 0}))}))},Fr=function make_vertices_sectors(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.edges_vertices,i=e.edges_vector;return Tr({vertices_coords:t,vertices_vertices:n,edges_vertices:r,edges_vector:i}).map((function(e){var t;return 1===e.length?[Qn.core.TWO_PI]:(t=Qn.core).interior_angles.apply(t,_toConsumableArray(e))}))},Vr=function make_vertices_coords_folded(e,t){var n=e.vertices_coords,r=e.vertices_faces,i=e.edges_vertices,o=e.edges_foldAngle,c=e.edges_assignment,a=e.faces_vertices,u=e.faces_faces,s=e.faces_matrix;s&&void 0===t||(s=Wr({vertices_coords:n,edges_vertices:i,edges_foldAngle:o,edges_assignment:c,faces_vertices:a,faces_faces:u},t)),r||(r=Nr({faces_vertices:a}));var l=r.map((function(e){return e[0]})).map((function(e){return void 0===e?Qn.core.identity3x4:s[e]}));return n.map((function(e){return Qn.core.resize(3,e)})).map((function(e,t){return Qn.core.multiply_matrix3_vector3(l[t],e)}))},Gr=function make_edges_faces(e){var t=e.faces_edges,n=Array.from(Array(kr.edges({faces_edges:t}))).map((function(){return[]}));return t.forEach((function(e,t){var r=[];e.forEach((function(e){r[e]=t})),r.forEach((function(e,t){return n[t].push(e)}))})),n},Br={M:-180,m:-180,V:180,v:180},Dr=function make_edges_foldAngle(e){return e.edges_assignment.map((function(e){return Br[e]||0}))},Rr=function make_edges_vector(e){var t=e.vertices_coords;return e.edges_vertices.map((function(e){return e.map((function(e){return t[e]}))})).map((function(e){return Qn.core.subtract(e[1],e[0])}))},Ur=function make_edges_coords_min_max(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords;return r||(r=n.map((function(e){return e.map((function(e){return t[e]}))}))),r.map((function(e){var t=e[0].map((function(){return 1/0})),n=e[0].map((function(){return-1/0}));return e.forEach((function(e){return e.forEach((function(e,r){e<t[r]&&(t[r]=e),e>n[r]&&(n[r]=e)}))})),[t,n]}))},Zr=function make_edges_coords_min_max_inclusive(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON,n=[-t,+t];return Ur(e).map((function(e){return e.map((function(e,t){return e.map((function(e){return e+n[t]}))}))}))},Xr=function make_planar_faces(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.vertices_edges,i=e.vertices_sectors,o=e.edges_vertices,c=e.edges_vector;n||(n=Pr({vertices_coords:t,edges_vertices:o,vertices_edges:r})),i||(i=Fr({vertices_coords:t,vertices_vertices:n,edges_vertices:o,edges_vector:c}));var a=Ir({edges_vertices:o});return wr({vertices_vertices:n,vertices_sectors:i}).map((function(e){return _objectSpread2(_objectSpread2({},e),{},{edges:e.edges.map((function(e){return a[e]}))})})).filter((function(e){return e.angles.map((function(e){return Math.PI-e})).reduce((function(e,t){return e+t}),0)>0}))},$r=function make_faces_faces(e){var t=e.faces_vertices,n=t.map((function(){return[]})),r={};return t.forEach((function(e,t){var i=e.length;e.forEach((function(e,o,c){var a=c[(o+1)%i];if(a<e){var u=[a,e];e=u[0],a=u[1]}var s="".concat(e," ").concat(a);if(s in r){var l=r[s];n[t].push(l),n[l].push(t)}else r[s]=t}))})),n},Hr=function get_face_face_shared_vertices(e,t){var n={};t.forEach((function(e){n[e]=!0}));for(var r=e.map((function(e){return!!n[e]})),i=[],o=r.indexOf(!1),c=o+1;c<r.length;c+=1)r[c]&&i.push(e[c]);for(var a=0;a<o;a+=1)r[a]&&i.push(e[a]);return i},Yr=function make_face_spanning_tree(e){var t=e.faces_vertices,n=e.faces_faces,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(n||(n=$r({faces_vertices:t})),0===n.length)return[];var i=[[{face:r}]],o={};o[r]=!0;var c=function _loop(){var e=i[i.length-1].map((function(e){return n[e.face].map((function(t){return{face:t,parent:e.face}}))})).reduce((function(e,t){return e.concat(t)}),[]),r={};e.forEach((function(e,t){o[e.face]&&(r[t]=!0),o[e.face]=!0}));var c=e.filter((function(e,t){return!r[t]}));c.map((function(e){return Hr(t[e.face],t[e.parent])})).forEach((function(e,t){c[t].edge_vertices=e.slice(0,2)})),i[i.length]=c};do{c()}while(i[i.length-1].length>0);return i.length>0&&0===i[i.length-1].length&&i.pop(),i},Wr=function make_faces_matrix(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_foldAngle,i=e.edges_assignment,o=e.faces_vertices,c=e.faces_faces,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;r||(r=i?Dr({edges_assignment:i}):Array(n.length).fill(0));var u=Ir({edges_vertices:n}),s=o.map((function(){return Qn.core.identity3x4}));return Yr({faces_vertices:o,faces_faces:c},a).slice(1).forEach((function(e){return e.forEach((function(e){var n,i=e.edge_vertices.map((function(e){return t[e]})),o=e.edge_vertices.join(" "),c=u[o],a=Qn.core.make_matrix3_rotate(r[c]*Math.PI/180,(n=Qn.core).subtract.apply(n,_toConsumableArray(Qn.core.resize_up(i[1],i[0]))),i[0]);s[e.face]=Qn.core.multiply_matrices3(s[e.parent],a)}))})),s},Jr=function make_faces_coloring_from_matrix(e){return e.faces_matrix.map((function(e){return e[0]*e[4]-e[1]*e[3]})).map((function(e){return e>=0}))},Kr=Object.freeze({__proto__:null,make_vertices_edges:Cr,make_vertices_edges_sorted:Sr,make_vertices_vertices:Pr,make_vertices_faces:Nr,make_vertices_faces_sorted:zr,make_vertices_to_edge_bidirectional:Ir,make_vertices_to_edge:Lr,make_vertices_to_face:qr,make_vertices_vertices_vector:Tr,make_vertices_sectors:Fr,make_vertices_coords_folded:Vr,make_edges_edges:function make_edges_edges(e){var t=e.edges_vertices,n=e.vertices_edges;return t.map((function(e,t){var r=n[e[0]].filter((function(e){return e!==t})),i=n[e[1]].filter((function(e){return e!==t}));return r.concat(i)}))},make_edges_faces:Gr,make_edges_foldAngle:Dr,make_edges_assignment:function make_edges_assignment(e){return e.edges_foldAngle.map((function(e){return 0===e?"F":e<0?"M":"V"}))},make_edges_vector:Rr,make_edges_length:function make_edges_length(e){var t=e.vertices_coords,n=e.edges_vertices;return Rr({vertices_coords:t,edges_vertices:n}).map((function(e){return Qn.core.magnitude(e)}))},make_edges_coords_min_max:Ur,make_edges_coords_min_max_exclusive:function make_edges_coords_min_max_exclusive(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON,n=[+t,-t];return Ur(e).map((function(e){return e.map((function(e,t){return e.map((function(e){return e+n[t]}))}))}))},make_edges_coords_min_max_inclusive:Zr,make_planar_faces:Xr,make_faces_vertices:function make_faces_vertices(e){return Xr(e).map((function(e){return e.vertices}))},make_faces_edges:function make_faces_edges(e){return Xr(e).map((function(e){return e.edges}))},make_faces_faces:$r,get_face_face_shared_vertices:Hr,make_face_spanning_tree:Yr,make_faces_matrix:Wr,make_faces_center:function make_faces_center(e){var t=e.vertices_coords;return e.faces_vertices.map((function(e){return e.map((function(e){return t[e]}))})).map((function(e){return Qn.core.centroid(e)}))},make_faces_coloring_from_matrix:Jr,make_faces_coloring:function make_faces_coloring(e){var t=e.faces_vertices,n=e.faces_faces,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=[];return i[r]=!0,Yr({faces_vertices:t,faces_faces:n},r).forEach((function(e,t){return e.forEach((function(e){i[e.face]=t%2==0}))})),i}}),Qr=function get_boundary(e){var t=e.vertices_edges,n=e.edges_vertices,r=e.edges_assignment;if(void 0===r)return{vertices:[],edges:[]};t||(t=Cr({edges_vertices:n}));for(var i=r.map((function(e){return"B"===e||"b"===e})),o=[],c=[],a=-1,u=0;u<i.length;u+=1)if(i[u]){a=u;break}if(-1===a)return{vertices:[],edges:[]};i[a]=!1,o.push(a),c.push(n[a][0]);for(var s=n[a][1];c[0]!==s;){if(c.push(s),void 0===(a=t[s].filter((function(e){return i[e]})).shift()))return{vertices:[],edges:[]};if(n[a][0]===s)s=_slicedToArray(n[a],2)[1];else s=_slicedToArray(n[a],1)[0];i[a]=!1,o.push(a)}return{vertices:c,edges:o}},ei=Object.freeze({__proto__:null,get_boundary:Qr,get_planar_boundary:function get_planar_boundary(e){var t=e.vertices_coords,n=e.vertices_edges,r=e.vertices_vertices,i=e.edges_vertices;r||(r=Pr({vertices_coords:t,vertices_edges:n,edges_vertices:i}));var o=Ir({edges_vertices:i}),c=[],a=[],u={vertices:a,edges:c},s=-1/0,l=-1;if(t.forEach((function(e,t){e[0]>s&&(s=e[0],l=t)})),-1===l)return u;a.push(l);var v=t[l],p=r[l],d=p.map((function(e){return t[e]})).map((function(e){return[e[0]-v[0],e[1]-v[1]]})).map((function(e){return Math.atan2(e[1],e[0])})).map((function(e){return e<0?e+2*Math.PI:e})).map((function(e,t){return{a:e,i:t}})).sort((function(e,t){return e.a-t.a})).shift().i,h=p[d],m=o[l<h?"".concat(l," ").concat(h):"".concat(h," ").concat(l)];c.push(m);for(var b=l,k=h,w=0;w<1e4;){var E=r[k],M=E.indexOf(b),O=E[(M+1)%E.length],j=o[k<O?"".concat(k," ").concat(O):"".concat(O," ").concat(k)];if(j===c[0])return u;a.push(k),c.push(j),b=k,k=O,w+=1}return console.warn("calculate boundary potentially entered infinite loop"),u}}),ti=function clip_line(e,t){var n=e.vertices_coords,r=e.vertices_edges,i=e.edges_vertices,o=e.edges_assignment,c=e.boundaries_vertices,a=Qn.typeof(t),u=Qn.core["clip_".concat(a,"_in_convex_poly_exclusive")];if(u){c||(c=Qr({vertices_edges:r,edges_vertices:i,edges_assignment:o}).vertices);var s=c.map((function(e){return n[e]}));return u.apply(void 0,[s].concat(_toConsumableArray(function prepare_clip_func_params(e,t){switch(t){case"line":case"ray":return[e.vector,e.origin];case"segment":return[e[0],e[1]];default:return[]}}(t,a))))}},ni=Object.freeze({__proto__:null,clip_line:ti}),ri=function nearest_vertex(e,t){var n=e.vertices_coords;if(n){var r=Qn.core.resize(n[0].length,t),i=n.map((function(e,t){return{d:Qn.core.distance(r,e),i:t}})).sort((function(e,t){return e.d-t.d})).shift();return i?i.i:void 0}},ii=function nearest_edge(e,t){var n=e.vertices_coords,r=e.edges_vertices;if(n&&r){var i=r.map((function(e){return e.map((function(e){return n[e]}))})).map((function(e){return Qn.core.nearest_point_on_line(Qn.core.subtract(e[1],e[0]),e[0],t,Qn.core.segment_limiter)}));return Qn.core.smallest_comparison_search(t,i,Qn.core.distance)}},oi=function face_containing_point(e,t){var n=e.vertices_coords,r=e.faces_vertices;if(n&&r){var i=r.map((function(e,t){return{face:e.map((function(e){return n[e]})),i:t}})).filter((function(e){return Qn.core.point_in_poly(t,e.face)})).shift();return void 0===i?void 0:i.i}},ci=oi,ai=Object.freeze({__proto__:null,nearest_vertex:ri,nearest_edge:ii,face_containing_point:oi,nearest_face:ci}),ui=function get_edges_vertices_span(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON;return Zr(e).map((function(n,r){return e.vertices_coords.map((function(e,r){return e[0]>n[0][0]-t&&e[1]>n[0][1]-t&&e[0]<n[1][0]+t&&e[1]<n[1][1]+t}))}))},si=function get_edges_edges_span(e){for(var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON,o=Zr({vertices_coords:t,edges_vertices:n,edges_coords:r},i),c=n.map((function(){return[]})),a=0;a<n.length-1;a+=1)for(var u=a+1;u<n.length;u+=1){var s=(o[a][1][0]<o[u][0][0]||o[u][1][0]<o[a][0][0])&&(o[a][1][1]<o[u][0][1]||o[u][1][1]<o[a][0][1]);c[a][u]=!s,c[u][a]=!s}for(var l=0;l<n.length;l+=1)c[l][l]=!0;return c},fi=Object.freeze({__proto__:null,get_edges_vertices_span:ui,get_edges_edges_span:si}),li=function merge_nextmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return[t]}));return t.forEach((function(e){r.forEach((function(t,n){return t.forEach((function(t,i){r[n][i]=e[t]}))})),r.forEach((function(e,t){r[t]=e.reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return void 0!==e}))}))})),r}},vi=function invert_map(e){var t=[];return e.forEach((function(e,n){null!=e&&("number"==typeof e&&(void 0!==t[e]?"number"==typeof t[e]?t[e]=[t[e],n]:t[e].push(n):t[e]=n),e.constructor===Array&&e.forEach((function(e){t[e]=n})))})),t},pi=Object.freeze({__proto__:null,merge_simple_nextmaps:function merge_simple_nextmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return t}));return t.forEach((function(e){return r.forEach((function(t,n){r[n]=e[t]}))})),r}},merge_nextmaps:li,merge_simple_backmaps:function merge_simple_backmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return t}));return t.forEach((function(e,t){var n=e.map((function(e){return r[e]}));r=n})),r}},merge_backmaps:function merge_backmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].reduce((function(e,t){return e.concat(t)}),[]).map((function(e,t){return[t]}));return t.forEach((function(e,t){var n=[];e.forEach((function(e,t){n[t]="number"==typeof e?r[e]:e.map((function(e){return r[e]})).reduce((function(e,t){return e.concat(t)}),[])})),r=n})),r}},invert_map:vi,invert_simple_map:function invert_simple_map(e){var t=[];return e.forEach((function(e,n){t[e]=n})),t}}),di=function max_arrays_length(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Math.max.apply(Math,[0].concat(_toConsumableArray(t.filter((function(e){return void 0!==e})).map((function(e){return e.length})))))},_i=function count(e,t){return di.apply(void 0,_toConsumableArray(hr(e,t).map((function(t){return e[t]}))))};_i.vertices=function(e){var t=e.vertices_coords,n=e.vertices_faces,r=e.vertices_vertices;return di(t,n,r)},_i.edges=function(e){var t=e.edges_vertices,n=e.edges_edges,r=e.edges_faces;return di(t,n,r)},_i.faces=function(e){var t=e.faces_vertices,n=e.faces_edges,r=e.faces_faces;return di(t,n,r)};var gi=function unique_sorted_integers(e){var t={};return e.forEach((function(e){t[e]=!0})),Object.keys(t).map((function(e){return parseInt(e)})).sort((function(e,t){return e-t}))},hi=function remove_geometry_indices(e,t,n){var r,i,o,c=_i(e,t),a=gi(n),u=[];for(r=0,i=0,o=0;r<c;r+=1,i+=1){for(;r===a[o];)u[r]=void 0,r+=1,o+=1;r<c&&(u[r]=i)}return mr(e,t).forEach((function(t){return e[t].forEach((function(n,r){return e[t][r].forEach((function(n,i){e[t][r][i]=u[n]}))}))})),a.reverse(),hr(e,t).forEach((function(t){return a.forEach((function(n){return e[t].splice(n,1)}))})),u},mi=function populate(e){if("object"===_typeof(e)&&e.edges_vertices){if(e.vertices_edges=Cr(e),e.vertices_vertices=Pr(e),e.vertices_edges=Sr(e),e.vertices_coords&&(e.edges_vector=Rr(e),e.vertices_sectors=Fr(e)),function set_edges_angles(e){var t=e.edges_vertices.length;if(e.edges_assignment||(e.edges_assignment=[]),e.edges_foldAngle||(e.edges_foldAngle=[]),e.edges_assignment.length>e.edges_foldAngle.length)for(var n=e.edges_foldAngle.length;n<e.edges_assignment.length;n+=1)e.edges_foldAngle[n]=pr(e.edges_assignment[n]);if(e.edges_foldAngle.length>e.edges_assignment.length)for(var r=e.edges_assignment.length;r<e.edges_foldAngle.length;r+=1)e.edges_assignment[r]=dr(e.edges_foldAngle[r]);for(var i=e.edges_assignment.length;i<t;i+=1)e.edges_assignment[i]="U",e.edges_foldAngle[i]=0}(e),e.vertices_coords){var t=Xr(e);e.faces_vertices=t.map((function(e){return e.vertices})),e.faces_edges=t.map((function(e){return e.edges})),e.faces_angles=t.map((function(e){return e.angles}))}else e.faces_vertices=[],e.faces_edges=[];return e.vertices_faces=e.vertices_vertices?zr(e):Nr(e),e.edges_faces=Gr(e),e.faces_faces=$r(e),e.vertices_coords&&(e.faces_matrix=Wr(e)),e}},yi=function add_vertices(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qn.core.EPSILON;e.vertices_coords||(e.vertices_coords=[]),"number"==typeof t[0]&&(t=[t]);var i=t.map((function(t){return e.vertices_coords.map((function(e){return Qn.core.distance(e,t)<r})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})),o=e.vertices_coords.length,c=t.filter((function(e,t){return void 0===i[t]}));return(n=e.vertices_coords).push.apply(n,_toConsumableArray(c)),i.map((function(e){return void 0===e?o++:e}))},bi=["vertices","edges","faces"],xi=function make_vertices_map_and_consider_duplicates(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qn.core.EPSILON,r=e.vertices_coords.length;return t.vertices_coords.map((function(t){return e.vertices_coords.map((function(e){return Qn.core.distance(e,t)<n})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})).map((function(e){return void 0===e?r++:e}))},Ai=function get_edges_duplicate_from_source_in_target(e,t){for(var n={},r={},i=0;i<e.edges_vertices.length;i+=1)r["".concat(e.edges_vertices[i][0]," ").concat(e.edges_vertices[i][1])]=i,r["".concat(e.edges_vertices[i][1]," ").concat(e.edges_vertices[i][0])]=i;for(var o=0;o<t.edges_vertices.length;o+=1){var c=r["".concat(t.edges_vertices[o][0]," ").concat(t.edges_vertices[o][1])];void 0!==c&&(n[o]=c)}return n},ki=function update_suffixes(e,t,n,r){return n.forEach((function(n){return t[n].forEach((function(t){return e[t].forEach((function(i,o){return i.forEach((function(i,c){e[t][o][c]=r[n][i]}))}))}))}))},wi=function assign(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qn.core.EPSILON,r={},i={},o={};bi.forEach((function(e){r[e]=hr(t,e),i[e]=mr(t,e)})),bi.forEach((function(t){return r[t].filter((function(t){return!e[t]})).forEach((function(t){e[t]=[]}))})),o.vertices=xi(e,t,n),ki(t,i,["vertices"],o);var c=_i.edges(e);o.edges=Array.from(Array(_i.edges(t))).map((function(e,t){return c+t}));var a=Ai(e,t);Object.keys(a).forEach((function(e){o.edges[e]=a[e]}));var u=_i.faces(e);return o.faces=Array.from(Array(_i.faces(t))).map((function(e,t){return u+t})),ki(t,i,["edges","faces"],o),bi.forEach((function(n){return r[n].forEach((function(r){return t[r].forEach((function(t,i){var c=o[n][i];e[r][c]=t}))}))})),o},Ei=function apply_matrix_to_graph(e,t){return _r(e,"coords").forEach((function(n){e[n]=e[n].map((function(e){return Qn.core.resize(3,e)})).map((function(e){return Qn.core.multiply_matrix3_vector3(t,e)}))})),_r(e,"matrix").forEach((function(n){e[n]=e[n].map((function(e){return Qn.core.multiply_matrices3(e,t)}))})),e},Mi={scale:function transform_scale(e,t){for(var n,r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];var c=(n=Qn.core).get_vector.apply(n,i),a=Qn.core.resize(3,c),u=Qn.core.make_matrix3_scale(t,a);return Ei(e,u)},translate:function transform_translate(e){for(var t,n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var c=(t=Qn.core).get_vector.apply(t,i),a=Qn.core.resize(3,c),u=(n=Qn.core).make_matrix3_translate.apply(n,_toConsumableArray(a));return Ei(e,u)},rotateZ:function transform_rotateZ(e,t){for(var n,r,i=arguments.length,o=new Array(i>2?i-2:0),c=2;c<i;c++)o[c-2]=arguments[c];var a=(n=Qn.core).get_vector.apply(n,o),u=Qn.core.resize(3,a),s=(r=Qn.core).make_matrix3_rotateZ.apply(r,[t].concat(_toConsumableArray(u)));return Ei(e,s)},transform:Ei},Oi=function subgraph(e,t){var n={},r={};return["faces","edges","vertices"].forEach((function(i){n[i]=Array.from(Array(_i[i](e))).map((function(e,t){return t})),r[i]=gi(t[i]||[]).reverse()})),Object.keys(r).forEach((function(e){return r[e].forEach((function(t){return n[e].splice(t,1)}))})),Object.keys(n).forEach((function(t){return hi(e,t,n[t])})),e},ji=function fn_and(e,t){return e&&t},Ci=function fn_cat(e,t){return e.concat(t)},Si=function fn_def(e){return void 0!==e},Pi=function get_isolated_vertices(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.faces_vertices,i=t.length,o=Array(i).fill(!1);return n&&n.forEach((function(e){e.filter((function(e){return!o[e]})).forEach((function(e){o[e]=!0,i-=1}))})),r&&r.forEach((function(e){e.filter((function(e){return!o[e]})).forEach((function(e){o[e]=!0,i-=1}))})),o.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},Ni=Object.freeze({__proto__:null,get_edge_isolated_vertices:function get_edge_isolated_vertices(e){var t=e.vertices_coords,n=e.edges_vertices,r=t.length,i=Array(r).fill(!1);return n.forEach((function(e){e.filter((function(e){return!i[e]})).forEach((function(e){i[e]=!0,r-=1}))})),i.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},get_face_isolated_vertices:function get_face_isolated_vertices(e){var t=e.vertices_coords,n=e.faces_vertices,r=t.length,i=Array(r).fill(!1);return n.forEach((function(e){e.filter((function(e){return!i[e]})).forEach((function(e){i[e]=!0,r-=1}))})),i.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},get_isolated_vertices:Pi}),zi=function get_circular_edges(e){for(var t=e.edges_vertices,n=[],r=0;r<t.length;r+=1)t[r][0]===t[r][1]&&n.push(r);return n},Ii=function get_duplicate_edges(e){var t=e.edges_vertices;if(!t)return[];for(var n=[],r={},i=0;i<t.length;i+=1){var o="".concat(t[i][0]," ").concat(t[i][1]),c="".concat(t[i][1]," ").concat(t[i][0]);void 0!==r[o]?n[i]=r[o]:(r[o]=i,r[c]=i)}return n},Li=function are_vertices_equivalent(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qn.core.EPSILON,r=e.length,i=0;i<r;i+=1)if(Math.abs(e[i]-t[i])>n)return!1;return!0},qi=function get_duplicate_vertices(e){for(var t=e.vertices_coords,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON,r=t.map((function(){return[]})),i=0;i<t.length-1;i+=1)for(var o=i+1;o<t.length;o+=1)r[i][o]=Li(t[i],t[o],n);for(var c=r.map((function(e){return e.map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e}))})),a=[],u=Array(t.length).fill(!1),s=0,l=function recurse(e,n){if(!u[n]&&s!==t.length)for(u[n]=!0,s+=1,a[e]||(a[e]=[]),a[e].push(n);c[n].length>0;)recurse(e,c[n][0]),c[n].splice(0,1)},v=0;v<t.length&&(l(v,v),s!==t.length);v+=1);return a.filter((function(e){return e.length}))},Ti=function remove_isolated_vertices(e){var t=Pi(e);return{map:hi(e,or,t),remove:t}},Fi=function remove_circular_edges(e){var t=zi(e);if(t.length){var n={};t.forEach((function(e){n[e]=!0})),mr(e,cr).forEach((function(t){return e[t].forEach((function(r,i){for(var o=r.length-1;o>=0;o-=1)!0===n[r[o]]&&e[t][i].splice(o,1)}))}))}return{map:hi(e,cr,t),remove:t}},Vi=function remove_duplicate_edges(e){var t=Ii(e),n=Object.keys(t),r=hi(e,cr,n);return t.forEach((function(e,t){r[t]=e})),{map:r,remove:n}},Gi=function remove_duplicate_vertices(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON,n=qi(e,t),r=[];n.forEach((function(e,t){return e.forEach((function(e){r[e]=t}))})),e.vertices_coords=n.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})).map((function(e){var t;return(t=Qn.core).average.apply(t,_toConsumableArray(e))})),mr(e,or).forEach((function(t){return e[t].forEach((function(n,i){return e[t][i].forEach((function(n,o){e[t][i][o]=r[n]}))}))})),hr(e,or).filter((function(e){return e!==ur})).forEach((function(t){return delete e[t]}));var i=n.map((function(e){return e.length>1?e.slice(1,e.length):void 0})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]);return{map:r,remove:i}},Bi=Object.freeze({__proto__:null,remove_isolated_vertices:Ti,remove_circular_edges:Fi,remove_duplicate_edges:Vi,remove_duplicate_vertices:Gi}),Di=function get_collinear_vertices(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON;r||(r=n.map((function(e){return e.map((function(e){return t[e]}))})));for(var o=ui({vertices_coords:t,edges_vertices:n,edges_coords:r},i),c=0;c<r.length;c+=1)for(var a=0;a<t.length;a+=1)o[c][a]&&(o[c][a]=Qn.core.point_on_segment_exclusive(t[a],r[c][0],r[c][1],i));return o.map((function(e){return e.map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e}))}))},Ri=function get_edges_edges_intersections(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_vector,i=e.edges_origin,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON;r||(r=Rr({vertices_coords:t,edges_vertices:n})),i||(i=n.map((function(e){return t[e[0]]})));for(var c=r.map((function(){return[]})),a=si({vertices_coords:t,edges_vertices:n},o),u=0;u<r.length-1;u+=1)for(var s=u+1;s<r.length;s+=1)!0===a[u][s]?(c[u][s]=Qn.core.intersect_lines(r[u],i[u],r[s],i[s],Qn.core.exclude_s,Qn.core.exclude_s,o),c[s][u]=c[u][s]):c[u][s]=void 0;return c},Ui=function fragment_graph(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON,n=e.edges_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})),r=n.map((function(e){return Qn.core.subtract(e[1],e[0])})),i=n.map((function(e){return e[0]})),o=Ri({vertices_coords:e.vertices_coords,edges_vertices:e.edges_vertices,edges_vector:r,edges_origin:i},1e-6),c=Di({vertices_coords:e.vertices_coords,edges_vertices:e.edges_vertices,edges_coords:n},t);if(0!==o.reduce(Ci,[]).filter(Si).length||0!==c.reduce(Ci,[]).filter(Si).length){var a={vertices:e.vertices_coords.length};o.forEach((function(t){return t.filter(Si).filter((function(e){return 2===e.length})).forEach((function(t){var n=e.vertices_coords.length;e.vertices_coords.push(_toConsumableArray(t)),t.splice(0,2),t.push(n)}))})),o.forEach((function(e,t){e.forEach((function(e,n){e&&(o[t][n]=e[0])}))}));var u=o.map((function(e){return e.filter(Si)}));e.edges_vertices.forEach((function(e,t){return e.push.apply(e,_toConsumableArray(u[t]).concat(_toConsumableArray(c[t])))})),e.edges_vertices.forEach((function(t,n){e.edges_vertices[n]=Or({vertices_coords:e.vertices_coords},t,r[n])}));var s=e.edges_vertices.map((function(e,t){return Array(e.length-1).fill(t)})).reduce(Ci,[]);return e.edges_vertices=e.edges_vertices.map((function(e){return Array.from(Array(e.length-1)).map((function(t,n,r){return[e[n],e[n+1]]}))})).reduce(Ci,[]),e.edges_assignment&&(e.edges_assignment=s.map((function(t){return e.edges_assignment[t]||"U"}))),e.edges_foldAngle&&(e.edges_foldAngle=s.map((function(t){return e.edges_foldAngle[t]||0}))),{vertices:{new:Array.from(Array(e.vertices_coords.length-a.vertices)).map((function(e,t){return a.vertices+t}))},edges:{backmap:s}}}},Zi=["vertices_coords","edges_vertices","edges_assignment","edges_foldAngle"],Xi=function fragment(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON;e.vertices_coords=e.vertices_coords.map((function(e){return e.slice(0,2)})),[or,cr,ar].map((function(t){return hr(e,t)})).reduce(Ci,[]).filter((function(e){return!Zi.includes(e)})).forEach((function(t){return delete e[t]}));var n,r={vertices:{},edges:{}};for(n=0;n<20;n++){var i=Gi(e,t/2),o=Vi(e),c=Fi(e),a=Ui(e,t);if(void 0===a){r.vertices.map=void 0===r.vertices.map?i.map:li(r.vertices.map,i.map),r.edges.map=void 0===r.edges.map?li(o.map,c.map):li(r.edges.map,o.map,c.map);break}var u=vi(a.edges.backmap),s=li(o.map,c.map,u);r.vertices.map=void 0===r.vertices.map?i.map:li(r.vertices.map,i.map),r.edges.map=void 0===r.edges.map?s:li(r.edges.map,s)}return 20===n&&console.warn("debug warning. fragment reached max iterations"),r},$i=function clone(e){var t,n;if("object"!==_typeof(e))return e;if(!e)return e;if("[object Array]"===Object.prototype.toString.apply(e)){for(t=[],n=0;n<e.length;n+=1)t[n]=clone(e[n]);return t}for(n in t={},e)e.hasOwnProperty(n)&&(t[n]=clone(e[n]));return t},Hi=function add_edges(e,t){var n;e.edges_vertices||(e.edges_vertices=[]),"number"==typeof t[0]&&(t=[t]);var r=t.map((function(t,n){return e.edges_vertices.length+n}));(n=e.edges_vertices).push.apply(n,_toConsumableArray(t));var i=Vi(e).map;return r.map((function(e){return i[e]}))},Yi=function split_edge(e,t,n){if(!(e.edges_vertices.length<t)){var r,i=e.edges_vertices[t];if(!n)n=(r=Qn.core).midpoint.apply(r,_toConsumableArray(i));var o=i.map((function(t){return e.vertices_coords[t]})).map((function(e){return Qn.core.distance(e,n)<Qn.core.EPSILON}));if(o[0])return{vertex:i[0],edges:{}};if(o[1])return{vertex:i[1],edges:{}};var c=e.vertices_coords.length;e.vertices_coords[c]=n;var a=[0,1].map((function(t){return t+e.edges_vertices.length}));(function split_edge_into_two(e,t,n){var r=e.edges_vertices[t],i=[{edges_vertices:[r[0],n]},{edges_vertices:[n,r[1]]}];return i.forEach((function(n,r){if([sr,fr].filter((function(n){return void 0!==e[n]&&void 0!==e[n][t]})).forEach((function(r){return n[r]=e[r][t]})),e.edges_faces&&void 0!==e.edges_faces[t]&&(n.edges_faces=_toConsumableArray(e.edges_faces[t])),e.edges_vector){var i=n.edges_vertices.map((function(t){return e.vertices_coords[t]}));n.edges_vector=Qn.core.subtract(i[1],i[0])}if(e.edges_length){var o,c=n.edges_vertices.map((function(t){return e.vertices_coords[t]}));n.edges_length=(o=Qn.core).distance2.apply(o,_toConsumableArray(c))}})),i})(e,t,c).forEach((function(t,n){return Object.keys(t).forEach((function(r){e[r][a[n]]=t[r]}))})),function update_vertices_vertices(e,t,n){var r=e.vertices_vertices;r&&(r[t]=_toConsumableArray(n),n.forEach((function(e,n,i){var o=i[(n+1)%i.length],c=r[e].indexOf(o);r[e][c]=t})))}(e,c,i),function update_vertices_edges(e,t,n,r,i){var o=e.vertices_edges;o&&(o[r]=_toConsumableArray(i),t.map((function(e){return o[e].indexOf(n)})).forEach((function(e,n){o[t[n]][e]=i[n]})))}(e,i,t,c,a);var u=function find_adjacent_faces_to_edge(e,t){var n=e.vertices_faces,r=e.edges_vertices,i=e.edges_faces,o=e.faces_edges;if(e.faces_vertices,i&&i[t])return i[t];var c=r[t];if(void 0!==n){for(var a=[],u=0;u<n[c[0]].length;u+=1)for(var s=0;s<n[c[1]].length;s+=1)n[c[0]][u]===n[c[1]][s]&&a.push(n[c[0]][u]);return a}if(o){for(var l=[],v=0;v<o.length;v+=1)for(var p=0;p<o[v].length;p+=1)o[v][p]===t&&l.push(v);return l}}(e,t);u&&(function update_vertices_faces(e,t,n){var r=e.vertices_faces;r&&(r[t]=_toConsumableArray(n))}(e,c,i),function update_faces_vertices(e,t,n,r){var i=e.faces_vertices;i&&t.map((function(e){return i[e]})).forEach((function(e){return e.map((function(e,t,n){var i=(t+1)%n.length;return e===r[0]&&n[i]===r[1]||e===r[1]&&n[i]===r[0]?i:void 0})).filter((function(e){return void 0!==e})).sort((function(e,t){return t-e})).forEach((function(t){return e.splice(t,0,n)}))}))}(e,u,c,i),function update_faces_edges(e,t,n,r,i){var o=e.edges_vertices,c=e.faces_edges;c&&t.map((function(e){return c[e]})).forEach((function(e){var t=e.indexOf(i),c=e[(t+e.length-1)%e.length],a=e[(t+1)%e.length],u=[[c,i],[i,a]].map((function(e){var t=e.map((function(e){return o[e]}));return t[0][0]===t[1][0]||t[0][0]===t[1][1]?t[0][0]:t[0][1]})).reduce((function(e,t){return e.concat(t)}),[]),s=[[u[0],n],[n,u[1]]].map((function(e){var t=e.map((function(e){return-1!==o[r[0]].indexOf(e)})).reduce((function(e,t){return e&&t}),!0),n=e.map((function(e){return-1!==o[r[1]].indexOf(e)})).reduce((function(e,t){return e&&t}),!0);if(t)return r[0];if(n)return r[1];throw new Error("something wrong with input graph's faces_edges construction")}));return t===e.length-1?(e.splice(t,1,s[0]),e.unshift(s[1])):e.splice.apply(e,[t,1].concat(_toConsumableArray(s))),s}))}(e,u,c,a,t));var s=hi(e,cr,[t]);return a.forEach((function(e,t){a[t]=s[a[t]]})),s.splice(-2),s[t]=a,{vertex:c,edges:{map:s,remove:t}}}},Wi=function split_convex_face(e,t,n,r){var i=function intersect_face_with_line(e,t,n,r){var i=e.vertices_coords,o=e.edges_vertices,c=e.faces_vertices,a=e.faces_edges,u=c[t].map((function(e){return i[e]})).map((function(e){return Qn.core.point_on_line(e,n,r)})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).slice(0,2),s=u.map((function(e){return{vertex:c[t][e],face_vertex_index:e}}));if(s.length>1){var l=u[1]-u[0];if(1===(l<0?l+c[t].length:l))return;return{vertices:s,edges:[]}}var v=a[t].map((function(e){return o[e].map((function(e){return i[e]}))})).map((function(e){var t;return(t=Qn.core).intersect_line_seg_exclude.apply(t,[n,r].concat(_toConsumableArray(e)))})).map((function(e,n){return{coords:e,face_edge_index:n,edge:a[t][n]}})).filter((function(e){return void 0!==e.coords})).slice(0,2);return s.length>0&&v.length>0?{vertices:s,edges:v}:v.length>1?{vertices:[],edges:v}:void 0}(e,t,n,r);if(void 0!==i){var o=i.vertices.map((function(e){return e.vertex})),c=[];i.edges.map((function(t,n,r){t.edge=c.length?c[0].edges.map[t.edge]:t.edge,c.push(Yi(e,t.edge,t.coords))})),o.push.apply(o,_toConsumableArray(c.map((function(e){return e.vertex}))));var a=e.edges_vertices.length,u=[0,1].map((function(t){return e.faces_vertices.length+t-1})),s=function make_edge(e,t,n){var r,i,o=e.vertices_coords,c=t.map((function(e){return o[e]})).reverse();return{edges_vertices:_toConsumableArray(t),edges_foldAngle:0,edges_assignment:"U",edges_length:(r=Qn.core).distance2.apply(r,_toConsumableArray(c)),edges_vector:(i=Qn.core).subtract.apply(i,_toConsumableArray(c)),edges_faces:_toConsumableArray(n)}}(e,o,u);Object.keys(s).filter((function(t){return void 0!==e[t]})).forEach((function(t){e[t][a]=s[t]})),function update_vertices_vertices(e,t){var n=e.vertices_coords,r=e.vertices_vertices,i=e.edges_vertices,o=i[t][0],c=i[t][1];r[o]=Mr({vertices_coords:n},r[o].concat(c),o),r[c]=Mr({vertices_coords:n},r[c].concat(o),c)}(e,a);var l=function make_faces(e,t,n){var r=e.edges_vertices,i=e.faces_vertices,o=Ir({edges_vertices:r}),c=n.map((function(e){return i[t].indexOf(e)}));return function split_circular_array(e,t){return t.sort((function(e,t){return e-t})),[e.slice(t[1]).concat(e.slice(0,t[0]+1)),e.slice(t[0],t[1]+1)]}(i[t],c).map((function(e){return{faces_vertices:e,faces_edges:e.map((function(e,t,n){return"".concat(e," ").concat(n[(t+1)%n.length])})).map((function(e){return o[e]}))}}))}(e,t,o),v=hi(e,"faces",[t]);if(l.forEach((function(t,n){return Object.keys(t).filter((function(t){return void 0!==e[t]})).forEach((function(r){e[r][u[n]]=t[r]}))})),e.vertices_faces=Nr(e),e.edges_faces=Gr(e),e.faces_faces=$r(e),2===c.length){var p=function invert_array(e){var t=[];return e.forEach((function(e,n){t[e]=n})),t}(c[0].edges.map);c[1].edges.remove=p[c[1].edges.remove]}return v[t]=u,{vertices:o,faces:{map:v,remove:t},edges:{map:li.apply(void 0,_toConsumableArray(c.map((function(e){return e.edges.map})))),new:a,remove:c.map((function(e){return e.edges.remove}))}}}},Ji=function fold_faces_layer(e,t){var n=[],r=e.map((function(e,t){return t})),i=r.filter((function(e){return t[e]})),o=r.filter((function(e){return!t[e]}));return o.sort((function(t,n){return e[t]-e[n]})).forEach((function(e,t){n[e]=t})),i.sort((function(t,n){return e[n]-e[t]})).forEach((function(e,t){n[e]=o.length+t})),n},Ki=function get_face_sidedness(e,t,n,r){var i=[n[0]-t[0],n[1]-t[1]],o=e[0]*i[1]-e[1]*i[0];return r?o>0:o<0},Qi=function make_face_center_fast(e,t){return e.faces_vertices[t]?e.faces_vertices[t].map((function(t){return e.vertices_coords[t]})).reduce((function(e,t){return[e[0]+t[0],e[1]+t[1]]}),[0,0]).map((function(n){return n/e.faces_vertices[t].length})):[0,0]},eo=function prepare_graph_crease(e,t,n,r){var i=_i.faces(e),o=Array.from(Array(i));e["faces_re:layer"]||(e["faces_re:layer"]=Array(i).fill(0)),e["faces_re:preindex"]=o.map((function(e,t){return t})),e.faces_matrix||(e.faces_matrix=Wr(e,r)),e.faces_coloring=Jr(e),e["faces_re:creases"]=e.faces_matrix.map((function(e){return Qn.core.invert_matrix3(e)})).map((function(e){return Qn.core.multiply_matrix3_line3(e,t,n)})),e.faces_center=o.map((function(t,n){return Qi(e,n)})),e["faces_re:sidedness"]=o.map((function(t,n){return Ki(e["faces_re:creases"][n].vector,e["faces_re:creases"][n].origin,e.faces_center[n],e.faces_coloring[n])}))},to=function two_furthest_points(e){var t=[0,-1/0],n=[1/0,0],r=[-1/0,0],i=[0,1/0];return e.forEach((function(e){e[0]<n[0]&&(n=e),e[0]>r[0]&&(r=e),e[1]<i[1]&&(i=e),e[1]>t[1]&&(t=e)})),Math.abs(t[1]-i[1])>Math.abs(r[0]-n[0])?[i,t]:[n,r]},no={M:"V",m:"V",V:"M",v:"M"},ro=function opposingCrease(e){return no[e]||e},io=function flat_fold(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"V",o=ro(i);if(null==r){var c=oi(e,n);r=void 0===c?0:c}t=Qn.core.resize(3,t),n=Qn.core.resize(3,n),eo(e,t,n,r);var a=$i(e);a.vertices_coords.forEach((function(e){return e.splice(2)}));var u=Array.from(Array(_i.faces(e))).map((function(e,t){return t})).reverse().map((function(t){var n=a.faces_coloring[t],r=Wi(a,t,a["faces_re:creases"][t].vector,a["faces_re:creases"][t].origin);if(void 0!==r)return a.edges_assignment[r.edges.new]=n?i:o,a.edges_foldAngle[r.edges.new]=n?vr[i]||0:vr[o]||0,r.faces.map[r.faces.remove].forEach((function(t){a.faces_center[t]=Qi(a,t),a["faces_re:sidedness"][t]=Ki(e["faces_re:creases"][r.faces.remove].vector,e["faces_re:creases"][r.faces.remove].origin,a.faces_center[t],e.faces_coloring[r.faces.remove]),a["faces_re:layer"][t]=e["faces_re:layer"][r.faces.remove],a["faces_re:preindex"][t]=e["faces_re:preindex"][r.faces.remove]})),r})).reverse();a["faces_re:layer"]=Ji(a["faces_re:layer"],a["faces_re:sidedness"]);var s=void 0===u[0]?0:a["faces_re:preindex"].map((function(e,t){return{pre:e,new:t}})).filter((function(e){return 0===e.pre})).filter((function(e){return a["faces_re:sidedness"][e.new]})).shift().new,l=e.faces_matrix[0];"M"!==i&&"m"!==i&&"V"!==i&&"v"!==i||(l=void 0!==u[0]||e["faces_re:sidedness"][0]?Qn.core.multiply_matrices3(e.faces_matrix[0],Qn.core.make_matrix3_reflectZ(e["faces_re:creases"][0].vector,e["faces_re:creases"][0].origin)):e.faces_matrix[0]);var v=Wr(a,s).map((function(e){return Qn.core.multiply_matrices3(l,e)}));a.faces_coloring=Jr({faces_matrix:v});var p=Qn.core.multiply_matrix3_line3(l,e["faces_re:creases"][0].vector,e["faces_re:creases"][0].origin),d=Qn.core.normalize(Qn.core.rotate270(p.vector)),h=u.map((function(t,n){return void 0===t?void 0:a.edges_vertices[t.edges.new].map((function(e){return a.vertices_coords[e]})).map((function(t){return Qn.core.multiply_matrix3_vector3(e.faces_matrix[n],t)}))})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]);return a["re:construction"]=0===h.length?{type:"flip",direction:d}:{type:"fold",assignment:i,direction:d,edge:to(h)},a.faces_matrix=v,a["vertices_re:foldedCoords"]=Vr(a,s),a.faces_matrix=v,delete e["faces_re:creases"],delete a["faces_re:creases"],delete e["faces_re:sidedness"],delete a["faces_re:sidedness"],delete e["faces_re:preindex"],delete a["faces_re:preindex"],delete e.faces_coloring,delete a.faces_coloring,delete e.faces_center,delete a.faces_center,a},oo=function clean(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"object"===_typeof(t)&&!1===t.edges||(Fi(e),Vi(e)),"object"===_typeof(t)&&!0===t.vertices&&Ti(e),e},co=function invert_array(e){var t=[];return e.forEach((function(e,n){t[e]=n})),t},ao={V:1,v:1,M:-1,m:-1},uo=function upOrDown(e,t){return t%2==0?ao[e]:-ao[e]},so=function between(e,t,n){return t<n?e.slice(t+1,n):e.slice(n+1,t)},fo=function get_sectors_layer(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qn.core.EPSILON,r=0,i=e.map((function(e,t){return t%2==0?e:-e})).map((function(e){return r+=e})),o=i.map((function(e,t,n){return t%2==0?n[(t+n.length-1)%n.length]:e})).map((function(e){return e+n})),c=i.map((function(e,t,n){return t%2==0?e:n[(t+n.length-1)%n.length]})).map((function(e){return e-n})),a=function test(t){var n=[];t.forEach((function(e,t){n[e]=t}));for(var r=t.length+(t.length===e.length?0:-1),a=function _loop(e){var r=(e+1)%t.length,a=so(t,n[e],n[r]),u=a.map((function(t){return i[e]<o[t]})).reduce(ji,!0),s=a.map((function(t){return i[e]>c[t]})).reduce(ji,!0);if(!u&&!s)return{v:!1}},u=0;u<r;u+=1){var s=a(u);if("object"===_typeof(s))return s.v}return!0},u=function final_test(e){var n=co(e);return n[0]>n[n.length-1]?"M"===t[0]:"V"===t[0]},s=function recurse(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n=n.slice(0,i).concat([r],n.slice(i,n.length)),!a(n))return[];if(r>=e.length-1)return u(n)?[n]:[];var o=uo(t[(r+1)%e.length],r),c=1===o?Array.from(Array(n.length-i)).map((function(e,t){return i+t+1})):Array.from(Array(i+1)).map((function(e,t){return t}));return c.map((function(e){return recurse(n,r+1,e)})).reduce((function(e,t){return e.concat(t)}),[]).map(co)};return s()},lo=function odd_assignment(e){for(var t=0,n=0,r=0;r<e.length;r+=1)"M"!==e[r]&&"m"!==e[r]||(t+=1),"V"!==e[r]&&"v"!==e[r]||(n+=1);for(var i=0;i<e.length;i+=1){if(t>n&&("V"===e[i]||"v"===e[i]))return i;if(n>t&&("M"===e[i]||"m"===e[i]))return i}},vo=Object.assign(Object.create(null),{assign:wi,add_vertices:yi,add_vertices_split_edges:function add_vertices_split_edges(e,t){var n=yi(e,t),r=e.edges_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})),i=t.map((function(e){return r.map((function(t){return Qn.core.point_on_segment_exclusive(e,t[0],t[1])})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})),o=i.filter((function(e){return void 0!==e})),c=i.map((function(e,t){return{e:e,i:t}})).filter((function(e){return void 0!==e.e})).map((function(t){var r=br(e,"edges",t.e);return[r,$i(r)].map((function(r,i){return Object.assign(r,{edges_vertices:[e.edges_vertices[t.e][i],n[t.i]]})}))})).reduce((function(e,t){return e.concat(t)}),[]),a=_i.edges(e),u={new:{edges:[]}};return c.forEach((function(t,n){return Object.keys(t).forEach((function(r){void 0===e[r]&&(e[r]=[]),e[r][a+n]=t[r],u.new.edges[n]=a+n}))})),hi(e,"edges",o),n},add_edges:Hi,split_edge:Yi,split_face:Wi,flat_fold:io,clean:oo,get_circular_edges:zi,get_duplicate_edges:Ii,get_duplicate_vertices:qi,get_collinear_vertices:Di,count:_i,implied:kr,fragment:Xi,remove:hi,populate:mi,subgraph:Oi,explode_faces:function explode_faces(e){var t=e.faces_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})).reduce((function(e,t){return e.concat(t)}),[]),n=0,r=e.faces_vertices.map((function(e){return e.map((function(e){return n++}))}));return{vertices_coords:JSON.parse(JSON.stringify(t)),faces_vertices:r}},layer_solver:fo,assignment_solver:function assignment_solver(e,t){null==t&&(t=e.map((function(){return"U"})));var n=function all_possible_assignments(e){var t=function get_unassigneds(e){return e.map((function(e,t){return t})).filter((function(t){return"U"===e[t]||"u"===e[t]}))}(e),n=Array.from(Array(Math.pow(2,t.length))).map((function(e,t){return t.toString(2)})).map((function(e){return Array(t.length-e.length+1).join("0")+e})).map((function(e){return Array.from(e).map((function(e){return"0"===e?"V":"M"}))})).map((function(n){var r=e.slice();return t.forEach((function(e,t){r[e]=n[t]})),r})),r=n.map((function(e){return e.filter((function(e){return"M"===e||"m"===e})).length})),i=n.map((function(e){return e.filter((function(e){return"V"===e||"v"===e})).length}));return n.filter((function(e,t){return 2===Math.abs(r[t]-i[t])}))}(t),r=n.map((function(t){return fo(e,t)}));return n.map((function(e,t){return t})).filter((function(e){return r[e].length>0})).map((function(e){return{assignment:n[e],layer:r[e]}}))},single_vertex_fold_angles:function single_vertex_fold_angles(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=lo(t);if(void 0!==r){var i=e[(r+1)%e.length],o=e[(r+2)%e.length],c=Math.PI*n,a=-Math.cos(i)*Math.cos(o)+Math.sin(i)*Math.sin(o)*Math.cos(Math.PI-c),u=Math.cos(Math.PI-c)-Math.pow(Math.sin(Math.PI-c),2)*Math.sin(i)*Math.sin(o)/(1-a),s=-Math.acos(u)+Math.PI;return r%2==0?[s,c,s,c].map((function(e,t){return r===t?-e:e})):[c,s,c,s].map((function(e,t){return r===t?-e:e}))}}},Kr,ni,Mi,ei,Er,ai,Ar,jr,fi,pi,Bi,Ni),po=function best_fit_arrow(e,t){Qr(e).vertices;var n,r=ti(e,t),i=((n=Qn.core).midpoint.apply(n,_toConsumableArray(r)),{vector:Qn.core.rotate90(t.vector),origin:t.origin});return ti(e,i)},_o=Object.freeze({__proto__:null,one_crease_arrow:function one_crease_arrow(e,t,n,r){return po(e,t)}}),go=function list_function_params(e,t,n){switch(e){case"1":case"2":case 1:case 2:return t;case"3":case 3:return[n[0].vector,n[0].origin,n[1].vector,n[1].origin];case"4":case 4:return[n[0].vector,t[0]];case"5":case 5:return[n[0].vector,n[0].origin,t[0],t[1]];case"6":case 6:return[n[0].vector,n[0].origin,n[1].vector,n[1].origin,t[0],t[1]];case"7":case 7:return[n[0].vector,n[0].origin,n[1].vector,t[0]]}return[]},ho=function arrayify(e,t){switch(e){case"1":case 1:case"2":case 2:case"4":case 4:case"7":case 7:return[t];case"3":case 3:case"5":case 5:case"6":case 6:return t}},mo=function axiom(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.points?n.points.map((function(e){return Qn.core.get_vector(e)})):void 0,i=n.lines?n.lines.map((function(e){return Qn.core.get_line(e)})):void 0,o=(t=Qn.core)["axiom".concat(e)].apply(t,_toConsumableArray(go(e,r,i)));return ho(e,o)},yo=[null,1,2,3,4,5,6,7];delete yo[0],Object.keys(yo).forEach((function(e){mo[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return mo.apply(void 0,[e].concat(n))}}));var bo=function line_line_for_arrows(e,t){return Qn.core.intersect_lines(e.vector,e.origin,t.vector,t.origin,Qn.core.include_l,Qn.core.include_l)},xo=function reflect_point(e,t){var n=Qn.core.make_matrix2_reflect(e.vector,e.origin);return Qn.core.multiply_matrix2_vector2(n,t)},Ao=function boundary_for_arrows(e){var t=e.vertices_coords;return Qn.core.convex_hull(t)},ko=function widest_perp(e,t,n){var r=Ao(e);if(void 0===n){var i,o=Qn.core.clip_line_in_convex_poly_exclusive(r,t.vector,t.origin);n=(i=Qn.core).midpoint.apply(i,_toConsumableArray(o))}var c=Qn.core.rotate270(t.vector),a=Qn.core.clip_line_in_convex_poly_exclusive(r,c,n).map((function(e){return Qn.core.distance(n,e)})).sort((function(e,t){return e-t})).shift(),u=Qn.core.scale(Qn.core.normalize(c),a);return Qn.segment(Qn.core.add(n,Qn.core.flip(u)),Qn.core.add(n,u))},wo=function between_2_segments(e,t,n){var r,i=t.map((function(e){return Qn.core.midpoint(e[0],e[1])})),o=(r=Qn.line).fromPoints.apply(r,_toConsumableArray(i)),c=Qn.intersect(n,o),a=Qn.line(n.vector.rotate90(),c);return Qn.segment(e.lines.map((function(e){return Qn.intersect(e,a)})))},Eo=[null,function axiom_1_arrows(e,t){return mo(1,e).map((function(e){return[ko(t,e)]}))},function axiom_2_arrows(e){return[[Qn.segment(e.points)]]},function axiom_3_arrows(e,t){var n=Ao(t),r=e.lines.map((function(e){return Qn.core.clip_line_in_convex_poly_exclusive(n,e.vector,e.origin)})),i=Qn.core.intersect_seg_seg_exclude(r[0][0],r[0][1],r[1][0],r[1][1]);return i?mo(3,e).map((function(t){return function between_2_intersecting_segments(e,t,n,r){var i=e.lines.map((function(e){return e.vector})),o=i.map(Qn.core.flip),c=i.concat(o).map((function(e){return Qn.ray(e,t)})),a=c.filter((function(e){return Qn.core.dot(e.vector,n.vector)>0&&Qn.core.cross2(e.vector,n.vector)>0})).shift(),u=c.filter((function(e){return Qn.core.dot(e.vector,n.vector)>0&&Qn.core.cross2(e.vector,n.vector)<0})).shift(),s=c.filter((function(e){return Qn.core.dot(e.vector,n.vector)<0&&Qn.core.cross2(e.vector,n.vector)>0})).shift(),l=c.filter((function(e){return Qn.core.dot(e.vector,n.vector)<0&&Qn.core.cross2(e.vector,n.vector)<0})).shift(),v=[a,u,s,l].map((function(e){return Qn.core.convex_poly_ray_exclusive(r,e.vector,e.origin).shift().shift()})),p=v.map((function(e){return Qn.core.distance(e,t)})),d=p[0]<p[1]?v[0]:v[1],h=p[0]<p[1]?Qn.core.add(u.origin,u.vector.normalize().scale(p[0])):Qn.core.add(a.origin,a.vector.normalize().scale(p[1])),m=p[2]<p[3]?v[2]:v[3],b=p[2]<p[3]?Qn.core.add(l.origin,l.vector.normalize().scale(p[2])):Qn.core.add(s.origin,s.vector.normalize().scale(p[3]));return[Qn.segment(d,h),Qn.segment(m,b)]}(e,i,t,n)})):[wo(e,r,mo(3,e).filter((function(e){return void 0!==e})).shift())]},function axiom_4_arrows(e,t){return mo(4,e).map((function(n){return[ko(t,n,bo(n,e.lines[0]))]}))},function axiom_5_arrows(e){return mo(5,e).map((function(t){return[Qn.segment(e.points[1],xo(t,e.points[1]))]}))},function axiom_6_arrows(e){return mo(6,e).map((function(t){return e.points.map((function(e){return Qn.segment(e,xo(t,e))}))}))},function axiom_7_arrows(e,t){return mo(7,e).map((function(n){return[Qn.segment(e.points[0],xo(n,e.points[0])),ko(t,n,bo(n,e.lines[1]))]}))}];delete Eo[0];var Mo=function axiom_arrows(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.points?t.points.map((function(e){return Qn.core.get_vector(e)})):void 0,r=t.lines?t.lines.map((function(e){return Qn.core.get_line(e)})):void 0,i=arguments.length,o=new Array(i>2?i-2:0),c=2;c<i;c++)o[c-2]=arguments[c];return Eo[e].apply(Eo,[{points:n,lines:r}].concat(o))};Object.keys(Eo).forEach((function(e){Mo[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Mo.apply(void 0,[e].concat(n))}}));var Oo=Object.assign(Object.create(null),_o,{axiom_arrows:Mo}),jo=Object.create(null),Co=function vertex_degree(e,t){var n=this;Object.defineProperty(e,"degree",{get:function get(){return n.vertices_vertices&&n.vertices_vertices[t]?n.vertices_vertices[t].length:null}})},So=function edge_coords(e,t){var n=this;Object.defineProperty(e,"coords",{get:function get(){if(n.edges_vertices&&n.edges_vertices[t]&&n.vertices_coords)return n.edges_vertices[t].map((function(e){return n.vertices_coords[e]}))}})},Po=function face_simple(e,t){var n=this;Object.defineProperty(e,"simple",{get:function get(){if(!n.faces_vertices||!n.faces_vertices[t])return null;for(var r=0;r<e.length-1;r+=1)for(var i=r+1;i<e.length;i+=1)if(n.faces_vertices[t][r]===n.faces_vertices[t][i])return!1;return!0}})},No=function face_coords(e,t){var n=this;Object.defineProperty(e,"coords",{get:function get(){if(n.faces_vertices&&n.faces_vertices[t]&&n.vertices_coords)return n.faces_vertices[t].map((function(e){return n.vertices_coords[e]}))}})},zo={vertices:function setup_vertex(e,t){return Co.call(this,e,t),e},edges:function setup_edge(e,t){return So.call(this,e,t),e},faces:function setup_face(e,t){return Po.call(this,e,t),No.call(this,e,t),e}},Io={};Io.prototype=Object.create(Object.prototype),Io.prototype.constructor=Io;var Lo=Object.assign({clean:oo,populate:mi,fragment:Xi,subgraph:Oi,assign:wi},Mi);Object.keys(Lo).forEach((function(e){Io.prototype[e]=function(){return Lo[e].apply(Lo,[this].concat(Array.prototype.slice.call(arguments)))}})),Io.prototype.copy=function(){return Object.assign(Object.create(Io.prototype),$i(this))},Io.prototype.load=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"===_typeof(e)&&(!0!==n.append&&ir.forEach((function(e){return delete t[e]})),Object.assign(this,{file_spec:tr,file_creator:nr},$i(e)))},Io.prototype.clear=function(){var e=this;rr.graph.forEach((function(t){return delete e[t]})),rr.orders.forEach((function(t){return delete e[t]})),delete this.file_frames};var qo=function shortenKeys(e,t,n){var r=this,i=Object.create(null);return Object.keys(e).forEach((function(t){i[t.substring(r.length+1)]=e[t]})),i},To=function getComponent(e){return yr(this,e).map(qo.bind(e)).map(zo[e].bind(this))};["vertices","edges","faces"].forEach((function(e){return Object.defineProperty(Io.prototype,e,{get:function get(){return To.call(this,e)}})})),Object.defineProperty(Io.prototype,"junctions",{get:function get(){return Tr(this).map((function(e){return Qn.junction.apply(Qn,_toConsumableArray(e))}))}}),Object.defineProperty(Io.prototype,"boundary",{get:function get(){var e=this,t=Qr(this),n=Qn.polygon(t.vertices.map((function(t){return e.vertices_coords[t]})));return Object.keys(t).forEach((function(e){n[e]=t[e]})),n}});var Fo={vertices:ri,edges:ii,faces:oi},Vo=function nearestElement(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o=(t=Qn.core).get_vector.apply(t,r),c=Fo[e](this,o),a=br(this,e,c);return zo[e].call(this,a,c),a.index=c,a};Io.prototype.nearest=function(){var e=arguments,t=this,n=Object.create(null);return["vertices","edges","faces"].forEach((function(r){return Object.defineProperty(n,lr[r],{get:function get(){return Vo.call.apply(Vo,[t,r].concat(_toConsumableArray(e)))}})})),n};var Go=Io.prototype,Bo={};Bo.prototype=Object.create(Go),Bo.prototype.constructor=Bo;Bo.prototype.copy=function(){return Object.assign(Object.create(Bo.prototype),$i(this))};var Do=function edges_array(e){var t=this;return e.mountain=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-180;return e.forEach((function(e){t.edges_assignment[e]="M",t.edges_foldAngle[e]=n})),e},e.valley=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:180;return e.forEach((function(e){t.edges_assignment[e]="V",t.edges_foldAngle[e]=n})),e},e.flat=function(){return e.forEach((function(e){t.edges_assignment[e]="F",t.edges_foldAngle[e]=0})),e},e};["line","ray","segment"].forEach((function(e){Bo.prototype[e]=function(){var t=Qn[e].apply(Qn,arguments);if(t){var n=ti(this,t);if(n){var r=yi(this,n),i=Hi(this,r),o=Xi(this).edges.map;return mi(this),Do.call(this,i.map((function(e){return o[e]})).reduce((function(e,t){return e.concat(t)}),[]))}}}})),["circle","ellipse","rect","polygon"].forEach((function(e){Bo.prototype[e]=function(){var t=this,n=Qn[e].apply(Qn,arguments);if(n){var r=n.segments(96).map((function(e){return Qn.segment(e)})).map((function(e){return ti(t,e)})).filter((function(e){return void 0!==e}));if(r){var i=[],o=[];r.forEach((function(e){var n=yi(t,e);i.push.apply(i,_toConsumableArray(n)),o.push.apply(o,_toConsumableArray(Hi(t,n)))}));var c=Xi(this).edges.map;return mi(this),Do.call(this,o.map((function(e){return c[e]})).reduce((function(e,t){return e.concat(t)}),[]))}}}}));var Ro=Bo.prototype,Uo={};Uo.prototype=Object.create(Go),Uo.prototype.constructor=Uo,Uo.prototype.flatFold=function(){var e=this,t=Qn.core.get_line(arguments),n=io(this,t.vector,t.origin);return[or,cr,ar].map((function(t){return hr(e,t)})).reduce(Ci,[]).forEach((function(t){return delete e[t]})),Object.assign(this,n),this},Uo.prototype.copy=function(){return Object.assign(Object.create(Uo.prototype),$i(this))},Uo.prototype.folded=function(){var e=Vr(this);return Object.assign(Object.create(Uo.prototype),Object.assign($i(this),{vertices_coords:e}))};var Zo=Uo.prototype,Xo=function make_polygon_vertices(e){return 4===e?[[0,0],[1,0],[1,1],[0,1]]:Qn.core.make_regular_polygon(e,.5/Math.sin(Math.PI/e))},$o={},Ho=[null,null,null,"triangle","square","pentagon","hexagon","heptagon","octogon","nonagon","decagon","hendecagon","dodecagon"];[0,1,2].forEach((function(e){delete Ho[e]}));var Yo=function create_init(e){return mi(e)};Ho.forEach((function(e,t){var n=Array.from(Array(t));$o[e]=function(){return Yo({vertices_coords:Xo(t),edges_vertices:n.map((function(e,t){return[t,(t+1)%n.length]})),edges_assignment:n.map((function(){return"B"}))})}})),$o.circle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:90;return Yo({vertices_coords:Qn.core.make_regular_polygon(e,1),edges_vertices:Array.from(Array(e)).map((function(e,t,n){return[t,(t+1)%n.length]})),edges_assignment:Array.from(Array(e)).map((function(){return"B"}))})},$o.kite=function(){return Yo({vertices_coords:[[0,0],[Math.sqrt(2)-1,0],[1,0],[1,1-(Math.sqrt(2)-1)],[1,1],[0,1]],edges_vertices:[[0,1],[1,2],[2,3],[3,4],[4,5],[5,0],[5,1],[3,5],[5,2]],edges_assignment:["B","B","B","B","B","B","V","V","F"]})};var Wo={axioms:{ar:[null,"اصنع خطاً يمر بنقطتين","اصنع خطاً عن طريق طي نقطة واحدة إلى أخرى","اصنع خطاً عن طريق طي خط واحد على آخر","اصنع خطاً يمر عبر نقطة واحدة ويجعل خطاً واحداً فوق نفسه","اصنع خطاً يمر بالنقطة الأولى ويجعل النقطة الثانية على الخط","اصنع خطاً يجلب النقطة الأولى إلى الخط الأول والنقطة الثانية إلى الخط الثاني","اصنع خطاً يجلب نقطة إلى خط ويجعل خط ثاني فوق نفسه"],de:[null,"Falte eine Linie durch zwei Punkte","Falte zwei Punkte aufeinander","Falte zwei Linien aufeinander","Falte eine Linie auf sich selbst, falte dabei durch einen Punkt","Falte einen Punkt auf eine Linie, falte dabei durch einen anderen Punkt","Falte einen Punkt auf eine Linie und einen weiteren Punkt auf eine weitere Linie","Falte einen Punkt auf eine Linie und eine weitere Linie in sich selbst zusammen"],en:[null,"fold a line through two points","fold two points together","fold two lines together","fold a line on top of itself, creasing through a point","fold a point to a line, creasing through another point","fold a point to a line and another point to another line","fold a point to a line and another line onto itself"],es:[null,"dobla una línea entre dos puntos","dobla dos puntos juntos","dobla y une dos líneas","dobla una línea sobre sí misma, doblándola hacia un punto","dobla un punto hasta una línea, doblándola a través de otro punto","dobla un punto hacia una línea y otro punto hacia otra línea","dobla un punto hacia una línea y otra línea sobre sí misma"],fr:[null,"créez un pli passant par deux points","pliez pour superposer deux points","pliez pour superposer deux lignes","rabattez une ligne sur elle-même à l'aide d'un pli qui passe par un point","rabattez un point sur une ligne à l'aide d'un pli qui passe par un autre point","rabattez un point sur une ligne et un autre point sur une autre ligne","rabattez un point sur une ligne et une autre ligne sur elle-même"],hi:[null,"एक क्रीज़ बनाएँ जो दो स्थानों से गुजरता है","एक स्थान को दूसरे स्थान पर मोड़कर एक क्रीज़ बनाएँ","एक रेखा पर दूसरी रेखा को मोड़कर क्रीज़ बनाएँ","एक क्रीज़ बनाएँ जो एक स्थान से गुजरता है और एक रेखा को स्वयं के ऊपर ले आता है","एक क्रीज़ बनाएँ जो पहले स्थान से गुजरता है और दूसरे स्थान को रेखा पर ले आता है","एक क्रीज़ बनाएँ जो पहले स्थान को पहली रेखा पर और दूसरे स्थान को दूसरी रेखा पर ले आता है","एक क्रीज़ बनाएँ जो एक स्थान को एक रेखा पर ले आता है और दूसरी रेखा को स्वयं के ऊपर ले आता है"],jp:[null,"2点に沿って折り目を付けます","2点を合わせて折ります","2つの線を合わせて折ります","点を通過させ、既にある線に沿って折ります","点を線沿いに合わせ別の点を通過させ折ります","線に向かって点を折り、同時にもう一方の線に向かってもう一方の点を折ります","線に向かって点を折り、同時に別の線をその上に折ります"],ko:[null,"두 점을 통과하는 선으로 접으세요","두 점을 함께 접으세요","두 선을 함께 접으세요","그 위에 선을 접으면서 점을 통과하게 접으세요","점을 선으로 접으면서, 다른 점을 지나게 접으세요","점을 선으로 접고 다른 점을 다른 선으로 접으세요","점을 선으로 접고 다른 선을 그 위에 접으세요"],ms:[null,"lipat garisan melalui dua titik","lipat dua titik bersama","lipat dua garisan bersama","lipat satu garisan di atasnya sendiri, melipat melalui satu titik","lipat satu titik ke garisan, melipat melalui titik lain","lipat satu titik ke garisan dan satu lagi titik ke garisan lain","lipat satu titik ke garisan dan satu lagi garisan di atasnya sendiri"],pt:[null,"dobre uma linha entre dois pontos","dobre os dois pontos para uni-los","dobre as duas linhas para uni-las","dobre uma linha sobre si mesma, criando uma dobra ao longo de um ponto","dobre um ponto até uma linha, criando uma dobra ao longo de outro ponto","dobre um ponto até uma linha e outro ponto até outra linha","dobre um ponto até uma linha e outra linha sobre si mesma"],ru:[null,"сложите линию через две точки","сложите две точки вместе","сложите две линии вместе","сверните линию сверху себя, сгибая через точку","сложите точку в линию, сгибая через другую точку","сложите точку в линию и другую точку в другую линию","сложите точку в линию и другую линию на себя"],tr:[null,"iki noktadan geçen bir çizgi boyunca katla","iki noktayı birbirine katla","iki çizgiyi birbirine katla","bir noktadan kıvırarak kendi üzerindeki bir çizgi boyunca katla","başka bir noktadan kıvırarak bir noktayı bir çizgiye katla","bir noktayı bir çizgiye ve başka bir noktayı başka bir çizgiye katla","bir noktayı bir çizgiye ve başka bir çizgiyi kendi üzerine katla"],vi:[null,"tạo một nếp gấp đi qua hai điểm","tạo nếp gấp bằng cách gấp một điểm này sang điểm khác","tạo nếp gấp bằng cách gấp một đường lên một đường khác","tạo một nếp gấp đi qua một điểm và đưa một đường lên trên chính nó","tạo một nếp gấp đi qua điểm đầu tiên và đưa điểm thứ hai lên đường thẳng","tạo một nếp gấp mang điểm đầu tiên đến đường đầu tiên và điểm thứ hai cho đường thứ hai","tạo một nếp gấp mang lại một điểm cho một đường và đưa một đường thứ hai lên trên chính nó"],zh:[null,"通過兩點折一條線","將兩點折疊起來","將兩條線折疊在一起","通過一個點折疊一條線在自身上面","將一個點，通過另一個點折疊成一條線，","將一個點折疊為一條線，再將另一個點折疊到另一條線","將一個點折疊成一條線，另一條線折疊到它自身上"]},folds:{es:{fold:{verb:"",noun:"doblez"},valley:"doblez de valle",mountain:"doblez de montaña",inside:"",outside:"",open:"",closed:"",rabbit:"",rabbit2:"",petal:"",squash:"",flip:"dale la vuelta a tu papel"},en:{fold:{verb:"fold",noun:"crease"},valley:"valley fold",mountain:"mountain fold",inside:"inside reverse fold",outside:"outside reverse fold",open:"open sink",closed:"closed sink",rabbit:"rabbit ear fold",rabbit2:"double rabbit ear fold",petal:"petal fold",squash:"squash fold",flip:"flip over"},zh:{fold:{verb:"",noun:""},valley:"谷摺",mountain:"山摺",inside:"內中割摺",outside:"外中割摺",open:"開放式沉壓摺",closed:"封閉式沉壓摺",rabbit:"兔耳摺",rabbit2:"雙兔耳摺",petal:"花瓣摺",blintz:"坐墊基",squash:"壓摺",flip:""}}},Jo=function(){var n={};if(t){var r=require("xmldom"),i=r.DOMParser,o=r.XMLSerializer;n.DOMParser=i,n.XMLSerializer=o,n.document=(new i).parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else e&&(n=window);return n}(),Ko=function make_edge_cylinder(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(Qn.core.mag_squared(t)<Qn.core.EPSILON)throw"degenerate edge";for(var i=Qn.core.normalize(t),o=[[1,0,0],[0,1,0],[0,0,1]].map((function(e){return Qn.core.cross3(e,i)})).sort((function(e,t){return Qn.core.magnitude(t)-Qn.core.magnitude(e)})).shift(),c=[Qn.core.normalize(o)],a=1;a<4;a+=1)c.push(Qn.core.cross3(c[a-1],i));var u=c.map((function(e){return Qn.core.scale(e,n)})),s=[-r,r].map((function(e){return Qn.core.scale(i,e)})),l=0===r?e:e.map((function(e,t){return Qn.core.add(e,s[t])}));return l.map((function(e){return u.map((function(t){return Qn.core.add(e,t)}))})).reduce(Ci,[])},Qo=Object.freeze({__proto__:null,make_faces_geometry:function make_faces_geometry(e){var t=Jo.THREE,n=e.vertices_coords.map((function(e){return[e[0],e[1],e[2]||0]})).reduce(Ci,[]),r=e.vertices_coords.map((function(e){return[0,0,1]})).reduce(Ci,[]),i=e.vertices_coords.map((function(e){return[1,1,1]})).reduce(Ci,[]),o=e.faces_vertices.map((function(e){return e.map((function(e,t,n){return[n[0],n[t+1],n[t+2]]})).slice(0,e.length-2)})).reduce(Ci,[]).reduce(Ci,[]),c=new t.BufferGeometry;return c.setAttribute("position",new t.Float32BufferAttribute(n,3)),c.setAttribute("normal",new t.Float32BufferAttribute(r,3)),c.setAttribute("color",new t.Float32BufferAttribute(i,3)),c.setIndex(o),c},make_edges_geometry:function make_edges_geometry(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_assignment,i=e.edges_coords,o=e.edges_vector,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.002,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=Jo.THREE;i||(i=n.map((function(e){return e.map((function(e){return t[e]}))}))),o||(o=i.map((function(e){return Qn.core.subtract(e[1],e[0])}))),i=i.map((function(e){return e.map((function(e){return Qn.core.resize(3,e)}))})),o=o.map((function(e){return Qn.core.resize(3,e)}));var s={B:[0,0,0],M:[0,0,0],F:[0,0,0],V:[0,0,0]},l=r.map((function(e){return[s[e],s[e],s[e],s[e],s[e],s[e],s[e],s[e]]})).reduce(Ci,[]).reduce(Ci,[]).reduce(Ci,[]),v=i.map((function(e,t){return Ko(e,o[t],c,a)})).reduce(Ci,[]).reduce(Ci,[]),p=o.map((function(e){if(Qn.core.mag_squared(e)<Qn.core.EPSILON)throw"degenerate edge";var t=Qn.core.normalize(e),n=(Qn.core.scale(t,c),Qn.core.scale(Qn.core.normalize(Qn.core.cross3(e,[0,0,-1])),c)),r=Qn.core.scale(Qn.core.normalize(Qn.core.cross3(e,[0,0,1])),c);return[n,[-n[2],n[1],n[0]],r,[-r[2],r[1],r[0]],n,[-n[2],n[1],n[0]],r,[-r[2],r[1],r[0]]]})).reduce(Ci,[]).reduce(Ci,[]),d=i.map((function(e,t){return[8*t+0,8*t+4,8*t+1,8*t+1,8*t+4,8*t+5,8*t+1,8*t+5,8*t+2,8*t+2,8*t+5,8*t+6,8*t+2,8*t+6,8*t+3,8*t+3,8*t+6,8*t+7,8*t+3,8*t+7,8*t+0,8*t+0,8*t+7,8*t+4,8*t+0,8*t+1,8*t+3,8*t+1,8*t+2,8*t+3,8*t+5,8*t+4,8*t+7,8*t+7,8*t+6,8*t+5]})).reduce(Ci,[]),h=new u.BufferGeometry;return h.setAttribute("position",new u.Float32BufferAttribute(v,3)),h.setAttribute("normal",new u.Float32BufferAttribute(p,3)),h.setAttribute("color",new u.Float32BufferAttribute(l,3)),h.setIndex(d),h.computeVertexNormals(),h}}),ec=function test_axiom1_2(e,t){return[e.points.map((function(e){return Qn.core.point_in_convex_poly_inclusive(e,t)})).reduce((function(e,t){return e&&t}),!0)]},tc=[null,ec,ec,function test_axiom3(e,t){return[!0,!0]},function test_axiom4(e,t){var n=Qn.core.intersect_lines(e.lines[0].vector,e.lines[0].origin,Qn.core.rotate90(e.lines[0].vector),e.points[0],Qn.core.include_l,Qn.core.include_l);return[[e.points[0],n].map((function(e){return Qn.core.point_in_convex_poly_inclusive(e,t)})).reduce((function(e,t){return e&&t}),!0)]},function test_axiom5(e,t){var n=Qn.core.axiom5(e.lines[0].vector,e.lines[0].origin,e.points[0],e.points[1]);if(0===n.length)return[];var r=e.points.map((function(e){return Qn.core.point_in_convex_poly_inclusive(e,t)})).reduce((function(e,t){return e&&t}),!0);return n.map((function(t){return function reflect_point(e,t){var n=Qn.core.make_matrix2_reflect(e.vector,e.origin);return Qn.core.multiply_matrix2_vector2(n,t)}(t,e.points[1])})).map((function(e){return Qn.core.point_in_convex_poly_inclusive(e,t)})).map((function(e){return e&&r}))},function test_axiom6(e,t){return[!0,!0,!0]},function test_axiom7(e,t){return[!0]}];delete tc[0];var nc,rc=function test_axiom(e,t,n){var r="object"===_typeof(n)&&n.vertices_coords?Qr(n).vertices.map((function(e){return n.vertices_coords[e]})):n;return tc[e](t,r)};Object.keys(tc).forEach((function(e){rc[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return rc.apply(void 0,[e].concat(n))}}));var ic={};["number","object","transform","class","style","function","string","undefined","boolean","path","svg","id","viewBox"].forEach((function(e){return ic[e]=e}));var oc=("undefined"==typeof window?"undefined":_typeof(window))!==ic.undefined&&_typeof(window.document)!==ic.undefined,cc=("undefined"==typeof process?"undefined":_typeof(process))!==ic.undefined&&null!=process.versions&&null!=process.versions.node,ac=("undefined"==typeof self?"undefined":_typeof(self))===ic.object&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,uc=Object.freeze({__proto__:null,isBrowser:oc,isNode:cc,isWebWorker:ac}),sc=function(){var e={};if(cc){var t=require("xmldom"),n=t.DOMParser,r=t.XMLSerializer;e.DOMParser=n,e.XMLSerializer=r,e.document=(new n).parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else oc&&(e=window);return e}(),fc="http://www.w3.org/2000/svg",lc={s:["svg"],d:["defs"],h:["desc","filter","metadata","style","script","title","view"],c:["cdata"],g:["g"],v:["circle","ellipse","line","path","polygon","polyline","rect"],t:["text"],i:["marker","symbol","clipPath","mask"],p:["linearGradient","radialGradient","pattern"],cT:["textPath","tspan"],cG:["stop"],cF:["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]},vc=function vec(e,t){return[Math.cos(e)*t,Math.sin(e)*t]},pc=function arcPath(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(null==i)return"";var c=vc(r,n),a=vc(i,n),u=[a[0]-c[0],a[1]-c[1]],s=c[0]*a[1]-c[1]*a[0],l=c[0]*a[0]+c[1]*a[1],v=Math.atan2(s,l)>0?0:1,p=o?"M ".concat(e,",").concat(t," l ").concat(c[0],",").concat(c[1]," "):"M ".concat(e+c[0],",").concat(t+c[1]," ");return p+=["a ",n,n,0,v,1,u[0],u[1]].join(" "),o&&(p+=" Z"),p},dc=function arcArguments(e,t,n,r,i){return[pc(e,t,n,r,i,!1)]},_c={arc:{nodeName:"path",attributes:["d"],args:dc,methods:{setArc:function setArc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("d",dc.apply(void 0,n))}}}},gc=function wedgeArguments(e,t,n,r,i){return[pc(e,t,n,r,i,!0)]},hc={wedge:{nodeName:"path",args:gc,attributes:["d"],methods:{setArc:function setArc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("d",gc.apply(void 0,n))}}}},mc=128,yc=function parabolaArguments(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Array.from(Array(129)).map((function(e,t){return(t-mc)/mc*2+1})).map((function(i){return[e+(i+1)*n*.5,t+Math.pow(i,2)*r]}))},bc={parabola:{nodeName:"polyline",attributes:["points"],args:function parabolaPathString(e,t,n,r){return[yc(e,t,n,r).map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ")]}}},xc=function regularPolygonArguments(e,t,n,r){var i=[t,n];return Array.from(Array(e)).map((function(t,n){return 2*Math.PI*n/e})).map((function(e){return[Math.cos(e),Math.sin(e)]})).map((function(e){return i.map((function(t,n){return t+r*e[n]}))}))},Ac={regularPolygon:{nodeName:"polygon",attributes:["points"],args:function polygonPathString(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return[xc(e,t,n,r).map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ")]}}},kc={roundRect:{nodeName:"path",attributes:["d"],args:function roundRectArguments(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;i>n/2&&(i=n/2),i>r/2&&(i=r/2);var o=n-2*i,c=r-2*i,a="A".concat(i," ").concat(i," 0 0 1");return["M".concat(e+(n-o)/2,",").concat(t),"h".concat(o),a,"".concat(e+n,",").concat(t+(r-c)/2),"v".concat(c),a,"".concat(e+n-i,",").concat(t+r),"h".concat(-o),a,"".concat(e,",").concat(t+r-i),"v".concat(-c),a,"".concat(e+i,",").concat(t)].join(" ")}}},wc=function is_iterable(e){return null!=e&&_typeof(e[Symbol.iterator])===ic.function},Ec=function flatten_arrays(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return wc(arguments[0])&&"string"!=typeof arguments[0]?flatten_arrays.apply(void 0,_toConsumableArray(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(e){return wc(e)?_toConsumableArray(flatten_arrays(e)):e})).reduce((function(e,t){return e.concat(t)}),[])}},Mc=function coordinates(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return _typeof(e)===ic.number})).concat(t.filter((function(e){return _typeof(e)===ic.object&&null!==e})).map((function(e){return _typeof(e.x)===ic.number?[e.x,e.y]:_typeof(e[0])===ic.number?[e[0],e[1]]:void 0})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]))},Oc=function add(e,t){return[e[0]+t[0],e[1]+t[1]]},jc=function sub(e,t){return[e[0]-t[0],e[1]-t[1]]},Cc=function scale(e,t){return[e[0]*t,e[1]*t]},Sc=function curveArguments(){var e=Mc.apply(void 0,_toConsumableArray(Ec.apply(void 0,arguments))),t=e.slice(0,4);if(!t.length)return[""];var n=e[4]||0,r=e[5]||.5,i=[t[0],t[1]],o=[t[2],t[3]],c=jc(o,i),a=Oc(i,Cc(c,.5)),u=[c[1],-c[0]],s=Oc(a,Cc(u,n)),l=Oc(i,Cc(jc(s,i),r)),v=Oc(o,Cc(jc(s,o),r));return["M".concat(i[0],",").concat(i[1],"C").concat(l[0],",").concat(l[1]," ").concat(v[0],",").concat(v[1]," ").concat(o[0],",").concat(o[1])]},Pc={bend:function bend(e,t){return e.setAttribute("d",Sc.apply(void 0,_toConsumableArray(function getEndpoints(e){var t=e.getAttribute("d");return null==t||""===t?[]:[t.slice(t.indexOf("M")+1,t.indexOf("C")).split(","),t.split(" ").pop().split(",")].map((function(e){return e.map((function(e){return parseFloat(e)}))}))}(e)).concat([t]))),e}},Nc={curve:{nodeName:"path",attributes:["d"],args:Sc,methods:Pc}},zc={};Object.assign(zc,_c,hc,bc,Ac,kc,Nc);var Ic=Object.keys(zc),Lc=[lc.h,lc.p,lc.i],qc=[lc.g,lc.v,lc.t,Ic],Tc={svg:[lc.s,lc.d].concat(Lc).concat(qc),g:qc,text:[lc.cT],linearGradient:[lc.cG],radialGradient:[lc.cG],defs:Lc,filter:[lc.cF],marker:qc,symbol:qc,clipPath:qc,mask:qc},Fc=Object.create(null);Object.keys(Tc).forEach((function(e){Fc[e]=Tc[e].reduce((function(e,t){return e.concat(t)}),[])}));var Vc=Object.freeze(Fc),Gc={toCamel:function toCamel(e){return e.replace(/([-_][a-z])/gi,(function(e){return e.toUpperCase().replace("-","").replace("_","")}))},toKebab:function toKebab(e){return e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z])([A-Z])(?=[a-z])/g,"$1-$2").toLowerCase()},capitalized:function capitalized(e){return e.charAt(0).toUpperCase()+e.slice(1)}},Bc=function viewBoxValue(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=1,c=n/o-n,a=e-c-i,u=t-c-i,s=n+2*c+2*i,l=r+2*c+2*i;return[a,u,s,l].join(" ")};function viewBox(){var e=Mc.apply(void 0,_toConsumableArray(Ec(arguments)));return 2===e.length&&e.unshift(0,0),4===e.length?Bc.apply(void 0,_toConsumableArray(e)):void 0}var Dc=function cdata(e){return(new sc.DOMParser).parseFromString("<root></root>","text/xml").createCDATASection("".concat(e))},Rc=function removeChildren(e){for(;e.lastChild;)e.removeChild(e.lastChild);return e},Uc=function moveChildren(e,t){for(;t.childNodes.length>0;){var n=t.childNodes[0];t.removeChild(n),e.appendChild(n)}return e},Zc=function assignSVG(e,t){return Array.from(t.attributes).forEach((function(t){return e.setAttribute(t.name,t.value)})),Uc(e,t)},Xc={removeChildren:Rc,appendTo:function appendTo(e,t){return null!=t&&t.appendChild(e),e},setAttributes:function setAttributes(e,t){return Object.keys(t).forEach((function(n){return e.setAttribute(Gc.toKebab(n),t[n])}))}},$c=function filterWhitespaceNodes(e){if(null===e)return e;for(var t=e.childNodes.length-1;t>=0;t-=1){var n=e.childNodes[t];3===n.nodeType&&n.data.match(/^\s*$/)&&e.removeChild(n),1===n.nodeType&&filterWhitespaceNodes(n)}return e},Hc=function parse(e){return(new sc.DOMParser).parseFromString(e,"text/xml")},Yc=function checkParseError(e){var t=e.getElementsByTagName("parsererror");if(t.length>0)throw new Error(t[0]);return $c(e.documentElement)},Wc=function sync(e){if(_typeof(e)===ic.string||e instanceof String)try{return Yc(Hc(e))}catch(e){return e}if(null!=e.childNodes)return e},Jc=function Load(e){return function isFilename(e){return _typeof(e)===ic.string&&/^[\w,\s-]+\.[A-Za-z]{3}$/.test(e)&&e.length<1e4}(e)&&oc&&_typeof(sc.fetch)===ic.function?function async(e){return new Promise((function(t,n){if(_typeof(e)===ic.string||e instanceof String)fetch(e).then((function(e){return e.text()})).then((function(e){return Yc(Hc(e))})).then((function(e){return"svg"===e.nodeName?e:e.getElementsByTagName("svg")[0]})).then((function(e){return null==e?n("valid XML found, but no SVG element"):t(e)})).catch((function(e){return n(e)}));else if(e instanceof sc.Document)return asyncDone(e)}))}(e):Wc(e)};var Kc=function save(e,t){if((t=Object.assign(function SAVE_OPTIONS(){return{download:!1,output:ic.string,windowStyle:!1,filename:"image.svg"}}(),t)).windowStyle){var n=sc.document.createElementNS(fc,ic.style);n.setAttribute("type","text/css"),n.innerHTML=function getWindowStylesheets(){var e=[];if(sc.document.styleSheets)for(var t=0;t<sc.document.styleSheets.length;t+=1){var n=sc.document.styleSheets[t];try{for(var r=("cssRules"in n?n.cssRules:n.rules),i=0;i<r.length;i+=1){var o=r[i];"cssText"in o?e.push(o.cssText):e.push("".concat(o.selectorText," {\n").concat(o.style.cssText,"\n}\n"))}}catch(e){console.warn(e)}}return e.join("\n")}(),e.appendChild(n)}var r=function vkXML(e,t){for(var n=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").split("~::~"),r=n.length,i=!1,o=0,c="",a=null!=t&&"string"==typeof t?t:"\t",u=["\n"],s=0;s<100;s+=1)u.push(u[s]+a);for(var l=0;l<r;l+=1)n[l].search(/<!/)>-1?(c+=u[o]+n[l],i=!0,(n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1||n[l].search(/!DOCTYPE/)>-1)&&(i=!1)):n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1?(c+=n[l],i=!1):/^<\w/.exec(n[l-1])&&/^<\/\w/.exec(n[l])&&/^<[\w:\-\.\,]+/.exec(n[l-1])==/^<\/[\w:\-\.\,]+/.exec(n[l])[0].replace("/","")?(c+=n[l],i||(o-=1)):n[l].search(/<\w/)>-1&&-1===n[l].search(/<\//)&&-1===n[l].search(/\/>/)?c=c+=i?n[l]:u[o++]+n[l]:n[l].search(/<\w/)>-1&&n[l].search(/<\//)>-1?c=c+=i?n[l]:u[o]+n[l]:n[l].search(/<\//)>-1?c=c+=i?n[l]:u[--o]+n[l]:n[l].search(/\/>/)>-1?c=c+=i?n[l]:u[o]+n[l]:n[l].search(/<\?/)>-1||n[l].search(/xmlns\:/)>-1||n[l].search(/xmlns\=/)>-1?c+=u[o]+n[l]:c+=n[l];return"\n"===c[0]?c.slice(1):c}((new sc.XMLSerializer).serializeToString(e));return t.download&&oc&&!cc&&function downloadInBrowser(e,t){var n=new sc.Blob([t],{type:"text/plain"}),r=sc.document.createElement("a");r.setAttribute("href",sc.URL.createObjectURL(n)),r.setAttribute("download",e),sc.document.body.appendChild(r),r.click(),sc.document.body.removeChild(r)}(t.filename,r),"svg"===t.output?e:r},Qc=function setViewBox(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=1===n.length&&"string"==typeof n[0]?n[0]:viewBox.apply(void 0,n);return i&&e.setAttribute(ic.viewBox,i),e},ea=function getViewBox(e){var t=e.getAttribute(ic.viewBox);return null==t?void 0:t.split(" ").map((function(e){return parseFloat(e)}))},ta=function convertToViewBox(e,t,n){var r=e.createSVGPoint();r.x=t,r.y=n;var i=r.matrixTransform(e.getScreenCTM().inverse());return[i.x,i.y]},na=Object.freeze({__proto__:null,setViewBox:Qc,getViewBox:ea,convertToViewBox:ta}),ra=function loadSVG(e,t){var n=Jc(t);if(null!=n)return _typeof(n.then)===ic.function?n.then((function(t){return Zc(e,t)})):Zc(e,n)},ia=function getFrame(e){var t=ea(e);if(void 0!==t)return t;if(_typeof(e.getBoundingClientRect)===ic.function){var n=e.getBoundingClientRect();return[n.x,n.y,n.width,n.height]}return[]},oa="svg-background-rectangle",ca=function stylesheet(e,t){var n=function findStyleSheet(e){var t=e.getElementsByTagName(ic.style);return 0===t.length?void 0:t[0]}(e);return null==n&&(n=this.Constructor(ic.style),e.insertBefore(n,e.firstChild)),n.textContent="",n.appendChild(Dc(t)),n},aa={clear:function clearSVG(e){return Array.from(e.attributes).filter((function(e){return"xmlns"!==e})).forEach((function(t){return e.removeAttribute(t.name)})),Rc(e)},size:Qc,setViewBox:Qc,getViewBox:ea,padding:function setPadding(e,t){var n=ea(e);return void 0!==n&&Qc.apply(void 0,[e].concat(_toConsumableArray([-t,-t,2*t,2*t].map((function(e,t){return n[t]+e}))))),e},background:function background(e,t){var n=Array.from(e.childNodes).filter((function(e){return e.getAttribute(ic.class)===oa})).shift();return null==n&&((n=this.Constructor.apply(this,["rect"].concat(_toConsumableArray(ia(e))))).setAttribute(ic.class,oa),n.setAttribute("stroke","none"),e.insertBefore(n,e.firstChild)),n.setAttribute("fill",t),e},getWidth:function getWidth(e){return ia(e)[2]},getHeight:function getHeight(e){return ia(e)[3]},stylesheet:function stylesheet(e,t){return ca.call(this,e,t)},load:ra,save:Kc},ua={math:{vector:function vector(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return[].concat(t)}}},sa={move:["mousemove","touchmove"],press:["mousedown","touchstart"],release:["mouseup","touchend"]},fa=Object.values(sa).reduce((function(e,t){return e.concat(t)}),[]),la=function defineGetter(e,t,n){return Object.defineProperty(e,t,{get:function get(){return n},enumerable:!0,configurable:!0})},va=function assignPress(e,t){var n;(["pressX","pressY"].filter((function(t){return!e.hasOwnProperty(t)})).forEach((function(n,r){return la(e,n,t[r])})),e.hasOwnProperty("press"))||la(e,"press",(n=ua.math).vector.apply(n,_toConsumableArray(t)))},pa=function TouchEvents(e){var t=[],n=[];Object.keys(sa).forEach((function(e){sa[e].forEach((function(e){n[e]=[]}))}));var r={press:function press(e,n){va(e,t=n)},release:function release(){},move:function move(e,n){e.buttons>0&&void 0===t[0]?t=n:0===e.buttons&&void 0!==t[0]&&(t=[]),va(e,t)}};Object.keys(sa).forEach((function(t){var i="on"+Gc.capitalized(t);Object.defineProperty(e,i,{set:function set(i){return null==i?function removeHandler(t){return sa[t].forEach((function(t){return n[t].forEach((function(n){return e.removeEventListener(t,n)}))}))}(t):sa[t].forEach((function(o){var c=function handlerFunc(n){var o=null!=n.touches?n.touches[0]:n;if(void 0!==o){var c,a=ta(e,o.clientX,o.clientY).map((function(e){return isNaN(e)?void 0:e}));if(["x","y"].filter((function(e){return!n.hasOwnProperty(e)})).forEach((function(e,t){return la(n,e,a[t])})),!n.hasOwnProperty("position"))la(n,"position",(c=ua.math).vector.apply(c,_toConsumableArray(a)));r[t](n,a)}i(n)};e.addEventListener&&(n[o].push(c),e.addEventListener(o,c))}))},enumerable:!0})})),Object.defineProperty(e,"off",{value:function value(){return function off(e,t){return fa.forEach((function(n){t[n].forEach((function(t){return e.removeEventListener(n,t)})),t[n]=[]}))}(e,n)}})},da=function UUID(){return Math.random().toString(36).replace(/[^a-z]+/g,"").concat("aaaaa").substr(0,5)},_a=function Animation(e){var t,n,r={},i=0,o=function removeHandlers(){sc.cancelAnimationFrame&&sc.cancelAnimationFrame(n),Object.keys(r).forEach((function(e){return delete r[e]})),t=void 0,i=0};Object.defineProperty(e,"play",{set:function set(e){if(o(),null!=e){var c=da();r[c]=function handlerFunc(o){t||(t=o,i=0),e({time:.001*(o-t),frame:i}),i+=1,r[c]&&(n=sc.requestAnimationFrame(r[c]))},sc.requestAnimationFrame&&(n=sc.requestAnimationFrame(r[c]))}},enumerable:!0}),Object.defineProperty(e,"stop",{value:o,enumerable:!0})},ga=function distanceSq2(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)},ha=function distance2(e,t){return Math.sqrt(ga(e,t))},ma=Object.freeze({__proto__:null,distanceSq2:ga,distance2:ha}),ya=[["cx","cy"],["x","y"]],ba=function controlPoint(e){var t=[0,0],n={selected:!1,svg:void 0,updatePosition:function updatePosition(e){return e}},r=function updateSVG(){n.svg&&(n.svg.parentNode||e.appendChild(n.svg),ya.filter((function(e){return null!=n.svg[e[0]]})).forEach((function(e){return e.forEach((function(e,r){n.svg.setAttribute(e,t[r])}))})))},i=new Proxy(t,{set:function set(e,t,n){return e[t]=n,r(),!0}}),o=function setPosition(){Mc.apply(void 0,_toConsumableArray(Ec.apply(void 0,arguments))).forEach((function(e,n){t[n]=e})),r(),"function"==typeof t.delegate&&t.delegate.apply(t.pointsContainer,[i,t.pointsContainer])};return t.delegate=void 0,t.setPosition=o,t.onMouseMove=function(e){return n.selected?o(n.updatePosition(e)):void 0},t.onMouseUp=function(){n.selected=!1},t.distance=function(e){return Math.sqrt(ga(e,t))},["x","y"].forEach((function(e,n){return Object.defineProperty(t,e,{get:function get(){return t[n]},set:function set(e){t[n]=e}})})),["svg","updatePosition","selected"].forEach((function(e){return Object.defineProperty(t,e,{get:function get(){return n[e]},set:function set(t){n[e]=t}})})),Object.defineProperty(t,"remove",{value:function value(){!function removeFromParent(e){e&&e.parentNode&&e.parentNode.removeChild(e)}(n.svg),t.delegate=void 0}}),i},xa=function controls(e,t,n){var r,i,o=Array.from(Array(t)).map((function(){return ba(e)})),c=function protocol(e){return"function"==typeof i?i.call(o,e,r,o):void 0};o.forEach((function(e){e.delegate=c,e.pointsContainer=o}));e.onPress=function mousePressedHandler(e){o.length>0&&(r=o.map((function(t,n){return{i:n,d:ga(t,[e.x,e.y])}})).sort((function(e,t){return e.d-t.d})).shift().i,o[r].selected=!0)},e.onMove=function mouseMovedHandler(e){o.forEach((function(t){return t.onMouseMove(e)}))},e.onRelease=function mouseReleasedHandler(){o.forEach((function(e){return e.onMouseUp()})),r=void 0},Object.defineProperty(o,"selectedIndex",{get:function get(){return r}}),Object.defineProperty(o,"selected",{get:function get(){return o[r]}}),Object.defineProperty(o,"add",{value:function value(t){o.push(ba(e))}}),o.removeAll=function(){for(;o.length>0;)o.pop().remove()};var a={onChange:function onChange(e,t){if(i=e,!0===t){var n=o.length-1;e.call(o,o[n],n,o)}},position:function position(e){return o.forEach((function(t,n){return t.setPosition(e.call(o,t,n,o))}))},svg:function svg(e){return o.forEach((function(t,n){t.svg=e.call(o,t,n,o)}))}};return Object.keys(a).forEach((function(e){o[e]=function(){return"function"==typeof arguments[0]&&a[e].apply(a,arguments),o}})),o.parent=function(e){return null!=e&&null!=e.appendChild&&o.forEach((function(t){e.appendChild(t.svg)})),o},o},Aa=function applyControlsToSVG(e){e.controls=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return xa.call.apply(xa,[e,e].concat(n))}},ka=(new sc.DOMParser).parseFromString("<div />","text/xml").documentElement.constructor,wa={svg:{args:function args(){return[viewBox(Mc.apply(void 0,arguments))].filter((function(e){return null!=e}))},methods:aa,init:function init(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.filter((function(e){return _typeof(e)===ic.string})).forEach((function(t){return ra(e,t)})),n.filter((function(e){return null!=e})).filter((function(e){return e instanceof ka})).filter((function(e){return _typeof(e.appendChild)===ic.function})).forEach((function(t){return t.appendChild(e)})),pa(e),_a(e),Aa(e)}}},Ea=function loadGroup(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n.map((function(e){return Wc(e)})).filter((function(e){return void 0!==e}));return i.filter((function(e){return e.tagName===ic.svg})).forEach((function(t){return Uc(e,t)})),i.filter((function(e){return e.tagName!==ic.svg})).forEach((function(t){return e.appendChild(t)})),e},Ma={g:{init:Ea,methods:{load:Ea}}},Oa=Object.assign(Object.create(null),{svg:["viewBox"],line:["x1","y1","x2","y2"],rect:["x","y","width","height"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],polygon:["points"],polyline:["points"],path:["d"],text:["x","y"],mask:["id"],symbol:["id"],clipPath:["id","clip-rule"],marker:["id","markerHeight","markerUnits","markerWidth","orient","refX","refY"],linearGradient:["x1","x2","y1","y2"],radialGradient:["cx","cy","r","fr","fx","fy"],stop:["offset","stop-color","stop-opacity"],pattern:["patternContentUnits","patternTransform","patternUnits"]}),ja=function setRadius(e,t){return e.setAttribute(Oa.circle[2],t),e},Ca=function setOrigin(e,t,n){return _toConsumableArray(Mc.apply(void 0,_toConsumableArray(Ec(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(Oa.circle[n],t)})),e},Sa=function fromPoints(e,t,n,r){return[e,t,ha([e,t],[n,r])]},Pa={circle:{args:function args(e,t,n,r){var i=Mc.apply(void 0,_toConsumableArray(Ec(e,t,n,r)));switch(i.length){case 0:case 1:return[,,].concat(_toConsumableArray(i));case 2:case 3:return i;default:return Sa.apply(void 0,_toConsumableArray(i))}},methods:{radius:ja,setRadius:ja,origin:Ca,setOrigin:Ca,center:Ca,setCenter:Ca,position:Ca,setPosition:Ca}}},Na=function setRadii(e,t,n){return[,,t,n].forEach((function(t,n){return e.setAttribute(Oa.ellipse[n],t)})),e},za=function setCenter(e,t,n){return _toConsumableArray(Mc.apply(void 0,_toConsumableArray(Ec(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(Oa.ellipse[n],t)})),e},Ia={ellipse:{args:function args(e,t,n,r){var i=Mc.apply(void 0,_toConsumableArray(Ec(e,t,n,r))).slice(0,4);switch(i.length){case 0:case 1:case 2:return[,,].concat(_toConsumableArray(i));default:return i}},methods:{radius:Na,setRadius:Na,origin:za,setOrigin:za,center:za,setCenter:za,position:za,setPosition:za}}},La=function Args(e,t,n,r){return Mc.apply(void 0,_toConsumableArray(Ec(e,t,n,r))).slice(0,4)},qa={line:{args:La,methods:{setPoints:function setPoints(e,t,n,r,i){return La(t,n,r,i).forEach((function(t,n){return e.setAttribute(Oa.line[n],t)})),e}}}},Ta=/[MmLlSsQqLlHhVvCcSsQqTtAaZz]/g,Fa=/-?[0-9]*\.?\d+/g,Va={m:"move",l:"line",v:"vertical",h:"horizontal",a:"ellipse",c:"curve",s:"smoothCurve",q:"quadCurve",t:"smoothQuadCurve",z:"close"};Object.keys(Va).forEach((function(e){var t=Va[e];Va[e.toUpperCase()]=t.charAt(0).toUpperCase()+t.slice(1)}));var Ga=function getD(e){var t=e.getAttribute("d");return null==t?"":t},Ba=function appendPathCommand(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return e.setAttribute("d","".concat(Ga(e)).concat(t).concat(Ec.apply(void 0,r).join(" "))),e},Da=function getCommands(e){return function parsePathCommands(e){for(var t,n=[];null!==(t=Ta.exec(e));)n.push(t);return n.map((function(t){return{command:e[t.index],index:t.index}})).reduceRight((function(t,n){var r=e.substring(n.index,t.length?t[t.length-1].index:e.length);return t.concat([{command:n.command,index:n.index,chunk:r.length>0?r.substr(1,r.length-1):r}])}),[]).reverse().map((function(e){var t=e.chunk.match(Fa);return e.en=Va[e.command],e.values=t?t.map(parseFloat):[],delete e.chunk,e}))}(Ga(e))},Ra={addCommand:Ba,appendCommand:Ba,clear:function clear(e){return e.removeAttribute("d"),e},getCommands:Da,get:Da,getD:function getD(e){return e.getAttribute("d")}};Object.keys(Va).forEach((function(e){Ra[Va[e]]=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return Ba.apply(void 0,[t,e].concat(r))}}));var Ua={path:{methods:Ra}},Za=function setRectSize(e,t,n){return[,,t,n].forEach((function(t,n){return e.setAttribute(Oa.rect[n],t)})),e},Xa=function setRectOrigin(e,t,n){return _toConsumableArray(Mc.apply(void 0,_toConsumableArray(Ec(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(Oa.rect[n],t)})),e},$a=function fixNegatives(e){return[0,1].forEach((function(t){e[2+t]<0&&(void 0===e[0+t]&&(e[0+t]=0),e[0+t]+=e[2+t],e[2+t]=-e[2+t])})),e},Ha={rect:{args:function args(e,t,n,r){var i=Mc.apply(void 0,_toConsumableArray(Ec(e,t,n,r))).slice(0,4);switch(i.length){case 0:case 1:case 2:case 3:return $a([,,].concat(_toConsumableArray(i)));default:return $a(i)}},methods:{origin:Xa,setOrigin:Xa,center:Xa,setCenter:Xa,size:Za,setSize:Za}}},Ya={style:{init:function init(e,t){e.textContent="",e.appendChild(Dc(t))},methods:{setTextContent:function setTextContent(e,t){return e.textContent="",e.appendChild(Dc(t)),e}}}},Wa={text:{args:function args(e,t,n){return Mc.apply(void 0,_toConsumableArray(Ec(e,t,n))).slice(0,2)},init:function init(e,t,n,r,i){var o=[t,n,r,i].filter((function(e){return _typeof(e)===ic.string})).shift();o&&e.appendChild(sc.document.createTextNode(o))}}},Ja=function makeIDString(){return Array.from(arguments).filter((function(e){return _typeof(e)===ic.string||e instanceof String})).shift()||da()},Ka=function args(){return[Ja.apply(void 0,arguments)]},Qa={mask:{args:Ka},clipPath:{args:Ka},symbol:{args:Ka},marker:{args:Ka,methods:{size:Qc,setViewBox:Qc}}},eu=function getPoints(e){var t=e.getAttribute("points");return null==t?"":t},tu=function polyString(){var e=arguments;return Array.from(Array(Math.floor(arguments.length/2))).map((function(t,n){return"".concat(e[2*n+0],",").concat(e[2*n+1])})).join(" ")},nu=function stringifyArgs(){return[tu.apply(void 0,_toConsumableArray(Mc.apply(void 0,_toConsumableArray(Ec.apply(void 0,arguments)))))]},ru=function setPoints$1(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("points",nu.apply(void 0,n)[0]),e},iu=function addPoint(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("points",[eu(e),nu.apply(void 0,n)[0]].filter((function(e){return""!==e})).join(" ")),e},ou=function Args$1(){return 1===arguments.length&&_typeof(arguments.length<=0?void 0:arguments[0])===ic.string?[arguments.length<=0?void 0:arguments[0]]:nu.apply(void 0,arguments)},cu={polyline:{args:ou,methods:{setPoints:ru,addPoint:iu}},polygon:{args:ou,methods:{setPoints:ru,addPoint:iu}}},au=Object.assign({},wa,Ma,Pa,Ia,qa,Ua,Ha,Ya,Wa,Qa,cu),uu={presentation:["color","color-interpolation","cursor","direction","display","fill","fill-opacity","fill-rule","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","image-rendering","letter-spacing","opacity","overflow","paint-order","pointer-events","preserveAspectRatio","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tabindex","transform-origin","user-select","vector-effect","visibility"],animation:["accumulate","additive","attributeName","begin","by","calcMode","dur","end","from","keyPoints","keySplines","keyTimes","max","min","repeatCount","repeatDur","restart","to","values"],effects:["azimuth","baseFrequency","bias","color-interpolation-filters","diffuseConstant","divisor","edgeMode","elevation","exponent","filter","filterRes","filterUnits","flood-color","flood-opacity","in","in2","intercept","k1","k2","k3","k4","kernelMatrix","lighting-color","limitingConeAngle","mode","numOctaves","operator","order","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","primitiveUnits","radius","result","seed","specularConstant","specularExponent","stdDeviation","stitchTiles","surfaceScale","targetX","targetY","type","xChannelSelector","yChannelSelector"],text:["dx","dy","alignment-baseline","baseline-shift","dominant-baseline","lengthAdjust","method","overline-position","overline-thickness","rotate","spacing","startOffset","strikethrough-position","strikethrough-thickness","text-anchor","text-decoration","text-rendering","textLength","underline-position","underline-thickness","word-spacing","writing-mode"],gradient:["gradientTransform","gradientUnits","spreadMethod"]};Object.values(lc).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return void 0===Oa[e]})).forEach((function(e){Oa[e]=[]})),[[["svg","defs","g"].concat(lc.v,lc.t),uu.presentation],[["filter"],uu.effects],[lc.cT.concat("text"),uu.text],[lc.cF,uu.effects],[lc.cG,uu.gradient]].forEach((function(e){return e[0].forEach((function(t){Oa[t]=Oa[t].concat(e[1])}))}));var su=function getClassList(e){if(null==e)return[];var t=e.getAttribute(ic.class);return null==t?[]:t.split(" ").filter((function(e){return""!==e}))},fu={addClass:function addClass(e,t){var n=su(e).filter((function(e){return e!==t}));n.push(t),e.setAttributeNS(null,ic.class,n.join(" "))},removeClass:function removeClass(e,t){var n=su(e).filter((function(e){return e!==t}));e.setAttributeNS(null,ic.class,n.join(" "))},setClass:function setClass(e,t){e.setAttributeNS(null,ic.class,t)},setId:function setId(e,t){e.setAttributeNS(null,ic.id,t)}},lu=function getAttr(e){var t=e.getAttribute(ic.transform);return null==t||""===t?void 0:t},vu={clearTransform:function clearTransform(e){return e.removeAttribute(ic.transform),e}};["translate","rotate","scale","matrix"].forEach((function(e){vu[e]=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return t.setAttribute(ic.transform,[lu(t),"".concat(e,"(").concat(r.join(" "),")")].filter((function(e){return void 0!==e})).join(" "))}}));var pu={};["clip-path","mask","symbol","marker-end","marker-mid","marker-start"].forEach((function(e){pu[Gc.toCamel(e)]=function(t,n){return t.setAttribute(e,function findIdURL(e){if(null==e)return"";if(_typeof(e)===ic.string)return"url"===e.slice(0,3)?e:"url(#".concat(e,")");if(null!=e.getAttribute){var t=e.getAttribute(ic.id);return"url(#".concat(t,")")}return""}(n))}}));var du={};(nc=lc.v).push.apply(nc,_toConsumableArray(Object.keys(zc))),Object.keys(zc).forEach((function(e){zc[e].attributes=void 0===zc[e].attributes?_toConsumableArray(uu.presentation):zc[e].attributes.concat(uu.presentation)})),Object.assign(du,au,zc),Object.keys(lc).forEach((function(e){return lc[e].filter((function(e){return void 0===du[e]})).forEach((function(e){du[e]={}}))}));var _u=function passthrough(){return Array.from(arguments)};Object.keys(du).forEach((function(e){du[e].nodeName||(du[e].nodeName=e),du[e].init||(du[e].init=_u),du[e].args||(du[e].args=_u),du[e].methods||(du[e].methods={}),du[e].attributes||(du[e].attributes=Oa[e]||[])}));var gu=function assign(e,t){e.forEach((function(e){return Object.keys(t).forEach((function(n){du[e].methods[n]=function(){return t[n].apply(t,arguments),arguments[0]}}))}))};gu(Ec(lc.t,lc.v,lc.g,lc.s,lc.p,lc.i,lc.h,lc.d),fu),gu(Ec(lc.t,lc.v,lc.g,lc.s,lc.p,lc.i,lc.h,lc.d),Xc),gu(Ec(lc.v,lc.g,lc.s),vu),gu(Ec(lc.t,lc.v,lc.g),pu);var hu={svg:{version:"1.1",xmlns:fc},style:{type:"text/css"}},mu=function RequiredAttributes(e,t){hu[t]&&Object.keys(hu[t]).forEach((function(n){return e.setAttribute(n,hu[t][n])}))},yu={},bu=function constructor(e){for(var t,n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var c=sc.document.createElementNS(fc,du[e].nodeName);return mu(c,e),(t=du[e]).init.apply(t,[c].concat(i)),(n=du[e]).args.apply(n,i).forEach((function(t,n){null!=du[e].attributes[n]&&c.setAttribute(du[e].attributes[n],t)})),du[e].attributes.forEach((function(e){Object.defineProperty(c,Gc.toCamel(e),{value:function value(){return c.setAttribute.apply(c,[e].concat(Array.prototype.slice.call(arguments))),c}})})),Object.keys(du[e].methods).forEach((function(t){return Object.defineProperty(c,t,{value:function value(){var n;return(n=du[e].methods[t]).call.apply(n,[yu,c].concat(Array.prototype.slice.call(arguments)))}})})),Vc[e]&&Vc[e].forEach((function(e){Object.defineProperty(c,e,{value:function value(){var t=constructor.apply(void 0,[e].concat(Array.prototype.slice.call(arguments)));return c.appendChild(t),t}})})),c};yu.Constructor=bu;var xu={};Object.keys(lc).forEach((function(e){return lc[e].forEach((function(e){xu[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return bu.apply(void 0,[e].concat(n))}}))}));var Au=function getFoldObject(e){return e.filter((function(e){return function possibleFoldObject(e){if("object"!==_typeof(e))return!1;var t=["vertices_coords","edges_vertices","faces_vertices","faces_edges"];return Object.keys(e).map((function(e){return t.includes(e)})).reduce((function(e,t){return e||t}),!1)}(e)})).shift()},ku=function initialize(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.filter((function(e){return _typeof(e)===ic.function})).forEach((function(t){return t.call(e,e)}))},wu=function SVG(){var e=arguments,t=bu.apply(void 0,[ic.svg].concat(Array.prototype.slice.call(arguments)));return"loading"===sc.document.readyState?sc.document.addEventListener("DOMContentLoaded",(function(){return ku.apply(void 0,[t].concat(_toConsumableArray(e)))})):ku.apply(void 0,[t].concat(Array.prototype.slice.call(arguments))),t};function vkXML$1(e,t){for(var n=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").split("~::~"),r=n.length,i=!1,o=0,c="",a=null!=t&&"string"==typeof t?t:"\t",u=["\n"],s=0;s<100;s+=1)u.push(u[s]+a);for(var l=0;l<r;l+=1)n[l].search(/<!/)>-1?(c+=u[o]+n[l],i=!0,(n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1||n[l].search(/!DOCTYPE/)>-1)&&(i=!1)):n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1?(c+=n[l],i=!1):/^<\w/.exec(n[l-1])&&/^<\/\w/.exec(n[l])&&/^<[\w:\-\.\,]+/.exec(n[l-1])==/^<\/[\w:\-\.\,]+/.exec(n[l])[0].replace("/","")?(c+=n[l],i||(o-=1)):n[l].search(/<\w/)>-1&&-1===n[l].search(/<\//)&&-1===n[l].search(/\/>/)?c=c+=i?n[l]:u[o++]+n[l]:n[l].search(/<\w/)>-1&&n[l].search(/<\//)>-1?c=c+=i?n[l]:u[o]+n[l]:n[l].search(/<\//)>-1?c=c+=i?n[l]:u[--o]+n[l]:n[l].search(/\/>/)>-1?c=c+=i?n[l]:u[o]+n[l]:n[l].search(/<\?/)>-1||n[l].search(/xmlns\:/)>-1||n[l].search(/xmlns\=/)>-1?c+=u[o]+n[l]:c+=n[l];return"\n"===c[0]?c.slice(1):c}Object.assign(wu,xu),wu.NS=fc,wu.linker=function Linker(e){var t=this;["segment","circle","ellipse","rect","polygon"].filter((function(t){return e[t]&&e[t].prototype})).forEach((function(n){e[n].prototype.svg=function(){return t.path(this.svgPath())}})),e.svg=t}.bind(wu),wu.use=function use(e){e.origami&&function bindRabbitEar(e,t){ua.math.vector=t.vector}(0,e),e.render_into_svg&&function bindFoldToSvg(e,t){var n=du.svg.init;du.svg.init=function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var c=Au(i);if(c){var a=t.options.apply(t,i);t.render_into_svg(e,c,a)}return n.apply(void 0,[e].concat(i))}}(0,e)}.bind(wu),wu.core=Object.assign(Object.create(null),{load:Jc,save:Kc,coordinates:Mc,flatten:Ec,attributes:Oa,children:Vc,cdata:Dc,detect:uc},Gc,fu,Xc,ma,vu,na);var Eu="vertices",Mu="edges",Ou="faces",ju="boundaries",Cu="boundary",Su="mountain",Pu="valley",Nu="mark",zu="unassigned",Iu="front",Lu="back",qu="svg",Tu="class",Fu="index",Vu="object",Gu="string",Bu="undefined",Du="black",Ru="white",Uu="lightgray",Zu="stroke-width",Xu="vertices_coords",$u="edges_vertices",Hu="faces_vertices",Yu="faces_edges",Wu="edges_assignment",Ju="faces_re:layer",Ku=("undefined"==typeof window?"undefined":_typeof(window))!==Bu&&_typeof(window.document)!==Bu,Qu=("undefined"==typeof process?"undefined":_typeof(process))!==Bu&&null!=process.versions&&null!=process.versions.node,es=function(){var e={};if(Qu){var t=require("xmldom"),n=t.DOMParser,r=t.XMLSerializer;e.DOMParser=n,e.XMLSerializer=r,e.document=(new n).parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else Ku&&(e=window);return e}(),ts="http://www.w3.org/2000/svg",ns={SVG:{NS:ts,g:function g(){return es.document.createElementNS(ts,"g")},defs:function defs(){return es.document.createElementNS(ts,"defs")},style:function style(){var e=es.document.createElementNS(ts,"style");return e.setAttributeNS(null,"type","text/css"),e},line:function line(e,t,n,r){var i=es.document.createElementNS(ts,"line");return i.setAttributeNS(null,"x1",e),i.setAttributeNS(null,"y1",t),i.setAttributeNS(null,"x2",n),i.setAttributeNS(null,"y2",r),i},circle:function circle(e,t,n){var r=es.document.createElementNS(ts,"circle");return r.setAttributeNS(null,"cx",e),r.setAttributeNS(null,"cy",t),r.setAttributeNS(null,"r",n),r},polygon:function polygon(e){var t=es.document.createElementNS(ts,"polygon"),n=e.map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ");return t.setAttributeNS(null,"points",n),t},path:function path(e){var t=es.document.createElementNS(ts,"path");return t.setAttributeNS(null,"d",e),t}}},rs=function recursive_freeze(e){return Object.freeze(e),void 0===e||Object.getOwnPropertyNames(e).filter((function(t){return null!==e[t]&&(_typeof(e[t])===Vu||"function"===_typeof(e[t]))&&!Object.isFrozen(e[t])})).forEach((function(t){return recursive_freeze(e[t])})),e},is=function recursive_assign(e,t){return Object.keys(t).forEach((function(n){_typeof(t[n])===Vu&&null!==t[n]?(n in e||(e[n]={}),recursive_assign(e[n],t[n])):_typeof(e)!==Vu||n in e||(e[n]=t[n])})),e},os=function get_object(e){if(null==e)return{};if(_typeof(e)===Vu&&null!==e)return e;if(_typeof(e)===Gu||e instanceof String)try{return JSON.parse(e)}catch(e){return{}}return{}},cs=function bounding_rect(e){if(null==e.vertices_coords||e.vertices_coords.length<=0)return[0,0,0,0];var t=e.vertices_coords[0].length,n=Array(t).fill(1/0),r=Array(t).fill(-1/0);return e.vertices_coords.forEach((function(e){return e.forEach((function(e,t){e<n[t]&&(n[t]=e),e>r[t]&&(r[t]=e)}))})),isNaN(n[0])||isNaN(n[1])||isNaN(r[0])||isNaN(r[1])?[0,0,0,0]:[n[0],n[1],r[0]-n[0],r[1]-n[1]]},as="none",us="500px",ss=function Options(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return rs({input:Gu,output:Gu,padding:null,file_frame:null,stylesheet:null,shadows:null,boundaries:!0,faces:!0,edges:!0,vertices:!1,attributes:{svg:{width:us,height:us,stroke:Du,fill:as,"stroke-linejoin":"bevel","stroke-width":e/200},circle:{r:e/200},boundaries:{fill:Ru},faces:{stroke:as,front:{fill:Uu},back:{fill:Ru},foldedForm:{stroke:Du}},edges:{boundary:{},mountain:{stroke:"red"},valley:{stroke:"blue"},mark:{stroke:Uu},unassigned:{stroke:Uu}},vertices:{stroke:as,fill:Du}}})},fs=function make_options(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=cs(e),r=Math.min(n[2],n[3]);return is(t,ss(r)),t.shadows&&is(t,{attributes:{faces:{front:{filter:"url(#shadow)"},back:{filter:"url(#shadow)"}}}}),t},ls=function boundaries_polygon(e){if(Xu in e==!1||$u in e==!1||Wu in e==!1)return[];var t=function get_boundary(e){if(null==e.edges_assignment)return{vertices:[],edges:[]};for(var t=e.edges_assignment.map((function(e){return"B"===e||"b"===e})),n=function make_vertices_edges(e){if(e.edges_vertices){var t=[];return e.edges_vertices.forEach((function(e,n){return e.forEach((function(e){void 0===t[e]&&(t[e]=[]),t[e].push(n)}))})),t}}(e),r=[],i=[],o=-1,c=0;c<t.length;c+=1)if(t[c]){o=c;break}if(-1===o)return{vertices:[],edges:[]};t[o]=!1,r.push(o),i.push(e.edges_vertices[o][0]);for(var a=e.edges_vertices[o][1];i[0]!==a;){if(i.push(a),void 0===(o=n[a].filter((function(e){return t[e]})).shift()))return{vertices:[],edges:[]};a=e.edges_vertices[o][0]===a?_slicedToArray(e.edges_vertices[o],2)[1]:_slicedToArray(e.edges_vertices[o],1)[0],t[o]=!1,r.push(o)}return{vertices:i,edges:r}}(e).vertices.map((function(t){return[0,1].map((function(n){return e.vertices_coords[t][n]}))}));if(0===t.length)return[];var n=ns.SVG.polygon(t);return n.setAttributeNS(null,Tu,Cu),[n]},vs=function vertices_circle(e,t){if(Xu in e==!1)return[];var n=e.vertices_coords.map((function(e){return ns.SVG.circle(e[0],e[1],.01)}));return n.forEach((function(e,t){return e.setAttributeNS(null,Fu,t)})),n},ps={B:Cu,b:Cu,M:Su,m:Su,V:Pu,v:Pu,F:Nu,f:Nu,U:zu,u:zu},ds={B:"b",b:"b",M:"m",m:"m",V:"v",v:"v",F:"f",f:"f",U:"u",u:"u"},_s=function edges_coords(e){return null==e.edges_vertices||null==e.vertices_coords?[]:e.edges_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))}))},gs=function segment_to_path(e){return"M".concat(e[0][0]," ").concat(e[0][1],"L").concat(e[1][0]," ").concat(e[1][1])},hs=function edges_path_data(e){var t=_s(e).map((function(e){return gs(e)})).join("");return""===t?void 0:t},ms=function edges_by_assignment_paths_data(e){if(null==e.edges_vertices||null==e.vertices_coords||null==e.edges_assignment)return[];var t=_s(e),n=function edges_indices_classes(e){var t={u:[],f:[],v:[],m:[],b:[]};return e.edges_assignment.map((function(e){return ds[e]})).forEach((function(e,n){return t[e].push(n)})),t}(e),r=Object.keys(n).map((function(e){return n[e].map((function(e){return t[e]}))})).map((function(e){return e.map((function(e){return gs(e)})).join("")})),i={};return Object.keys(n).map((function(e,t){""!==r[t]&&(i[e]=r[t])})),i},ys=function edges_path(e){if(null==e.edges_assignment){var t=hs(e);return void 0===t?[]:[ns.SVG.path(t)]}var n=ms(e);return Object.keys(n).map((function(e){var t=ns.SVG.path(n[e]);return t.setAttributeNS(null,Tu,ps[e]),t}))},bs={subtract:function subtract(e,t){return e.map((function(e,n){return e-(t[n]||0)}))},cross2:function cross2(e,t){return e[0]*t[1]-e[1]*t[0]}},xs=function finalize_faces(e,t){var n=_typeof(e.frame_classes)===Vu&&null!==e.frame_classes&&!e.frame_classes.includes("creasePattern"),r=null!=e[Ju]&&e[Ju].length===e.faces_vertices.length,i=[[Iu],[Lu]].map((function(e){return n&&e.push("foldedForm"),e})).map((function(e){return e.join(" ")}));return function get_faces_winding(e){return e.faces_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]})).map((function(e,t,n){return[e,n[(t+1)%n.length],n[(t+2)%n.length]]})).map((function(e){return bs.cross2(bs.subtract(e[1],e[0]),bs.subtract(e[2],e[1]))})).reduce((function(e,t){return e+t}),0)}))}(e).map((function(e){return e<0?i[0]:i[1]})).forEach((function(e,n){return t[n].setAttributeNS(null,Tu,e)})),r?function faces_sorted_by_layer(e){return e.map((function(e,t){return{layer:e,i:t}})).sort((function(e,t){return e.layer-t.layer})).map((function(e){return e.i}))}(e[Ju]).map((function(e){return t[e]})):t},As=function faces_vertices_polygon(e){if(Hu in e==!1||Xu in e==!1)return[];var t=e.faces_vertices.map((function(t){return t.map((function(t){return[0,1].map((function(n){return e.vertices_coords[t][n]}))}))})).map((function(e){return ns.SVG.polygon(e)}));return t.forEach((function(e,t){return e.setAttributeNS(null,Fu,t)})),xs(e,t)},ks=function faces_edges_polygon(e){if(Yu in e==!1||$u in e==!1||Xu in e==!1)return[];var t=e.faces_edges.map((function(t){return t.map((function(t){return e.edges_vertices[t]})).map((function(e,t,n){var r=n[(t+1)%n.length];return e[1]===r[0]||e[1]===r[1]?e[0]:e[1]})).map((function(t){return[0,1].map((function(n){return e.vertices_coords[t][n]}))}))})).map((function(e){return ns.SVG.polygon(e)}));return t.forEach((function(e,t){return e.setAttributeNS(null,Fu,t)})),xs(e,t)},ws={vertices:[],edges:[zu,Nu,Pu,Su,Cu],faces:[Iu,Lu,"foldedForm"],boundaries:[]},Es=function style_component(e,t,n){var r=t.attributes,i=ws[n]||[];Array.from(e.childNodes).filter((function(e){return r[e.nodeName]})).forEach((function(e){return Object.keys(r[e.nodeName]).forEach((function(t){return e.setAttributeNS(null,t,r[e.nodeName][t])}))})),Object.keys(r[n]).filter((function(e){return!i.includes(e)})).forEach((function(t){return e.setAttributeNS(null,t,r[n][t])})),0!==i.length&&Array.from(e.childNodes).forEach((function(e){return Object.keys(r[n][e.getAttribute(Tu)]||{}).forEach((function(t){return e.setAttributeNS(null,t,r[n][e.getAttribute(Tu)][t])}))}))},Ms={vertices:vs,edges:ys,faces:function faces_draw_function(e){return null!=e.faces_vertices?As(e):ks(e)},boundaries:ls},Os=function render_components(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.attributes||(t.attributes={}),[ju,Ou,Mu,Eu].filter((function(e){return!0===t[e]})).map((function(n){var r=ns.SVG.g();return r.setAttributeNS(null,Tu,n),Ms[n](e,t).forEach((function(e){return r.appendChild(e)})),Es(r,t,n),r})).filter((function(e){return e.childNodes.length>0}))},js=es.document,Cs=Object.freeze({blur:.005,opacity:.3,color:Du}),Ss="result",Ps="in",Ns="blur",zs="offsetColor",Is="offsetBlur",Ls="feMergeNode",qs="200%",Ts=function make_defs(e,t){var n=cs(e),r=Math.min(n[2],n[3]),i=ns.SVG.defs();if(null!=t.stylesheet){var o=ns.SVG.style();i.appendChild(o);var c=t.attributes.svg[Zu]?t.attributes.svg[Zu]:r/200,a=(new es.DOMParser).parseFromString("<xml></xml>","application/xml").createCDATASection("\n* { --".concat(Zu,": ").concat(c,"; }\n").concat(t.stylesheet));o.appendChild(a)}if(null!=t.shadows){var u=_typeof(t.shadows)===Vu&&null!==t.shadows?t.shadows:{blur:r/200};i.appendChild(function shadowFilter(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Cs,t="shadow";_typeof(e)===Vu&&null!==e||(e={}),Object.keys(Cs).filter((function(t){return!(t in e)})).forEach((function(t){e[t]=Cs[t]}));var n=js.createElementNS(ns.SVG.NS,"filter");n.setAttributeNS(null,"width",qs),n.setAttributeNS(null,"height",qs),n.setAttributeNS(null,"id",t);var r=js.createElementNS(ns.SVG.NS,"feGaussianBlur");r.setAttributeNS(null,Ps,"SourceAlpha"),r.setAttributeNS(null,"stdDeviation",e.blur),r.setAttributeNS(null,Ss,Ns);var i=js.createElementNS(ns.SVG.NS,"feOffset");i.setAttributeNS(null,Ps,Ns),i.setAttributeNS(null,Ss,Is);var o=js.createElementNS(ns.SVG.NS,"feFlood");o.setAttributeNS(null,"flood-color",e.color),o.setAttributeNS(null,"flood-opacity",e.opacity),o.setAttributeNS(null,Ss,zs);var c=js.createElementNS(ns.SVG.NS,"feComposite");c.setAttributeNS(null,Ps,zs),c.setAttributeNS(null,"in2",Is),c.setAttributeNS(null,"operator",Ps),c.setAttributeNS(null,Ss,Is);var a=js.createElementNS(ns.SVG.NS,"feMerge"),u=js.createElementNS(ns.SVG.NS,Ls),s=js.createElementNS(ns.SVG.NS,Ls);return s.setAttributeNS(null,Ps,"SourceGraphic"),a.appendChild(u),a.appendChild(s),n.appendChild(r),n.appendChild(i),n.appendChild(o),n.appendChild(c),n.appendChild(a),n}(u))}return null!=t.stylesheet||null!=t.shadows?i:void 0},Fs=function makeViewBox(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=1,c=n/o-n,a=e-c-i,u=t-c-i,s=n+2*c+2*i,l=r+2*c+2*i;return[a,u,s,l].join(" ")},Vs=function make_svg_attributes(e,t){var n=cs(e),r=(Math.min(n[2],n[3]),{viewBox:Fs.apply(void 0,_toConsumableArray(n).concat([t.padding]))}),i=function graph_classes(e){return[(null!=e.file_classes?e.file_classes:[]).join(" "),(null!=e.frame_classes?e.frame_classes:[]).join(" ")].filter((function(e){return""!==e})).join(" ")}(e);return""!==i&&(r.class=i),Object.assign(r,t.attributes.svg),r},Gs=function render_into_svg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};fs(t,n);var r=Ts(t,n);r&&e.appendChild(r),Os(t,n).forEach((function(t){return e.appendChild(t)}));var i=Vs(t,n);return Object.keys(i).forEach((function(t){return e.setAttributeNS(null,t,i[t])})),e},Bs=function svg$1$1(){var e=es.document.createElementNS(ns.SVG.NS,qu);return e.setAttribute("version","1.1"),e.setAttribute("xmlns",ns.SVG.NS),e},Ds=function FoldToSvg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=os(e);fs(n,t);var r=Gs(Bs(),n,t);if(t.output===qu)return r;var i=(new es.XMLSerializer).serializeToString(r),o=vkXML$1(i);return o};Object.assign(Ds,{render_into_svg:Gs,render_components:Os,options:fs,boundaries_polygon:ls,vertices_circle:vs,edges_path_data:hs,edges_by_assignment_paths_data:ms,edges_path:ys,edges_line:function edges_line(e){var t=_s(e).map((function(e){return ns.SVG.line(e[0][0],e[0][1],e[1][0],e[1][1])}));return t.forEach((function(e,t){return e.setAttributeNS(null,Fu,t)})),function make_edges_assignment_names(e){return null==e.edges_vertices||null==e.edges_assignment||e.edges_vertices.length!==e.edges_assignment.length?[]:e.edges_assignment.map((function(e){return ps[e]}))}(e).forEach((function(e,n){return t[n].setAttributeNS(null,Tu,e)})),t},faces_vertices_polygon:As,faces_edges_polygon:ks,linker:function linker(e){}.bind(Ds),use:function use(e){e.NS&&(ns.SVG=e)}});var Rs={graph:Go,cp:Ro,origami:Zo},Us={graph:function graph(){return{}},cp:$o.square,origami:$o.square};Object.keys(Rs).forEach((function(e){jo[e]=function(){var t=Array.from(arguments).filter((function(e){return xr(e)})).map((function(e){return JSON.parse(JSON.stringify(e))}));return Object.assign.apply(Object,[Object.create(Rs[e]),t.length?{}:Us[e]()].concat(_toConsumableArray(t),[{file_spec:tr,file_creator:nr}]))},jo[e].prototype=Rs[e],jo[e].prototype.constructor=jo[e],Object.keys($o).forEach((function(t){jo[e][t]=function(){return jo[e]($o[t].apply($o,arguments))}}))})),Object.assign(jo.graph,vo),mo.test=rc;var Zs=Object.assign(er,jo,{math:Qn.core,axiom:mo,diagram:Oo,text:Wo,webgl:Qo});return Object.defineProperty(Zs,"use",{enumerable:!1,value:function use(e){null!=e&&"function"==typeof e.linker&&e.linker(this)}.bind(Zs)}),Object.keys(Qn).filter((function(e){return"core"!==e})).forEach((function(e){Zs[e]=Qn[e]})),wu.use(Ds),wu.use(Zs),Ds.use(wu),Zs.use(wu),Zs.use(Ds),Zs}));
