/* Rabbit Ear 0.9.01 alpha 2021-01-10 (c) Robby Kraft, MIT License */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).ear=t()}(this,(function(){"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread2(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _slicedToArray(e,t){return function _arrayWithHoles(e){if(Array.isArray(e))return e}(e)||function _iterableToArrayLimit(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var c,a=e[Symbol.iterator]();!(r=(c=a.next()).done)&&(n.push(c.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(e,t)||_unsupportedIterableToArray(e,t)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||_unsupportedIterableToArray(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var e="undefined"!=typeof window&&void 0!==window.document,t="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,n=("object"===("undefined"==typeof self?"undefined":_typeof(self))&&self.constructor&&self.constructor.name,function type_of(e){switch(e.constructor.name){case"vector":case"matrix":case"segment":case"ray":case"line":case"circle":case"ellipse":case"rect":case"polygon":case"junction":return e.constructor.name}if("object"===_typeof(e)){if(null!=e.radius)return"circle";if(null!=e.width)return"rect";if(null!=e.x||"number"==typeof e[0])return"vector";if(null!=e[0]&&e[0].length&&("number"==typeof e[0].x||"number"==typeof e[0][0]))return"segment";if(null!=e.vector&&null!=e.origin)return"line"}}),r=function resize(e,t){return t.length===e?t:Array(e).fill(0).map((function(e,n){return t[n]?t[n]:e}))},o=function resize_up$1(e,t){var n=e.length>t.length?e.length:t.length;return[e,t].map((function(e){return r(n,e)}))},i=function count_places(e){var t="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?Math.max(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},c=function clean_number(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;if("number"!=typeof e)return e;var n=parseFloat(e.toFixed(t));return i(n)===Math.min(t,i(e))?e:n},a=function is_iterable(e){return null!=e&&"function"==typeof e[Symbol.iterator]},u=function semi_flatten_arrays(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return a(arguments[0])&&"string"!=typeof arguments[0]?semi_flatten_arrays.apply(void 0,_toConsumableArray(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(e){return a(e)?_toConsumableArray(semi_flatten_arrays(e)):e}))}},s=function flatten_arrays(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return a(arguments[0])&&"string"!=typeof arguments[0]?flatten_arrays.apply(void 0,_toConsumableArray(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(e){return a(e)?_toConsumableArray(flatten_arrays(e)):e})).reduce((function(e,t){return e.concat(t)}),[])}},l=Object.freeze({__proto__:null,resize:r,resize_up:o,resize_down:function resize_down(e,t){var n=e.length>t.length?t.length:e.length;return[e,t].map((function(e){return r(n,e)}))},clean_number:c,semi_flatten_arrays:u,flatten_arrays:s}),v=Object.create(null),p=[1,0,0,1],d=p.concat(0,0),g=function determinant2(e){return e[0]*e[3]-e[1]*e[2]},m=function make_matrix2_rotate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.cos(e),r=Math.sin(e);return[n,r,-r,n,t[0],t[1]]},h=Object.freeze({__proto__:null,identity2x2:p,identity2x3:d,multiply_matrix2_vector2:function multiply_matrix2_vector2(e,t){return[e[0]*t[0]+e[2]*t[1]+e[4],e[1]*t[0]+e[3]*t[1]+e[5]]},multiply_matrix2_line2:function multiply_matrix2_line2(e,t,n){return{vector:[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1]],origin:[e[0]*n[0]+e[2]*n[1]+e[4],e[1]*n[0]+e[3]*n[1]+e[5]]}},multiply_matrices2:function multiply_matrices2(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]},determinant2:g,invert_matrix2:function invert_matrix2(e){var t=g(e);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(e[4])&&isFinite(e[5]))return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[3]*e[4])/t,(e[1]*e[4]-e[0]*e[5])/t]},make_matrix2_translate:function make_matrix2_translate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return p.concat(e,t)},make_matrix2_scale:function make_matrix2_scale(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0];return[e,0,0,t,e*-n[0]+n[0],t*-n[1]+n[1]]},make_matrix2_rotate:m,make_matrix2_reflect:function make_matrix2_reflect(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.atan2(e[1],e[0]),r=Math.cos(n),o=Math.sin(n),i=Math.cos(-n),c=Math.sin(-n),a=r*i+o*c,u=r*-c+o*i,s=o*i+-r*c,l=o*-c+-r*i,v=t[0]+a*-t[0]+-t[1]*s,p=t[1]+u*-t[0]+-t[1]*l;return[a,u,s,l,v,p]}}),b=180/Math.PI,k=Math.PI/180,w=2*Math.PI,M=1e-6,E=Object.freeze({__proto__:null,R2D:b,D2R:k,TWO_PI:w,EPSILON:M}),O=function fn_square(e){return e*e},j=function fn_add(e,t){return e+(t||0)},C=function fn_not_undefined(e){return void 0!==e},P=function fn_vec2_angle(e){return Math.atan2(e[1],e[0])},S=function fn_to_vec2(e){return[Math.cos(e),Math.sin(e)]},N=function magnitude(e){return Math.sqrt(e.map(O).reduce(j,0))},I=function mag_squared(e){return e.map(O).reduce(j,0)},q=function normalize(e){var t=N(e);return 0===t?e:e.map((function(e){return e/t}))},L=function scale(e,t){return e.map((function(e){return e*t}))},T=function add$1(e,t){return e.map((function(e,n){return e+(t[n]||0)}))},F=function subtract(e,t){return e.map((function(e,n){return e-(t[n]||0)}))},V=function dot(e,t){return e.map((function(n,r){return e[r]*t[r]})).reduce(j,0)},B=function midpoint(e,t){return e.map((function(e,n){return(e+t[n])/2}))},G=function average(){var e=arguments;if(0===arguments.length)return[];var t=arguments[0].length>0?arguments[0].length:0,n=Array(t).fill(0);return Array.from(arguments).forEach((function(e){return n.forEach((function(t,r){n[r]+=e[r]||0}))})),n.map((function(t){return t/e.length}))},R=function lerp(e,t,n){var r=1-n;return e.map((function(e,o){return e*r+(t[o]||0)*n}))},D=function cross2(e,t){return e[0]*t[1]-e[1]*t[0]},U=function cross3(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},Z=function distance2(e,t){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)},H=function distance(e,t){return Math.sqrt(e.map((function(n,r){return Math.pow(e[r]-t[r],2)})).reduce((function(e,t){return e+t}),0))},X=function flip(e){return e.map((function(e){return-e}))},$=function rotate90(e){return[-e[1],e[0]]},W=function rotate270(e){return[e[1],-e[0]]},Y=function degenerate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return Math.abs(e.reduce(j,0))<t},K=function parallel(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return 1-Math.abs(V(q(e),q(t)))<n},J=Object.freeze({__proto__:null,magnitude:N,mag_squared:I,normalize:q,scale:L,add:T,subtract:F,dot:V,midpoint:B,average:G,lerp:R,cross2:D,cross3:U,distance2:Z,distance3:function distance3(e,t){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return Math.sqrt(n*n+r*r+o*o)},distance:H,flip:X,rotate90:$,rotate270:W,degenerate:Y,parallel:K}),Q=Object.freeze([1,0,0,0,1,0,0,0,1]),ee=Object.freeze(Q.concat(0,0,0)),te=function is_identity3x4(e){return ee.map((function(t,n){return Math.abs(t-e[n])<M})).reduce((function(e,t){return e&&t}),!0)},ne=function multiply_matrix3_vector3(e,t){return[e[0]*t[0]+e[3]*t[1]+e[6]*t[2]+e[9],e[1]*t[0]+e[4]*t[1]+e[7]*t[2]+e[10],e[2]*t[0]+e[5]*t[1]+e[8]*t[2]+e[11]]},re=function multiply_matrix3_line3(e,t,n){return{vector:[e[0]*t[0]+e[3]*t[1]+e[6]*t[2],e[1]*t[0]+e[4]*t[1]+e[7]*t[2],e[2]*t[0]+e[5]*t[1]+e[8]*t[2]],origin:[e[0]*n[0]+e[3]*n[1]+e[6]*n[2]+e[9],e[1]*n[0]+e[4]*n[1]+e[7]*n[2]+e[10],e[2]*n[0]+e[5]*n[1]+e[8]*n[2]+e[11]]}},oe=function multiply_matrices3(e,t){return[e[0]*t[0]+e[3]*t[1]+e[6]*t[2],e[1]*t[0]+e[4]*t[1]+e[7]*t[2],e[2]*t[0]+e[5]*t[1]+e[8]*t[2],e[0]*t[3]+e[3]*t[4]+e[6]*t[5],e[1]*t[3]+e[4]*t[4]+e[7]*t[5],e[2]*t[3]+e[5]*t[4]+e[8]*t[5],e[0]*t[6]+e[3]*t[7]+e[6]*t[8],e[1]*t[6]+e[4]*t[7]+e[7]*t[8],e[2]*t[6]+e[5]*t[7]+e[8]*t[8],e[0]*t[9]+e[3]*t[10]+e[6]*t[11]+e[9],e[1]*t[9]+e[4]*t[10]+e[7]*t[11]+e[10],e[2]*t[9]+e[5]*t[10]+e[8]*t[11]+e[11]]},ie=function determinant3(e){return e[0]*e[4]*e[8]-e[0]*e[7]*e[5]-e[3]*e[1]*e[8]+e[3]*e[7]*e[2]+e[6]*e[1]*e[5]-e[6]*e[4]*e[2]},ce=function invert_matrix3(e){var t=ie(e);if(!(Math.abs(t)<1e-6||isNaN(t))&&isFinite(e[9])&&isFinite(e[10])&&isFinite(e[11])){var n=[e[4]*e[8]-e[7]*e[5],-e[1]*e[8]+e[7]*e[2],e[1]*e[5]-e[4]*e[2],-e[3]*e[8]+e[6]*e[5],e[0]*e[8]-e[6]*e[2],-e[0]*e[5]+e[3]*e[2],e[3]*e[7]-e[6]*e[4],-e[0]*e[7]+e[6]*e[1],e[0]*e[4]-e[3]*e[1],-e[3]*e[7]*e[11]+e[3]*e[8]*e[10]+e[6]*e[4]*e[11]-e[6]*e[5]*e[10]-e[9]*e[4]*e[8]+e[9]*e[5]*e[7],e[0]*e[7]*e[11]-e[0]*e[8]*e[10]-e[6]*e[1]*e[11]+e[6]*e[2]*e[10]+e[9]*e[1]*e[8]-e[9]*e[2]*e[7],-e[0]*e[4]*e[11]+e[0]*e[5]*e[10]+e[3]*e[1]*e[11]-e[3]*e[2]*e[10]-e[9]*e[1]*e[5]+e[9]*e[2]*e[4]],r=1/t;return n.map((function(e){return e*r}))}},ae=function make_matrix3_translate(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Q.concat(e,t,n)},ue=function single_axis_rotate(e,t,n,r,o){var i=Q.concat([0,1,2].map((function(e){return t[e]||0}))),c=Math.cos(e),a=Math.sin(e);return i[3*n+n]=c,i[3*n+r]=(o?1:-1)*a,i[3*r+n]=(o?-1:1)*a,i[3*r+r]=c,i},se=function make_matrix3_rotateX(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return ue(e,t,1,2,!0)},fe=function make_matrix3_rotateY(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return ue(e,t,0,2,!1)},le=function make_matrix3_rotateZ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return ue(e,t,0,1,!0)},_e=function make_matrix3_rotate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0],o=r(3,q(t)),i=[0,1,2].map((function(e){return n[e]||0})),c=_slicedToArray(o,3),a=c[0],u=c[1],s=c[2],l=Math.cos(e),v=Math.sin(e),p=Math.sqrt(o[1]*o[1]+o[2]*o[2]),d=Math.abs(p)<1e-6?0:u/p,g=Math.abs(p)<1e-6?1:s/p,m=Q.concat(-i[0],-i[1],-i[2]),h=Q.concat(i[0],i[1],i[2]),b=[1,0,0,0,g,d,0,-d,g,0,0,0],k=[1,0,0,0,g,-d,0,d,g,0,0,0],w=[p,0,a,0,1,0,-a,0,p,0,0,0],M=[p,0,-a,0,1,0,a,0,p,0,0,0],E=[l,v,0,-v,l,0,0,0,1,0,0,0];return oe(h,oe(k,oe(M,oe(E,oe(w,oe(b,m))))))},ve=function make_matrix3_scale(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return[e,0,0,0,e,0,0,0,e,e*-t[0]+t[0],e*-t[1]+t[1],e*-t[2]+t[2]]},pe=function make_matrix3_reflectZ(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0],n=Math.atan2(e[1],e[0]),r=Math.cos(n),o=Math.sin(n),i=Math.cos(-n),c=Math.sin(-n),a=r*i+o*c,u=r*-c+o*i,s=o*i+-r*c,l=o*-c+-r*i,v=t[0]+a*-t[0]+-t[1]*s,p=t[1]+u*-t[0]+-t[1]*l;return[a,u,0,s,l,0,0,0,1,v,p,0]},de=Object.freeze({__proto__:null,identity3x3:Q,identity3x4:ee,is_identity3x4:te,multiply_matrix3_vector3:ne,multiply_matrix3_line3:re,multiply_matrices3:oe,determinant3:ie,invert_matrix3:ce,make_matrix3_translate:ae,make_matrix3_rotateX:se,make_matrix3_rotateY:fe,make_matrix3_rotateZ:le,make_matrix3_rotate:_e,make_matrix3_scale:ve,make_matrix3_reflectZ:pe}),ge=function vector_origin_form(e,t){return{vector:e||[],origin:t||[]}},me=function get_vector$1(){if(arguments[0]instanceof v.vector)return arguments[0];var e=s(arguments);return e.length>0&&"object"===_typeof(e[0])&&null!==e[0]&&!isNaN(e[0].x)&&(e=["x","y","z"].map((function(t){return e[0][t]})).filter(C)),e.filter((function(e){return"number"==typeof e}))},he=function get_vector_of_vectors(){return u(arguments).map((function(e){return me(e)}))},ye=function get_segment(){if(arguments[0]instanceof v.segment)return arguments[0];var e=u(arguments);return 4===e.length?[[e[0],e[1]],[e[2],e[3]]]:he(e)},be=function get_line(){var e=u(arguments);return 0===e.length?ge([],[]):e[0]instanceof v.line||e[0]instanceof v.ray||e[0]instanceof v.segment?e[0]:e[0].constructor===Object?ge(e[0].vector||[],e[0].origin||[]):"number"==typeof e[0]?ge(me(e)):ge.apply(void 0,_toConsumableArray(e.map((function(e){return me(e)}))))},xe=be,Ae=function get_rect_params(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return{x:e,y:t,width:n,height:r}},ke=function get_rect(){if(arguments[0]instanceof v.rect)return arguments[0];var e=s(arguments);if(e.length>0&&"object"===_typeof(e[0])&&null!==e[0]&&!isNaN(e[0].width))return Ae.apply(void 0,_toConsumableArray(["x","y","width","height"].map((function(t){return e[0][t]})).filter(C)));var t=e.filter((function(e){return"number"==typeof e})),n=t.length<4?[,,].concat(_toConsumableArray(t)):t;return Ae.apply(void 0,_toConsumableArray(n))},we=function get_circle_params(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return{radius:e,origin:[].concat(n)}},Me=function get_circle(){if(arguments[0]instanceof v.circle)return arguments[0];var e=he(arguments),t=s(arguments).filter((function(e){return"number"==typeof e}));if(2===arguments.length){if(1===e[1].length)return we.apply(void 0,[e[1][0]].concat(_toConsumableArray(e[0])));if(1===e[0].length)return we.apply(void 0,[e[0][0]].concat(_toConsumableArray(e[1])));if(e[0].length>1&&e[1].length>1)return we.apply(void 0,[Z.apply(void 0,_toConsumableArray(e))].concat(_toConsumableArray(e[0])))}else switch(t.length){case 0:return we(1,0,0,0);case 1:return we(t[0],0,0,0);default:return we.apply(void 0,[t.pop()].concat(_toConsumableArray(t)))}return we(1,0,0,0)},Ee=[[0,1,3,4,9,10],[0,1,2,3,4,5,6,7,8,9,10,11],[0,1,2,void 0,3,4,5,void 0,6,7,8,void 0,9,10,11]];[11,7,3].forEach((function(e){return delete Ee[2][e]}));var Oe=function matrix_map_3x4(e){return Ee[e<8?0:e<13?1:2]},je=function get_matrix_3x4(){var e=s(arguments),t=_toConsumableArray(ee);return Oe(e.length).forEach((function(n,r){null!=e[r]&&(t[n]=e[r])})),t},Ce=Object.freeze({__proto__:null,get_vector:me,get_vector_of_vectors:he,get_segment:ye,get_line:be,get_ray:xe,get_rect_params:Ae,get_rect:ke,get_circle:Me,get_matrix_3x4:je}),Pe=function fEqual(e,t){return e===t},Se=function fEpsilonEqual(e,t){return Math.abs(e-t)<M},ze=function array_similarity_test(e,t){return Array.from(Array(e.length-1)).map((function(n,r){return t(e[0],e[r+1])})).reduce((function(e,t){return e&&t}),!0)},Ne=function equivalent_vectors(){var e=Array.from(arguments),t=e.map((function(e){return e.length})).reduce((function(e,t){return e>t?e:t})),n=e.map((function(e){return r(t,e)}));return Array.from(Array(arguments.length-1)).map((function(e,t){return n[0].map((function(e,r){return Math.abs(n[0][r]-n[t+1][r])<M})).reduce((function(e,t){return e&&t}),!0)})).reduce((function(e,t){return e&&t}),!0)},Ie=Object.freeze({__proto__:null,equivalent_vec2:function equivalent_vec2(e,t){return Math.abs(e[0]-t[0])<M&&Math.abs(e[1]-t[1])<M},equivalent_numbers:function equivalent_numbers(){return 0!==arguments.length&&(1===arguments.length&&void 0!==arguments[0]?equivalent_numbers.apply(void 0,_toConsumableArray(arguments[0])):ze(arguments,Se))},equivalent_vectors:Ne,equivalent:function equivalent(){var e=u.apply(void 0,arguments);if(e.length<1)return!1;var t=_typeof(e[0]);if("undefined"===t)return!1;switch(t){case"number":return ze(e,Se);case"boolean":case"string":return ze(e,Pe);case"object":return e[0].constructor===Array?Ne.apply(void 0,_toConsumableArray(e)):ze(e,(function(e,t){return JSON.stringify(e)===JSON.stringify(t)}));default:return}}}),qe=function ray_limiter(e){return e<-M?0:e},Le=function segment_limiter(e){return e<-M?0:e>1.000001?1:e},Te=function smallest_comparison_search(e,t,n){for(var r,o=t.map((function(t,r){return{o:t,i:r,d:n(e,t)}})),i=1/0,c=0;c<o.length;c+=1)o[c].d<i&&(r=c,i=o[c].d);return r},Fe=function nearest_point_on_line(e,t,n,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;t=r(e.length,t),n=r(e.length,n);var c=I(e),a=F(n,t),u=V(e,a),s=u/c,l=o(s,i);return T(t,L(e,l))},Ve=function nearest_point_on_polygon(e,t){var n=e.map((function(e,t,n){return F(n[(t+1)%n.length],e)}));return e.map((function(e,r){return Fe(n[r],e,t,Le)})).map((function(e,n){return{point:e,i:n,distance:H(e,t)}})).sort((function(e,t){return e.distance-t.distance})).shift()},Be=function nearest_point_on_circle(e,t,n){return T(t,L(q(F(n,t)),e))},Ge=Object.freeze({__proto__:null,ray_limiter:qe,segment_limiter:Le,smallest_comparison_search:Te,nearest_point2:function nearest_point2(e,t){var n=Te(e,t,Z);return void 0===n?void 0:t[n]},nearest_point:function nearest_point(e,t){var n=Te(e,t,H);return void 0===n?void 0:t[n]},nearest_point_on_line:Fe,nearest_point_on_polygon:Ve,nearest_point_on_circle:Be,nearest_point_on_ellipse:function nearest_point_on_ellipse(){return!1}}),Re=function include_l(){return!0},De=function include_r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return e>-t},Ue=function include_s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return e>-t&&e<1+t},Ze=function exclude_l(){return!0},He=function exclude_r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return e>t},Xe=function exclude_s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M;return e>t&&e<1-t},$e=function intersect_lines(e,t,n,r,o,i){var c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:M,a=D(e,n),u=-a;if(!(Math.abs(D(q(e),q(n)))<c)){var s=D(F(r,t),n),l=D(F(t,r),e),v=s/a,p=l/u;return o(v,c/N(e))&&i(p,c/N(n))?T(t,L(e,v)):void 0}},We=Object.freeze({__proto__:null,include_l:Re,include_r:De,include_s:Ue,exclude_l:Ze,exclude_r:He,exclude_s:Xe,intersect_lines:$e}),Ye=function collinear(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M,i=F(e,n),c=I(t);if(Math.sqrt(c)<o)return!1;var a=Math.sqrt(c),u=D(i,t.map((function(e){return e/a}))),s=V(i,t)/c;return Math.abs(u)<o&&r(s,o/a)},Ke=function point_on_line(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return Math.abs(D(F(e,n),q(t)))<r},Je=Object.freeze({__proto__:null,collinear:Ye,point_on_line:Ke,point_on_ray_inclusive:function point_on_ray_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return Ye(e,t,n,De,r)},point_on_ray_exclusive:function point_on_ray_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return Ye(e,t,n,He,r)},point_on_segment_inclusive:function point_on_segment_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return Ye(e,F(n,t),t,Ue,r)},point_on_segment_exclusive:function point_on_segment_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return Ye(e,F(n,t),t,Xe,r)}}),Qe=function overlap_lines(e,t,n,r,o,i){var c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:M,a=D(e,n),u=-a;if(Math.abs(a)<c)return Ye(r,e,t,o,c)||Ye(r,X(e),T(t,e),o,c)||Ye(t,n,r,i,c)||Ye(t,X(n),T(r,n),i,c);var s=D(F(r,t),n),l=D(F(t,r),e),v=s/a,p=l/u;return o(v,c/N(e))&&i(p,c/N(n))},et=function overlap_segment_segment_inclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(F(t,e),e,F(r,n),n,Ue,Ue,o)},tt=function overlap_segment_segment_exclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(F(t,e),e,F(r,n),n,Xe,Xe,o)},nt=Object.freeze({__proto__:null,overlap_lines:Qe,overlap_line_line_inclusive:function overlap_line_line_inclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,n,r,Re,Re,o)},overlap_line_ray_inclusive:function overlap_line_ray_inclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,n,r,Re,De,o)},overlap_line_segment_inclusive:function overlap_line_segment_inclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,F(r,n),n,Re,Ue,o)},overlap_ray_ray_inclusive:function overlap_ray_ray_inclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,n,r,De,De,o)},overlap_ray_segment_inclusive:function overlap_ray_segment_inclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,F(r,n),n,De,Ue,o)},overlap_segment_segment_inclusive:et,overlap_line_line_exclusive:function overlap_line_line_exclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,n,r,Ze,Ze,o)},overlap_line_ray_exclusive:function overlap_line_ray_exclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,n,r,Ze,He,o)},overlap_line_segment_exclusive:function overlap_line_segment_exclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,F(r,n),n,Ze,Xe,o)},overlap_ray_ray_exclusive:function overlap_ray_ray_exclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,n,r,He,He,o)},overlap_ray_segment_exclusive:function overlap_ray_segment_exclusive(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return Qe(e,t,F(r,n),n,He,Xe,o)},overlap_segment_segment_exclusive:tt}),rt=function point_in_convex_poly_inclusive(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return D(q(F(t[1],t[0])),F(e,t[0]))>-n})).map((function(e,t,n){return e===n[0]})).reduce((function(e,t){return e&&t}),!0)},ot=function point_in_convex_poly_exclusive(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return D(q(F(t[1],t[0])),F(e,t[0]))>n})).map((function(e,t,n){return e===n[0]})).reduce((function(e,t){return e&&t}),!0)},it=function point_in_poly(e,t){for(var n=!1,r=0,o=t.length-1;r<t.length;o=r++)t[r][1]>e[1]!=t[o][1]>e[1]&&e[0]<(t[o][0]-t[r][0])*(e[1]-t[r][1])/(t[o][1]-t[r][1])+t[r][0]&&(n=!n);return n},ct=function overlap_convex_polygons(e,t,n,r,o){for(var i=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})),c=t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})),a=0;a<i.length;a+=1)for(var u=0;u<c.length;u+=1)if(n(i[a][0],i[a][1],c[u][0],c[u][1],o))return!0;return!!r(t[0],e,o)||!!r(e[0],t,o)},at=function overlap_convex_polygons_exclusive(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return ct(e,t,tt,ot,n)},ut=Object.freeze({__proto__:null,point_in_convex_poly_inclusive:rt,point_in_convex_poly_exclusive:ot,point_in_poly:it,overlap_convex_polygons_inclusive:function overlap_convex_polygons_inclusive(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return ct(e,t,et,rt,n)},overlap_convex_polygons_exclusive:at,enclose_convex_polygons_inclusive:function enclose_convex_polygons_inclusive(e,t){var n=e.map((function(e){return rt(e,t)})).reduce((function(e,t){return e||t}),!1),r=t.map((function(e){return rt(e,t)})).reduce((function(e,t){return e&&t}),!0);return!n&&r}}),st=function quick_equivalent_2(e,t){return Math.abs(e[0]-t[0])<M&&Math.abs(e[1]-t[1])<M},ft=function intersect_line_seg_include(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return $e(e,t,F(r,n),n,Re,Ue,o)},lt=function intersect_line_seg_exclude(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return $e(e,t,F(r,n),n,Ze,Xe,o)},_t=function intersect_ray_seg_include(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return $e(e,t,F(r,n),n,De,Ue,o)},vt=function intersect_ray_seg_exclude(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return $e(e,t,F(r,n),n,He,Xe,o)},pt=function intersect_seg_seg_include(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return $e(F(t,e),e,F(r,n),n,Ue,Ue,o)},dt=function intersect_seg_seg_exclude(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return $e(F(t,e),e,F(r,n),n,Xe,Xe,o)},gt=function counter_clockwise_angle_radians(e,t){for(;e<0;)e+=w;for(;t<0;)t+=w;for(;e>w;)e-=w;for(;t>w;)t-=w;var n=t-e;return n>=0?n:w-(e-t)},mt=function clockwise_angle2(e,t){var n=t[0]*e[0]+t[1]*e[1],r=t[0]*e[1]-t[1]*e[0],o=Math.atan2(r,n);return o<0&&(o+=w),o},ht=function counter_clockwise_angle2(e,t){var n=e[0]*t[0]+e[1]*t[1],r=e[0]*t[1]-e[1]*t[0],o=Math.atan2(r,n);return o<0&&(o+=w),o},yt=function clockwise_bisect2(e,t){return S(P(e)-mt(e,t)/2)},bt=function counter_clockwise_bisect2(e,t){return S(P(e)+ht(e,t)/2)},xt=function bisect_lines2(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M,i=D(e,n),c=V(e,n),a=i>-o?[bt(e,n)]:[yt(e,n)];a[1]=i>-o?$(a[0]):W(a[0]);var u=(r[0]-t[0])*n[1]-n[0]*(r[1]-t[1]),s=u/i,l=[e,n].map((function(e){return q(e)})),v=Math.abs(D.apply(void 0,_toConsumableArray(l)))<o,p=v?B(t,r):[t[0]+e[0]*s,t[1]+e[1]*s],d=a.map((function(e){return{vector:e,origin:p}}));return v&&delete d[c>-o?1:0],d},At=function counter_clockwise_order_radians(){var e=s(arguments),t=e.map((function(e,t){return t})).sort((function(t,n){return e[t]-e[n]}));return t.slice(t.indexOf(0),t.length).concat(t.slice(0,t.indexOf(0)))},kt=function counter_clockwise_sectors_radians(){var e=s(arguments),t=At(e).map((function(t){return e[t]}));return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return gt(e[0],e[1])}))},wt=function counter_clockwise_subsect_radians(e,t,n){var r=gt(t,n)/e;return Array.from(Array(e-1)).map((function(e,n){return t+r*(n+1)}))},Mt=Object.freeze({__proto__:null,is_counter_clockwise_between:function is_counter_clockwise_between(e,t,n){for(;n<t;)n+=w;for(;e>t;)e-=w;for(;e<t;)e+=w;return e<n},clockwise_angle_radians:function clockwise_angle_radians(e,t){for(;e<0;)e+=w;for(;t<0;)t+=w;for(;e>w;)e-=w;for(;t>w;)t-=w;var n=e-t;return n>=0?n:w-(t-e)},counter_clockwise_angle_radians:gt,clockwise_angle2:mt,counter_clockwise_angle2:ht,clockwise_bisect2:yt,counter_clockwise_bisect2:bt,bisect_lines2:xt,counter_clockwise_order_radians:At,counter_clockwise_order2:function counter_clockwise_order2(){return At(he(arguments).map(P))},counter_clockwise_sectors_radians:kt,counter_clockwise_sectors2:function counter_clockwise_sectors2(){return kt(he(arguments).map(P))},counter_clockwise_subsect_radians:wt,counter_clockwise_subsect2:function counter_clockwise_subsect2(e,t,n){var r=Math.atan2(t[1],t[0]),o=Math.atan2(n[1],n[0]);return wt(e,r,o).map(S)}}),Et=function circumcircle(e,t,n){var r=t[0]-e[0],o=t[1]-e[1],i=n[0]-e[0],c=n[1]-e[1],a=r*(e[0]+t[0])+o*(e[1]+t[1]),u=i*(e[0]+n[0])+c*(e[1]+n[1]),s=2*(r*(n[1]-t[1])-o*(n[0]-t[0]));if(Math.abs(s)<M){var l=Math.min(e[0],t[0],n[0]),v=Math.min(e[1],t[1],n[1]),p=.5*(Math.max(e[0],t[0],n[0])-l),d=.5*(Math.max(e[1],t[1],n[1])-v);return{origin:[l+p,v+d],radius:Math.sqrt(p*p+d*d)}}var g=[(c*a-o*u)/s,(r*u-i*a)/s],m=g[0]-e[0],h=g[1]-e[1];return{origin:g,radius:Math.sqrt(m*m+h*h)}},Ot=function signed_area(e){return.5*e.map((function(e,t,n){var r=n[(t+1)%n.length];return e[0]*r[1]-r[0]*e[1]})).reduce(j,0)},jt=function centroid(e){var t=1/(6*Ot(e));return e.map((function(e,t,n){var r=n[(t+1)%n.length],o=e[0]*r[1]-r[0]*e[1];return[(e[0]+r[0])*o,(e[1]+r[1])*o]})).reduce((function(e,t){return[e[0]+t[0],e[1]+t[1]]}),[0,0]).map((function(e){return e*t}))},Ct=function enclosing_rectangle(e){var t=Array(e[0].length).fill(1/0),n=Array(e[0].length).fill(-1/0);e.forEach((function(e){return e.forEach((function(e,r){e<t[r]&&(t[r]=e),e>n[r]&&(n[r]=e)}))}));var r=n.map((function(e,n){return e-t[n]}));return Ae(t[0],t[1],r[0],r[1])},Pt=function angle_array(e){return Array.from(Array(Math.floor(e))).map((function(t,n){return w*(n/e)}))},St=function angles_to_vecs(e,t){return e.map((function(e){return[t*Math.cos(e),t*Math.sin(e)]})).map((function(e){return e.map((function(e){return c(e,14)}))}))},zt=function make_regular_polygon(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return St(Pt(e),t)},Nt=function make_regular_polygon_side_aligned(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=Math.PI/e,r=Pt(e).map((function(e){return e+n}));return St(r,t)},It=function split_polygon(){return console.warn("split polygon not done")},qt=function split_convex_polygon(e,t,n){var r=e.map((function(e,r){return{point:Ke(e,t,n)?e:null,at_index:r}})).filter((function(e){return null!=e.point})),o=e.map((function(e,r,o){return{point:lt(t,n,e,o[(r+1)%o.length]),at_index:r}})).filter((function(e){return null!=e.point}));if(2==o.length){var i=o.slice().sort((function(e,t){return e.at_index-t.at_index})),c=e.slice(i[1].at_index+1).concat(e.slice(0,i[0].at_index+1));c.push(i[0].point),c.push(i[1].point);var a=e.slice(i[0].at_index+1,i[1].at_index+1);return a.push(i[1].point),a.push(i[0].point),[c,a]}if(1==o.length&&1==r.length){r[0].type="v",o[0].type="e";var u=r.concat(o).sort((function(e,t){return e.at_index-t.at_index})),s=e.slice(u[1].at_index+1).concat(e.slice(0,u[0].at_index+1));"e"===u[0].type&&s.push(u[0].point),s.push(u[1].point);var l=e.slice(u[0].at_index+1,u[1].at_index+1);return"e"===u[1].type&&l.push(u[1].point),l.push(u[0].point),[s,l]}if(2==r.length){var v=r.slice().sort((function(e,t){return e.at_index-t.at_index}));return[e.slice(v[1].at_index).concat(e.slice(0,v[0].at_index+1)),e.slice(v[0].at_index,v[1].at_index+1)]}return[e.slice()]},Lt=function convex_hull(e){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M,n=1e4,r=e.slice().sort((function(e,n){return Math.abs(e[1]-n[1])<t?e[0]-n[0]:e[1]-n[1]})),o=[];o.push(r[0]);var i=0,c=0,a=function _loop(){c+=1;var e=o.length-1,n=r.filter((function(n){return!(Math.abs(n[0]-o[e][0])<t&&Math.abs(n[1]-o[e][1])<t)})).map((function(t){for(var n=Math.atan2(o[e][1]-t[1],o[e][0]-t[0]);n<i;)n+=2*Math.PI;return{node:t,angle:n,distance:void 0}})).sort((function(e,t){return e.angle<t.angle?-1:e.angle>t.angle?1:0}));if(0===n.length)return{v:void 0};var a=n[0];if(n=n.filter((function(e){return Math.abs(a.angle-e.angle)<t})).map((function(t){var n=Math.sqrt(Math.pow(o[e][0]-t.node[0],2)+Math.pow(o[e][1]-t.node[1],2));return t.distance=n,t})).sort((function(e,t){return e.distance<t.distance?1:e.distance>t.distance?-1:0})),o.filter((function(e){return e===n[0].node})).length>0)return{v:o};o.push(n[0].node),i=Math.atan2(o[e][1]-n[0].node[1],o[e][0]-n[0].node[0])};do{var u=a();if("object"===_typeof(u))return u.v}while(c<n)},Tt=function recurseSkeleton(e,t,n){var r=e.map((function(e,t){return{vector:n[t],origin:e}})).map((function(e,t,n){return $e(e.vector,e.origin,n[(t+1)%n.length].vector,n[(t+1)%n.length].origin,He,He)})),o=t.map((function(e,t){return Fe(e.vector,e.origin,r[t],(function(e){return e}))}));if(3===e.length)return e.map((function(e){return{type:"skeleton",points:[e,r[0]]}})).concat([{type:"perpendicular",points:[o[0],r[0]]}]);var i=r.map((function(e,t){return H(e,o[t])})),c=0;i.forEach((function(e,t){e<i[c]&&(c=t)}));var a=[{type:"skeleton",points:[e[c],r[c]]},{type:"skeleton",points:[e[(c+1)%e.length],r[c]]},{type:"perpendicular",points:[o[c],r[c]]}],u=yt(X(t[(c+t.length-1)%t.length].vector),t[(c+1)%t.length].vector),s=c===e.length-1;return e.splice(c,2,r[c]),t.splice(c,1),n.splice(c,2,u),s&&(e.splice(0,1),n.splice(0,1),t.push(t.shift())),a.concat(recurseSkeleton(e,t,n))},Ft=function straight_skeleton(e){var t=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return{vector:F(e[1],e[0]),origin:e[0]}})),n=e.map((function(e,t,n){return[(t-1+n.length)%n.length,t,(t+1)%n.length].map((function(e){return n[e]}))})).map((function(e){return[F(e[0],e[1]),F(e[2],e[1])]})).map((function(e){return yt.apply(void 0,_toConsumableArray(e))}));return Tt(e,t,n)},Vt=Object.freeze({__proto__:null,circumcircle:Et,signed_area:Ot,centroid:jt,enclosing_rectangle:Ct,make_regular_polygon:zt,make_regular_polygon_side_aligned:Nt,make_regular_polygon_inradius:function make_regular_polygon_inradius(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return zt(e,t/Math.cos(Math.PI/e))},make_regular_polygon_inradius_side_aligned:function make_regular_polygon_inradius_side_aligned(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Nt(e,t/Math.cos(Math.PI/e))},make_regular_polygon_side_length:function make_regular_polygon_side_length(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return zt(e,t/2/Math.sin(Math.PI/e))},make_regular_polygon_side_length_side_aligned:function make_regular_polygon_side_length_side_aligned(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Nt(e,t/2/Math.sin(Math.PI/e))},split_polygon:It,split_convex_polygon:qt,convex_hull:Lt,straight_skeleton:Ft}),Bt=function acossafe(e){return e>=1?0:e<=-1?Math.PI:Math.acos(e)},Gt=function rotatePoint(e,t,n){var r=t[0]-e[0],o=t[1]-e[1],i=r*Math.cos(n)+o*Math.sin(n),c=o*Math.cos(n)-r*Math.sin(n);return[e[0]+i,e[1]+c]},Rt=function circle_circle(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M,r=e.radius<t.radius?e.radius:t.radius,o=e.radius<t.radius?t.radius:e.radius,i=e.radius<t.radius?e.origin:t.origin,c=e.radius<t.radius?t.origin:e.origin,a=[i[0]-c[0],i[1]-c[1]],u=Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2));if(!(u<n)){var s=a.map((function(e,t){return e/u*o+c[t]}));if(Math.abs(o+r-u)<n||Math.abs(o-(r+u))<n)return[s];if(!(u+r<o||o+r<u)){var l=Bt((r*r-u*u-o*o)/(-2*u*o)),v=Gt(c,s,+l),p=Gt(c,s,-l);return[v,p]}}},Dt=function intersect_circle_line(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:M,c=Math.pow(n[0],2)+Math.pow(n[1],2),a=Math.sqrt(c),u=0===a?n:n.map((function(e){return e/a})),s=[-u[1],u[0]],l=[r[0]-t[0],r[1]-t[1]],v=l[0]*u[1]-u[0]*l[1];if(!(Math.abs(v)>e+i)){var p=Math.sqrt(Math.pow(e,2)-Math.pow(v,2)),d=function f(e,n){return t[n]-s[n]*v+u[n]*e},g=Math.abs(e-Math.abs(v))<i?[p].map((function(e){return[e,e].map(d)})):[-p,p].map((function(e){return[e,e].map(d)})),m=g.map((function(e){return e.map((function(e,t){return e-r[t]}))})).map((function(e){return e[0]*n[0]+n[1]*e[1]})).map((function(e){return e/c}));return g.filter((function(e,t){return o(m[t],i)}))}},Ut=function line_func(){return!0},Zt=function ray_func(e,t){return e>-t},Ht=function segment_func(e,t){return e>-t&&e<1+t},Xt=function circle_line(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return Dt(e.radius,e.origin,t.vector,t.origin,Ut,n)},$t=function circle_ray(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return Dt(e.radius,e.origin,t.vector,t.origin,Zt,n)},Wt=function circle_segment(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M;return Dt(e.radius,e.origin,t.vector,t.origin,Ht,n)},Yt=Object.freeze({__proto__:null,circle_circle:Rt,intersect_circle_line:Dt,circle_line:Xt,circle_ray:$t,circle_segment:Wt}),Kt=function line_to_ud(e,t){var n=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)),r=[-e[1],e[0]],o=(t[0]*r[0]+t[1]*r[1])/n;return o<0?{u:[-r[0]/n,-r[1]/n],d:-o}:{u:[r[0]/n,r[1]/n],d:o}},Jt=function ud_to_line(e){var t=e.u,n=e.d;return{vector:[t[1],-t[0]],origin:[n*t[0],n*t[1]]}},Qt=function cubrt(e){return e<0?-Math.pow(-e,1/3):Math.pow(e,1/3)},en=Object.freeze({__proto__:null,axiom1:function axiom1(e,t){return v.line(q(F.apply(void 0,_toConsumableArray(o(t,e)))),e)},axiom2:function axiom2(e,t){return v.line(q($(F.apply(void 0,_toConsumableArray(o(t,e))))),B(e,t))},axiom3:function axiom3(e,t,n,r){return xt(e,t,n,r).map(v.line)},axiom4:function axiom4(e,t){return v.line($(q(e)),t)},axiom5:function axiom5(e,t,n,r){return(Dt(H(n,r),n,e,t,(function(){return!0}))||[]).map((function(e){return v.line(q($(F.apply(void 0,_toConsumableArray(o(e,r))))),B(r,e))}))},axiom6:function axiom6(e,t,n,r,o,i){var c=Kt(e,t),a=Kt(n,r);if(Math.abs(1-V(c.u,o)/c.d)<.02)return[];var u=[-c.u[1],c.u[0]],s=[o[0]+c.d*c.u[0]-2*i[0],o[1]+c.d*c.u[1]-2*i[1]],l=[c.d*c.u[0]-o[0],c.d*c.u[1]-o[1]],p=V(i,a.u)-a.d,d=2*V(l,u),g=V(l,l),m=V(T(s,l),u),h=V(s,l),b=V(u,a.u),k=V(l,a.u),w=b,E=p+m*b+k,O=p*d+h*b+m*k,j=p*g+h*k,C=function make_point(e){return[c.d*c.u[0]+e*u[0],c.d*c.u[1]+e*u[1]]},P=0;Math.abs(O)>M&&(P=1),Math.abs(E)>M&&(P=2),Math.abs(w)>M&&(P=3);var S=[];switch(P){case 1:S.push(C(-j/O));break;case 2:var N=Math.pow(O,2)-4*E*j;if(N<-M)break;var I=-O/(2*E);if(N<M){S.push(C(I));break}var L=Math.sqrt(N)/(2*E);S.push(C(I+L),C(I-L));break;case 3:var G=E/w,R=O/w,D=j/w,U=(3*R-Math.pow(G,2))/9,Z=(9*G*R-27*D-2*Math.pow(G,3))/54,H=Math.pow(U,3)+Math.pow(Z,2),X=-G/3;if(H>0){var $=Math.sqrt(H),W=Qt(Z+$),Y=Qt(Z-$);S.push(C(X+W+Y));break}if(Math.abs(H)<M){var K=Math.pow(Z,1/3);if(isNaN(K))break;S.push(C(X+2*K),C(X-K));break}var J=Math.sqrt(-H),Q=Math.atan2(J,Z)/3,ee=Math.pow(Math.pow(Z,2)-H,1/6),te=ee*Math.cos(Q),ne=ee*Math.sin(Q);S.push(C(X+2*te),C(X-te-Math.sqrt(3)*ne),C(X-te+Math.sqrt(3)*ne))}return S.map((function(e){return q(F(e,o))})).map((function(e,t){return{u:e,d:V(e,B(S[t],o))}})).map(Jt).map(v.line)},axiom7:function axiom7(e,t,n,r){var i=$e(e,t,n,r,Re,Re);return void 0===i?void 0:v.line(q($(F.apply(void 0,_toConsumableArray(o(i,r))))),B(r,i))}}),tn=function get_unique_pair(e){for(var t=1;t<e.length;t+=1)if(!st(e[0],e[t]))return[e[0],e[t]]},nn=function convex_poly_line_intersect(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M,i=t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return e(n,r,t[0],t[1],o)})).filter((function(e){return null!=e}));switch(i.length){case 0:return;case 1:return[i];default:return tn(i)||[i[0]]}},rn=function poly_include_exclude_func(e,t,n,r,o){var i,c=nn(e,t,n,r,o);switch(e){case lt:i=ft;break;case vt:i=_t;break;case dt:i=pt;break;case ft:case _t:case pt:default:return c}var a=nn(i,t,n,r,o);if(void 0!==a){var u=tn(a);if(void 0===u)switch(e){case lt:return;case vt:return ot(r,t,o)?a:void 0;case dt:return ot(n,t,o)||ot(r,t,o)?a:void 0}return ot(B.apply(void 0,_toConsumableArray(u)),t,o)?u:c}},on=function convex_poly_line_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return rn(lt,e,t,n,r)},cn=function convex_poly_ray_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return rn(vt,e,t,n,r)},an=function convex_poly_segment_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return rn(dt,e,t,n,r)},un=Object.freeze({__proto__:null,convex_poly_line_inclusive:function convex_poly_line_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return rn(ft,e,t,n,r)},convex_poly_line_exclusive:on,convex_poly_ray_inclusive:function convex_poly_ray_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return rn(_t,e,t,n,r)},convex_poly_ray_exclusive:cn,convex_poly_segment_inclusive:function convex_poly_segment_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return rn(pt,e,t,n,r)},convex_poly_segment_exclusive:an}),sn=function convexPolyLine(e,t){return on(e,t.vector,t.origin)},fn=function convexPolyRay(e,t){return cn(e,t.vector,t.origin)},ln=function convexPolySegment(e,t){return an(e,t[0],t[1])},_n=function lineFunc(e,t,n,r,o){return $e(e.vector,e.origin,t.vector,t.origin,n,r,o)},vn={polygon:{line:sn,ray:fn,segment:ln},circle:{circle:Rt,line:Xt,ray:$t,segment:Wt},line:{polygon:function polygon(e,t){return sn(t,e)},circle:function circle(e,t){return Xt(t,e)},line:function line(e,t,n){return _n(e,t,Ze,Ze,n)},ray:function ray(e,t,n){return _n(e,t,Ze,He,n)},segment:function segment(e,t,n){return _n(e,t,Ze,Xe,n)}},ray:{polygon:function polygon(e,t){return fn(t,e)},circle:function circle(e,t){return $t(t,e)},line:function line(e,t,n){return _n(t,e,Ze,He,n)},ray:function ray(e,t,n){return _n(e,t,He,He,n)},segment:function segment(e,t,n){return _n(e,t,He,Xe,n)}},segment:{polygon:function polygon(e,t){return ln(t,e)},circle:function circle(e,t){return Wt(t,e)},line:function line(e,t,n){return _n(t,e,Ze,Xe,n)},ray:function ray(e,t,n){return _n(t,e,He,Xe,n)},segment:function segment(e,t,n){return _n(e,t,Xe,Xe,n)}}},pn={polygon:"polygon",rect:"polygon",circle:"circle",line:"line",ray:"ray",segment:"segment"},dn=function intersect(e,t){var r,o=pn[n(e)],i=pn[n(t)];return(r=vn[o])[i].apply(r,arguments)},gn=Object.assign(Object.create(null),nt,Je,ut),mn=function get_unique_pair$1(e){for(var t=1;t<e.length;t+=1)if(!st(e[0],e[t]))return[e[0],e[t]]},hn=function get_unique_points(e){for(var t=[],n=0;n<e.length;n+=1){for(var r=!1,o=0;o<t.length;o+=1)st(e[n],t[o])&&(r=!0);r||t.push(e[n])}return t},yn=function sortPointsAlongVector(e,t){return e.map((function(e){return{point:e,d:e[0]*t[0]+e[1]*t[1]}})).sort((function(e,t){return e.d-t.d})).map((function(e){return e.point}))},bn=function collinear_check(e,t,n){var r=e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){return F.apply(void 0,_toConsumableArray(e))}));return r.map((function(e,n){return K(e,t)?n:void 0})).filter(C).map((function(t){return Ke(n,r[t],e[t])})).reduce((function(e,t){return e||t}),!1)},xn=function clip_intersections(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:M;return t.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(t){return e(n,r,t[0],t[1],o)})).filter(C)},An=function clip_line_in_convex_poly_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,o=(xn(lt,e,t,n,r),xn(ft,e,t,n,r));if(void 0!==o){var i=mn(o);if(void 0!==i)return ot(B.apply(void 0,_toConsumableArray(i)),e,r)?i:void 0}},kn=function clip_ray_in_convex_poly_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,o=(xn(vt,e,t,n,r),xn(_t,e,t,n,r));if(void 0!==o){var i=mn(o);return void 0===i?ot(n,e,r)?[n,o[0]]:void 0:ot(B.apply(void 0,_toConsumableArray(i)),e,r)?i:void 0}},wn=function clip_segment_func(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,o=[t,n],i=o.map((function(t){return rt(t,e,r)}));if(!0===i[0]&&!0===i[1])return[_toConsumableArray(t),_toConsumableArray(n)];var c=xn(pt,e,t,n,r),a=hn(c);if(2===a.length)return a;if(a.length>2){var u=yn(a,F(n,t));return[u[0],u[u.length-1]]}if(c.length>0){var s=o.map((function(t){return ot(t,e,r)}));if(!0===s[0])return[_toConsumableArray(t),c[0]];if(!0===s[1])return[_toConsumableArray(n),c[0]]}},Mn=function clip_segment_in_convex_poly_exclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,o=F(n,t);if(!bn(e,o,t))return wn(e,t,n,r)},En=Object.freeze({__proto__:null,clip_line_in_convex_poly_inclusive:function clip_line_in_convex_poly_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,o=xn(ft,e,t,n,r);switch(o.length){case 0:case 1:return;default:return mn(o)}},clip_line_in_convex_poly_exclusive:An,clip_ray_in_convex_poly_inclusive:function clip_ray_in_convex_poly_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M,o=xn(_t,e,t,n,r);if(0!==o.length){rt(n,e);return mn(o)||[n,o[0]]}},clip_ray_in_convex_poly_exclusive:kn,clip_segment_in_convex_poly_inclusive:function clip_segment_in_convex_poly_inclusive(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:M;return wn(e,t,n,r)},clip_segment_in_convex_poly_exclusive:Mn}),On={preserve:{magnitude:function magnitude(){return N(this)},isEquivalent:function isEquivalent(){return Ne(this,me(arguments))},isParallel:function isParallel(){return K.apply(void 0,_toConsumableArray(o(this,me(arguments))))},dot:function dot(){return V.apply(void 0,_toConsumableArray(o(this,me(arguments))))},distanceTo:function distanceTo(){return H.apply(void 0,_toConsumableArray(o(this,me(arguments))))}},vector:{copy:function copy(){return _toConsumableArray(this)},normalize:function normalize(){return q(this)},scale:function scale(){return L(this,arguments[0])},flip:function flip(){return X(this)},rotate90:function rotate90(){return $(this)},rotate270:function rotate270(){return W(this)},cross:function cross(){return U(r(3,this),r(3,me(arguments)))},transform:function transform(){return ne(je(arguments),r(3,this))},add:function add(){return T(this,r(this.length,me(arguments)))},subtract:function subtract(){return F(this,r(this.length,me(arguments)))},rotateZ:function rotateZ(e,t){return ne(je(m(e,t)),r(3,this))},lerp:function lerp(e,t){return R(this,r(this.length,me(e)),t)},midpoint:function midpoint(){return B.apply(void 0,_toConsumableArray(o(this,me(arguments))))},bisect:function bisect(){return bt(this,me(arguments))}}},jn={};Object.keys(On.preserve).forEach((function(e){jn[e]=On.preserve[e]})),Object.keys(On.vector).forEach((function(e){jn[e]=function(){return v.vector.apply(v,_toConsumableArray(On.vector[e].apply(this,arguments)))}}));var Cn={fromAngle:function fromAngle(e){return v.vector(Math.cos(e),Math.sin(e))},fromAngleDegrees:function fromAngleDegrees(e){return v.vector.fromAngle(e*k)}},Pn={vector:{P:Array.prototype,A:function VectorArgs(){var e=this;me(arguments).forEach((function(t){return e.push(t)}))},G:{x:function x(){return this[0]},y:function y(){return this[1]},z:function z(){return this[2]}},M:jn,S:Cn}},Sn={};Sn.prototype=Object.create(Object.prototype),Sn.prototype.constructor=Sn,Sn.prototype.isParallel=function(){var e=o(this.vector,be.apply(void 0,arguments).vector);return K.apply(void 0,_toConsumableArray(e))},Sn.prototype.isCollinear=function(){var e=be(arguments);return Ke(e.origin,this.vector,this.origin)&&K.apply(void 0,_toConsumableArray(o(this.vector,e.vector)))},Sn.prototype.isDegenerate=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M;return Y(this.vector,e)},Sn.prototype.reflectionMatrix=function(){return v.matrix(pe(this.vector,this.origin))},Sn.prototype.nearestPoint=function(){var e=me(arguments);return v.vector(Fe(this.vector,this.origin,e,this.clip_function))},Sn.prototype.transform=function(){var e=this.dimension,t=re(je(arguments),r(3,this.vector),r(3,this.origin));return this.constructor(r(e,t.vector),r(e,t.origin))},Sn.prototype.translate=function(){var e=T.apply(void 0,_toConsumableArray(o(this.origin,me(arguments))));return this.constructor(this.vector,e)},Sn.prototype.intersect=function(e){return dn(this,e)},Sn.prototype.bisect=function(){var e=be(arguments);return xt(this.vector,this.origin,e.vector,e.origin)},Object.defineProperty(Sn.prototype,"dimension",{get:function get(){return[this.vector,this.origin].map((function(e){return e.length})).reduce((function(e,t){return Math.max(e,t)}),0)}});var zn={fromPoints:function fromPoints(){var e=he(arguments);return this.constructor({vector:F(e[1],e[0]),origin:e[0]})},fromAngle:function fromAngle(){var e=arguments[0]||0;return this.constructor({vector:[Math.cos(e),Math.sin(e)],origin:[0,0]})},perpendicularBisector:function perpendicularBisector(){var e=he(arguments);return this.constructor({vector:$(F(e[1],e[0])),origin:G(e[0],e[1])})}},Nn={line:{P:Sn.prototype,A:function A(){var e=be.apply(void 0,arguments);this.vector=v.vector(e.vector),this.origin=v.vector(r(this.vector.length,e.origin))},G:{length:function length(){return 1/0}},M:{clip_function:function clip_function(e){return e},svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2e4,t=this.origin.add(this.vector.scale(-e/2)),n=this.vector.scale(e);return"M".concat(t[0]," ").concat(t[1],"l").concat(n[0]," ").concat(n[1])}},S:zn}},In={ray:{P:Sn.prototype,A:function A(){var e=be.apply(void 0,arguments);this.vector=v.vector(e.vector),this.origin=v.vector(r(this.vector.length,e.origin))},G:{length:function length(){return 1/0}},M:{flip:function flip(){return v.ray(X(this.vector),this.origin)},scale:function scale(e){return v.ray(this.vector.scale(e),this.origin)},normalize:function normalize(){return v.ray(this.vector.normalize(),this.origin)},clip_function:qe,svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4,t=this.vector.scale(e);return"M".concat(this.origin[0]," ").concat(this.origin[1],"l").concat(t[0]," ").concat(t[1])}},S:zn}},qn={segment:{P:Sn.prototype,A:function A(){var e=ye.apply(void 0,arguments);this.points=[v.vector(e[0]),v.vector(e[1])],this.vector=this.points[1].subtract(this.points[0]),this.origin=this.points[0]},G:{0:function _(){return this.points[0]},1:function _(){return this.points[1]},length:function length(){return this.vector.magnitude()}},M:{clip_function:Le,transform:function transform(){for(var e=this.points[0].length,t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];var i=je(n),c=this.points.map((function(e){return r(3,e)})).map((function(e){return ne(i,e)})).map((function(t){return r(e,t)}));return v.segment(c)},translate:function translate(){var translate=get_vector(arguments),e=this.points.map((function(e){return add.apply(void 0,_toConsumableArray(resize_up(e,translate)))}));return v.segment(e)},midpoint:function midpoint(){return v.vector(G(this.points[0],this.points[1]))},svgPath:function svgPath(){var e=this.points.map((function(e){return"".concat(e[0]," ").concat(e[1])}));return["M","L"].map((function(t,n){return"".concat(t).concat(e[n])})).join("")}},S:{fromPoints:function fromPoints(){return this.constructor.apply(this,arguments)}}}},Ln=function pointOnEllipse(e,t,n,r,o,i){var c=Math.cos(o),a=Math.sin(o),u=Math.cos(i),s=Math.sin(i);return[e+c*n*u+-a*r*s,t+a*n*u+c*r*s]},Tn=function pathInfo(e,t,n,r,o,i,c){var a=i;if(a<0&&!isNaN(a))for(;a<0;)a+=2*Math.PI;var u=c>2*Math.PI?2*Math.PI:c,s=Ln(e,t,n,r,o,a),l=Ln(e,t,n,r,o,a+u/2),v=Ln(e,t,n,r,o,a+u),p=u/2>Math.PI?1:0,d=u/2>0?1:0;return{x1:s[0],y1:s[1],x2:l[0],y2:l[1],x3:v[0],y3:v[1],fa:p,fs:d}},Fn=function cln(e){return c(e,4)},Vn=function ellipticalArcTo(e,t,n,r,o,i,c){return"A".concat(Fn(e)," ").concat(Fn(t)," ").concat(Fn(n)," ").concat(Fn(r)," ").concat(Fn(o)," ").concat(Fn(i)," ").concat(Fn(c))},Bn={circle:{A:function CircleArgs(){var e=Me.apply(void 0,arguments);this.radius=e.radius,this.origin=v.vector.apply(v,_toConsumableArray(e.origin))},G:{x:function x(){return this.origin[0]},y:function y(){return this.origin[1]},z:function z(){return this.origin[2]}},M:{nearestPoint:function nearestPoint(){return v.vector(Be(this.radius,this.origin,me(arguments)))},intersect:function intersect(e){return dn(this,e)},svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,n=Tn(this.origin[0],this.origin[1],this.radius,this.radius,0,e,t),r=Vn(this.radius,this.radius,0,n.fa,n.fs,n.x2,n.y2),o=Vn(this.radius,this.radius,0,n.fa,n.fs,n.x3,n.y3);return"M".concat(n.x1," ").concat(n.y1).concat(r).concat(o)},points:function points(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(t)).map((function(e,n){return 2*Math.PI/t*n})).map((function(t){return[e.origin[0]+e.radius*Math.cos(t),e.origin[1]+e.radius*Math.sin(t)]}))},polygon:function polygon(){return v.polygon(this.points(arguments[0]))},segments:function segments(){var e=this.points(arguments[0]);return e.map((function(t,n){var r=(n+1)%e.length;return[t,e[r]]}))}},S:{fromPoints:function fromPoints(){if(3===arguments.length){var e=Et.apply(void 0,arguments);return this.constructor(e.radius,e.origin)}return this.constructor.apply(this,arguments)},fromThreePoints:function fromThreePoints(){var e=Et.apply(void 0,arguments);return this.constructor(e.radius,e.origin)}}}},Gn=function getFoci(e,t,n,r){var o=t>n,i=o?Math.pow(t,2)-Math.pow(n,2):Math.pow(n,2)-Math.pow(t,2),c=Math.sqrt(i),a=o?Math.cos(r):Math.sin(r),u=o?Math.sin(r):Math.cos(r);return[v.vector(e[0]+c*a,e[1]+c*u),v.vector(e[0]-c*a,e[1]-c*u)]},Rn={ellipse:{A:function A(){var e=s(arguments).filter((function(e){return!isNaN(e)})),t=r(5,e);this.rx=t[0],this.ry=t[1],this.origin=v.vector(t[2],t[3]),this.spin=t[4],this.foci=Gn(this.origin,this.rx,this.ry,this.spin)},G:{x:function x(){return this.origin[0]},y:function y(){return this.origin[1]}},M:{svgPath:function svgPath(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2*Math.PI,n=Tn(this.origin[0],this.origin[1],this.rx,this.ry,this.spin,e,t),r=Vn(this.rx,this.ry,this.spin/Math.PI*180,n.fa,n.fs,n.x2,n.y2),o=Vn(this.rx,this.ry,this.spin/Math.PI*180,n.fa,n.fs,n.x3,n.y3);return"M".concat(n.x1," ").concat(n.y1).concat(r).concat(o)},points:function points(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;return Array.from(Array(t)).map((function(e,n){return 2*Math.PI/t*n})).map((function(t){return Ln(e.origin.x,e.origin.y,e.rx,e.ry,e.spin,t)}))},polygon:function polygon(){return v.polygon(this.points(arguments[0]))},segments:function segments(){var e=this.points(arguments[0]);return e.map((function(t,n){var r=(n+1)%e.length;return[t,e[r]]}))}},S:{}}},Dn=function makeClip(e){return void 0===e?void 0:v.segment(e)},Un={area:function area(){return Ot(this)},centroid:function centroid(){return v.vector(jt(this))},enclosingRectangle:function enclosingRectangle(){return v.rect(Ct(this))},contains:function contains(){return it(me(arguments),this)},scale:function scale(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jt(this),n=this.map((function(e){return[0,1].map((function(n,r){return e[r]-t[r]}))})).map((function(n){return n.map((function(r,o){return t[o]+n[o]*e}))}));return this.constructor.fromPoints(n)},rotate:function rotate(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:jt(this),n=this.map((function(n){var r=[n[0]-t[0],n[1]-t[1]],o=Math.sqrt(Math.pow(r[0],2)+Math.pow(r[1],2)),i=Math.atan2(r[1],r[0]);return[t[0]+Math.cos(i+e)*o,t[1]+Math.sin(i+e)*o]}));return v.polygon(n)},translate:function translate(){var e=me.apply(void 0,arguments),t=this.map((function(t){return t.map((function(t,n){return t+e[n]}))}));return this.constructor.fromPoints(t)},transform:function transform(){var e=je.apply(void 0,arguments),t=this.map((function(t){return ne(e,r(3,t))}));return v.polygon(t)},nearest:function nearest(){var e=me.apply(void 0,arguments),t=Ve(this,e);return void 0===t?void 0:Object.assign(t,{edge:this.sides[t.i]})},overlaps:function overlaps(){var e=u(arguments);return at(this,e)},split:function split(){var e=be.apply(void 0,arguments),t=this.isConvex?qt:It;return t(this,e.vector,e.origin).map((function(e){return v.polygon(e)}))},intersectLine:function intersectLine(){var e=be.apply(void 0,arguments);return on(this,e.vector,e.origin)},intersectRay:function intersectRay(){var e=be.apply(void 0,arguments);return cn(this,e.vector,e.origin)},intersectSegment:function intersectSegment(){var e=ye.apply(void 0,arguments);return an(this,e[0],e[1])},clipLine:function clipLine(){var e=be.apply(void 0,arguments),t=An(this,e.vector,e.origin);return Dn(t)},clipRay:function clipRay(){var e=be.apply(void 0,arguments),t=kn(this,e.vector,e.origin);return Dn(t)},clipSegment:function clipSegment(){var e=ye.apply(void 0,arguments),t=Mn(this,e[0],e[1]);return Dn(t)},clip:function clip(e){switch(n(e)){case"segment":return this.clipSegment(e);case"ray":return this.clipRay(e);case"line":return this.clipLine(e);default:return}},svgPath:function svgPath(){var e=Array(this.length).fill("L");return e[0]="M","".concat(this.map((function(t,n){return"".concat(e[n]).concat(t[0]," ").concat(t[1])})).join(""),"z")},intersect:function intersect(e){return dn(this,e)}},Zn={};Zn.prototype=Object.create(Array.prototype),Zn.prototype.constructor=Zn,Object.keys(Un).forEach((function(e){Zn.prototype[e]=Un[e]}));var Hn=function rectToPoints(e){return[[e.x,e.y],[e.x+e.width,e.y],[e.x+e.width,e.y+e.height],[e.x,e.y+e.height]]},Xn={rect:{P:Zn.prototype,A:function A(){var e=ke.apply(void 0,arguments);this.width=e.width,this.height=e.height,this.origin=v.vector(e.x,e.y),this.push.apply(this,_toConsumableArray(Hn(this)))},G:{x:function x(){return this.origin[0]},y:function y(){return this.origin[1]},center:function center(){return v.vector(this.origin[0]+this.width/2,this.origin[1]+this.height/2)}},M:{area:function area(){return this.width*this.height},segments:function segments(){return function rectToSides(e){return[[[e.x,e.y],[e.x+e.width,e.y]],[[e.x+e.width,e.y],[e.x+e.width,e.y+e.height]],[[e.x+e.width,e.y+e.height],[e.x,e.y+e.height]],[[e.x,e.y+e.height],[e.x,e.y]]]}(this)},svgPath:function svgPath(){return"M".concat(this.origin.join(" "),"h").concat(this.width,"v").concat(this.height,"h").concat(-this.width,"Z")}},S:{fromPoints:function fromPoints(){return v.rect(Ct(he(arguments)))}}}},$n={polygon:{P:Zn.prototype,A:function A(){this.push.apply(this,_toConsumableArray(u(arguments))),this.sides=this.map((function(e,t,n){return[e,n[(t+1)%n.length]]})),this.vectors=this.sides.map((function(e){return F(e[1],e[0])}))},G:{isConvex:function isConvex(){return!0},points:function points(){return this}},M:{segments:function segments(){return this.sides},straightSkeleton:function straightSkeleton(){return Ft(this)}},S:{fromPoints:function fromPoints(){return this.constructor.apply(this,arguments)},regularPolygon:function regularPolygon(){return this.constructor(zt.apply(void 0,arguments))},convexHull:function convexHull(){return this.constructor(Lt.apply(void 0,arguments))}}}},Wn=function assign(e,t){for(var n=0;n<12;n+=1)e[n]=t[n];return e},Yn={matrix:{P:Array.prototype,A:function A(){var e=this;je(arguments).forEach((function(t){return e.push(t)}))},G:{},M:{copy:function copy(){return v.matrix.apply(v,_toConsumableArray(Array.from(this)))},set:function set(){return Wn(this,je(arguments))},isIdentity:function isIdentity(){return te(this)},multiply:function multiply(e){return Wn(this,oe(this,e))},determinant:function determinant(){return ie(this)},inverse:function inverse(){return Wn(this,ce(this))},translate:function translate(e,t,n){return Wn(this,oe(this,ae(e,t,n)))},rotateX:function rotateX(e){return Wn(this,oe(this,se(e)))},rotateY:function rotateY(e){return Wn(this,oe(this,fe(e)))},rotateZ:function rotateZ(e){return Wn(this,oe(this,le(e)))},rotate:function rotate(e,t,n){var r=_e(e,t,n);return Wn(this,oe(this,r))},scale:function scale(e){return Wn(this,oe(this,ve(e)))},reflectZ:function reflectZ(e,t){var n=pe(e,t);return Wn(this,oe(this,n))},transform:function transform(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return v.vector(ne(this,r(3,me(t))))},transformVector:function transformVector(e){return v.vector(ne(this,r(3,me(e))))},transformLine:function transformLine(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=be(t);return v.line(re(this,r.vector,r.origin))}},S:{}}},Kn=Object.assign({},Pn,Nn,In,qn,Bn,Rn,Xn,$n,Yn),Jn=function create(e,t){var n=Object.create(Kn[e].proto);return Kn[e].A.apply(n,t),n};Object.assign(v,{vector:function vector(){return Jn("vector",arguments)},circle:function circle(){return Jn("circle",arguments)},ellipse:function ellipse(){return Jn("ellipse",arguments)},rect:function rect(){return Jn("rect",arguments)},polygon:function polygon(){return Jn("polygon",arguments)},line:function line(){return Jn("line",arguments)},ray:function ray(){return Jn("ray",arguments)},segment:function segment(){return Jn("segment",arguments)},matrix:function matrix(){return Jn("matrix",arguments)},junction:function junction(){return Jn("junction",arguments)}}),Object.keys(Kn).forEach((function(e){var t={};t.prototype=null!=Kn[e].P?Object.create(Kn[e].P):Object.create(Object.prototype),t.prototype.constructor=t,v[e].prototype=t.prototype,v[e].prototype.constructor=v[e],Object.keys(Kn[e].G).forEach((function(n){return Object.defineProperty(t.prototype,n,{get:Kn[e].G[n]})})),Object.keys(Kn[e].M).forEach((function(n){return Object.defineProperty(t.prototype,n,{value:Kn[e].M[n]})})),Object.keys(Kn[e].S).forEach((function(t){return Object.defineProperty(v[e],t,{value:Kn[e].S[t].bind(v[e].prototype)})})),Kn[e].proto=t.prototype}));var Qn=v;Qn.core=Object.assign(Object.create(null),E,J,Ie,Vt,Mt,h,de,Ge,en,gn,Ce,l,Yt,We,un,En,{intersect_line_seg_include:ft,intersect_line_seg_exclude:lt,intersect_ray_seg_include:_t,intersect_ray_seg_exclude:vt,intersect_seg_seg_include:pt,intersect_seg_seg_exclude:dt}),Qn.typeof=n,Qn.intersect=dn;var er=Object.create(null),tr=1.1,nr="Rabbit Ear",rr={file:["file_spec","file_creator","file_author","file_title","file_description","file_classes","file_frames"],frame:["frame_author","frame_title","frame_description","frame_attributes","frame_classes","frame_unit","frame_parent","frame_inherit"],graph:["vertices_coords","vertices_vertices","vertices_faces","edges_vertices","edges_faces","edges_assignment","edges_foldAngle","edges_length","faces_vertices","faces_edges","vertices_edges","edges_edges","faces_faces"],orders:["edgeOrders","faceOrders"]},or=Object.freeze([].concat(rr.file).concat(rr.frame).concat(rr.graph).concat(rr.orders)),ir="vertices",cr="edges",ar="faces",ur="vertices_coords",sr="edges_assignment",fr="edges_foldAngle",lr={vertices:"vertex",edges:"edge",faces:"face"},_r={M:-180,m:-180,V:180,v:180,B:0,b:0,F:0,f:0,U:0,u:0},vr=function edge_assignment_to_foldAngle(e){return _r[e]||0},pr=function edge_foldAngle_to_assignment(e){return e>0?"V":e<0?"M":"U"},dr=function filter_keys_with_suffix(e,t){return Object.keys(e).map((function(e){return e.substring(e.length-t.length,e.length)===t?e:void 0})).filter((function(e){return void 0!==e}))},gr=function filter_keys_with_prefix(e,t){return Object.keys(e).map((function(e){return e.substring(0,t.length)===t?e:void 0})).filter((function(e){return void 0!==e}))},mr=function get_graph_keys_with_prefix(e,t){return gr(e,"".concat(t,"_"))},hr=function get_graph_keys_with_suffix(e,t){return dr(e,"_".concat(t))},yr=function transpose_graph_arrays(e,t){var n=mr(e,t);if(0===n.length)return[];var r=Math.max.apply(Math,_toConsumableArray(n.map((function(t){return e[t].length})))),o=Array.from(Array(r)).map((function(){return{}}));return n.forEach((function(t){return o.forEach((function(n,r){o[r][t]=e[t][r]}))})),o},br=function transpose_graph_array_at_index(e,t,n){var r=mr(e,t);if(0!==r.length){var o={};return r.forEach((function(t){o[t]=e[t][n]})),o}},xr=function fold_object_certainty(e){return"object"!==_typeof(e)||null===e?0:or.filter((function(t){return e[t]})).length},Ar=Object.freeze({__proto__:null,edges_assignment_degrees:_r,edges_assignment_names:{M:"mountain",m:"mountain",V:"valley",v:"valley",B:"boundary",b:"boundary",F:"mark",f:"mark",U:"unassigned",u:"unassigned"},edge_assignment_to_foldAngle:vr,edge_foldAngle_to_assignment:pr,filter_keys_with_suffix:dr,filter_keys_with_prefix:gr,get_graph_keys_with_prefix:mr,get_graph_keys_with_suffix:hr,transpose_graph_arrays:yr,transpose_graph_array_at_index:br,fold_object_certainty:xr}),kr=function implied_count(e,t,n){return Math.max(function max_num_in_array_in_arrays(e){var t=-1;return e.filter((function(e){return void 0!==e})).forEach((function(e){return e.forEach((function(e){return e.forEach((function(e){e>t&&(t=e)}))}))})),t}(hr(e,t).map((function(t){return e[t]}))),e[n]?function max_num_in_orders(e){var t=-1;return e.forEach((function(e){e[0]>t&&(t=e[0]),e[1]>t&&(t=e[1])})),t}(e[n]):-1)+1};kr.vertices=function(e){return kr(e,"vertices")},kr.edges=function(e){return kr(e,"edges","edgeOrders")},kr.faces=function(e){return kr(e,"faces","faceOrders")};var wr=function planar_vertex_walk(e){var t=e.vertices_vertices,n={vertices_vertices:t,vertices_sectors:e.vertices_sectors},r={};return t.map((function(e,t){return e.map((function(e){return function counter_clockwise_walk(e,t,n){for(var r=e.vertices_vertices,o=e.vertices_sectors,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c={},a={vertices:[t],edges:[],angles:[]},u=t,s=n;;){var l=r[s],v=(l.indexOf(u)+l.length-1)%l.length,p=l[v],d="".concat(s," ").concat(p);if(c[d])return Object.assign(i,c),a.vertices.pop(),a;if(c[d]=!0,i[d])return;a.vertices.push(s),a.edges.push(d),a.angles.push(o[s][v]),u=s,s=p}}(n,t,e,r)})).filter((function(e){return void 0!==e}))})).reduce((function(e,t){return e.concat(t)}),[])},Mr=Object.freeze({__proto__:null,planar_vertex_walk:wr}),Er=function sort_vertices_counter_clockwise(e,t,n){var r=e.vertices_coords;return t.map((function(e){return r[e]})).map((function(e){return Qn.core.subtract(e,r[n])})).map((function(e){return Math.atan2(e[1],e[0])})).map((function(e){return e>-Qn.core.EPSILON?e:e+2*Math.PI})).map((function(e,t){return{a:e,i:t}})).sort((function(e,t){return e.a-t.a})).map((function(e){return e.i})).map((function(e){return t[e]}))},Or=function sort_vertices_along_vector(e,t,n){var r=e.vertices_coords;return t.map((function(e){return{i:e,d:Qn.core.dot(r[e],n)}})).sort((function(e,t){return e.d-t.d})).map((function(e){return e.i}))},jr=Object.freeze({__proto__:null,sort_vertices_counter_clockwise:Er,sort_vertices_along_vector:Or}),Cr=function make_vertices_edges(e){var t=e.edges_vertices,n=[];return t.forEach((function(e,t){return e.forEach((function(e){void 0===n[e]&&(n[e]=[]),n[e].push(t)}))})),n},Pr=function make_vertices_edges_sorted(e){var t=e.edges_vertices,n=e.vertices_vertices,r=Ir({edges_vertices:t});return n.map((function(e,t){return e.map((function(e){return r["".concat(t," ").concat(e)]}))}))},Sr=function make_vertices_vertices(e){var t=e.vertices_coords,n=e.vertices_edges,r=e.edges_vertices;n||(n=Cr({edges_vertices:r}));var o=n.map((function(e,t){return e.map((function(e){return r[e].filter((function(e){return e!==t}))})).reduce((function(e,t){return e.concat(t)}),[])}));return void 0===t?o:o.map((function(e,n){return Er({vertices_coords:t},e,n)}))},zr=function make_vertices_faces(e){var t=e.faces_vertices,n=Array.from(Array(kr.vertices({faces_vertices:t}))).map((function(){return[]}));return t.forEach((function(e,t){var r=[];e.forEach((function(e){r[e]=t})),r.forEach((function(e,t){return n[t].push(e)}))})),n},Nr=function make_vertices_faces_sorted(e){var t=e.vertices_vertices,n=e.faces_vertices,r=Lr({faces_vertices:n});return t.map((function(e,t){return e.map((function(e,n,r){return[r[(n+1)%r.length],t,e].join(" ")}))})).map((function(e){return e.map((function(e){return r[e]})).filter((function(e){return void 0!==e}))}))},Ir=function make_vertices_to_edge_bidirectional(e){var t=e.edges_vertices,n={};return t.map((function(e){return e.join(" ")})).forEach((function(e,t){n[e]=t})),t.map((function(e){return"".concat(e[1]," ").concat(e[0])})).forEach((function(e,t){n[e]=t})),n},qr=function make_vertices_to_edge(e){var t=e.edges_vertices,n={};return t.map((function(e){return e.join(" ")})).forEach((function(e,t){n[e]=t})),n},Lr=function make_vertices_to_face(e){var t=e.faces_vertices,n={};return t.forEach((function(e,t){return e.map((function(t,n){return[0,1,2].map((function(t){return(n+t)%e.length})).map((function(t){return e[t]})).join(" ")})).forEach((function(e){n[e]=t}))})),n},Tr=function make_vertices_vertices_vector(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.edges_vertices,o=e.edges_vector;o||(o=Dr({vertices_coords:t,edges_vertices:r}));var i=qr({edges_vertices:r});return n.map((function(e,t){return n[t].map((function(e){var n=i["".concat(t," ").concat(e)],r=i["".concat(e," ").concat(t)];return void 0!==n?o[n]:void 0!==r?Qn.core.flip(o[r]):void 0}))}))},Fr=function make_vertices_sectors(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.edges_vertices,o=e.edges_vector;return Tr({vertices_coords:t,vertices_vertices:n,edges_vertices:r,edges_vector:o}).map((function(e){return 1===e.length?[Qn.core.TWO_PI]:Qn.core.counter_clockwise_sectors2(e)}))},Vr=function make_vertices_coords_folded(e,t){var n=e.vertices_coords,r=e.vertices_faces,o=e.edges_vertices,i=e.edges_foldAngle,c=e.edges_assignment,a=e.faces_vertices,u=e.faces_faces,s=e.faces_matrix;s&&void 0===t||(s=Yr({vertices_coords:n,edges_vertices:o,edges_foldAngle:i,edges_assignment:c,faces_vertices:a,faces_faces:u},t)),r||(r=zr({faces_vertices:a}));var l=r.map((function(e){return e[0]})).map((function(e){return void 0===e?Qn.core.identity3x4:s[e]}));return n.map((function(e){return Qn.core.resize(3,e)})).map((function(e,t){return Qn.core.multiply_matrix3_vector3(l[t],e)}))},Br=function make_edges_faces(e){var t=e.faces_edges,n=Array.from(Array(kr.edges({faces_edges:t}))).map((function(){return[]}));return t.forEach((function(e,t){var r=[];e.forEach((function(e){r[e]=t})),r.forEach((function(e,t){return n[t].push(e)}))})),n},Gr={M:-180,m:-180,V:180,v:180},Rr=function make_edges_foldAngle(e){return e.edges_assignment.map((function(e){return Gr[e]||0}))},Dr=function make_edges_vector(e){var t=e.vertices_coords;return e.edges_vertices.map((function(e){return e.map((function(e){return t[e]}))})).map((function(e){return Qn.core.subtract(e[1],e[0])}))},Ur=function make_edges_coords_min_max(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords;return r||(r=n.map((function(e){return e.map((function(e){return t[e]}))}))),r.map((function(e){var t=e[0].map((function(){return 1/0})),n=e[0].map((function(){return-1/0}));return e.forEach((function(e){return e.forEach((function(e,r){e<t[r]&&(t[r]=e),e>n[r]&&(n[r]=e)}))})),[t,n]}))},Zr=function make_edges_coords_min_max_inclusive(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON,n=[-t,+t];return Ur(e).map((function(e){return e.map((function(e,t){return e.map((function(e){return e+n[t]}))}))}))},Hr=function make_planar_faces(e){var t=e.vertices_coords,n=e.vertices_vertices,r=e.vertices_edges,o=e.vertices_sectors,i=e.edges_vertices,c=e.edges_vector;n||(n=Sr({vertices_coords:t,edges_vertices:i,vertices_edges:r})),o||(o=Fr({vertices_coords:t,vertices_vertices:n,edges_vertices:i,edges_vector:c}));var a=Ir({edges_vertices:i});return wr({vertices_vertices:n,vertices_sectors:o}).map((function(e){return _objectSpread2(_objectSpread2({},e),{},{edges:e.edges.map((function(e){return a[e]}))})})).filter((function(e){return e.angles.map((function(e){return Math.PI-e})).reduce((function(e,t){return e+t}),0)>0}))},Xr=function make_faces_faces(e){var t=e.faces_vertices,n=t.map((function(){return[]})),r={};return t.forEach((function(e,t){var o=e.length;e.forEach((function(e,i,c){var a=c[(i+1)%o];if(a<e){var u=[a,e];e=u[0],a=u[1]}var s="".concat(e," ").concat(a);if(s in r){var l=r[s];n[t].push(l),n[l].push(t)}else r[s]=t}))})),n},$r=function get_face_face_shared_vertices(e,t){var n={};t.forEach((function(e){n[e]=!0}));for(var r=e.map((function(e){return!!n[e]})),o=[],i=r.indexOf(!1),c=i+1;c<r.length;c+=1)r[c]&&o.push(e[c]);for(var a=0;a<i;a+=1)r[a]&&o.push(e[a]);return o},Wr=function make_face_spanning_tree(e){var t=e.faces_vertices,n=e.faces_faces,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(n||(n=Xr({faces_vertices:t})),0===n.length)return[];var o=[[{face:r}]],i={};i[r]=!0;var c=function _loop(){var e=o[o.length-1].map((function(e){return n[e.face].map((function(t){return{face:t,parent:e.face}}))})).reduce((function(e,t){return e.concat(t)}),[]),r={};e.forEach((function(e,t){i[e.face]&&(r[t]=!0),i[e.face]=!0}));var c=e.filter((function(e,t){return!r[t]}));c.map((function(e){return $r(t[e.face],t[e.parent])})).forEach((function(e,t){c[t].edge_vertices=e.slice(0,2)})),o[o.length]=c};do{c()}while(o[o.length-1].length>0);return o.length>0&&0===o[o.length-1].length&&o.pop(),o},Yr=function make_faces_matrix(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_foldAngle,o=e.edges_assignment,i=e.faces_vertices,c=e.faces_faces,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;r||(r=o?Rr({edges_assignment:o}):Array(n.length).fill(0));var u=Ir({edges_vertices:n}),s=i.map((function(){return Qn.core.identity3x4}));return Wr({faces_vertices:i,faces_faces:c},a).slice(1).forEach((function(e){return e.forEach((function(e){var n,o=e.edge_vertices.map((function(e){return t[e]})),i=e.edge_vertices.join(" "),c=u[i],a=Qn.core.make_matrix3_rotate(r[c]*Math.PI/180,(n=Qn.core).subtract.apply(n,_toConsumableArray(Qn.core.resize_up(o[1],o[0]))),o[0]);s[e.face]=Qn.core.multiply_matrices3(s[e.parent],a)}))})),s},Kr=function make_faces_coloring_from_matrix(e){return e.faces_matrix.map((function(e){return e[0]*e[4]-e[1]*e[3]})).map((function(e){return e>=0}))},Jr=Object.freeze({__proto__:null,make_vertices_edges:Cr,make_vertices_edges_sorted:Pr,make_vertices_vertices:Sr,make_vertices_faces:zr,make_vertices_faces_sorted:Nr,make_vertices_to_edge_bidirectional:Ir,make_vertices_to_edge:qr,make_vertices_to_face:Lr,make_vertices_vertices_vector:Tr,make_vertices_sectors:Fr,make_vertices_coords_folded:Vr,make_edges_edges:function make_edges_edges(e){var t=e.edges_vertices,n=e.vertices_edges;return t.map((function(e,t){var r=n[e[0]].filter((function(e){return e!==t})),o=n[e[1]].filter((function(e){return e!==t}));return r.concat(o)}))},make_edges_faces:Br,make_edges_foldAngle:Rr,make_edges_assignment:function make_edges_assignment(e){return e.edges_foldAngle.map((function(e){return 0===e?"F":e<0?"M":"V"}))},make_edges_vector:Dr,make_edges_length:function make_edges_length(e){var t=e.vertices_coords,n=e.edges_vertices;return Dr({vertices_coords:t,edges_vertices:n}).map((function(e){return Qn.core.magnitude(e)}))},make_edges_coords_min_max:Ur,make_edges_coords_min_max_exclusive:function make_edges_coords_min_max_exclusive(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON,n=[+t,-t];return Ur(e).map((function(e){return e.map((function(e,t){return e.map((function(e){return e+n[t]}))}))}))},make_edges_coords_min_max_inclusive:Zr,make_planar_faces:Hr,make_faces_vertices:function make_faces_vertices(e){return Hr(e).map((function(e){return e.vertices}))},make_faces_edges:function make_faces_edges(e){return Hr(e).map((function(e){return e.edges}))},make_faces_faces:Xr,get_face_face_shared_vertices:$r,make_face_spanning_tree:Wr,make_faces_matrix:Yr,make_faces_center:function make_faces_center(e){var t=e.vertices_coords;return e.faces_vertices.map((function(e){return e.map((function(e){return t[e]}))})).map((function(e){return Qn.core.centroid(e)}))},make_faces_coloring_from_matrix:Kr,make_faces_coloring:function make_faces_coloring(e){var t=e.faces_vertices,n=e.faces_faces,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=[];return o[r]=!0,Wr({faces_vertices:t,faces_faces:n},r).forEach((function(e,t){return e.forEach((function(e){o[e.face]=t%2==0}))})),o}}),Qr=function get_boundary(e){var t=e.vertices_edges,n=e.edges_vertices,r=e.edges_assignment;if(void 0===r)return{vertices:[],edges:[]};t||(t=Cr({edges_vertices:n}));for(var o=r.map((function(e){return"B"===e||"b"===e})),i=[],c=[],a=-1,u=0;u<o.length;u+=1)if(o[u]){a=u;break}if(-1===a)return{vertices:[],edges:[]};o[a]=!1,i.push(a),c.push(n[a][0]);for(var s=n[a][1];c[0]!==s;){if(c.push(s),void 0===(a=t[s].filter((function(e){return o[e]})).shift()))return{vertices:[],edges:[]};if(n[a][0]===s)s=_slicedToArray(n[a],2)[1];else s=_slicedToArray(n[a],1)[0];o[a]=!1,i.push(a)}return{vertices:c,edges:i}},eo=Object.freeze({__proto__:null,get_boundary:Qr,get_planar_boundary:function get_planar_boundary(e){var t=e.vertices_coords,n=e.vertices_edges,r=e.vertices_vertices,o=e.edges_vertices;r||(r=Sr({vertices_coords:t,vertices_edges:n,edges_vertices:o}));var i=Ir({edges_vertices:o}),c=[],a=[],u={vertices:a,edges:c},s=-1/0,l=-1;if(t.forEach((function(e,t){e[0]>s&&(s=e[0],l=t)})),-1===l)return u;a.push(l);var v=t[l],p=r[l],d=p.map((function(e){return t[e]})).map((function(e){return[e[0]-v[0],e[1]-v[1]]})).map((function(e){return Math.atan2(e[1],e[0])})).map((function(e){return e<0?e+2*Math.PI:e})).map((function(e,t){return{a:e,i:t}})).sort((function(e,t){return e.a-t.a})).shift().i,g=p[d],m=i[l<g?"".concat(l," ").concat(g):"".concat(g," ").concat(l)];c.push(m);for(var h=l,b=g,k=0;k<1e4;){var w=r[b],M=w.indexOf(h),E=w[(M+1)%w.length],O=i[b<E?"".concat(b," ").concat(E):"".concat(E," ").concat(b)];if(O===c[0])return u;a.push(b),c.push(O),h=b,b=E,k+=1}return console.warn("calculate boundary potentially entered infinite loop"),u}}),to=function clip_line(e,t){var n=e.vertices_coords,r=e.vertices_edges,o=e.edges_vertices,i=e.edges_assignment,c=e.boundaries_vertices,a=Qn.typeof(t),u=Qn.core["clip_".concat(a,"_in_convex_poly_exclusive")];if(u){c||(c=Qr({vertices_edges:r,edges_vertices:o,edges_assignment:i}).vertices);var s=c.map((function(e){return n[e]}));return u.apply(void 0,[s].concat(_toConsumableArray(function prepare_clip_func_params(e,t){switch(t){case"line":case"ray":return[e.vector,e.origin];case"segment":return[e[0],e[1]];default:return[]}}(t,a))))}},no=Object.freeze({__proto__:null,clip_line:to}),ro=function nearest_vertex(e,t){var n=e.vertices_coords;if(n){var r=Qn.core.resize(n[0].length,t),o=n.map((function(e,t){return{d:Qn.core.distance(r,e),i:t}})).sort((function(e,t){return e.d-t.d})).shift();return o?o.i:void 0}},oo=function nearest_edge(e,t){var n=e.vertices_coords,r=e.edges_vertices;if(n&&r){var o=r.map((function(e){return e.map((function(e){return n[e]}))})).map((function(e){return Qn.core.nearest_point_on_line(Qn.core.subtract(e[1],e[0]),e[0],t,Qn.core.segment_limiter)}));return Qn.core.smallest_comparison_search(t,o,Qn.core.distance)}},io=function face_containing_point(e,t){var n=e.vertices_coords,r=e.faces_vertices;if(n&&r){var o=r.map((function(e,t){return{face:e.map((function(e){return n[e]})),i:t}})).filter((function(e){return Qn.core.point_in_poly(t,e.face)})).shift();return void 0===o?void 0:o.i}},co=io,ao=Object.freeze({__proto__:null,nearest_vertex:ro,nearest_edge:oo,face_containing_point:io,nearest_face:co}),uo=function get_edges_vertices_span(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON;return Zr(e).map((function(n,r){return e.vertices_coords.map((function(e,r){return e[0]>n[0][0]-t&&e[1]>n[0][1]-t&&e[0]<n[1][0]+t&&e[1]<n[1][1]+t}))}))},so=function get_edges_edges_span(e){for(var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON,i=Zr({vertices_coords:t,edges_vertices:n,edges_coords:r},o),c=n.map((function(){return[]})),a=0;a<n.length-1;a+=1)for(var u=a+1;u<n.length;u+=1){var s=(i[a][1][0]<i[u][0][0]||i[u][1][0]<i[a][0][0])&&(i[a][1][1]<i[u][0][1]||i[u][1][1]<i[a][0][1]);c[a][u]=!s,c[u][a]=!s}for(var l=0;l<n.length;l+=1)c[l][l]=!0;return c},fo=Object.freeze({__proto__:null,get_edges_vertices_span:uo,get_edges_edges_span:so}),lo=function merge_nextmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return[t]}));return t.forEach((function(e){r.forEach((function(t,n){return t.forEach((function(t,o){r[n][o]=e[t]}))})),r.forEach((function(e,t){r[t]=e.reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return void 0!==e}))}))})),r}},_o=function invert_map(e){var t=[];return e.forEach((function(e,n){null!=e&&("number"==typeof e&&(void 0!==t[e]?"number"==typeof t[e]?t[e]=[t[e],n]:t[e].push(n):t[e]=n),e.constructor===Array&&e.forEach((function(e){t[e]=n})))})),t},vo=function invert_simple_map(e){var t=[];return e.forEach((function(e,n){t[e]=n})),t},po=Object.freeze({__proto__:null,merge_simple_nextmaps:function merge_simple_nextmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return t}));return t.forEach((function(e){return r.forEach((function(t,n){r[n]=e[t]}))})),r}},merge_nextmaps:lo,merge_simple_backmaps:function merge_simple_backmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].map((function(e,t){return t}));return t.forEach((function(e,t){var n=e.map((function(e){return r[e]}));r=n})),r}},merge_backmaps:function merge_backmaps(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(0!==t.length){var r=t[0].reduce((function(e,t){return e.concat(t)}),[]).map((function(e,t){return[t]}));return t.forEach((function(e,t){var n=[];e.forEach((function(e,t){n[t]="number"==typeof e?r[e]:e.map((function(e){return r[e]})).reduce((function(e,t){return e.concat(t)}),[])})),r=n})),r}},invert_map:_o,invert_simple_map:vo}),go=function is_folded_form(e){return e.frame_classes&&e.frame_classes.includes("foldedForm")||e.file_classes&&e.file_classes.includes("foldedForm")},mo=Object.freeze({__proto__:null,is_folded_form:go}),ho=function max_arrays_length(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Math.max.apply(Math,[0].concat(_toConsumableArray(t.filter((function(e){return void 0!==e})).map((function(e){return e.length})))))},yo=function count(e,t){return ho.apply(void 0,_toConsumableArray(mr(e,t).map((function(t){return e[t]}))))};yo.vertices=function(e){var t=e.vertices_coords,n=e.vertices_faces,r=e.vertices_vertices;return ho(t,n,r)},yo.edges=function(e){var t=e.edges_vertices,n=e.edges_edges,r=e.edges_faces;return ho(t,n,r)},yo.faces=function(e){var t=e.faces_vertices,n=e.faces_edges,r=e.faces_faces;return ho(t,n,r)};var bo,xo=function unique_sorted_integers(e){var t={};return e.forEach((function(e){t[e]=!0})),Object.keys(t).map((function(e){return parseInt(e)})).sort((function(e,t){return e-t}))},Ao=function remove_geometry_indices(e,t,n){var r,o,i,c=yo(e,t),a=xo(n),u=[];for(r=0,o=0,i=0;r<c;r+=1,o+=1){for(;r===a[i];)u[r]=void 0,r+=1,i+=1;r<c&&(u[r]=o)}return hr(e,t).forEach((function(t){return e[t].forEach((function(n,r){return e[t][r].forEach((function(n,o){e[t][r][o]=u[n]}))}))})),a.reverse(),mr(e,t).forEach((function(t){return a.forEach((function(n){return e[t].splice(n,1)}))})),u},ko=function populate(e){if("object"===_typeof(e)&&e.edges_vertices){if(e.vertices_edges=Cr(e),e.vertices_vertices=Sr(e),e.vertices_edges=Pr(e),e.vertices_coords&&(e.edges_vector=Dr(e),e.vertices_sectors=Fr(e)),function set_edges_angles(e){var t=e.edges_vertices.length;if(e.edges_assignment||(e.edges_assignment=[]),e.edges_foldAngle||(e.edges_foldAngle=[]),e.edges_assignment.length>e.edges_foldAngle.length)for(var n=e.edges_foldAngle.length;n<e.edges_assignment.length;n+=1)e.edges_foldAngle[n]=vr(e.edges_assignment[n]);if(e.edges_foldAngle.length>e.edges_assignment.length)for(var r=e.edges_assignment.length;r<e.edges_foldAngle.length;r+=1)e.edges_assignment[r]=pr(e.edges_foldAngle[r]);for(var o=e.edges_assignment.length;o<t;o+=1)e.edges_assignment[o]="U",e.edges_foldAngle[o]=0}(e),e.vertices_coords){var t=Hr(e);e.faces_vertices=t.map((function(e){return e.vertices})),e.faces_edges=t.map((function(e){return e.edges})),e.faces_angles=t.map((function(e){return e.angles}))}else e.faces_vertices=[],e.faces_edges=[];return e.vertices_faces=e.vertices_vertices?Nr(e):zr(e),e.edges_faces=Br(e),e.faces_faces=Xr(e),e.vertices_coords&&(e.faces_matrix=Yr(e)),e}},wo=function add_vertices(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qn.core.EPSILON;e.vertices_coords||(e.vertices_coords=[]),"number"==typeof t[0]&&(t=[t]);var o=t.map((function(t){return e.vertices_coords.map((function(e){return Qn.core.distance(e,t)<r})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})),i=e.vertices_coords.length,c=t.filter((function(e,t){return void 0===o[t]}));return(n=e.vertices_coords).push.apply(n,_toConsumableArray(c)),o.map((function(e){return void 0===e?i++:e}))},Mo=["vertices","edges","faces"],Eo=function make_vertices_map_and_consider_duplicates(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qn.core.EPSILON,r=e.vertices_coords.length;return t.vertices_coords.map((function(t){return e.vertices_coords.map((function(e){return Qn.core.distance(e,t)<n})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})).map((function(e){return void 0===e?r++:e}))},Oo=function get_edges_duplicate_from_source_in_target(e,t){for(var n={},r={},o=0;o<e.edges_vertices.length;o+=1)r["".concat(e.edges_vertices[o][0]," ").concat(e.edges_vertices[o][1])]=o,r["".concat(e.edges_vertices[o][1]," ").concat(e.edges_vertices[o][0])]=o;for(var i=0;i<t.edges_vertices.length;i+=1){var c=r["".concat(t.edges_vertices[i][0]," ").concat(t.edges_vertices[i][1])];void 0!==c&&(n[i]=c)}return n},jo=function update_suffixes(e,t,n,r){return n.forEach((function(n){return t[n].forEach((function(t){return e[t].forEach((function(o,i){return o.forEach((function(o,c){e[t][i][c]=r[n][o]}))}))}))}))},Co=function assign(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qn.core.EPSILON,r={},o={},i={};Mo.forEach((function(e){r[e]=mr(t,e),o[e]=hr(t,e)})),Mo.forEach((function(t){return r[t].filter((function(t){return!e[t]})).forEach((function(t){e[t]=[]}))})),i.vertices=Eo(e,t,n),jo(t,o,["vertices"],i);var c=yo.edges(e);i.edges=Array.from(Array(yo.edges(t))).map((function(e,t){return c+t}));var a=Oo(e,t);Object.keys(a).forEach((function(e){i.edges[e]=a[e]}));var u=yo.faces(e);return i.faces=Array.from(Array(yo.faces(t))).map((function(e,t){return u+t})),jo(t,o,["edges","faces"],i),Mo.forEach((function(n){return r[n].forEach((function(r){return t[r].forEach((function(t,o){var c=i[n][o];e[r][c]=t}))}))})),i},Po=function apply_matrix_to_graph(e,t){return dr(e,"coords").forEach((function(n){e[n]=e[n].map((function(e){return Qn.core.resize(3,e)})).map((function(e){return Qn.core.multiply_matrix3_vector3(t,e)}))})),dr(e,"matrix").forEach((function(n){e[n]=e[n].map((function(e){return Qn.core.multiply_matrices3(e,t)}))})),e},So={scale:function transform_scale(e,t){for(var n,r=arguments.length,o=new Array(r>2?r-2:0),i=2;i<r;i++)o[i-2]=arguments[i];var c=(n=Qn.core).get_vector.apply(n,o),a=Qn.core.resize(3,c),u=Qn.core.make_matrix3_scale(t,a);return Po(e,u)},translate:function transform_translate(e){for(var t,n,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];var c=(t=Qn.core).get_vector.apply(t,o),a=Qn.core.resize(3,c),u=(n=Qn.core).make_matrix3_translate.apply(n,_toConsumableArray(a));return Po(e,u)},rotateZ:function transform_rotateZ(e,t){for(var n,r,o=arguments.length,i=new Array(o>2?o-2:0),c=2;c<o;c++)i[c-2]=arguments[c];var a=(n=Qn.core).get_vector.apply(n,i),u=Qn.core.resize(3,a),s=(r=Qn.core).make_matrix3_rotateZ.apply(r,[t].concat(_toConsumableArray(u)));return Po(e,s)},transform:Po},zo=function subgraph(e,t){var n={},r={};return["faces","edges","vertices"].forEach((function(o){n[o]=Array.from(Array(yo[o](e))).map((function(e,t){return t})),r[o]=xo(t[o]||[]).reverse()})),Object.keys(r).forEach((function(e){return r[e].forEach((function(t){return n[e].splice(t,1)}))})),Object.keys(n).forEach((function(t){return Ao(e,t,n[t])})),e},No=function fn_and(e,t){return e&&t},Io=function fn_cat(e,t){return e.concat(t)},qo=function fn_def(e){return void 0!==e},Lo=function fn_add(e,t){return e+t},To=function get_isolated_vertices(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.faces_vertices,o=t.length,i=Array(o).fill(!1);return n&&n.forEach((function(e){e.filter((function(e){return!i[e]})).forEach((function(e){i[e]=!0,o-=1}))})),r&&r.forEach((function(e){e.filter((function(e){return!i[e]})).forEach((function(e){i[e]=!0,o-=1}))})),i.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},Fo=Object.freeze({__proto__:null,get_edge_isolated_vertices:function get_edge_isolated_vertices(e){var t=e.vertices_coords,n=e.edges_vertices,r=t.length,o=Array(r).fill(!1);return n.forEach((function(e){e.filter((function(e){return!o[e]})).forEach((function(e){o[e]=!0,r-=1}))})),o.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},get_face_isolated_vertices:function get_face_isolated_vertices(e){var t=e.vertices_coords,n=e.faces_vertices,r=t.length,o=Array(r).fill(!1);return n.forEach((function(e){e.filter((function(e){return!o[e]})).forEach((function(e){o[e]=!0,r-=1}))})),o.map((function(e,t){return e?void 0:t})).filter((function(e){return void 0!==e}))},get_isolated_vertices:To}),Vo=function get_circular_edges(e){for(var t=e.edges_vertices,n=[],r=0;r<t.length;r+=1)t[r][0]===t[r][1]&&n.push(r);return n},Bo=function get_duplicate_edges(e){var t=e.edges_vertices;if(!t)return[];for(var n=[],r={},o=0;o<t.length;o+=1){var i="".concat(t[o][0]," ").concat(t[o][1]),c="".concat(t[o][1]," ").concat(t[o][0]);void 0!==r[i]?n[o]=r[i]:(r[i]=o,r[c]=o)}return n},Go=function are_vertices_equivalent(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qn.core.EPSILON,r=e.length,o=0;o<r;o+=1)if(Math.abs(e[o]-t[o])>n)return!1;return!0},Ro=function get_duplicate_vertices(e){for(var t=e.vertices_coords,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON,r=t.map((function(){return[]})),o=0;o<t.length-1;o+=1)for(var i=o+1;i<t.length;i+=1)r[o][i]=Go(t[o],t[i],n);for(var c=r.map((function(e){return e.map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e}))})),a=[],u=Array(t.length).fill(!1),s=0,l=function recurse(e,n){if(!u[n]&&s!==t.length)for(u[n]=!0,s+=1,a[e]||(a[e]=[]),a[e].push(n);c[n].length>0;)recurse(e,c[n][0]),c[n].splice(0,1)},v=0;v<t.length&&(l(v,v),s!==t.length);v+=1);return a.filter((function(e){return e.length}))},Do=function remove_isolated_vertices(e){var t=To(e);return{map:Ao(e,ir,t),remove:t}},Uo=function remove_circular_edges(e){var t=Vo(e);if(t.length){var n={};t.forEach((function(e){n[e]=!0})),hr(e,cr).forEach((function(t){return e[t].forEach((function(r,o){for(var i=r.length-1;i>=0;i-=1)!0===n[r[i]]&&e[t][o].splice(i,1)}))}))}return{map:Ao(e,cr,t),remove:t}},Zo=function remove_duplicate_edges(e){var t=Bo(e),n=Object.keys(t),r=Ao(e,cr,n);return t.forEach((function(e,t){r[t]=e})),{map:r,remove:n}},Ho=function remove_duplicate_vertices(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON,n=Ro(e,t),r=[];n.forEach((function(e,t){return e.forEach((function(e){r[e]=t}))})),e.vertices_coords=n.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})).map((function(e){var t;return(t=Qn.core).average.apply(t,_toConsumableArray(e))})),hr(e,ir).forEach((function(t){return e[t].forEach((function(n,o){return e[t][o].forEach((function(n,i){e[t][o][i]=r[n]}))}))})),mr(e,ir).filter((function(e){return e!==ur})).forEach((function(t){return delete e[t]}));var o=n.map((function(e){return e.length>1?e.slice(1,e.length):void 0})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]);return{map:r,remove:o}},Xo=Object.freeze({__proto__:null,remove_isolated_vertices:Do,remove_circular_edges:Uo,remove_duplicate_edges:Zo,remove_duplicate_vertices:Ho}),$o=function get_collinear_vertices(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_coords,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON;r||(r=n.map((function(e){return e.map((function(e){return t[e]}))})));for(var i=uo({vertices_coords:t,edges_vertices:n,edges_coords:r},o),c=0;c<r.length;c+=1)for(var a=0;a<t.length;a+=1)i[c][a]&&(i[c][a]=Qn.core.point_on_segment_exclusive(t[a],r[c][0],r[c][1],o));return i.map((function(e){return e.map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e}))}))},Wo=function get_edges_edges_intersections(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_vector,o=e.edges_origin,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON;r||(r=Dr({vertices_coords:t,edges_vertices:n})),o||(o=n.map((function(e){return t[e[0]]})));for(var c=r.map((function(){return[]})),a=so({vertices_coords:t,edges_vertices:n},i),u=0;u<r.length-1;u+=1)for(var s=u+1;s<r.length;s+=1)!0===a[u][s]?(c[u][s]=Qn.core.intersect_lines(r[u],o[u],r[s],o[s],Qn.core.exclude_s,Qn.core.exclude_s,i),c[s][u]=c[u][s]):c[u][s]=void 0;return c},Yo=function fragment_graph(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON,n=e.edges_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})),r=n.map((function(e){return Qn.core.subtract(e[1],e[0])})),o=n.map((function(e){return e[0]})),i=Wo({vertices_coords:e.vertices_coords,edges_vertices:e.edges_vertices,edges_vector:r,edges_origin:o},1e-6),c=$o({vertices_coords:e.vertices_coords,edges_vertices:e.edges_vertices,edges_coords:n},t);if(0!==i.reduce(Io,[]).filter(qo).length||0!==c.reduce(Io,[]).filter(qo).length){var a={vertices:e.vertices_coords.length};i.forEach((function(t){return t.filter(qo).filter((function(e){return 2===e.length})).forEach((function(t){var n=e.vertices_coords.length;e.vertices_coords.push(_toConsumableArray(t)),t.splice(0,2),t.push(n)}))})),i.forEach((function(e,t){e.forEach((function(e,n){e&&(i[t][n]=e[0])}))}));var u=i.map((function(e){return e.filter(qo)}));e.edges_vertices.forEach((function(e,t){return e.push.apply(e,_toConsumableArray(u[t]).concat(_toConsumableArray(c[t])))})),e.edges_vertices.forEach((function(t,n){e.edges_vertices[n]=Or({vertices_coords:e.vertices_coords},t,r[n])}));var s=e.edges_vertices.map((function(e,t){return Array(e.length-1).fill(t)})).reduce(Io,[]);if(e.edges_vertices=e.edges_vertices.map((function(e){return Array.from(Array(e.length-1)).map((function(t,n,r){return[e[n],e[n+1]]}))})).reduce(Io,[]),e.edges_assignment&&e.edges_foldAngle&&e.edges_foldAngle.length>e.edges_assignment.length)for(var l=e.edges_assignment.length;l<e.edges_foldAngle.length;l+=1)e.edges_assignment[l]=pr(e.edges_foldAngle[l]);return e.edges_assignment&&(e.edges_assignment=s.map((function(t){return e.edges_assignment[t]||"U"}))),e.edges_foldAngle&&(e.edges_foldAngle=s.map((function(t){return e.edges_foldAngle[t]})).map((function(t,n){return void 0===t?vr(e.edges_assignment[n]):t}))),{vertices:{new:Array.from(Array(e.vertices_coords.length-a.vertices)).map((function(e,t){return a.vertices+t}))},edges:{backmap:s}}}},Ko=["vertices_coords","edges_vertices","edges_assignment","edges_foldAngle"],Jo=function fragment(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn.core.EPSILON;e.vertices_coords=e.vertices_coords.map((function(e){return e.slice(0,2)})),[ir,cr,ar].map((function(t){return mr(e,t)})).reduce(Io,[]).filter((function(e){return!Ko.includes(e)})).forEach((function(t){return delete e[t]}));var n,r={vertices:{},edges:{}};for(n=0;n<20;n++){var o=Ho(e,t/2),i=Zo(e),c=Uo(e),a=Yo(e,t);if(void 0===a){r.vertices.map=void 0===r.vertices.map?o.map:lo(r.vertices.map,o.map),r.edges.map=void 0===r.edges.map?lo(i.map,c.map):lo(r.edges.map,i.map,c.map);break}var u=_o(a.edges.backmap),s=lo(i.map,c.map,u);r.vertices.map=void 0===r.vertices.map?o.map:lo(r.vertices.map,o.map),r.edges.map=void 0===r.edges.map?s:lo(r.edges.map,s)}return 20===n&&console.warn("debug warning. fragment reached max iterations"),r},Qo=function clone(e){var t,n;if("object"!==_typeof(e))return e;if(!e)return e;if("[object Array]"===Object.prototype.toString.apply(e)){for(t=[],n=0;n<e.length;n+=1)t[n]=clone(e[n]);return t}for(n in t={},e)e.hasOwnProperty(n)&&(t[n]=clone(e[n]));return t},ei=function add_edges(e,t){var n;e.edges_vertices||(e.edges_vertices=[]),"number"==typeof t[0]&&(t=[t]);var r=t.map((function(t,n){return e.edges_vertices.length+n}));(n=e.edges_vertices).push.apply(n,_toConsumableArray(t));var o=Zo(e).map;return r.map((function(e){return o[e]}))},ti=function split_edge(e,t,n){if(!(e.edges_vertices.length<t)){var r,o=e.edges_vertices[t];if(!n)n=(r=Qn.core).midpoint.apply(r,_toConsumableArray(o));var i=o.map((function(t){return e.vertices_coords[t]})).map((function(e){return Qn.core.distance(e,n)<Qn.core.EPSILON}));if(i[0])return{vertex:o[0],edges:{}};if(i[1])return{vertex:o[1],edges:{}};var c=e.vertices_coords.length;e.vertices_coords[c]=n;var a=[0,1].map((function(t){return t+e.edges_vertices.length}));(function split_edge_into_two(e,t,n){var r=e.edges_vertices[t],o=[{edges_vertices:[r[0],n]},{edges_vertices:[n,r[1]]}];return o.forEach((function(n,r){if([sr,fr].filter((function(n){return void 0!==e[n]&&void 0!==e[n][t]})).forEach((function(r){return n[r]=e[r][t]})),e.edges_faces&&void 0!==e.edges_faces[t]&&(n.edges_faces=_toConsumableArray(e.edges_faces[t])),e.edges_vector){var o=n.edges_vertices.map((function(t){return e.vertices_coords[t]}));n.edges_vector=Qn.core.subtract(o[1],o[0])}if(e.edges_length){var i,c=n.edges_vertices.map((function(t){return e.vertices_coords[t]}));n.edges_length=(i=Qn.core).distance2.apply(i,_toConsumableArray(c))}})),o})(e,t,c).forEach((function(t,n){return Object.keys(t).forEach((function(r){e[r][a[n]]=t[r]}))})),function update_vertices_vertices(e,t,n){var r=e.vertices_vertices;r&&(r[t]=_toConsumableArray(n),n.forEach((function(e,n,o){var i=o[(n+1)%o.length],c=r[e].indexOf(i);r[e][c]=t})))}(e,c,o),function update_vertices_edges(e,t,n,r,o){var i=e.vertices_edges;i&&(i[r]=_toConsumableArray(o),t.map((function(e){return i[e].indexOf(n)})).forEach((function(e,n){i[t[n]][e]=o[n]})))}(e,o,t,c,a);var u=function find_adjacent_faces_to_edge(e,t){var n=e.vertices_faces,r=e.edges_vertices,o=e.edges_faces,i=e.faces_edges;if(e.faces_vertices,o&&o[t])return o[t];var c=r[t];if(void 0!==n){for(var a=[],u=0;u<n[c[0]].length;u+=1)for(var s=0;s<n[c[1]].length;s+=1)n[c[0]][u]===n[c[1]][s]&&a.push(n[c[0]][u]);return a}if(i){for(var l=[],v=0;v<i.length;v+=1)for(var p=0;p<i[v].length;p+=1)i[v][p]===t&&l.push(v);return l}}(e,t);u&&(function update_vertices_faces(e,t,n){var r=e.vertices_faces;r&&(r[t]=_toConsumableArray(n))}(e,c,o),function update_faces_vertices(e,t,n,r){var o=e.faces_vertices;o&&t.map((function(e){return o[e]})).forEach((function(e){return e.map((function(e,t,n){var o=(t+1)%n.length;return e===r[0]&&n[o]===r[1]||e===r[1]&&n[o]===r[0]?o:void 0})).filter((function(e){return void 0!==e})).sort((function(e,t){return t-e})).forEach((function(t){return e.splice(t,0,n)}))}))}(e,u,c,o),function update_faces_edges(e,t,n,r,o){var i=e.edges_vertices,c=e.faces_edges;c&&t.map((function(e){return c[e]})).forEach((function(e){var t=e.indexOf(o),c=e[(t+e.length-1)%e.length],a=e[(t+1)%e.length],u=[[c,o],[o,a]].map((function(e){var t=e.map((function(e){return i[e]}));return t[0][0]===t[1][0]||t[0][0]===t[1][1]?t[0][0]:t[0][1]})).reduce((function(e,t){return e.concat(t)}),[]),s=[[u[0],n],[n,u[1]]].map((function(e){var t=e.map((function(e){return-1!==i[r[0]].indexOf(e)})).reduce((function(e,t){return e&&t}),!0),n=e.map((function(e){return-1!==i[r[1]].indexOf(e)})).reduce((function(e,t){return e&&t}),!0);if(t)return r[0];if(n)return r[1];throw new Error("something wrong with input graph's faces_edges construction")}));return t===e.length-1?(e.splice(t,1,s[0]),e.unshift(s[1])):e.splice.apply(e,[t,1].concat(_toConsumableArray(s))),s}))}(e,u,c,a,t));var s=Ao(e,cr,[t]);return a.forEach((function(e,t){a[t]=s[a[t]]})),s.splice(-2),s[t]=a,{vertex:c,edges:{map:s,remove:t}}}},ni=function split_convex_face(e,t,n,r){var o=function intersect_face_with_line(e,t,n,r){var o=e.vertices_coords,i=e.edges_vertices,c=e.faces_vertices,a=e.faces_edges,u=c[t].map((function(e){return o[e]})).map((function(e){return Qn.core.point_on_line(e,n,r)})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).slice(0,2),s=u.map((function(e){return{vertex:c[t][e],face_vertex_index:e}}));if(s.length>1){var l=u[1]-u[0];if(1===(l<0?l+c[t].length:l))return;return{vertices:s,edges:[]}}var v=a[t].map((function(e){return i[e].map((function(e){return o[e]}))})).map((function(e){var t;return(t=Qn.core).intersect_line_seg_exclude.apply(t,[n,r].concat(_toConsumableArray(e)))})).map((function(e,n){return{coords:e,face_edge_index:n,edge:a[t][n]}})).filter((function(e){return void 0!==e.coords})).slice(0,2);return s.length>0&&v.length>0?{vertices:s,edges:v}:v.length>1?{vertices:[],edges:v}:void 0}(e,t,n,r);if(void 0!==o){var i=o.vertices.map((function(e){return e.vertex})),c=[];o.edges.map((function(t,n,r){t.edge=c.length?c[0].edges.map[t.edge]:t.edge,c.push(ti(e,t.edge,t.coords))})),i.push.apply(i,_toConsumableArray(c.map((function(e){return e.vertex}))));var a=e.edges_vertices.length,u=[0,1].map((function(t){return e.faces_vertices.length+t-1})),s=function make_edge(e,t,n){var r,o,i=e.vertices_coords,c=t.map((function(e){return i[e]})).reverse();return{edges_vertices:_toConsumableArray(t),edges_foldAngle:0,edges_assignment:"U",edges_length:(r=Qn.core).distance2.apply(r,_toConsumableArray(c)),edges_vector:(o=Qn.core).subtract.apply(o,_toConsumableArray(c)),edges_faces:_toConsumableArray(n)}}(e,i,u);Object.keys(s).filter((function(t){return void 0!==e[t]})).forEach((function(t){e[t][a]=s[t]})),function update_vertices_vertices(e,t){var n=e.vertices_coords,r=e.vertices_vertices,o=e.edges_vertices,i=o[t][0],c=o[t][1];r[i]=Er({vertices_coords:n},r[i].concat(c),i),r[c]=Er({vertices_coords:n},r[c].concat(i),c)}(e,a);var l=function make_faces(e,t,n){var r=e.edges_vertices,o=e.faces_vertices,i=Ir({edges_vertices:r}),c=n.map((function(e){return o[t].indexOf(e)}));return function split_circular_array(e,t){return t.sort((function(e,t){return e-t})),[e.slice(t[1]).concat(e.slice(0,t[0]+1)),e.slice(t[0],t[1]+1)]}(o[t],c).map((function(e){return{faces_vertices:e,faces_edges:e.map((function(e,t,n){return"".concat(e," ").concat(n[(t+1)%n.length])})).map((function(e){return i[e]}))}}))}(e,t,i),v=Ao(e,"faces",[t]);if(l.forEach((function(t,n){return Object.keys(t).filter((function(t){return void 0!==e[t]})).forEach((function(r){e[r][u[n]]=t[r]}))})),e.vertices_faces=zr(e),e.edges_faces=Br(e),e.faces_faces=Xr(e),2===c.length){var p=vo(c[0].edges.map);c[1].edges.remove=p[c[1].edges.remove]}return v[t]=u,{vertices:i,faces:{map:v,remove:t},edges:{map:lo.apply(void 0,_toConsumableArray(c.map((function(e){return e.edges.map})))),new:a,remove:c.map((function(e){return e.edges.remove}))}}}},ri=function fold_faces_layer(e,t){var n=[],r=e.map((function(e,t){return t})),o=r.filter((function(e){return t[e]})),i=r.filter((function(e){return!t[e]}));return i.sort((function(t,n){return e[t]-e[n]})).forEach((function(e,t){n[e]=t})),o.sort((function(t,n){return e[n]-e[t]})).forEach((function(e,t){n[e]=i.length+t})),n},oi=function get_face_sidedness(e,t,n,r){var o=[n[0]-t[0],n[1]-t[1]],i=e[0]*o[1]-e[1]*o[0];return r?i>0:i<0},ii=function make_face_center_fast(e,t){return e.faces_vertices[t]?e.faces_vertices[t].map((function(t){return e.vertices_coords[t]})).reduce((function(e,t){return[e[0]+t[0],e[1]+t[1]]}),[0,0]).map((function(n){return n/e.faces_vertices[t].length})):[0,0]},ci=function prepare_graph_crease(e,t,n,r){var o=yo.faces(e),i=Array.from(Array(o));e["faces_re:layer"]||(e["faces_re:layer"]=Array(o).fill(0)),e["faces_re:preindex"]=i.map((function(e,t){return t})),e.faces_matrix||(e.faces_matrix=Yr(e,r)),e.faces_coloring=Kr(e),e["faces_re:creases"]=e.faces_matrix.map((function(e){return Qn.core.invert_matrix3(e)})).map((function(e){return Qn.core.multiply_matrix3_line3(e,t,n)})),e.faces_center=i.map((function(t,n){return ii(e,n)})),e["faces_re:sidedness"]=i.map((function(t,n){return oi(e["faces_re:creases"][n].vector,e["faces_re:creases"][n].origin,e.faces_center[n],e.faces_coloring[n])}))},ai=function two_furthest_points(e){var t=[0,-1/0],n=[1/0,0],r=[-1/0,0],o=[0,1/0];return e.forEach((function(e){e[0]<n[0]&&(n=e),e[0]>r[0]&&(r=e),e[1]<o[1]&&(o=e),e[1]>t[1]&&(t=e)})),Math.abs(t[1]-o[1])>Math.abs(r[0]-n[0])?[o,t]:[n,r]},ui={M:"V",m:"V",V:"M",v:"M"},si=function opposingCrease(e){return ui[e]||e},fi=function flat_fold(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"V",i=si(o);if(null==r){var c=io(e,n);r=void 0===c?0:c}t=Qn.core.resize(3,t),n=Qn.core.resize(3,n),ci(e,t,n,r);var a=Qo(e);a.vertices_coords.forEach((function(e){return e.splice(2)}));var u=Array.from(Array(yo.faces(e))).map((function(e,t){return t})).reverse().map((function(t){var n=a.faces_coloring[t],r=ni(a,t,a["faces_re:creases"][t].vector,a["faces_re:creases"][t].origin);if(void 0!==r)return a.edges_assignment[r.edges.new]=n?o:i,a.edges_foldAngle[r.edges.new]=n?_r[o]||0:_r[i]||0,r.faces.map[r.faces.remove].forEach((function(t){a.faces_center[t]=ii(a,t),a["faces_re:sidedness"][t]=oi(e["faces_re:creases"][r.faces.remove].vector,e["faces_re:creases"][r.faces.remove].origin,a.faces_center[t],e.faces_coloring[r.faces.remove]),a["faces_re:layer"][t]=e["faces_re:layer"][r.faces.remove],a["faces_re:preindex"][t]=e["faces_re:preindex"][r.faces.remove]})),r})).reverse();a["faces_re:layer"]=ri(a["faces_re:layer"],a["faces_re:sidedness"]);var s=void 0===u[0]?0:a["faces_re:preindex"].map((function(e,t){return{pre:e,new:t}})).filter((function(e){return 0===e.pre})).filter((function(e){return a["faces_re:sidedness"][e.new]})).shift().new,l=e.faces_matrix[0];"M"!==o&&"m"!==o&&"V"!==o&&"v"!==o||(l=void 0!==u[0]||e["faces_re:sidedness"][0]?Qn.core.multiply_matrices3(e.faces_matrix[0],Qn.core.make_matrix3_reflectZ(e["faces_re:creases"][0].vector,e["faces_re:creases"][0].origin)):e.faces_matrix[0]);var v=Yr(a,s).map((function(e){return Qn.core.multiply_matrices3(l,e)}));a.faces_coloring=Kr({faces_matrix:v});var p=Qn.core.multiply_matrix3_line3(l,e["faces_re:creases"][0].vector,e["faces_re:creases"][0].origin),d=Qn.core.normalize(Qn.core.rotate270(p.vector)),g=u.map((function(t,n){return void 0===t?void 0:a.edges_vertices[t.edges.new].map((function(e){return a.vertices_coords[e]})).map((function(t){return Qn.core.multiply_matrix3_vector3(e.faces_matrix[n],t)}))})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]);return a["re:construction"]=0===g.length?{type:"flip",direction:d}:{type:"fold",assignment:o,direction:d,edge:ai(g)},a.faces_matrix=v,a["vertices_re:foldedCoords"]=Vr(a,s),a.faces_matrix=v,delete e["faces_re:creases"],delete a["faces_re:creases"],delete e["faces_re:sidedness"],delete a["faces_re:sidedness"],delete e["faces_re:preindex"],delete a["faces_re:preindex"],delete e.faces_coloring,delete a.faces_coloring,delete e.faces_center,delete a.faces_center,a},li=function clean(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"object"===_typeof(t)&&!1===t.edges||(Uo(e),Zo(e)),"object"===_typeof(t)&&!0===t.vertices&&Do(e),e},_i="vertices",vi="edges",pi="faces",di="boundaries",gi="boundary",mi="mountain",hi="valley",yi="mark",bi="unassigned",xi="class",Ai="index",ki="vertices_coords",wi="edges_vertices",Mi="faces_edges",Ei="faces_re:layer",Oi={};["number","object","transform","class","style","function","string","undefined","boolean","path","svg","id","viewBox"].forEach((function(e){return Oi[e]=e}));var ji=("undefined"==typeof window?"undefined":_typeof(window))!==Oi.undefined&&_typeof(window.document)!==Oi.undefined,Ci=("undefined"==typeof process?"undefined":_typeof(process))!==Oi.undefined&&null!=process.versions&&null!=process.versions.node,Pi=("undefined"==typeof self?"undefined":_typeof(self))===Oi.object&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,Si=Object.freeze({__proto__:null,isBrowser:ji,isNode:Ci,isWebWorker:Pi}),zi=function(){var e={};if(Ci){var t=require("xmldom"),n=t.DOMParser,r=t.XMLSerializer;e.DOMParser=n,e.XMLSerializer=r,e.document=(new n).parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else ji&&(e=window);return e}(),Ni="http://www.w3.org/2000/svg",Ii={s:["svg"],d:["defs"],h:["desc","filter","metadata","style","script","title","view"],c:["cdata"],g:["g"],v:["circle","ellipse","line","path","polygon","polyline","rect"],t:["text"],i:["marker","symbol","clipPath","mask"],p:["linearGradient","radialGradient","pattern"],cT:["textPath","tspan"],cG:["stop"],cF:["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]},qi=function vec(e,t){return[Math.cos(e)*t,Math.sin(e)*t]},Li=function arcPath(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(null==o)return"";var c=qi(r,n),a=qi(o,n),u=[a[0]-c[0],a[1]-c[1]],s=c[0]*a[1]-c[1]*a[0],l=c[0]*a[0]+c[1]*a[1],v=Math.atan2(s,l)>0?0:1,p=i?"M ".concat(e,",").concat(t," l ").concat(c[0],",").concat(c[1]," "):"M ".concat(e+c[0],",").concat(t+c[1]," ");return p+=["a ",n,n,0,v,1,u[0],u[1]].join(" "),i&&(p+=" Z"),p},Ti=function arcArguments(e,t,n,r,o){return[Li(e,t,n,r,o,!1)]},Fi={arc:{nodeName:"path",attributes:["d"],args:Ti,methods:{setArc:function setArc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("d",Ti.apply(void 0,n))}}}},Vi=function wedgeArguments(e,t,n,r,o){return[Li(e,t,n,r,o,!0)]},Bi={wedge:{nodeName:"path",args:Vi,attributes:["d"],methods:{setArc:function setArc(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("d",Vi.apply(void 0,n))}}}},Gi=128,Ri=function parabolaArguments(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Array.from(Array(129)).map((function(e,t){return(t-Gi)/Gi*2+1})).map((function(o){return[e+(o+1)*n*.5,t+Math.pow(o,2)*r]}))},Di={parabola:{nodeName:"polyline",attributes:["points"],args:function parabolaPathString(e,t,n,r){return[Ri(e,t,n,r).map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ")]}}},Ui=function regularPolygonArguments(e,t,n,r){var o=[t,n];return Array.from(Array(e)).map((function(t,n){return 2*Math.PI*n/e})).map((function(e){return[Math.cos(e),Math.sin(e)]})).map((function(e){return o.map((function(t,n){return t+r*e[n]}))}))},Zi={regularPolygon:{nodeName:"polygon",attributes:["points"],args:function polygonPathString(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return[Ui(e,t,n,r).map((function(e){return"".concat(e[0],",").concat(e[1])})).join(" ")]}}},Hi={roundRect:{nodeName:"path",attributes:["d"],args:function roundRectArguments(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;o>n/2&&(o=n/2),o>r/2&&(o=r/2);var i=n-2*o,c=r-2*o,a="A".concat(o," ").concat(o," 0 0 1");return["M".concat(e+(n-i)/2,",").concat(t),"h".concat(i),a,"".concat(e+n,",").concat(t+(r-c)/2),"v".concat(c),a,"".concat(e+n-o,",").concat(t+r),"h".concat(-i),a,"".concat(e,",").concat(t+r-o),"v".concat(-c),a,"".concat(e+o,",").concat(t)].join(" ")}}},Xi=function is_iterable(e){return null!=e&&_typeof(e[Symbol.iterator])===Oi.function},$i=function flatten_arrays(){switch(arguments.length){case void 0:case 0:return Array.from(arguments);case 1:return Xi(arguments[0])&&"string"!=typeof arguments[0]?flatten_arrays.apply(void 0,_toConsumableArray(arguments[0])):[arguments[0]];default:return Array.from(arguments).map((function(e){return Xi(e)?_toConsumableArray(flatten_arrays(e)):e})).reduce((function(e,t){return e.concat(t)}),[])}},Wi=function coordinates(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return _typeof(e)===Oi.number})).concat(t.filter((function(e){return _typeof(e)===Oi.object&&null!==e})).map((function(e){return _typeof(e.x)===Oi.number?[e.x,e.y]:_typeof(e[0])===Oi.number?[e[0],e[1]]:void 0})).filter((function(e){return void 0!==e})).reduce((function(e,t){return e.concat(t)}),[]))},Yi=function add(e,t){return[e[0]+t[0],e[1]+t[1]]},Ki=function sub(e,t){return[e[0]-t[0],e[1]-t[1]]},Ji=function scale(e,t){return[e[0]*t,e[1]*t]},Qi=function curveArguments(){var e=Wi.apply(void 0,_toConsumableArray($i.apply(void 0,arguments))),t=e.slice(0,4);if(!t.length)return[""];var n=e[4]||0,r=e[5]||.5,o=[t[0],t[1]],i=[t[2],t[3]],c=Ki(i,o),a=Yi(o,Ji(c,.5)),u=[c[1],-c[0]],s=Yi(a,Ji(u,n)),l=Yi(o,Ji(Ki(s,o),r)),v=Yi(i,Ji(Ki(s,i),r));return["M".concat(o[0],",").concat(o[1],"C").concat(l[0],",").concat(l[1]," ").concat(v[0],",").concat(v[1]," ").concat(i[0],",").concat(i[1])]},ec={bend:function bend(e,t){return e.setAttribute("d",Qi.apply(void 0,_toConsumableArray(function getEndpoints(e){var t=e.getAttribute("d");return null==t||""===t?[]:[t.slice(t.indexOf("M")+1,t.indexOf("C")).split(","),t.split(" ").pop().split(",")].map((function(e){return e.map((function(e){return parseFloat(e)}))}))}(e)).concat([t]))),e}},tc={curve:{nodeName:"path",attributes:["d"],args:Qi,methods:ec}},nc={};Object.assign(nc,Fi,Bi,Di,Zi,Hi,tc);var rc=Object.keys(nc),oc=[Ii.h,Ii.p,Ii.i],ic=[Ii.g,Ii.v,Ii.t,rc],cc={svg:[Ii.s,Ii.d].concat(oc).concat(ic),g:ic,text:[Ii.cT],linearGradient:[Ii.cG],radialGradient:[Ii.cG],defs:oc,filter:[Ii.cF],marker:ic,symbol:ic,clipPath:ic,mask:ic},ac=Object.create(null);Object.keys(cc).forEach((function(e){ac[e]=cc[e].reduce((function(e,t){return e.concat(t)}),[])}));var uc={toCamel:function toCamel(e){return e.replace(/([-_][a-z])/gi,(function(e){return e.toUpperCase().replace("-","").replace("_","")}))},toKebab:function toKebab(e){return e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z])([A-Z])(?=[a-z])/g,"$1-$2").toLowerCase()},capitalized:function capitalized(e){return e.charAt(0).toUpperCase()+e.slice(1)}},sc=function viewBoxValue(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=1,c=n/i-n,a=e-c-o,u=t-c-o,s=n+2*c+2*o,l=r+2*c+2*o;return[a,u,s,l].join(" ")};function viewBox(){var e=Wi.apply(void 0,_toConsumableArray($i(arguments)));return 2===e.length&&e.unshift(0,0),4===e.length?sc.apply(void 0,_toConsumableArray(e)):void 0}var fc=function cdata(e){return(new zi.DOMParser).parseFromString("<root></root>","text/xml").createCDATASection("".concat(e))},lc=function removeChildren(e){for(;e.lastChild;)e.removeChild(e.lastChild);return e},_c=function moveChildren(e,t){for(;t.childNodes.length>0;){var n=t.childNodes[0];t.removeChild(n),e.appendChild(n)}return e},vc=function assignSVG(e,t){return Array.from(t.attributes).forEach((function(t){return e.setAttribute(t.name,t.value)})),_c(e,t)},pc={removeChildren:lc,appendTo:function appendTo(e,t){return null!=t&&t.appendChild(e),e},setAttributes:function setAttributes(e,t){return Object.keys(t).forEach((function(n){return e.setAttribute(uc.toKebab(n),t[n])}))}},dc=function filterWhitespaceNodes(e){if(null===e)return e;for(var t=e.childNodes.length-1;t>=0;t-=1){var n=e.childNodes[t];3===n.nodeType&&n.data.match(/^\s*$/)&&e.removeChild(n),1===n.nodeType&&filterWhitespaceNodes(n)}return e},gc=function parse(e){return(new zi.DOMParser).parseFromString(e,"text/xml")},mc=function checkParseError(e){var t=e.getElementsByTagName("parsererror");if(t.length>0)throw new Error(t[0]);return dc(e.documentElement)},hc=function sync(e){if(_typeof(e)===Oi.string||e instanceof String)try{return mc(gc(e))}catch(e){return e}if(null!=e.childNodes)return e},yc=function Load(e){return function isFilename(e){return _typeof(e)===Oi.string&&/^[\w,\s-]+\.[A-Za-z]{3}$/.test(e)&&e.length<1e4}(e)&&ji&&_typeof(zi.fetch)===Oi.function?function async(e){return new Promise((function(t,n){if(_typeof(e)===Oi.string||e instanceof String)fetch(e).then((function(e){return e.text()})).then((function(e){return mc(gc(e))})).then((function(e){return"svg"===e.nodeName?e:e.getElementsByTagName("svg")[0]})).then((function(e){return null==e?n("valid XML found, but no SVG element"):t(e)})).catch((function(e){return n(e)}));else if(e instanceof zi.Document)return asyncDone(e)}))}(e):hc(e)};var bc=function save(e,t){if((t=Object.assign(function SAVE_OPTIONS(){return{download:!1,output:Oi.string,windowStyle:!1,filename:"image.svg"}}(),t)).windowStyle){var n=zi.document.createElementNS(Ni,Oi.style);n.setAttribute("type","text/css"),n.innerHTML=function getWindowStylesheets(){var e=[];if(zi.document.styleSheets)for(var t=0;t<zi.document.styleSheets.length;t+=1){var n=zi.document.styleSheets[t];try{for(var r=("cssRules"in n?n.cssRules:n.rules),o=0;o<r.length;o+=1){var i=r[o];"cssText"in i?e.push(i.cssText):e.push("".concat(i.selectorText," {\n").concat(i.style.cssText,"\n}\n"))}}catch(e){console.warn(e)}}return e.join("\n")}(),e.appendChild(n)}var r=function vkXML(e,t){for(var n=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").split("~::~"),r=n.length,o=!1,i=0,c="",a=null!=t&&"string"==typeof t?t:"\t",u=["\n"],s=0;s<100;s+=1)u.push(u[s]+a);for(var l=0;l<r;l+=1)n[l].search(/<!/)>-1?(c+=u[i]+n[l],o=!0,(n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1||n[l].search(/!DOCTYPE/)>-1)&&(o=!1)):n[l].search(/-->/)>-1||n[l].search(/\]>/)>-1?(c+=n[l],o=!1):/^<\w/.exec(n[l-1])&&/^<\/\w/.exec(n[l])&&/^<[\w:\-\.\,]+/.exec(n[l-1])==/^<\/[\w:\-\.\,]+/.exec(n[l])[0].replace("/","")?(c+=n[l],o||(i-=1)):n[l].search(/<\w/)>-1&&-1===n[l].search(/<\//)&&-1===n[l].search(/\/>/)?c=c+=o?n[l]:u[i++]+n[l]:n[l].search(/<\w/)>-1&&n[l].search(/<\//)>-1?c=c+=o?n[l]:u[i]+n[l]:n[l].search(/<\//)>-1?c=c+=o?n[l]:u[--i]+n[l]:n[l].search(/\/>/)>-1?c=c+=o?n[l]:u[i]+n[l]:n[l].search(/<\?/)>-1||n[l].search(/xmlns\:/)>-1||n[l].search(/xmlns\=/)>-1?c+=u[i]+n[l]:c+=n[l];return"\n"===c[0]?c.slice(1):c}((new zi.XMLSerializer).serializeToString(e));return t.download&&ji&&!Ci&&function downloadInBrowser(e,t){var n=new zi.Blob([t],{type:"text/plain"}),r=zi.document.createElement("a");r.setAttribute("href",zi.URL.createObjectURL(n)),r.setAttribute("download",e),zi.document.body.appendChild(r),r.click(),zi.document.body.removeChild(r)}(t.filename,r),"svg"===t.output?e:r},xc=function setViewBox(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=1===n.length&&"string"==typeof n[0]?n[0]:viewBox.apply(void 0,n);return o&&e.setAttribute(Oi.viewBox,o),e},Ac=function getViewBox(e){var t=e.getAttribute(Oi.viewBox);return null==t?void 0:t.split(" ").map((function(e){return parseFloat(e)}))},kc=function convertToViewBox(e,t,n){var r=e.createSVGPoint();r.x=t,r.y=n;var o=r.matrixTransform(e.getScreenCTM().inverse());return[o.x,o.y]},wc=Object.freeze({__proto__:null,setViewBox:xc,getViewBox:Ac,convertToViewBox:kc}),Mc=function loadSVG(e,t){var n=yc(t);if(null!=n)return _typeof(n.then)===Oi.function?n.then((function(t){return vc(e,t)})):vc(e,n)},Ec=function getFrame(e){var t=Ac(e);if(void 0!==t)return t;if(_typeof(e.getBoundingClientRect)===Oi.function){var n=e.getBoundingClientRect();return[n.x,n.y,n.width,n.height]}return[]},Oc="svg-background-rectangle",jc=function stylesheet(e,t){var n=function findStyleSheet(e){var t=e.getElementsByTagName(Oi.style);return 0===t.length?void 0:t[0]}(e);return null==n&&(n=this.Constructor(Oi.style),e.insertBefore(n,e.firstChild)),n.textContent="",n.appendChild(fc(t)),n},Cc={clear:function clearSVG(e){return Array.from(e.attributes).filter((function(e){return"xmlns"!==e})).forEach((function(t){return e.removeAttribute(t.name)})),lc(e)},size:xc,setViewBox:xc,getViewBox:Ac,padding:function setPadding(e,t){var n=Ac(e);return void 0!==n&&xc.apply(void 0,[e].concat(_toConsumableArray([-t,-t,2*t,2*t].map((function(e,t){return n[t]+e}))))),e},background:function background(e,t){var n=Array.from(e.childNodes).filter((function(e){return e.getAttribute(Oi.class)===Oc})).shift();return null==n&&((n=this.Constructor.apply(this,["rect"].concat(_toConsumableArray(Ec(e))))).setAttribute(Oi.class,Oc),n.setAttribute("stroke","none"),e.insertBefore(n,e.firstChild)),n.setAttribute("fill",t),e},getWidth:function getWidth(e){return Ec(e)[2]},getHeight:function getHeight(e){return Ec(e)[3]},stylesheet:function stylesheet(e,t){return jc.call(this,e,t)},load:Mc,save:bc},Pc={math:{vector:function vector(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return[].concat(t)}}},Sc={move:["mousemove","touchmove"],press:["mousedown","touchstart"],release:["mouseup","touchend"]},zc=Object.values(Sc).reduce((function(e,t){return e.concat(t)}),[]),Nc=function defineGetter(e,t,n){return Object.defineProperty(e,t,{get:function get(){return n},enumerable:!0,configurable:!0})},Ic=function assignPress(e,t){var n;(["pressX","pressY"].filter((function(t){return!e.hasOwnProperty(t)})).forEach((function(n,r){return Nc(e,n,t[r])})),e.hasOwnProperty("press"))||Nc(e,"press",(n=Pc.math).vector.apply(n,_toConsumableArray(t)))},qc=function TouchEvents(e){var t=[],n=[];Object.keys(Sc).forEach((function(e){Sc[e].forEach((function(e){n[e]=[]}))}));var r={press:function press(e,n){Ic(e,t=n)},release:function release(){},move:function move(e,n){e.buttons>0&&void 0===t[0]?t=n:0===e.buttons&&void 0!==t[0]&&(t=[]),Ic(e,t)}};Object.keys(Sc).forEach((function(t){var o="on"+uc.capitalized(t);Object.defineProperty(e,o,{set:function set(o){return null==o?function removeHandler(t){return Sc[t].forEach((function(t){return n[t].forEach((function(n){return e.removeEventListener(t,n)}))}))}(t):Sc[t].forEach((function(i){var c=function handlerFunc(n){var i=null!=n.touches?n.touches[0]:n;if(void 0!==i){var c,a=kc(e,i.clientX,i.clientY).map((function(e){return isNaN(e)?void 0:e}));if(["x","y"].filter((function(e){return!n.hasOwnProperty(e)})).forEach((function(e,t){return Nc(n,e,a[t])})),!n.hasOwnProperty("position"))Nc(n,"position",(c=Pc.math).vector.apply(c,_toConsumableArray(a)));r[t](n,a)}o(n)};e.addEventListener&&(n[i].push(c),e.addEventListener(i,c))}))},enumerable:!0})})),Object.defineProperty(e,"off",{value:function value(){return function off(e,t){return zc.forEach((function(n){t[n].forEach((function(t){return e.removeEventListener(n,t)})),t[n]=[]}))}(e,n)}})},Lc=function UUID(){return Math.random().toString(36).replace(/[^a-z]+/g,"").concat("aaaaa").substr(0,5)},Tc=function Animation(e){var t,n,r={},o=0,i=function removeHandlers(){zi.cancelAnimationFrame&&zi.cancelAnimationFrame(n),Object.keys(r).forEach((function(e){return delete r[e]})),t=void 0,o=0};Object.defineProperty(e,"play",{set:function set(e){if(i(),null!=e){var c=Lc();r[c]=function handlerFunc(i){t||(t=i,o=0),e({time:.001*(i-t),frame:o}),o+=1,r[c]&&(n=zi.requestAnimationFrame(r[c]))},zi.requestAnimationFrame&&(n=zi.requestAnimationFrame(r[c]))}},enumerable:!0}),Object.defineProperty(e,"stop",{value:i,enumerable:!0})},Fc=function distanceSq2(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)},Vc=function distance2(e,t){return Math.sqrt(Fc(e,t))},Bc=Object.freeze({__proto__:null,distanceSq2:Fc,distance2:Vc}),Gc=[["cx","cy"],["x","y"]],Rc=function controlPoint(e){var t=[0,0],n={selected:!1,svg:void 0,updatePosition:function updatePosition(e){return e}},r=function updateSVG(){n.svg&&(n.svg.parentNode||e.appendChild(n.svg),Gc.filter((function(e){return null!=n.svg[e[0]]})).forEach((function(e){return e.forEach((function(e,r){n.svg.setAttribute(e,t[r])}))})))},o=new Proxy(t,{set:function set(e,t,n){return e[t]=n,r(),!0}}),i=function setPosition(){Wi.apply(void 0,_toConsumableArray($i.apply(void 0,arguments))).forEach((function(e,n){t[n]=e})),r(),"function"==typeof t.delegate&&t.delegate.apply(t.pointsContainer,[o,t.pointsContainer])};return t.delegate=void 0,t.setPosition=i,t.onMouseMove=function(e){return n.selected?i(n.updatePosition(e)):void 0},t.onMouseUp=function(){n.selected=!1},t.distance=function(e){return Math.sqrt(Fc(e,t))},["x","y"].forEach((function(e,n){return Object.defineProperty(t,e,{get:function get(){return t[n]},set:function set(e){t[n]=e}})})),["svg","updatePosition","selected"].forEach((function(e){return Object.defineProperty(t,e,{get:function get(){return n[e]},set:function set(t){n[e]=t}})})),Object.defineProperty(t,"remove",{value:function value(){!function removeFromParent(e){e&&e.parentNode&&e.parentNode.removeChild(e)}(n.svg),t.delegate=void 0}}),o},Dc=function controls(e,t,n){var r,o,i=Array.from(Array(t)).map((function(){return Rc(e)})),c=function protocol(e){return"function"==typeof o?o.call(i,e,r,i):void 0};i.forEach((function(e){e.delegate=c,e.pointsContainer=i}));e.onPress=function mousePressedHandler(e){i.length>0&&(r=i.map((function(t,n){return{i:n,d:Fc(t,[e.x,e.y])}})).sort((function(e,t){return e.d-t.d})).shift().i,i[r].selected=!0)},e.onMove=function mouseMovedHandler(e){i.forEach((function(t){return t.onMouseMove(e)}))},e.onRelease=function mouseReleasedHandler(){i.forEach((function(e){return e.onMouseUp()})),r=void 0},Object.defineProperty(i,"selectedIndex",{get:function get(){return r}}),Object.defineProperty(i,"selected",{get:function get(){return i[r]}}),Object.defineProperty(i,"add",{value:function value(t){i.push(Rc(e))}}),i.removeAll=function(){for(;i.length>0;)i.pop().remove()};var a={onChange:function onChange(e,t){if(o=e,!0===t){var n=i.length-1;e.call(i,i[n],n,i)}},position:function position(e){return i.forEach((function(t,n){return t.setPosition(e.call(i,t,n,i))}))},svg:function svg(e){return i.forEach((function(t,n){t.svg=e.call(i,t,n,i)}))}};return Object.keys(a).forEach((function(e){i[e]=function(){return"function"==typeof arguments[0]&&a[e].apply(a,arguments),i}})),i.parent=function(e){return null!=e&&null!=e.appendChild&&i.forEach((function(t){e.appendChild(t.svg)})),i},i},Uc=function applyControlsToSVG(e){e.controls=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Dc.call.apply(Dc,[e,e].concat(n))}},Zc=(new zi.DOMParser).parseFromString("<div />","text/xml").documentElement.constructor,Hc={svg:{args:function args(){return[viewBox(Wi.apply(void 0,arguments))].filter((function(e){return null!=e}))},methods:Cc,init:function init(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.filter((function(e){return _typeof(e)===Oi.string})).forEach((function(t){return Mc(e,t)})),n.filter((function(e){return null!=e})).filter((function(e){return e instanceof Zc})).filter((function(e){return _typeof(e.appendChild)===Oi.function})).forEach((function(t){return t.appendChild(e)})),qc(e),Tc(e),Uc(e)}}},Xc=function loadGroup(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=n.map((function(e){return hc(e)})).filter((function(e){return void 0!==e}));return o.filter((function(e){return e.tagName===Oi.svg})).forEach((function(t){return _c(e,t)})),o.filter((function(e){return e.tagName!==Oi.svg})).forEach((function(t){return e.appendChild(t)})),e},$c={g:{init:Xc,methods:{load:Xc}}},Wc=Object.assign(Object.create(null),{svg:["viewBox"],line:["x1","y1","x2","y2"],rect:["x","y","width","height"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],polygon:["points"],polyline:["points"],path:["d"],text:["x","y"],mask:["id"],symbol:["id"],clipPath:["id","clip-rule"],marker:["id","markerHeight","markerUnits","markerWidth","orient","refX","refY"],linearGradient:["x1","x2","y1","y2"],radialGradient:["cx","cy","r","fr","fx","fy"],stop:["offset","stop-color","stop-opacity"],pattern:["patternContentUnits","patternTransform","patternUnits"]}),Yc=function setRadius(e,t){return e.setAttribute(Wc.circle[2],t),e},Kc=function setOrigin(e,t,n){return _toConsumableArray(Wi.apply(void 0,_toConsumableArray($i(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(Wc.circle[n],t)})),e},Jc=function fromPoints(e,t,n,r){return[e,t,Vc([e,t],[n,r])]},Qc={circle:{args:function args(e,t,n,r){var o=Wi.apply(void 0,_toConsumableArray($i(e,t,n,r)));switch(o.length){case 0:case 1:return[,,].concat(_toConsumableArray(o));case 2:case 3:return o;default:return Jc.apply(void 0,_toConsumableArray(o))}},methods:{radius:Yc,setRadius:Yc,origin:Kc,setOrigin:Kc,center:Kc,setCenter:Kc,position:Kc,setPosition:Kc}}},ea=function setRadii(e,t,n){return[,,t,n].forEach((function(t,n){return e.setAttribute(Wc.ellipse[n],t)})),e},ta=function setCenter(e,t,n){return _toConsumableArray(Wi.apply(void 0,_toConsumableArray($i(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(Wc.ellipse[n],t)})),e},na={ellipse:{args:function args(e,t,n,r){var o=Wi.apply(void 0,_toConsumableArray($i(e,t,n,r))).slice(0,4);switch(o.length){case 0:case 1:case 2:return[,,].concat(_toConsumableArray(o));default:return o}},methods:{radius:ea,setRadius:ea,origin:ta,setOrigin:ta,center:ta,setCenter:ta,position:ta,setPosition:ta}}},ra=function Args(e,t,n,r){return Wi.apply(void 0,_toConsumableArray($i(e,t,n,r))).slice(0,4)},oa={line:{args:ra,methods:{setPoints:function setPoints(e,t,n,r,o){return ra(t,n,r,o).forEach((function(t,n){return e.setAttribute(Wc.line[n],t)})),e}}}},ia=/[MmLlSsQqLlHhVvCcSsQqTtAaZz]/g,ca=/-?[0-9]*\.?\d+/g,aa={m:"move",l:"line",v:"vertical",h:"horizontal",a:"ellipse",c:"curve",s:"smoothCurve",q:"quadCurve",t:"smoothQuadCurve",z:"close"};Object.keys(aa).forEach((function(e){var t=aa[e];aa[e.toUpperCase()]=t.charAt(0).toUpperCase()+t.slice(1)}));var ua=function getD(e){var t=e.getAttribute("d");return null==t?"":t},sa=function appendPathCommand(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return e.setAttribute("d","".concat(ua(e)).concat(t).concat($i.apply(void 0,r).join(" "))),e},fa=function getCommands(e){return function parsePathCommands(e){for(var t,n=[];null!==(t=ia.exec(e));)n.push(t);return n.map((function(t){return{command:e[t.index],index:t.index}})).reduceRight((function(t,n){var r=e.substring(n.index,t.length?t[t.length-1].index:e.length);return t.concat([{command:n.command,index:n.index,chunk:r.length>0?r.substr(1,r.length-1):r}])}),[]).reverse().map((function(e){var t=e.chunk.match(ca);return e.en=aa[e.command],e.values=t?t.map(parseFloat):[],delete e.chunk,e}))}(ua(e))},la={addCommand:sa,appendCommand:sa,clear:function clear(e){return e.removeAttribute("d"),e},getCommands:fa,get:fa,getD:function getD(e){return e.getAttribute("d")}};Object.keys(aa).forEach((function(e){la[aa[e]]=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return sa.apply(void 0,[t,e].concat(r))}}));var _a={path:{methods:la}},va=function setRectSize(e,t,n){return[,,t,n].forEach((function(t,n){return e.setAttribute(Wc.rect[n],t)})),e},pa=function setRectOrigin(e,t,n){return _toConsumableArray(Wi.apply(void 0,_toConsumableArray($i(t,n))).slice(0,2)).forEach((function(t,n){return e.setAttribute(Wc.rect[n],t)})),e},da=function fixNegatives(e){return[0,1].forEach((function(t){e[2+t]<0&&(void 0===e[0+t]&&(e[0+t]=0),e[0+t]+=e[2+t],e[2+t]=-e[2+t])})),e},ga={rect:{args:function args(e,t,n,r){var o=Wi.apply(void 0,_toConsumableArray($i(e,t,n,r))).slice(0,4);switch(o.length){case 0:case 1:case 2:case 3:return da([,,].concat(_toConsumableArray(o)));default:return da(o)}},methods:{origin:pa,setOrigin:pa,center:pa,setCenter:pa,size:va,setSize:va}}},ma={style:{init:function init(e,t){e.textContent="",e.appendChild(fc(t))},methods:{setTextContent:function setTextContent(e,t){return e.textContent="",e.appendChild(fc(t)),e}}}},ha={text:{args:function args(e,t,n){return Wi.apply(void 0,_toConsumableArray($i(e,t,n))).slice(0,2)},init:function init(e,t,n,r,o){var i=[t,n,r,o].filter((function(e){return _typeof(e)===Oi.string})).shift();i&&e.appendChild(zi.document.createTextNode(i))}}},ya=function makeIDString(){return Array.from(arguments).filter((function(e){return _typeof(e)===Oi.string||e instanceof String})).shift()||Lc()},ba=function args(){return[ya.apply(void 0,arguments)]},xa={mask:{args:ba},clipPath:{args:ba},symbol:{args:ba},marker:{args:ba,methods:{size:xc,setViewBox:xc}}},Aa=function getPoints(e){var t=e.getAttribute("points");return null==t?"":t},ka=function polyString(){var e=arguments;return Array.from(Array(Math.floor(arguments.length/2))).map((function(t,n){return"".concat(e[2*n+0],",").concat(e[2*n+1])})).join(" ")},wa=function stringifyArgs(){return[ka.apply(void 0,_toConsumableArray(Wi.apply(void 0,_toConsumableArray($i.apply(void 0,arguments)))))]},Ma=function setPoints$1(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("points",wa.apply(void 0,n)[0]),e},Ea=function addPoint(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.setAttribute("points",[Aa(e),wa.apply(void 0,n)[0]].filter((function(e){return""!==e})).join(" ")),e},Oa=function Args$1(){return 1===arguments.length&&_typeof(arguments.length<=0?void 0:arguments[0])===Oi.string?[arguments.length<=0?void 0:arguments[0]]:wa.apply(void 0,arguments)},ja={polyline:{args:Oa,methods:{setPoints:Ma,addPoint:Ea}},polygon:{args:Oa,methods:{setPoints:Ma,addPoint:Ea}}},Ca=Object.assign({},Hc,$c,Qc,na,oa,_a,ga,ma,ha,xa,ja),Pa={presentation:["color","color-interpolation","cursor","direction","display","fill","fill-opacity","fill-rule","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","image-rendering","letter-spacing","opacity","overflow","paint-order","pointer-events","preserveAspectRatio","shape-rendering","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","tabindex","transform-origin","user-select","vector-effect","visibility"],animation:["accumulate","additive","attributeName","begin","by","calcMode","dur","end","from","keyPoints","keySplines","keyTimes","max","min","repeatCount","repeatDur","restart","to","values"],effects:["azimuth","baseFrequency","bias","color-interpolation-filters","diffuseConstant","divisor","edgeMode","elevation","exponent","filter","filterRes","filterUnits","flood-color","flood-opacity","in","in2","intercept","k1","k2","k3","k4","kernelMatrix","lighting-color","limitingConeAngle","mode","numOctaves","operator","order","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","primitiveUnits","radius","result","seed","specularConstant","specularExponent","stdDeviation","stitchTiles","surfaceScale","targetX","targetY","type","xChannelSelector","yChannelSelector"],text:["dx","dy","alignment-baseline","baseline-shift","dominant-baseline","lengthAdjust","method","overline-position","overline-thickness","rotate","spacing","startOffset","strikethrough-position","strikethrough-thickness","text-anchor","text-decoration","text-rendering","textLength","underline-position","underline-thickness","word-spacing","writing-mode"],gradient:["gradientTransform","gradientUnits","spreadMethod"]};Object.values(Ii).reduce((function(e,t){return e.concat(t)}),[]).filter((function(e){return void 0===Wc[e]})).forEach((function(e){Wc[e]=[]})),[[["svg","defs","g"].concat(Ii.v,Ii.t),Pa.presentation],[["filter"],Pa.effects],[Ii.cT.concat("text"),Pa.text],[Ii.cF,Pa.effects],[Ii.cG,Pa.gradient]].forEach((function(e){return e[0].forEach((function(t){Wc[t]=Wc[t].concat(e[1])}))}));var Sa=function getClassList(e){if(null==e)return[];var t=e.getAttribute(Oi.class);return null==t?[]:t.split(" ").filter((function(e){return""!==e}))},za={addClass:function addClass(e,t){var n=Sa(e).filter((function(e){return e!==t}));n.push(t),e.setAttributeNS(null,Oi.class,n.join(" "))},removeClass:function removeClass(e,t){var n=Sa(e).filter((function(e){return e!==t}));e.setAttributeNS(null,Oi.class,n.join(" "))},setClass:function setClass(e,t){e.setAttributeNS(null,Oi.class,t)},setId:function setId(e,t){e.setAttributeNS(null,Oi.id,t)}},Na=function getAttr(e){var t=e.getAttribute(Oi.transform);return null==t||""===t?void 0:t},Ia={clearTransform:function clearTransform(e){return e.removeAttribute(Oi.transform),e}};["translate","rotate","scale","matrix"].forEach((function(e){Ia[e]=function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return t.setAttribute(Oi.transform,[Na(t),"".concat(e,"(").concat(r.join(" "),")")].filter((function(e){return void 0!==e})).join(" "))}}));var qa={};["clip-path","mask","symbol","marker-end","marker-mid","marker-start"].forEach((function(e){qa[uc.toCamel(e)]=function(t,n){return t.setAttribute(e,function findIdURL(e){if(null==e)return"";if(_typeof(e)===Oi.string)return"url"===e.slice(0,3)?e:"url(#".concat(e,")");if(null!=e.getAttribute){var t=e.getAttribute(Oi.id);return"url(#".concat(t,")")}return""}(n))}}));var La={};(bo=Ii.v).push.apply(bo,_toConsumableArray(Object.keys(nc))),Object.keys(nc).forEach((function(e){nc[e].attributes=void 0===nc[e].attributes?_toConsumableArray(Pa.presentation):nc[e].attributes.concat(Pa.presentation)})),Object.assign(La,Ca,nc),Object.keys(Ii).forEach((function(e){return Ii[e].filter((function(e){return void 0===La[e]})).forEach((function(e){La[e]={}}))}));var Ta=function passthrough(){return Array.from(arguments)};Object.keys(La).forEach((function(e){La[e].nodeName||(La[e].nodeName=e),La[e].init||(La[e].init=Ta),La[e].args||(La[e].args=Ta),La[e].methods||(La[e].methods={}),La[e].attributes||(La[e].attributes=Wc[e]||[])}));var Fa=function assign(e,t){e.forEach((function(e){return Object.keys(t).forEach((function(n){La[e].methods[n]=function(){return t[n].apply(t,arguments),arguments[0]}}))}))};Fa($i(Ii.t,Ii.v,Ii.g,Ii.s,Ii.p,Ii.i,Ii.h,Ii.d),za),Fa($i(Ii.t,Ii.v,Ii.g,Ii.s,Ii.p,Ii.i,Ii.h,Ii.d),pc),Fa($i(Ii.v,Ii.g,Ii.s),Ia),Fa($i(Ii.t,Ii.v,Ii.g),qa);var Va={svg:{version:"1.1",xmlns:Ni},style:{type:"text/css"}},Ba=function RequiredAttributes(e,t){Va[t]&&Object.keys(Va[t]).forEach((function(n){return e.setAttribute(n,Va[t][n])}))},Ga={},Ra=function constructor(e){for(var t,n,r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];var c=zi.document.createElementNS(Ni,La[e].nodeName);return Ba(c,e),(t=La[e]).init.apply(t,[c].concat(o)),(n=La[e]).args.apply(n,o).forEach((function(t,n){null!=La[e].attributes[n]&&c.setAttribute(La[e].attributes[n],t)})),La[e].attributes.forEach((function(e){Object.defineProperty(c,uc.toCamel(e),{value:function value(){return c.setAttribute.apply(c,[e].concat(Array.prototype.slice.call(arguments))),c}})})),Object.keys(La[e].methods).forEach((function(t){return Object.defineProperty(c,t,{value:function value(){var n;return(n=La[e].methods[t]).call.apply(n,[Ga,c].concat(Array.prototype.slice.call(arguments)))}})})),ac[e]&&ac[e].forEach((function(e){Object.defineProperty(c,e,{value:function value(){var t=constructor.apply(void 0,[e].concat(Array.prototype.slice.call(arguments)));return c.appendChild(t),t}})})),c};Ga.Constructor=Ra;var Da={};Object.keys(Ii).forEach((function(e){return Ii[e].forEach((function(e){Da[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return Ra.apply(void 0,[e].concat(n))}}))}));var Ua=function getFoldObject(e){return e.filter((function(e){return function possibleFoldObject(e){if("object"!==_typeof(e))return!1;var t=["vertices_coords","edges_vertices","faces_vertices","faces_edges"];return Object.keys(e).map((function(e){return t.includes(e)})).reduce((function(e,t){return e||t}),!1)}(e)})).shift()},Za=function initialize(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.filter((function(e){return _typeof(e)===Oi.function})).forEach((function(t){return t.call(e,e)}))},Ha=function SVG(){var e=arguments,t=Ra.apply(void 0,[Oi.svg].concat(Array.prototype.slice.call(arguments)));return"loading"===zi.document.readyState?zi.document.addEventListener("DOMContentLoaded",(function(){return Za.apply(void 0,[t].concat(_toConsumableArray(e)))})):Za.apply(void 0,[t].concat(Array.prototype.slice.call(arguments))),t};Object.assign(Ha,Da),Ha.NS=Ni,Ha.linker=function Linker(e){e.graph&&e.origami&&function link_rabbitear(e,t){t.svg=e,["segment","circle","ellipse","rect","polygon"].filter((function(e){return t[e]&&t[e].prototype})).forEach((function(n){t[n].prototype.svg=function(){return e.path(this.svgPath())}})),La.graph={nodeName:"g",init:function init(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.graph.svg(n,_objectSpread2(_objectSpread2({},r),{},{parent:e})),e},args:function args(){return[]},methods:La.g.methods,attributes:La.g.attributes},ac.graph=_toConsumableArray(ac.g),ac.svg.push("graph"),ac.g.push("graph")}(this,e)}.bind(Ha),Ha.use=function use(e){e.origami&&function bindRabbitEar(e,t){Pc.math.vector=t.vector}(0,e),e.render_into_svg&&function bindFoldToSvg(e,t){var n=La.svg.init;La.svg.init=function(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];var c=Ua(o);if(c){var a=t.options.apply(t,o);t.render_into_svg(e,c,a)}return n.apply(void 0,[e].concat(o))}}(0,e)}.bind(Ha),Ha.core=Object.assign(Object.create(null),{load:yc,save:bc,coordinates:Wi,flatten:$i,attributes:Wc,children:ac,cdata:fc,detect:Si},uc,za,pc,Bc,Ia,wc);var Xa={SVG:Ha},$a={SVG:Ha},Wa={},Ya={stroke:"black"},Ka={},Ja={m:{stroke:"red"},v:{stroke:"blue"},f:{stroke:"lightgray"}},Qa={B:gi,b:gi,M:mi,m:mi,V:hi,v:hi,F:yi,f:yi,U:bi,u:bi},eu={B:"b",b:"b",M:"m",m:"m",V:"v",v:"v",F:"f",f:"f",U:"u",u:"u"},tu=function edges_assignment_indices(e){var t={u:[],f:[],v:[],m:[],b:[]},n=e.edges_assignment.map((function(e){return eu[e]}));return e.edges_vertices.map((function(e,t){return n[t]||"u"})).forEach((function(e,n){return t[e].push(n)})),t},nu=function edges_path_data(e){return function edges_coords(e){var t=e.vertices_coords,n=e.edges_vertices;return t&&n?n.map((function(e){return e.map((function(e){return t[e]}))})):[]}(e).map((function(e){return function segment_to_path(e){return"M".concat(e[0][0]," ").concat(e[0][1],"L").concat(e[1][0]," ").concat(e[1][1])}(e)})).join("")},ru=function edges_path_data_assign(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_assignment;if(!t||!n)return{};if(!r)return{u:nu({vertices_coords:t,edges_vertices:n})};var o=tu({vertices_coords:t,edges_vertices:n,edges_assignment:r});return Object.keys(o).forEach((function(e){o[e]=nu({vertices_coords:t,edges_vertices:o[e].map((function(e){return n[e]}))})})),Object.keys(o).forEach((function(e){""===o[e]&&delete o[e]})),o},ou=function edges_paths_assign(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_assignment,o=ru({vertices_coords:t,edges_vertices:n,edges_assignment:r});return Object.keys(o).forEach((function(e){var t=$a.SVG.path(o[e]);t.setAttributeNS(null,xi,Qa[e]),o[e]=t})),o},iu=function apply_style(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).forEach((function(n){return e.setAttributeNS(null,n,t[n])}))},cu={SVG:Ha},au={back:{fill:"white"},front:{fill:"#ddd"}},uu={},su={stroke:"black","stroke-linejoin":"bevel"},fu={fill:"none"},lu=function apply_style(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).forEach((function(n){return e.setAttributeNS(null,n,t[n])}))},_u=function finalize_faces(e,t,n,r){var o=go(e),i=null!=e[Ei]&&e[Ei].length===e.faces_vertices.length,c=[["front"],["back"]],a=function get_faces_winding(e){return e.faces_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]})).map((function(e,t,n){return[e,n[(t+1)%n.length],n[(t+2)%n.length]]})).map((function(e){return Qn.core.cross2(Qn.core.subtract(e[1],e[0]),Qn.core.subtract(e[2],e[1]))})).reduce((function(e,t){return e+t}),0)}))}(e).map((function(e){return e<0}));return a.map((function(e){return e?c[0]:c[1]})).forEach((function(e,n){t[n].setAttributeNS(null,xi,e),lu(t[n],o?au[e]:uu[e]),lu(t[n],r[e])})),(i?function faces_sorted_by_layer(e){return e.map((function(e,t){return{layer:e,i:t}})).sort((function(e,t){return e.layer-t.layer})).map((function(e){return e.i}))}(e[Ei]).map((function(e){return t[e]})):t).forEach((function(e){return n.appendChild(e)})),Object.defineProperty(n,"front",{get:function get(){return t.filter((function(e,t){return a[t]}))}}),Object.defineProperty(n,"back",{get:function get(){return t.filter((function(e,t){return!a[t]}))}}),lu(n,o?su:fu),n},vu={SVG:Ha},pu={fill:"none"},du={stroke:"black",fill:"white"},gu=function apply_style(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(t).forEach((function(n){return e.setAttributeNS(null,n,t[n])}))},mu=function graph_classes(e){return[e.file_classes?e.file_classes:[],e.frame_classes?e.frame_classes:[]].reduce((function(e,t){return e.concat(t)}))},hu={SVG:Ha},yu={vertices:function vertices_circle(e){var t=e.vertices_coords,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Xa.SVG.g();if(!t)return r;t.map((function(e){return Xa.SVG.circle(e[0],e[1],.01)})).forEach((function(e){return r.appendChild(e)}));return r.setAttributeNS(null,"fill","none"),Object.keys(n).forEach((function(e){return r.setAttributeNS(null,e,n[e])})),r},edges:function edges_paths(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=go(e),r=ou(e),o=$a.SVG.g();return Object.keys(r).forEach((function(e){r[e].setAttributeNS(null,xi,Qa[e]),iu(r[e],n?Ka[e]:Ja[e]),iu(r[e],t[e]),iu(r[e],t[Qa[e]]),o.appendChild(r[e]),Object.defineProperty(o,Qa[e],{get:function get(){return r[e]}})})),iu(o,n?Wa:Ya),iu(o,t.stroke?{stroke:t.stroke}:{}),o},faces:function faces_draw_function(e,t){return null!=e.faces_vertices?function faces_vertices_polygon(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=cu.SVG.g();if(!e.vertices_coords||!e.faces_vertices)return n;var r=e.faces_vertices.map((function(t){return t.map((function(t){return[0,1].map((function(n){return e.vertices_coords[t][n]}))}))})).map((function(e){return cu.SVG.polygon(e)}));return r.forEach((function(e,t){return e.setAttributeNS(null,Ai,t)})),n.setAttributeNS(null,"fill","white"),_u(e,r,n,t)}(e,t):function faces_edges_polygon(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=cu.SVG.g();if(Mi in e==0||wi in e==0||ki in e==0)return n;var r=e.faces_edges.map((function(t){return t.map((function(t){return e.edges_vertices[t]})).map((function(e,t,n){var r=n[(t+1)%n.length];return e[1]===r[0]||e[1]===r[1]?e[0]:e[1]})).map((function(t){return[0,1].map((function(n){return e.vertices_coords[t][n]}))}))})).map((function(e){return cu.SVG.polygon(e)}));return r.forEach((function(e,t){return e.setAttributeNS(null,Ai,t)})),n.setAttributeNS(null,"fill","white"),_u(e,r,n,t)}(e,t)},boundaries:function boundaries_polygon(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=vu.SVG.g();if(!e.vertices_coords||!e.edges_vertices||!e.edges_assignment)return n;var r=Qr(e).vertices.map((function(t){return[0,1].map((function(n){return e.vertices_coords[t][n]}))}));if(0===r.length)return n;var o=vu.SVG.polygon(r);return o.setAttributeNS(null,xi,gi),n.appendChild(o),gu(n,go(e)?pu:du),Object.keys(t).forEach((function(e){return n.setAttributeNS(null,e,t[e])})),n}},bu=function draw_groups(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.parent?t.parent:hu.SVG.g(),r=["graph"].concat(mu(e)).join(" ");return n.setAttributeNS(null,xi,r),[di,pi,vi,_i].map((function(r){var o=t[r]||{},i=yu[r](e,o);return i.setAttributeNS(null,xi,r),Object.defineProperty(n,r,{get:function get(){return i}}),i})).filter((function(e){return e.childNodes.length>0})).forEach((function(e){return n.appendChild(e)})),n};[di,pi,vi,_i].forEach((function(e){bu[e]=function(){var t=yu[e].apply(yu,arguments);return t.setAttributeNS(null,xi,e),t}}));var xu=Object.assign(Object.create(null),{assign:Co,add_vertices:wo,add_vertices_split_edges:function add_vertices_split_edges(e,t){var n=wo(e,t),r=e.edges_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})),o=t.map((function(e){return r.map((function(t){return Qn.core.point_on_segment_exclusive(e,t[0],t[1])})).map((function(e,t){return e?t:void 0})).filter((function(e){return void 0!==e})).shift()})),i=o.filter((function(e){return void 0!==e})),c=o.map((function(e,t){return{e:e,i:t}})).filter((function(e){return void 0!==e.e})).map((function(t){var r=br(e,"edges",t.e);return[r,Qo(r)].map((function(r,o){return Object.assign(r,{edges_vertices:[e.edges_vertices[t.e][o],n[t.i]]})}))})).reduce((function(e,t){return e.concat(t)}),[]),a=yo.edges(e),u={new:{edges:[]}};return c.forEach((function(t,n){return Object.keys(t).forEach((function(r){void 0===e[r]&&(e[r]=[]),e[r][a+n]=t[r],u.new.edges[n]=a+n}))})),Ao(e,"edges",i),n},add_edges:ei,split_edge:ti,split_face:ni,flat_fold:fi,clean:li,get_circular_edges:Vo,get_duplicate_edges:Bo,get_duplicate_vertices:Ro,get_collinear_vertices:$o,count:yo,implied:kr,fragment:Jo,remove:Ao,populate:ko,subgraph:zo,explode_faces:function explode_faces(e){var t=e.faces_vertices.map((function(t){return t.map((function(t){return e.vertices_coords[t]}))})).reduce((function(e,t){return e.concat(t)}),[]),n=0,r=e.faces_vertices.map((function(e){return e.map((function(e){return n++}))}));return{vertices_coords:JSON.parse(JSON.stringify(t)),faces_vertices:r}},svg:bu},Jr,no,So,eo,Mr,ao,Ar,jr,fo,po,mo,Xo,Fo),Au=function list_function_params(e,t,n){switch(e){case"1":case"2":case 1:case 2:return t;case"3":case 3:return[n[0].vector,n[0].origin,n[1].vector,n[1].origin];case"4":case 4:return[n[0].vector,t[0]];case"5":case 5:return[n[0].vector,n[0].origin,t[0],t[1]];case"6":case 6:return[n[0].vector,n[0].origin,n[1].vector,n[1].origin,t[0],t[1]];case"7":case 7:return[n[0].vector,n[0].origin,n[1].vector,t[0]]}return[]},ku=function arrayify(e,t){switch(e){case"1":case 1:case"2":case 2:case"4":case 4:case"7":case 7:return[t];case"3":case 3:case"5":case 5:case"6":case 6:return t}},wu=function axiom(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.points?n.points.map((function(e){return Qn.core.get_vector(e)})):void 0,o=n.lines?n.lines.map((function(e){return Qn.core.get_line(e)})):void 0,i=(t=Qn.core)["axiom".concat(e)].apply(t,_toConsumableArray(Au(e,r,o)));return ku(e,i)},Mu=[null,1,2,3,4,5,6,7];delete Mu[0],Object.keys(Mu).forEach((function(e){wu[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return wu.apply(void 0,[e].concat(n))}}));var Eu=function line_line_for_arrows(e,t){return Qn.core.intersect_lines(e.vector,e.origin,t.vector,t.origin,Qn.core.include_l,Qn.core.include_l)},Ou=function reflect_point(e,t){var n=Qn.core.make_matrix2_reflect(e.vector,e.origin);return Qn.core.multiply_matrix2_vector2(n,t)},ju=function boundary_for_arrows(e){var t=e.vertices_coords;return Qn.core.convex_hull(t)},Cu=function widest_perp(e,t,n){var r=ju(e);if(void 0===n){var o,i=Qn.core.clip_line_in_convex_poly_exclusive(r,t.vector,t.origin);n=(o=Qn.core).midpoint.apply(o,_toConsumableArray(i))}var c=Qn.core.rotate270(t.vector),a=Qn.core.clip_line_in_convex_poly_exclusive(r,c,n).map((function(e){return Qn.core.distance(n,e)})).sort((function(e,t){return e-t})).shift(),u=Qn.core.scale(Qn.core.normalize(c),a);return Qn.segment(Qn.core.add(n,Qn.core.flip(u)),Qn.core.add(n,u))},Pu=function between_2_segments(e,t,n){var r,o=t.map((function(e){return Qn.core.midpoint(e[0],e[1])})),i=(r=Qn.line).fromPoints.apply(r,_toConsumableArray(o)),c=Qn.intersect(n,i),a=Qn.line(n.vector.rotate90(),c);return Qn.segment(e.lines.map((function(e){return Qn.intersect(e,a)})))},Su=[null,function axiom_1_arrows(e,t){return wu(1,e).map((function(e){return[Cu(t,e)]}))},function axiom_2_arrows(e){return[[Qn.segment(e.points)]]},function axiom_3_arrows(e,t){var n=ju(t),r=e.lines.map((function(e){return Qn.core.clip_line_in_convex_poly_exclusive(n,e.vector,e.origin)})),o=Qn.core.intersect_seg_seg_exclude(r[0][0],r[0][1],r[1][0],r[1][1]);return o?wu(3,e).map((function(t){return function between_2_intersecting_segments(e,t,n,r){var o=e.lines.map((function(e){return e.vector})),i=o.map(Qn.core.flip),c=o.concat(i).map((function(e){return Qn.ray(e,t)})),a=c.filter((function(e){return Qn.core.dot(e.vector,n.vector)>0&&Qn.core.cross2(e.vector,n.vector)>0})).shift(),u=c.filter((function(e){return Qn.core.dot(e.vector,n.vector)>0&&Qn.core.cross2(e.vector,n.vector)<0})).shift(),s=c.filter((function(e){return Qn.core.dot(e.vector,n.vector)<0&&Qn.core.cross2(e.vector,n.vector)>0})).shift(),l=c.filter((function(e){return Qn.core.dot(e.vector,n.vector)<0&&Qn.core.cross2(e.vector,n.vector)<0})).shift(),v=[a,u,s,l].map((function(e){return Qn.core.convex_poly_ray_exclusive(r,e.vector,e.origin).shift().shift()})),p=v.map((function(e){return Qn.core.distance(e,t)})),d=p[0]<p[1]?v[0]:v[1],g=p[0]<p[1]?Qn.core.add(u.origin,u.vector.normalize().scale(p[0])):Qn.core.add(a.origin,a.vector.normalize().scale(p[1])),m=p[2]<p[3]?v[2]:v[3],h=p[2]<p[3]?Qn.core.add(l.origin,l.vector.normalize().scale(p[2])):Qn.core.add(s.origin,s.vector.normalize().scale(p[3]));return[Qn.segment(d,g),Qn.segment(m,h)]}(e,o,t,n)})):[Pu(e,r,wu(3,e).filter((function(e){return void 0!==e})).shift())]},function axiom_4_arrows(e,t){return wu(4,e).map((function(n){return[Cu(t,n,Eu(n,e.lines[0]))]}))},function axiom_5_arrows(e){return wu(5,e).map((function(t){return[Qn.segment(e.points[1],Ou(t,e.points[1]))]}))},function axiom_6_arrows(e){return wu(6,e).map((function(t){return e.points.map((function(e){return Qn.segment(e,Ou(t,e))}))}))},function axiom_7_arrows(e,t){return wu(7,e).map((function(n){return[Qn.segment(e.points[0],Ou(n,e.points[0])),Cu(t,n,Eu(n,e.lines[1]))]}))}];delete Su[0];var zu=function axiom_arrows(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.points?t.points.map((function(e){return Qn.core.get_vector(e)})):void 0,r=t.lines?t.lines.map((function(e){return Qn.core.get_line(e)})):void 0,o=arguments.length,i=new Array(o>2?o-2:0),c=2;c<o;c++)i[c-2]=arguments[c];return Su[e].apply(Su,[{points:n,lines:r}].concat(i))};Object.keys(Su).forEach((function(e){zu[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return zu.apply(void 0,[e].concat(n))}}));var Nu=Object.assign(Object.create(null),{axiom_arrows:zu}),Iu=function maekawa_assignments(e){var t=function get_unassigned_indices(e){return e.map((function(e,t){return t})).filter((function(t){return"U"===e[t]||"u"===e[t]}))}(e),n=Array.from(Array(Math.pow(2,t.length))).map((function(e,t){return t.toString(2)})).map((function(e){return Array(t.length-e.length+1).join("0")+e})).map((function(e){return Array.from(e).map((function(e){return"0"===e?"V":"M"}))})).map((function(n){var r=e.slice();return t.forEach((function(e,t){r[e]=n[t]})),r})),r=n.map((function(e){return e.filter((function(e){return"M"===e||"m"===e})).length})),o=n.map((function(e){return e.filter((function(e){return"V"===e||"v"===e})).length}));return n.filter((function(e,t){return 2===Math.abs(r[t]-o[t])}))},qu={V:1,v:1,M:-1,m:-1},Lu=function upOrDown(e,t){return t%2==0?qu[e]:-qu[e]},Tu=function between(e,t,n){return t<n?e.slice(t+1,n):e.slice(n+1,t)},Fu=function get_sectors_layer(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Qn.core.EPSILON,r=0,o=e.map((function(e,t){return t%2==0?e:-e})).map((function(e){return r+=e})),i=o.map((function(e,t,n){return t%2==0?n[(t+n.length-1)%n.length]:e})).map((function(e){return e+n})),c=o.map((function(e,t,n){return t%2==0?e:n[(t+n.length-1)%n.length]})).map((function(e){return e-n})),a=function test(t){var n=[];t.forEach((function(e,t){n[e]=t}));for(var r=t.length+(t.length===e.length?0:-1),a=function _loop(e){var r=(e+1)%t.length,a=Tu(t,n[e],n[r]),u=a.map((function(t){return o[e]<i[t]})).reduce(No,!0),s=a.map((function(t){return o[e]>c[t]})).reduce(No,!0);if(!u&&!s)return{v:!1}},u=0;u<r;u+=1){var s=a(u);if("object"===_typeof(s))return s.v}return!0},u=function final_test(e){var n=vo(e);return n[0]>n[n.length-1]?"M"===t[0]:"V"===t[0]},s=function recurse(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(n=n.slice(0,o).concat([r],n.slice(o,n.length)),!a(n))return[];if(r>=e.length-1)return u(n)?[n]:[];var i=Lu(t[(r+1)%e.length],r),c=1===i?Array.from(Array(n.length-o)).map((function(e,t){return o+t+1})):Array.from(Array(o+1)).map((function(e,t){return t}));return c.map((function(e){return recurse(n,r+1,e)})).reduce((function(e,t){return e.concat(t)}),[]).map(vo)};return s()},Vu=function odd_assignment(e){for(var t=0,n=0,r=0;r<e.length;r+=1)"M"!==e[r]&&"m"!==e[r]||(t+=1),"V"!==e[r]&&"v"!==e[r]||(n+=1);for(var o=0;o<e.length;o+=1){if(t>n&&("V"===e[o]||"v"===e[o]))return o;if(n>t&&("M"===e[o]||"m"===e[o]))return o}},Bu=function alternating_sum(e){return[0,1].map((function(t){return e.filter((function(e,n){return n%2===t})).reduce(Lo,0)}))},Gu=function kawasaki_solutions_radians(e){return e.map((function(e,t,n){return[e,n[(t+1)%n.length]]})).map((function(e){var t;return(t=Qn.core).counter_clockwise_angle_radians.apply(t,_toConsumableArray(e))})).map((function(e,t,n){return n.slice(t+1,n.length).concat(n.slice(0,t))})).map((function(e){return Bu(e).map((function(e){return Math.PI-e}))})).map((function(t,n){return e[n]+t[0]})).map((function(t,n){return Qn.core.is_counter_clockwise_between(t,e[n],e[(n+1)%e.length])?t:void 0}))},Ru=Object.freeze({__proto__:null,alternating_sum:Bu,alternating_sum_difference:function alternating_sum_difference(e){var t=e.reduce(Lo,0)/2;return Bu(e).map((function(e){return e-t}))},kawasaki_solutions_radians:Gu,kawasaki_solutions:function kawasaki_solutions(e){var t=e.map((function(e){return Math.atan2(e[1],e[0])}));return Gu(t).map((function(e){return void 0===e?void 0:[Math.cos(e),Math.sin(e)]}))}}),Du=Object.assign(Object.create(null),{maekawa_assignments:Iu,sectors_layer:Fu,layer_solver:function layer_solver(e,t){null==t&&(t=e.map((function(){return"U"})));var n=Iu(t),r=n.map((function(t){return Fu(e,t)}));return n.map((function(e,t){return t})).filter((function(e){return r[e].length>0})).map((function(e){return{assignment:n[e],layer:r[e]}}))},fold_angles4:function single_vertex_fold_angles(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Vu(t);if(void 0!==r){var o=e[(r+1)%e.length],i=e[(r+2)%e.length],c=Math.PI*n,a=-Math.cos(o)*Math.cos(i)+Math.sin(o)*Math.sin(i)*Math.cos(Math.PI-c),u=Math.cos(Math.PI-c)-Math.pow(Math.sin(Math.PI-c),2)*Math.sin(o)*Math.sin(i)/(1-a),s=-Math.acos(u)+Math.PI;return r%2==0?[s,c,s,c].map((function(e,t){return r===t?-e:e})):[c,s,c,s].map((function(e,t){return r===t?-e:e}))}}},Ru),Uu=Object.create(null),Zu=function vertex_degree(e,t){var n=this;Object.defineProperty(e,"degree",{get:function get(){return n.vertices_vertices&&n.vertices_vertices[t]?n.vertices_vertices[t].length:null}})},Hu=function edge_coords(e,t){var n=this;Object.defineProperty(e,"coords",{get:function get(){if(n.edges_vertices&&n.edges_vertices[t]&&n.vertices_coords)return n.edges_vertices[t].map((function(e){return n.vertices_coords[e]}))}})},Xu=function face_simple(e,t){var n=this;Object.defineProperty(e,"simple",{get:function get(){if(!n.faces_vertices||!n.faces_vertices[t])return null;for(var r=0;r<e.length-1;r+=1)for(var o=r+1;o<e.length;o+=1)if(n.faces_vertices[t][r]===n.faces_vertices[t][o])return!1;return!0}})},$u=function face_coords(e,t){var n=this;Object.defineProperty(e,"coords",{get:function get(){if(n.faces_vertices&&n.faces_vertices[t]&&n.vertices_coords)return n.faces_vertices[t].map((function(e){return n.vertices_coords[e]}))}})},Wu={vertices:function setup_vertex(e,t){return Zu.call(this,e,t),e},edges:function setup_edge(e,t){return Hu.call(this,e,t),e},faces:function setup_face(e,t){return Xu.call(this,e,t),$u.call(this,e,t),e}},Yu={};Yu.prototype=Object.create(Object.prototype),Yu.prototype.constructor=Yu;var Ku=Object.assign({clean:li,populate:ko,fragment:Jo,subgraph:zo,assign:Co,svg:bu},So);Object.keys(Ku).forEach((function(e){Yu.prototype[e]=function(){return Ku[e].apply(Ku,[this].concat(Array.prototype.slice.call(arguments)))}})),Yu.prototype.copy=function(){return Object.assign(Object.create(Yu.prototype),Qo(this))},Yu.prototype.load=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"object"===_typeof(e)&&(!0!==n.append&&or.forEach((function(e){return delete t[e]})),Object.assign(this,{file_spec:tr,file_creator:nr},Qo(e)))},Yu.prototype.clear=function(){var e=this;rr.graph.forEach((function(t){return delete e[t]})),rr.orders.forEach((function(t){return delete e[t]})),delete this.file_frames};var Ju=function shortenKeys(e,t,n){var r=this,o=Object.create(null);return Object.keys(e).forEach((function(t){o[t.substring(r.length+1)]=e[t]})),o},Qu=function getComponent(e){return yr(this,e).map(Ju.bind(e)).map(Wu[e].bind(this))};["vertices","edges","faces"].forEach((function(e){return Object.defineProperty(Yu.prototype,e,{get:function get(){return Qu.call(this,e)}})})),Object.defineProperty(Yu.prototype,"junctions",{get:function get(){return Tr(this).map((function(e){return Qn.junction.apply(Qn,_toConsumableArray(e))}))}}),Object.defineProperty(Yu.prototype,"boundary",{get:function get(){var e=this,t=Qr(this),n=Qn.polygon(t.vertices.map((function(t){return e.vertices_coords[t]})));return Object.keys(t).forEach((function(e){n[e]=t[e]})),n}});var es={vertices:ro,edges:oo,faces:io},ts=function nearestElement(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=(t=Qn.core).get_vector.apply(t,r),c=es[e](this,i),a=br(this,e,c);return Wu[e].call(this,a,c),a.index=c,a};Yu.prototype.nearest=function(){var e=arguments,t=this,n=Object.create(null);return["vertices","edges","faces"].forEach((function(r){return Object.defineProperty(n,lr[r],{get:function get(){return ts.call.apply(ts,[t,r].concat(_toConsumableArray(e)))}})})),n};var ns=Yu.prototype,rs={};rs.prototype=Object.create(ns),rs.prototype.constructor=rs;rs.prototype.copy=function(){return Object.assign(Object.create(rs.prototype),Qo(this))};var os=function edges_array(e){var t=this;return e.mountain=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-180;return e.forEach((function(e){t.edges_assignment[e]="M",t.edges_foldAngle[e]=n})),e},e.valley=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:180;return e.forEach((function(e){t.edges_assignment[e]="V",t.edges_foldAngle[e]=n})),e},e.flat=function(){return e.forEach((function(e){t.edges_assignment[e]="F",t.edges_foldAngle[e]=0})),e},e};["line","ray","segment"].forEach((function(e){rs.prototype[e]=function(){var t=Qn[e].apply(Qn,arguments);if(t){var n=to(this,t);if(n){var r=wo(this,n),o=ei(this,r),i=Jo(this).edges.map;return ko(this),os.call(this,o.map((function(e){return i[e]})).reduce((function(e,t){return e.concat(t)}),[]))}}}})),["circle","ellipse","rect","polygon"].forEach((function(e){rs.prototype[e]=function(){var t=this,n=Qn[e].apply(Qn,arguments);if(n){var r=n.segments(96).map((function(e){return Qn.segment(e)})).map((function(e){return to(t,e)})).filter((function(e){return void 0!==e}));if(r){var o=[],i=[];r.forEach((function(e){var n=wo(t,e);o.push.apply(o,_toConsumableArray(n)),i.push.apply(i,_toConsumableArray(ei(t,n)))}));var c=Jo(this).edges.map;return ko(this),os.call(this,i.map((function(e){return c[e]})).reduce((function(e,t){return e.concat(t)}),[]))}}}}));var is=rs.prototype,cs={};cs.prototype=Object.create(ns),cs.prototype.constructor=cs,cs.prototype.flatFold=function(){var e=this,t=Qn.core.get_line(arguments),n=fi(this,t.vector,t.origin);return[ir,cr,ar].map((function(t){return mr(e,t)})).reduce(Io,[]).forEach((function(t){return delete e[t]})),Object.assign(this,n),this},cs.prototype.copy=function(){return Object.assign(Object.create(cs.prototype),Qo(this))},cs.prototype.folded=function(){var e=Vr(this);return Object.assign(Object.create(cs.prototype),Object.assign(Qo(this),{vertices_coords:e},{frame_classes:["foldedForm"]}))};var as=cs.prototype,us=function make_polygon_vertices(e){return 4===e?[[0,0],[1,0],[1,1],[0,1]]:Qn.core.make_regular_polygon(e,.5/Math.sin(Math.PI/e))},ss={},fs=[null,null,null,"triangle","square","pentagon","hexagon","heptagon","octogon","nonagon","decagon","hendecagon","dodecagon"];[0,1,2].forEach((function(e){delete fs[e]}));var ls=function create_init(e){return ko(e)};fs.forEach((function(e,t){var n=Array.from(Array(t));ss[e]=function(){return ls({vertices_coords:us(t),edges_vertices:n.map((function(e,t){return[t,(t+1)%n.length]})),edges_assignment:n.map((function(){return"B"}))})}})),ss.rectangle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return ls({vertices_coords:[[0,0],[0,e],[e,t],[0,t]],edges_vertices:Array.from(Array(4)).map((function(e,t,n){return[t,(t+1)%n.length]})),edges_assignment:Array.from(Array(4)).map((function(){return"B"}))})},ss.circle=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:90;return ls({vertices_coords:Qn.core.make_regular_polygon(e,1),edges_vertices:Array.from(Array(e)).map((function(e,t,n){return[t,(t+1)%n.length]})),edges_assignment:Array.from(Array(e)).map((function(){return"B"}))})},ss.kite=function(){return ls({vertices_coords:[[0,0],[Math.sqrt(2)-1,0],[1,0],[1,1-(Math.sqrt(2)-1)],[1,1],[0,1]],edges_vertices:[[0,1],[1,2],[2,3],[3,4],[4,5],[5,0],[5,1],[3,5],[5,2]],edges_assignment:["B","B","B","B","B","B","V","V","F"]})};var _s={axioms:{ar:[null,"اصنع خطاً يمر بنقطتين","اصنع خطاً عن طريق طي نقطة واحدة إلى أخرى","اصنع خطاً عن طريق طي خط واحد على آخر","اصنع خطاً يمر عبر نقطة واحدة ويجعل خطاً واحداً فوق نفسه","اصنع خطاً يمر بالنقطة الأولى ويجعل النقطة الثانية على الخط","اصنع خطاً يجلب النقطة الأولى إلى الخط الأول والنقطة الثانية إلى الخط الثاني","اصنع خطاً يجلب نقطة إلى خط ويجعل خط ثاني فوق نفسه"],de:[null,"Falte eine Linie durch zwei Punkte","Falte zwei Punkte aufeinander","Falte zwei Linien aufeinander","Falte eine Linie auf sich selbst, falte dabei durch einen Punkt","Falte einen Punkt auf eine Linie, falte dabei durch einen anderen Punkt","Falte einen Punkt auf eine Linie und einen weiteren Punkt auf eine weitere Linie","Falte einen Punkt auf eine Linie und eine weitere Linie in sich selbst zusammen"],en:[null,"fold a line through two points","fold two points together","fold two lines together","fold a line on top of itself, creasing through a point","fold a point to a line, creasing through another point","fold a point to a line and another point to another line","fold a point to a line and another line onto itself"],es:[null,"dobla una línea entre dos puntos","dobla dos puntos juntos","dobla y une dos líneas","dobla una línea sobre sí misma, doblándola hacia un punto","dobla un punto hasta una línea, doblándola a través de otro punto","dobla un punto hacia una línea y otro punto hacia otra línea","dobla un punto hacia una línea y otra línea sobre sí misma"],fr:[null,"créez un pli passant par deux points","pliez pour superposer deux points","pliez pour superposer deux lignes","rabattez une ligne sur elle-même à l'aide d'un pli qui passe par un point","rabattez un point sur une ligne à l'aide d'un pli qui passe par un autre point","rabattez un point sur une ligne et un autre point sur une autre ligne","rabattez un point sur une ligne et une autre ligne sur elle-même"],hi:[null,"एक क्रीज़ बनाएँ जो दो स्थानों से गुजरता है","एक स्थान को दूसरे स्थान पर मोड़कर एक क्रीज़ बनाएँ","एक रेखा पर दूसरी रेखा को मोड़कर क्रीज़ बनाएँ","एक क्रीज़ बनाएँ जो एक स्थान से गुजरता है और एक रेखा को स्वयं के ऊपर ले आता है","एक क्रीज़ बनाएँ जो पहले स्थान से गुजरता है और दूसरे स्थान को रेखा पर ले आता है","एक क्रीज़ बनाएँ जो पहले स्थान को पहली रेखा पर और दूसरे स्थान को दूसरी रेखा पर ले आता है","एक क्रीज़ बनाएँ जो एक स्थान को एक रेखा पर ले आता है और दूसरी रेखा को स्वयं के ऊपर ले आता है"],jp:[null,"2点に沿って折り目を付けます","2点を合わせて折ります","2つの線を合わせて折ります","点を通過させ、既にある線に沿って折ります","点を線沿いに合わせ別の点を通過させ折ります","線に向かって点を折り、同時にもう一方の線に向かってもう一方の点を折ります","線に向かって点を折り、同時に別の線をその上に折ります"],ko:[null,"두 점을 통과하는 선으로 접으세요","두 점을 함께 접으세요","두 선을 함께 접으세요","그 위에 선을 접으면서 점을 통과하게 접으세요","점을 선으로 접으면서, 다른 점을 지나게 접으세요","점을 선으로 접고 다른 점을 다른 선으로 접으세요","점을 선으로 접고 다른 선을 그 위에 접으세요"],ms:[null,"lipat garisan melalui dua titik","lipat dua titik bersama","lipat dua garisan bersama","lipat satu garisan di atasnya sendiri, melipat melalui satu titik","lipat satu titik ke garisan, melipat melalui titik lain","lipat satu titik ke garisan dan satu lagi titik ke garisan lain","lipat satu titik ke garisan dan satu lagi garisan di atasnya sendiri"],pt:[null,"dobre uma linha entre dois pontos","dobre os dois pontos para uni-los","dobre as duas linhas para uni-las","dobre uma linha sobre si mesma, criando uma dobra ao longo de um ponto","dobre um ponto até uma linha, criando uma dobra ao longo de outro ponto","dobre um ponto até uma linha e outro ponto até outra linha","dobre um ponto até uma linha e outra linha sobre si mesma"],ru:[null,"сложите линию через две точки","сложите две точки вместе","сложите две линии вместе","сверните линию сверху себя, сгибая через точку","сложите точку в линию, сгибая через другую точку","сложите точку в линию и другую точку в другую линию","сложите точку в линию и другую линию на себя"],tr:[null,"iki noktadan geçen bir çizgi boyunca katla","iki noktayı birbirine katla","iki çizgiyi birbirine katla","bir noktadan kıvırarak kendi üzerindeki bir çizgi boyunca katla","başka bir noktadan kıvırarak bir noktayı bir çizgiye katla","bir noktayı bir çizgiye ve başka bir noktayı başka bir çizgiye katla","bir noktayı bir çizgiye ve başka bir çizgiyi kendi üzerine katla"],vi:[null,"tạo một nếp gấp đi qua hai điểm","tạo nếp gấp bằng cách gấp một điểm này sang điểm khác","tạo nếp gấp bằng cách gấp một đường lên một đường khác","tạo một nếp gấp đi qua một điểm và đưa một đường lên trên chính nó","tạo một nếp gấp đi qua điểm đầu tiên và đưa điểm thứ hai lên đường thẳng","tạo một nếp gấp mang điểm đầu tiên đến đường đầu tiên và điểm thứ hai cho đường thứ hai","tạo một nếp gấp mang lại một điểm cho một đường và đưa một đường thứ hai lên trên chính nó"],zh:[null,"通過兩點折一條線","將兩點折疊起來","將兩條線折疊在一起","通過一個點折疊一條線在自身上面","將一個點，通過另一個點折疊成一條線，","將一個點折疊為一條線，再將另一個點折疊到另一條線","將一個點折疊成一條線，另一條線折疊到它自身上"]},folds:{es:{fold:{verb:"",noun:"doblez"},valley:"doblez de valle",mountain:"doblez de montaña",inside:"",outside:"",open:"",closed:"",rabbit:"",rabbit2:"",petal:"",squash:"",flip:"dale la vuelta a tu papel"},en:{fold:{verb:"fold",noun:"crease"},valley:"valley fold",mountain:"mountain fold",inside:"inside reverse fold",outside:"outside reverse fold",open:"open sink",closed:"closed sink",rabbit:"rabbit ear fold",rabbit2:"double rabbit ear fold",petal:"petal fold",squash:"squash fold",flip:"flip over"},zh:{fold:{verb:"",noun:""},valley:"谷摺",mountain:"山摺",inside:"內中割摺",outside:"外中割摺",open:"開放式沉壓摺",closed:"封閉式沉壓摺",rabbit:"兔耳摺",rabbit2:"雙兔耳摺",petal:"花瓣摺",blintz:"坐墊基",squash:"壓摺",flip:""}}},vs=function(){var n={};if(t){var r=require("xmldom"),o=r.DOMParser,i=r.XMLSerializer;n.DOMParser=o,n.XMLSerializer=i,n.document=(new o).parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else e&&(n=window);return n}(),ps=function make_edge_cylinder(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(Qn.core.mag_squared(t)<Qn.core.EPSILON)return[];for(var o=Qn.core.normalize(t),i=[[1,0,0],[0,1,0],[0,0,1]].map((function(e){return Qn.core.cross3(e,o)})).sort((function(e,t){return Qn.core.magnitude(t)-Qn.core.magnitude(e)})).shift(),c=[Qn.core.normalize(i)],a=1;a<4;a+=1)c.push(Qn.core.cross3(c[a-1],o));var u=c.map((function(e){return Qn.core.scale(e,n)})),s=[-r,r].map((function(e){return Qn.core.scale(o,e)})),l=0===r?e:e.map((function(e,t){return Qn.core.add(e,s[t])}));return l.map((function(e){return u.map((function(t){return Qn.core.add(e,t)}))})).reduce(Io,[])},ds=Object.freeze({__proto__:null,make_faces_geometry:function make_faces_geometry(e){var t=vs.THREE,n=e.vertices_coords.map((function(e){return[e[0],e[1],e[2]||0]})).reduce(Io,[]),r=e.vertices_coords.map((function(e){return[0,0,1]})).reduce(Io,[]),o=e.vertices_coords.map((function(e){return[1,1,1]})).reduce(Io,[]),i=e.faces_vertices.map((function(e){return e.map((function(e,t,n){return[n[0],n[t+1],n[t+2]]})).slice(0,e.length-2)})).reduce(Io,[]).reduce(Io,[]),c=new t.BufferGeometry;return c.setAttribute("position",new t.Float32BufferAttribute(n,3)),c.setAttribute("normal",new t.Float32BufferAttribute(r,3)),c.setAttribute("color",new t.Float32BufferAttribute(o,3)),c.setIndex(i),c},make_edges_geometry:function make_edges_geometry(e){var t=e.vertices_coords,n=e.edges_vertices,r=e.edges_assignment,o=e.edges_coords,i=e.edges_vector,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.002,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=vs.THREE;o||(o=n.map((function(e){return e.map((function(e){return t[e]}))}))),i||(i=o.map((function(e){return Qn.core.subtract(e[1],e[0])}))),o=o.map((function(e){return e.map((function(e){return Qn.core.resize(3,e)}))})),i=i.map((function(e){return Qn.core.resize(3,e)}));var s={B:[0,0,0],M:[0,0,0],F:[0,0,0],V:[0,0,0]},l=r.map((function(e){return[s[e],s[e],s[e],s[e],s[e],s[e],s[e],s[e]]})).reduce(Io,[]).reduce(Io,[]).reduce(Io,[]),v=o.map((function(e,t){return ps(e,i[t],c,a)})).reduce(Io,[]).reduce(Io,[]),p=i.map((function(e){if(Qn.core.mag_squared(e)<Qn.core.EPSILON)throw"degenerate edge";var t=Qn.core.normalize(e),n=(Qn.core.scale(t,c),Qn.core.scale(Qn.core.normalize(Qn.core.cross3(e,[0,0,-1])),c)),r=Qn.core.scale(Qn.core.normalize(Qn.core.cross3(e,[0,0,1])),c);return[n,[-n[2],n[1],n[0]],r,[-r[2],r[1],r[0]],n,[-n[2],n[1],n[0]],r,[-r[2],r[1],r[0]]]})).reduce(Io,[]).reduce(Io,[]),d=o.map((function(e,t){return[8*t+0,8*t+4,8*t+1,8*t+1,8*t+4,8*t+5,8*t+1,8*t+5,8*t+2,8*t+2,8*t+5,8*t+6,8*t+2,8*t+6,8*t+3,8*t+3,8*t+6,8*t+7,8*t+3,8*t+7,8*t+0,8*t+0,8*t+7,8*t+4,8*t+0,8*t+1,8*t+3,8*t+1,8*t+2,8*t+3,8*t+5,8*t+4,8*t+7,8*t+7,8*t+6,8*t+5]})).reduce(Io,[]),g=new u.BufferGeometry;return g.setAttribute("position",new u.Float32BufferAttribute(v,3)),g.setAttribute("normal",new u.Float32BufferAttribute(p,3)),g.setAttribute("color",new u.Float32BufferAttribute(l,3)),g.setIndex(d),g.computeVertexNormals(),g}}),gs=function reflect_point(e,t){var n=Qn.core.make_matrix2_reflect(e.vector,e.origin);return Qn.core.multiply_matrix2_vector2(n,t)},ms=function test_axiom1_2(e,t){return[e.points.map((function(e){return Qn.core.point_in_convex_poly_inclusive(e,t)})).reduce((function(e,t){return e&&t}),!0)]},hs=[null,ms,ms,function test_axiom3(e,t){var n=e.lines.map((function(e){return Qn.core.clip_line_in_convex_poly_inclusive(t,e.vector,e.origin)}));return void 0===n[0]||void 0===n[1]?[!1,!1]:Qn.core.axiom3(e.lines[0].vector,e.lines[0].origin,e.lines[1].vector,e.lines[1].origin).map((function(e,t){return void 0===e?void 0:[gs(e,n[0][0]),gs(e,n[0][1])]})).map((function(e){return void 0===e?void 0:Qn.core.point_on_segment_inclusive(e[0],n[1][0],n[1][1])||Qn.core.point_on_segment_inclusive(e[1],n[1][0],n[1][1])||Qn.core.point_on_segment_inclusive(n[1][0],e[0],e[1])||Qn.core.point_on_segment_inclusive(n[1][1],e[0],e[1])}))},function test_axiom4(e,t){var n=Qn.core.intersect_lines(e.lines[0].vector,e.lines[0].origin,Qn.core.rotate90(e.lines[0].vector),e.points[0],Qn.core.include_l,Qn.core.include_l);return[[e.points[0],n].map((function(e){return Qn.core.point_in_convex_poly_inclusive(e,t)})).reduce((function(e,t){return e&&t}),!0)]},function test_axiom5(e,t){var n=Qn.core.axiom5(e.lines[0].vector,e.lines[0].origin,e.points[0],e.points[1]);if(0===n.length)return[];var r=e.points.map((function(e){return Qn.core.point_in_convex_poly_inclusive(e,t)})).reduce((function(e,t){return e&&t}),!0);return n.map((function(t){return gs(t,e.points[1])})).map((function(e){return Qn.core.point_in_convex_poly_inclusive(e,t)})).map((function(e){return e&&r}))},function test_axiom6(e,t){var n=Qn.core.axiom6(e.lines[0].vector,e.lines[0].origin,e.lines[1].vector,e.lines[1].origin,e.points[0],e.points[1]);if(0===n.length)return[];if(!e.points.map((function(e){return Qn.core.point_in_convex_poly_inclusive(e,t)})).reduce((function(e,t){return e&&t}),!0))return n.map((function(){return!1}));var r=n.map((function(t){return gs(t,e.points[0])})).map((function(e){return Qn.core.point_in_convex_poly_inclusive(e,t)})),o=n.map((function(t){return gs(t,e.points[1])})).map((function(e){return Qn.core.point_in_convex_poly_inclusive(e,t)}));return n.map((function(e,t){return r[t]&&o[t]}))},function test_axiom7(e,t){var n=Qn.core.point_in_convex_poly_inclusive(e.points[0],t),r=Qn.core.axiom7(e.lines[0].vector,e.lines[0].origin,e.lines[1].vector,e.points[0]),o=gs(r,e.points[0]),i=Qn.core.point_in_convex_poly_inclusive(o,t),c=void 0!==Qn.core.convex_poly_line_inclusive(t,e.lines[1].vector,e.lines[1].origin);return[n&&i&&c]}];delete hs[0];var ys=function test_axiom(e,t,n){var r="object"===_typeof(n)&&n.vertices_coords?Qr(n).vertices.map((function(e){return n.vertices_coords[e]})):n;return hs[e](t,r)};Object.keys(hs).forEach((function(e){ys[e]=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ys.apply(void 0,[e].concat(n))}}));var bs={graph:ns,cp:is,origami:as},xs={graph:function graph(){return{}},cp:ss.square,origami:ss.square};Object.keys(bs).forEach((function(e){Uu[e]=function(){var t=Array.from(arguments).filter((function(e){return xr(e)})).map((function(e){return JSON.parse(JSON.stringify(e))}));return Object.assign.apply(Object,[Object.create(bs[e]),t.length?{}:xs[e]()].concat(_toConsumableArray(t),[{file_spec:tr,file_creator:nr}]))},Uu[e].prototype=bs[e],Uu[e].prototype.constructor=Uu[e],Object.keys(ss).forEach((function(t){Uu[e][t]=function(){return Uu[e](ss[t].apply(ss,arguments))}}))})),Object.assign(Uu.graph,xu),wu.test=ys;var As=Object.assign(er,Uu,{math:Qn.core,axiom:wu,diagram:Nu,single:Du,text:_s,webgl:ds});return Object.defineProperty(As,"use",{enumerable:!1,value:function use(e){null!=e&&"function"==typeof e.linker&&e.linker(this)}.bind(As)}),Object.keys(Qn).filter((function(e){return"core"!==e})).forEach((function(e){As[e]=Qn[e]})),Ha.use(As),As.use(Ha),As}));
