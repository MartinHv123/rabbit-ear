/* Rabbit Ear v0.1.91 (c) Robby Kraft, MIT License */(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.RabbitEar=t()})(this,function(){'use strict';var Me=Math.tan,Ce=Math.floor,Oe=Math.acos,Be=Math.min,Fe=Math.max,Ie=Math.PI,ze=Math.abs,Ve=Math.sin,De=Math.cos,Te=Math.atan2,qe=Math.sqrt,Re=Math.pow;function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){return s(e)||o(e,t)||c()}function n(e){return r(e)||a(e)||d()}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function s(e){if(Array.isArray(e))return e}function a(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function o(e,t){var i=[],n=!0,r=!1,s=void 0;try{for(var a=e[Symbol.iterator](),o;!(n=(o=a.next()).done)&&(i.push(o.value),!(t&&i.length===t));n=!0);}catch(e){r=!0,s=e}finally{try{n||null==a["return"]||a["return"]()}finally{if(r)throw s}}return i}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function l(t){return l="function"==typeof Symbol&&"symbol"===e(Symbol.iterator)?function(t){return e(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":e(t)},l(t)}function g(e,t){return _(e)||u(e,t)||v()}function f(e){return p(e)||h(e)||m()}function p(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function _(e){if(Array.isArray(e))return e}function h(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function u(e,t){var i=[],n=!0,r=!1,s=void 0;try{for(var a=e[Symbol.iterator](),o;!(n=(o=a.next()).done)&&(i.push(o.value),!(t&&i.length===t));n=!0);}catch(e){r=!0,s=e}finally{try{n||null==a["return"]||a["return"]()}finally{if(r)throw s}}return i}function m(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function v(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function k(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return vt(t)}function w(){var e=Array.from(arguments),t=e.filter(function(e){return!isNaN(e)}),i=e.filter(function(e){return e.constructor===Array});if(0==e.length)return{vector:[],point:[]};if(!isNaN(e[0])&&4<=t.length)return{point:[e[0],e[1]],vector:[e[2],e[3]]};if(0<i.length){if(1===i.length)return w.apply(void 0,f(i[0]));if(2===i.length)return{point:[i[0][0],i[0][1]],vector:[i[1][0],i[1][1]]};if(4===i.length)return{point:[i[0],i[1]],vector:[i[2],i[3]]}}if(e[0].constructor===Object){var n=[],r=[];return null==e[0].vector?null!=e[0].direction&&(n=mt(e[0].direction)):n=mt(e[0].vector),null==e[0].point?null!=e[0].origin&&(r=mt(e[0].origin)):r=mt(e[0].point),{point:r,vector:n}}return{point:[],vector:[]}}function E(){return w.apply(void 0,arguments)}function P(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];if(0!==t.length){if(1===t.length&&void 0!==t[0])return P.apply(void 0,f(t[0]));var n=Array.from(t),r=n.filter(function(e){return!isNaN(e)}),s=n.filter(function(e){return"object"===l(e)}).filter(function(e){return e.constructor===Array});return 4<=r.length?[[r[0],r[1]],[r[2],r[3]]]:2<=s.length&&!isNaN(s[0][0])?s:1!==s.length||isNaN(s[0][0][0])?void 0:s[0]}}function A(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return 0===t.length?void 0:1===t.length&&void 0!==t[0]?A.apply(void 0,f(t[0])):Array.from(t)}function N(e,t){var i=null==t?{}:t,n=function(e){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:wt;return this.compare_function(e,t)&&!0},r=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:wt;return this.compare_function(e,i)&&t>=-i},s=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:wt;return this.compare_function(e,i)&&t>=-i&&t<=1+i};return Object.defineProperty(i,"isParallel",{value:function(e,t){if(null==e.vector)throw"line isParallel(): please ensure object contains a vector";var i=this.vector.length<e.vector.length,n=i?this.vector:e.vector,r=i?e.vector:this.vector;return Ct(n,r,t)}}),Object.defineProperty(i,"isDegenerate",{value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:wt;return Mt(this.vector,e)}}),Object.defineProperty(i,"nearestPoint",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=mt(t);return ji(wi(this.point,this.vector,n,this.clip_function))}}),Object.defineProperty(i,"reflection",{value:function(){return Mi.makeReflection(this.vector,this.point)}}),Object.defineProperty(i,"intersect",{value:function(e){var t=this;return $t(this.point,this.vector,e.point,e.vector,function(i,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:wt;return t.compare_function(i,r)&&e.compare_function(n,r)})}}),Object.defineProperty(i,"intersectLine",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=w(t);return $t(this.point,this.vector,r.point,r.vector,n.bind(this))}}),Object.defineProperty(i,"intersectRay",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=E(t);return $t(this.point,this.vector,n.point,n.vector,r.bind(this))}}),Object.defineProperty(i,"intersectEdge",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=k(t),r=[n[1][0]-n[0][0],n[1][1]-n[0][1]];return $t(this.point,this.vector,n[0],r,s.bind(this))}}),Object.freeze(i)}function L(e){var t={},i=e,n=function(){return vi(this.points)},r=function(){return this.points.map(function(e,t,i){return[i[(t+i.length-1)%i.length],i[t],i[(t+1)%i.length]]}).map(function(e){return Ii(e[1],e[2],e[0])})};return Object.defineProperty(t,"area",{value:n}),Object.defineProperty(t,"centroid",{value:function(){return yi(this.points)}}),Object.defineProperty(t,"midpoint",{value:function(){return He(this.points)}}),Object.defineProperty(t,"enclosingRectangle",{value:function(){return xi(this.points)}}),Object.defineProperty(t,"contains",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return Bt(mt(t),this.points)}}),Object.defineProperty(t,"nearest",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=mt(t),r=this.sides.map(function(e){return e.nearestPoint(n)}),s=1/0,a;return r.map(function(e){return Qe(n,e)}).forEach(function(e,t){e<s&&(s=e,a=t)}),{point:r[a],edge:this.sides[a]}}}),Object.defineProperty(t,"clipEdge",{value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=k(i),s=gi(this.points,r[0],r[1]);return void 0===s?void 0:Fi(s)}}),Object.defineProperty(t,"clipLine",{value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=w(i),s=ci(this.points,r.point,r.vector);return void 0===s?void 0:Fi(s)}}),Object.defineProperty(t,"clipRay",{value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=w(i),s=li(this.points,r.point,r.vector);return void 0===s?void 0:Fi(s)}}),Object.defineProperty(t,"split",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=w(t);return Ei(this.points,r.point,r.vector).map(function(e){return i(e)})}}),Object.defineProperty(t,"scale",{value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:yi(this.points),n=this.points.map(function(e){return[0,1].map(function(n,r){return e[r]-t[r]})}).map(function(n){return n.map(function(r,s){return t[s]+n[s]*e})});return i(n)}}),Object.defineProperty(t,"rotate",{value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:yi(this.points),n=this.points.map(function(i){var n=[i[0]-t[0],i[1]-t[1]],r=qe(Re(n[0],2)+Re(n[1],2)),s=Te(n[1],n[0]);return[t[0]+De(s+e)*r,t[1]+Ve(s+e)*r]});return i(n)}}),Object.defineProperty(t,"translate",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=mt(t),s=this.points.map(function(e){return e.map(function(e,t){return e+r[t]})});return i(s)}}),Object.defineProperty(t,"transform",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=kt(t),s=this.points.map(function(e){return ji(tt(e,r))});return i(s)}}),Object.defineProperty(t,"edges",{get:function(){return this.sides}}),Object.defineProperty(t,"sectors",{get:function(){return r()}}),Object.defineProperty(t,"signedArea",{value:n}),Object.freeze(t)}function j(t){return j="function"==typeof Symbol&&"symbol"===e(Symbol.iterator)?function(t){return e(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":e(t)},j(t)}function M(e,t){return F(e)||z(e,t)||D()}function C(e){return O(e)||I(e)||V()}function O(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function F(e){if(Array.isArray(e))return e}function I(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function z(e,t){var i=[],n=!0,r=!1,s=void 0;try{for(var a=e[Symbol.iterator](),o;!(n=(o=a.next()).done)&&(i.push(o.value),!(t&&i.length===t));n=!0);}catch(e){r=!0,s=e}finally{try{n||null==a["return"]||a["return"]()}finally{if(r)throw s}}return i}function V(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function D(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function T(e,t){for(var i=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").split("~::~"),n=i.length,r=!1,s=0,a="",o=null!=t&&"string"==typeof t?t:"\t",d=["\n"],c=0;100>c;c+=1)d.push(d[c]+o);for(var l=0;l<n;l+=1)-1<i[l].search(/<!/)?(a+=d[s]+i[l],r=!0,(-1<i[l].search(/-->/)||-1<i[l].search(/\]>/)||-1<i[l].search(/!DOCTYPE/))&&(r=!1)):-1<i[l].search(/-->/)||-1<i[l].search(/\]>/)?(a+=i[l],r=!1):/^<\w/.exec(i[l-1])&&/^<\/\w/.exec(i[l])&&/^<[\w:\-\.\,]+/.exec(i[l-1])==/^<\/[\w:\-\.\,]+/.exec(i[l])[0].replace("/","")?(a+=i[l],r||(s-=1)):-1<i[l].search(/<\w/)&&-1===i[l].search(/<\//)&&-1===i[l].search(/\/>/)?a=r?a+=i[l]:a+=d[s++]+i[l]:-1<i[l].search(/<\w/)&&-1<i[l].search(/<\//)?a=r?a+=i[l]:a+=d[s]+i[l]:-1<i[l].search(/<\//)?a=r?a+=i[l]:a+=d[--s]+i[l]:-1<i[l].search(/\/>/)?a=r?a+=i[l]:a+=d[s]+i[l]:a+=-1<i[l].search(/<\?/)?d[s]+i[l]:-1<i[l].search(/xmlns\:/)||-1<i[l].search(/xmlns\=/)?d[s]+i[l]:i[l];return"\n"===a[0]?a.slice(1):a}function q(e){var t=Yn(e),i={},n=function(e,i){if(null!=i){0<i.length&&e.preventDefault();var n=t.getPointer();i.forEach(function(e){return e(n)})}},r=function(e){var r=i[Gn.move];t.didMove(e.clientX,e.clientY),n(e,r)},s=function(e){var r=i[Gn.end];t.didRelease(),n(e,r)},a=function(t){var n=i[Gn.scroll],r={deltaX:t.deltaX,deltaY:t.deltaY,deltaZ:t.deltaZ};r.position=vn(p,t.clientX,t.clientY),r.x=r.position[0],r.y=r.position[1],null==n||(0<n.length&&t.preventDefault(),n.forEach(function(e){return e(r)}))},o=function(e){null!=_&&clearInterval(h),_=e,null!=_&&(u=0,h=setInterval(function(){var e={time:p.getCurrentTime(),frame:u++};_(e)},1e3/60))},d={mouseup:function(e){r(e);var s=i[Gn.end];t.didRelease(e.clientX,e.clientY),n(e,s)},mousedown:function(e){var r=i[Gn.begin];t.didPress(e.clientX,e.clientY),n(e,r)},mousemove:r,mouseleave:function(e){var r=i[Gn.leave];t.didMove(e.clientX,e.clientY),n(e,r)},mouseenter:function(e){var r=i[Gn.enter];t.didMove(e.clientX,e.clientY),n(e,r)},touchend:s,touchmove:function(e){var r=i[Gn.move],s=e.touches[0];null==s||(t.didMove(s.clientX,s.clientY),n(e,r))},touchstart:function(e){var r=i[Gn.begin],s=e.touches[0];null==s||(t.didPress(s.clientX,s.clientY),n(e,r))},touchcancel:s,wheel:a},c=function(e,t){if("function"!=typeof t)throw"must supply a function type to addEventListener";void 0===i[e]&&(i[e]=[]),i[e].push(t)},l=function(e){Object.keys(d).forEach(function(t){return e.addEventListener(t,d[t],!1)}),o(_)},g=function(e){Object.keys(d).forEach(function(t){return e.removeEventListener(t,d[t],!1)}),null!=_&&clearInterval(h)},f=function(e){null!=p&&"function"==typeof e.removeEventListener&&g(p),p=e,t.node=p,Object.keys(Gn).map(function(e){return Gn[e]}).forEach(function(e){Object.defineProperty(p,e,{set:function(t){c(e,t)}})}),Object.defineProperty(p,"animate",{set:function(e){o(e)}}),Object.defineProperty(p,"mouse",{get:function(){return t.getPointer()}}),Object.defineProperty(p,"pointer",{get:function(){return t.getPointer()}}),"function"==typeof p.addEventListener&&l(p)},p,_,h,u;return f(e),{setup:f,addEventListener:c,remove:function(){g(p)}}}function R(t){return R="function"==typeof Symbol&&"symbol"===e(Symbol.iterator)?function(t){return e(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":e(t)},R(t)}function X(e,t){return Y(e)||H(e,t)||Q()}function W(e){return G(e)||K(e)||Z()}function G(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function Y(e){if(Array.isArray(e))return e}function K(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function H(e,t){var i=[],n=!0,r=!1,s=void 0;try{for(var a=e[Symbol.iterator](),o;!(n=(o=a.next()).done)&&(i.push(o.value),!(t&&i.length===t));n=!0);}catch(e){r=!0,s=e}finally{try{n||null==a["return"]||a["return"]()}finally{if(r)throw s}}return i}function Z(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function Q(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function J(e,t){for(var i=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").split("~::~"),n=i.length,r=!1,s=0,a="",o=null!=t&&"string"==typeof t?t:"\t",d=["\n"],c=0;100>c;c+=1)d.push(d[c]+o);for(var l=0;l<n;l+=1)-1<i[l].search(/<!/)?(a+=d[s]+i[l],r=!0,(-1<i[l].search(/-->/)||-1<i[l].search(/\]>/)||-1<i[l].search(/!DOCTYPE/))&&(r=!1)):-1<i[l].search(/-->/)||-1<i[l].search(/\]>/)?(a+=i[l],r=!1):/^<\w/.exec(i[l-1])&&/^<\/\w/.exec(i[l])&&/^<[\w:\-\.\,]+/.exec(i[l-1])==/^<\/[\w:\-\.\,]+/.exec(i[l])[0].replace("/","")?(a+=i[l],r||(s-=1)):-1<i[l].search(/<\w/)&&-1===i[l].search(/<\//)&&-1===i[l].search(/\/>/)?a=r?a+=i[l]:a+=d[s++]+i[l]:-1<i[l].search(/<\w/)&&-1<i[l].search(/<\//)?a=r?a+=i[l]:a+=d[s]+i[l]:-1<i[l].search(/<\//)?a=r?a+=i[l]:a+=d[--s]+i[l]:-1<i[l].search(/\/>/)?a=r?a+=i[l]:a+=d[s]+i[l]:a+=-1<i[l].search(/<\?/)?d[s]+i[l]:-1<i[l].search(/xmlns\:/)||-1<i[l].search(/xmlns\=/)?d[s]+i[l]:i[l];return"\n"===a[0]?a.slice(1):a}function $(e,t){void 0===e["re:diagrams"]||0===e["re:diagrams"].length||Array.from(e["re:diagrams"]).forEach(function(i){if(!0=="re:diagram_lines"in i&&i["re:diagram_lines"].forEach(function(e){var i="re:diagram_line_classes"in e?e["re:diagram_line_classes"].join(" "):"valley",n=e["re:diagram_line_coords"];if(void 0!==n){var r=Us(n[0][0],n[0][1],n[1][0],n[1][1]);r.setAttribute("class",i),t.appendChild(r)}}),!0=="re:diagram_arrows"in i){var n=Ls(e),r=n[2]>n[3]?n[3]:n[2],s={length:.09*r,width:.035*r,strokeWidth:.02*r};i["re:diagram_arrows"].forEach(function(e){if(2===e["re:diagram_arrow_coords"].length){var i=e["re:diagram_arrow_coords"],n=i[0][0]<i[1][0];.1>ze(i[0][0]-i[1][0])&&(n=i[0][1]<i[1][1]?.5>i[0][0]:.5<i[0][0]),.1>ze(i[0][1]-i[1][1])&&(n=i[0][0]<i[1][0]?.5<i[0][1]:.5>i[0][1]),s.side=n;var r=Qs(i[0],i[1],s);t.appendChild(r)}})}})}function ee(e){return te(e)||ie(e)||ne()}function te(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function ie(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function ne(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function re(e){var t=[];return e.replace($a,function(e,i,n){var r=i.toLowerCase();for(n=se(n),"m"===r&&2<n.length&&(t.push([i].concat(n.splice(0,2))),r="l",i="m"===i?"l":"L");0<=n.length;){if(n.length===Ja[r])return n.unshift(i),t.push(n);if(n.length<Ja[r])throw new Error("malformed path data");t.push([i].concat(n.splice(0,Ja[r])))}}),t}function se(e){var t=e.match(eo);return t?t.map(Number):[]}function ae(e,t,i,n,r,s,a,o){return new oe(e,t,i,n,r,s,a,o)}function oe(e,t,n,r,s,a,o,d){this.a={x:e,y:t},this.b={x:n,y:r},this.c={x:s,y:a},this.d={x:o,y:d},null!==o&&void 0!==o&&null!==d&&void 0!==d?(this.getArcLength=i,this.getPoint=fe,this.getDerivative=ce):(this.getArcLength=pe,this.getPoint=ge,this.getDerivative=de),this.init()}function de(e,i,n){return{x:2*(1-n)*(e[1]-e[0])+2*n*(e[2]-e[1]),y:2*(1-n)*(i[1]-i[0])+2*n*(i[2]-i[1])}}function ce(e,i,n){var t=ge([3*(e[1]-e[0]),3*(e[2]-e[1]),3*(e[3]-e[2])],[3*(i[1]-i[0]),3*(i[2]-i[1]),3*(i[3]-i[2])],n);return t}function le(e,i,n,r,s){for(var a=1,o=e/i,d=(e-n(r,s,o))/i,c=0;.001<a;){var l=n(r,s,o+d),g=n(r,s,o-d),f=ze(e-l)/i,p=ze(e-g)/i;if(f<a?(a=f,o+=d):p<a?(a=p,o-=d):d/=2,c++,500<c)break}return o}function ge(e,i,n){var t=(1-n)*(1-n)*e[0]+2*(1-n)*n*e[1]+n*n*e[2],r=(1-n)*(1-n)*i[0]+2*(1-n)*n*i[1]+n*n*i[2];return{x:t,y:r}}function fe(e,i,n){var t=(1-n)*(1-n)*(1-n)*e[0]+3*(1-n)*(1-n)*n*e[1]+3*(1-n)*n*n*e[2]+n*n*n*e[3],r=(1-n)*(1-n)*(1-n)*i[0]+3*(1-n)*(1-n)*n*i[1]+3*(1-n)*n*n*i[2]+n*n*n*i[3];return{x:t,y:r}}function pe(e,i,n){var r=Math.log;void 0===n&&(n=1);var s=e[0]-2*e[1]+e[2],a=i[0]-2*i[1]+i[2],o=2*e[1]-2*e[0],d=2*i[1]-2*i[0],c=4*(s*s+a*a);if(0===c)return n*qe(Re(e[2]-e[0],2)+Re(i[2]-i[0],2));var l=4*(s*o+a*d)/(2*c),g=n+l,f=(o*o+d*d)/c-l*l,p=0<g*g+f?qe(g*g+f):0,_=0<l*l+f?qe(l*l+f):0,h=0===l+qe(l*l+f)?0:f*r(ze((g+p)/(l+_)));return qe(c)/2*(g*p-l*_+h)}function _e(e,t){return no[e][t]}function he(e,i,t){var r=t.length-1,n,s,a;if(0==r)return 0;if(0===e){for(s=0,a=0;a<=r;a++)s+=_e(r,a)*Re(1-i,r-a)*Re(i,a)*t[a];return s}for(n=Array(r),a=0;a<r;a++)n[a]=r*(t[a+1]-t[a]);return he(e-1,i,n)}function ue(e,i,n){var t=he(1,n,e),r=he(1,n,i);return qe(t*t+r*r)}function i(e,n,r){var s,a,o,d;void 0===r&&(r=1);for(s=r/2,a=0,o=0;20>o;o++)d=s*to[20][o]+s,a+=io[20][o]*ue(e,n,d);return s*a}function B(e,t,i,n,r,s,a,o,d){return new me(e,t,i,n,r,s,a,o,d)}function me(e,i,n,r,s,a,o,d,c){this.x0=e,this.y0=i,this.rx=n,this.ry=r,this.xAxisRotate=s,this.LargeArcFlag=a,this.SweepFlag=o,this.x1=d,this.y1=c;var t=ye(300,function(l){return ve({x:e,y:i},n,r,s,a,o,{x:d,y:c},l)});this.length=t.arcLength}function ve(e,i,n,r,s,a,o,d){i=ze(i),n=ze(n),r=xe(r,360);var t=ke(r);if(e.x===o.x&&e.y===o.y)return e;if(0===i||0===n)return this.pointOnLine(e,o,d);var c=(e.x-o.x)/2,l=(e.y-o.y)/2,g={x:De(t)*c+Ve(t)*l,y:-Ve(t)*c+De(t)*l},f=Re(g.x,2)/Re(i,2)+Re(g.y,2)/Re(n,2);1<f&&(i=qe(f)*i,n=qe(f)*n);var p=Re(i,2)*Re(n,2)-Re(i,2)*Re(g.y,2)-Re(n,2)*Re(g.x,2),_=Re(i,2)*Re(g.y,2)+Re(n,2)*Re(g.x,2),h=p/_;h=0>h?0:h;var u=(s===a?-1:1)*qe(h),m={x:u*(i*g.y/n),y:u*(-(n*g.x)/i)},v={x:De(t)*m.x-Ve(t)*m.y+(e.x+o.x)/2,y:Ve(t)*m.x+De(t)*m.y+(e.y+o.y)/2},y={x:(g.x-m.x)/i,y:(g.y-m.y)/n},x=Ee({x:1,y:0},y),k={x:(-g.x-m.x)/i,y:(-g.y-m.y)/n},b=Ee(y,k);!a&&0<b?b-=2*Ie:a&&0>b&&(b+=2*Ie),b%=2*Ie;var w=x+b*d,E=i*De(w),P=n*Ve(w),A={x:De(t)*E-Ve(t)*P+v.x,y:Ve(t)*E+De(t)*P+v.y};return A.ellipticalArcStartAngle=x,A.ellipticalArcEndAngle=x+b,A.ellipticalArcAngle=w,A.ellipticalArcCenter=v,A.resultantRx=i,A.resultantRy=n,A}function ye(e,n){e=e?e:500;for(var r=0,s=[],a=[],o=n(0),d=0,c,l;d<e;d++)l=we(d*(1/e),0,1),c=n(l),r+=be(o,c),a.push([o,c]),s.push({t:l,arcLength:r}),o=c;return c=n(1),a.push([o,c]),r+=be(o,c),s.push({t:1,arcLength:r}),{arcLength:r,arcLengthMap:s,approximationLines:a}}function xe(e,t){return(e%t+t)%t}function ke(e){return e*(Ie/180)}function be(e,t){return qe(Re(t.x-e.x,2)+Re(t.y-e.y,2))}function we(e,t,i){return Be(Fe(e,t),i)}function Ee(e,t){var i=e.x*t.x+e.y*t.y,r=qe((Re(e.x,2)+Re(e.y,2))*(Re(t.x,2)+Re(t.y,2))),n=0>e.x*t.y-e.y*t.x?-1:1,s=n*Oe(i/r);return s}function Pe(e,t,i,n){return new Ae(e,t,i,n)}function Ae(e,t,i,n){this.x0=e,this.x1=t,this.y0=i,this.y1=n}function Se(e){function t(e){if(!e)return null;for(var a=re(e),o=[0,0],d=[0,0],c=0,l,g;c<a.length;c++)"M"===a[c][0]?(o=[a[c][1],a[c][2]],g=[o[0],o[1]],s.push(null)):"m"===a[c][0]?(o=[a[c][1]+o[0],a[c][2]+o[1]],g=[o[0],o[1]],s.push(null)):"L"===a[c][0]?(n+=qe(Re(o[0]-a[c][1],2)+Re(o[1]-a[c][2],2)),s.push(new Pe(o[0],a[c][1],o[1],a[c][2])),o=[a[c][1],a[c][2]]):"l"===a[c][0]?(n+=qe(Re(a[c][1],2)+Re(a[c][2],2)),s.push(new Pe(o[0],a[c][1]+o[0],o[1],a[c][2]+o[1])),o=[a[c][1]+o[0],a[c][2]+o[1]]):"H"===a[c][0]?(n+=ze(o[0]-a[c][1]),s.push(new Pe(o[0],a[c][1],o[1],o[1])),o[0]=a[c][1]):"h"===a[c][0]?(n+=ze(a[c][1]),s.push(new Pe(o[0],o[0]+a[c][1],o[1],o[1])),o[0]=a[c][1]+o[0]):"V"===a[c][0]?(n+=ze(o[1]-a[c][1]),s.push(new Pe(o[0],o[0],o[1],a[c][1])),o[1]=a[c][1]):"v"===a[c][0]?(n+=ze(a[c][1]),s.push(new Pe(o[0],o[0],o[1],o[1]+a[c][1])),o[1]=a[c][1]+o[1]):"z"===a[c][0]||"Z"===a[c][0]?(n+=qe(Re(g[0]-o[0],2)+Re(g[1]-o[1],2)),s.push(new Pe(o[0],g[0],o[1],g[1])),o=[g[0],g[1]]):"C"===a[c][0]?(l=new ae(o[0],o[1],a[c][1],a[c][2],a[c][3],a[c][4],a[c][5],a[c][6]),n+=l.getTotalLength(),o=[a[c][5],a[c][6]],s.push(l)):"c"===a[c][0]?(l=new ae(o[0],o[1],o[0]+a[c][1],o[1]+a[c][2],o[0]+a[c][3],o[1]+a[c][4],o[0]+a[c][5],o[1]+a[c][6]),0<l.getTotalLength()?(n+=l.getTotalLength(),s.push(l),o=[a[c][5]+o[0],a[c][6]+o[1]]):s.push(new Pe(o[0],o[0],o[1],o[1]))):"S"===a[c][0]?(l=0<c&&-1<["C","c","S","s"].indexOf(a[c-1][0])?new ae(o[0],o[1],2*o[0]-a[c-1][a[c-1].length-4],2*o[1]-a[c-1][a[c-1].length-3],a[c][1],a[c][2],a[c][3],a[c][4]):new ae(o[0],o[1],o[0],o[1],a[c][1],a[c][2],a[c][3],a[c][4]),n+=l.getTotalLength(),o=[a[c][3],a[c][4]],s.push(l)):"s"===a[c][0]?(l=0<c&&-1<["C","c","S","s"].indexOf(a[c-1][0])?new ae(o[0],o[1],o[0]+l.d.x-l.c.x,o[1]+l.d.y-l.c.y,o[0]+a[c][1],o[1]+a[c][2],o[0]+a[c][3],o[1]+a[c][4]):new ae(o[0],o[1],o[0],o[1],o[0]+a[c][1],o[1]+a[c][2],o[0]+a[c][3],o[1]+a[c][4]),n+=l.getTotalLength(),o=[a[c][3]+o[0],a[c][4]+o[1]],s.push(l)):"Q"===a[c][0]?(l=o[0]==a[c][1]&&o[1]==a[c][2]?new Pe(a[c][1],a[c][3],a[c][2],a[c][4]):new ae(o[0],o[1],a[c][1],a[c][2],a[c][3],a[c][4]),n+=l.getTotalLength(),s.push(l),o=[a[c][3],a[c][4]],d=[a[c][1],a[c][2]]):"q"===a[c][0]?(l=0==a[c][1]&&0==a[c][2]?new Pe(o[0]+a[c][1],o[0]+a[c][3],o[1]+a[c][2],o[1]+a[c][4]):new ae(o[0],o[1],o[0]+a[c][1],o[1]+a[c][2],o[0]+a[c][3],o[1]+a[c][4]),n+=l.getTotalLength(),d=[o[0]+a[c][1],o[1]+a[c][2]],o=[a[c][3]+o[0],a[c][4]+o[1]],s.push(l)):"T"===a[c][0]?(l=0<c&&-1<["Q","q","T","t"].indexOf(a[c-1][0])?new ae(o[0],o[1],2*o[0]-d[0],2*o[1]-d[1],a[c][1],a[c][2]):new Pe(o[0],a[c][1],o[1],a[c][2]),s.push(l),n+=l.getTotalLength(),d=[2*o[0]-d[0],2*o[1]-d[1]],o=[a[c][1],a[c][2]]):"t"===a[c][0]?(l=0<c&&-1<["Q","q","T","t"].indexOf(a[c-1][0])?new ae(o[0],o[1],2*o[0]-d[0],2*o[1]-d[1],o[0]+a[c][1],o[1]+a[c][2]):new Pe(o[0],o[0]+a[c][1],o[1],o[1]+a[c][2]),n+=l.getTotalLength(),d=[2*o[0]-d[0],2*o[1]-d[1]],o=[a[c][1]+o[0],a[c][2]+o[0]],s.push(l)):"A"===a[c][0]?(l=new B(o[0],o[1],a[c][1],a[c][2],a[c][3],a[c][4],a[c][5],a[c][6],a[c][7]),n+=l.getTotalLength(),o=[a[c][6],a[c][7]],s.push(l)):"a"===a[c][0]&&(l=new B(o[0],o[1],a[c][1],a[c][2],a[c][3],a[c][4],a[c][5],o[0]+a[c][6],o[1]+a[c][7]),n+=l.getTotalLength(),o=[o[0]+a[c][6],o[1]+a[c][7]],s.push(l)),r.push(n);return t}var n=0,r=[],s=[];t.getTotalLength=function(){return n},t.getPointAtLength=function(e){var t=a(e);return s[t.i].getPointAtLength(t.fraction)},t.getTangentAtLength=function(e){var t=a(e);return s[t.i].getTangentAtLength(t.fraction)},t.getPropertiesAtLength=function(e){var t=a(e);return s[t.i].getPropertiesAtLength(t.fraction)},t.getParts=function(){for(var e=[],t=0;t<s.length;t++)if(null!=s[t]){var n={};n.start=s[t].getPointAtLength(0),n.end=s[t].getPointAtLength(r[t]-r[t-1]),n.length=r[t]-r[t-1],function(e){n.getPointAtLength=function(t){return e.getPointAtLength(t)},n.getTangentAtLength=function(t){return e.getTangentAtLength(t)},n.getPropertiesAtLength=function(t){return e.getPropertiesAtLength(t)}}(s[t]),e.push(n)}return e};var a=function(e){0>e?e=0:e>n&&(e=n);for(var t=r.length-1;r[t]>=e&&0<r[t];)t--;return t++,{fraction:e-r[t-1],i:t}};return t(e)}function Ne(e,t){for(var i=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").split("~::~"),n=i.length,r=!1,s=0,a="",o=null!=t&&"string"==typeof t?t:"\t",d=["\n"],c=0;100>c;c+=1)d.push(d[c]+o);for(var l=0;l<n;l+=1)-1<i[l].search(/<!/)?(a+=d[s]+i[l],r=!0,(-1<i[l].search(/-->/)||-1<i[l].search(/\]>/)||-1<i[l].search(/!DOCTYPE/))&&(r=!1)):-1<i[l].search(/-->/)||-1<i[l].search(/\]>/)?(a+=i[l],r=!1):/^<\w/.exec(i[l-1])&&/^<\/\w/.exec(i[l])&&/^<[\w:\-\.\,]+/.exec(i[l-1])==/^<\/[\w:\-\.\,]+/.exec(i[l])[0].replace("/","")?(a+=i[l],r||(s-=1)):-1<i[l].search(/<\w/)&&-1===i[l].search(/<\//)&&-1===i[l].search(/\/>/)?a=r?a+=i[l]:a+=d[s++]+i[l]:-1<i[l].search(/<\w/)&&-1<i[l].search(/<\//)?a=r?a+=i[l]:a+=d[s]+i[l]:-1<i[l].search(/<\//)?a=r?a+=i[l]:a+=d[--s]+i[l]:-1<i[l].search(/\/>/)?a=r?a+=i[l]:a+=d[s]+i[l]:a+=-1<i[l].search(/<\?/)?d[s]+i[l]:-1<i[l].search(/xmlns\:/)||-1<i[l].search(/xmlns\=/)?d[s]+i[l]:i[l];return"\n"===a[0]?a.slice(1):a}function Le(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"F",r=Nd(e,t),s=e.vertices_coords[t];gd(e,i,s,r[i],n)}function je(){function t(e){var t=new THREE.PerspectiveCamera(45,e.clientWidth/e.clientHeight,.1,1e3),n=new THREE.OrbitControls(t,e);n.enableZoom=!1,t.position.set(-.75,2,-.025),n.target.set(0,0,0),n.addEventListener("change",void 0);var r=new THREE.WebGLRenderer({antialias:!0});1!==window.devicePixelRatio&&r.setPixelRatio(window.devicePixelRatio),r.setClearColor("#FFFFFF"),r.setSize(e.clientWidth,e.clientHeight),e.appendChild(r.domElement);var s=new THREE.DirectionalLight(16777215,.2);s.position.set(20,20,-100),_.add(s);var a=new THREE.SpotLight(16777215,.3);a.position.set(50,-200,100),_.add(a);var o=new THREE.SpotLight(16777215,.3);o.position.set(100,50,200),_.add(o);var d=new THREE.AmbientLight(16777215,.48);_.add(d);(function e(){requestAnimationFrame(e),r.render(_,t),n.update()})(),i()}function i(){var e=new THREE.MeshPhongMaterial({color:16777215,side:THREE.DoubleSide,flatShading:!0,shininess:0,specular:16777215,reflectivity:0}),t=h.frame?Ur(h.cp,h.frame):h.cp,i=n(t,e),r=c(t);p.forEach(function(e){return _.remove(e)}),p=[],p.push(i),p.push(r),p.forEach(function(e){return _.add(e)})}function n(e,t){var i=new THREE.BufferGeometry,n=e.vertices_coords.map(function(e){return[e[0],e[1],null==e[2]?0:e[2]]}).reduce(function(e,t){return e.concat(t)},[]),r=e.vertices_coords.map(function(){return[0,0,1]}).reduce(function(e,t){return e.concat(t)},[]),s=e.vertices_coords.map(function(){return[1,1,1]}).reduce(function(e,t){return e.concat(t)},[]),a=e.faces_vertices.map(function(e){return e.map(function(e,t,i){return[i[0],i[t+1],i[t+2]]}).slice(0,e.length-2)}).reduce(function(e,t){return e.concat(t)},[]).reduce(function(e,t){return e.concat(t)},[]);return i.addAttribute("position",new THREE.Float32BufferAttribute(n,3)),i.addAttribute("normal",new THREE.Float32BufferAttribute(r,3)),i.addAttribute("color",new THREE.Float32BufferAttribute(s,3)),i.setIndex(a),null==t&&(t=new THREE.MeshNormalMaterial({side:THREE.DoubleSide})),new THREE.Mesh(i,t)}function r(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function s(e){return qe(Re(e[0],2)+Re(e[1],2)+Re(e[2],2))}function a(e){var t=qe(Re(e[0],2)+Re(e[1],2)+Re(e[2],2));return[e[0]/t,e[1]/t,e[2]/t]}function o(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function d(e,t){var n=[e[1][0]-e[0][0],e[1][1]-e[0][1],e[1][2]-e[0][2]],d=qe(Re(n[0],2)+Re(n[1],2)+Re(n[2],2));if(1e-10>d)throw"degenerate edge";for(var c=[n[0]/d,n[1]/d,n[2]/d],l=[a(r(c,[1,0,0])),a(r(c,[0,1,0])),a(r(c,[0,0,1]))].map(function(e,t){return{i:t,v:e,mag:s(e)}}).filter(function(e){return 1e-10<e.mag}).map(function(e){return e.v}).shift(),g=[l],f=1;4>f;f++)g.push(a(r(g[f-1],c)));var p=g.map(function(e){return o(e,t)});return e.map(function(e){return p.map(function(t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]})}).reduce(function(e,t){return e.concat(t)},[])}function c(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.002,i=e.edges_vertices.map(function(t){return t.map(function(t){return e.vertices_coords[t]})});i.forEach(function(e){null==e[0][2]&&(e[0][2]=0),null==e[1][2]&&(e[1][2]=0)});var n={B:[0,0,0],M:[0,0,0],F:[0,0,0],V:[0,0,0]},s=e.edges_assignment.map(function(t){return[n[t],n[t],n[t],n[t],n[t],n[t],n[t],n[t]]}).reduce(function(e,t){return e.concat(t)},[]).reduce(function(e,t){return e.concat(t)},[]).reduce(function(e,t){return e.concat(t)},[]),c=i.map(function(e){return d(e,t)}).reduce(function(e,t){return e.concat(t)},[]).reduce(function(e,t){return e.concat(t)},[]),l=i.map(function(e){var i=[e[1][0]-e[0][0],e[1][1]-e[0][1],e[1][2]-e[0][2]],n=qe(Re(i[0],2)+Re(i[1],2)+Re(i[2],2));if(1e-10>n)throw"degenerate edge";var s=o(a(r(i,[0,0,-1])),t),d=o(a(r(i,[0,0,1])),t);return[s,[-s[2],s[1],s[0]],d,[-d[2],d[1],d[0]],s,[-s[2],s[1],s[0]],d,[-d[2],d[1],d[0]]]}).reduce(function(e,t){return e.concat(t)},[]).reduce(function(e,t){return e.concat(t)},[]),g=i.map(function(t,e){return[8*e+0,8*e+4,8*e+1,8*e+1,8*e+4,8*e+5,8*e+1,8*e+5,8*e+2,8*e+2,8*e+5,8*e+6,8*e+2,8*e+6,8*e+3,8*e+3,8*e+6,8*e+7,8*e+3,8*e+7,8*e+0,8*e+0,8*e+7,8*e+4,8*e+0,8*e+1,8*e+3,8*e+1,8*e+2,8*e+3,8*e+5,8*e+4,8*e+7,8*e+7,8*e+6,8*e+5]}).reduce(function(e,t){return e.concat(t)},[]),f=new THREE.BufferGeometry;f.addAttribute("position",new THREE.Float32BufferAttribute(c,3)),f.addAttribute("normal",new THREE.Float32BufferAttribute(l,3)),f.addAttribute("color",new THREE.Float32BufferAttribute(s,3)),f.setIndex(g),f.computeVertexNormals();var p=new THREE.MeshToonMaterial({shininess:0,side:THREE.DoubleSide,vertexColors:THREE.VertexColors});return new THREE.Mesh(f,p)}for(var l=arguments.length,g=Array(l),f=0;f<l;f++)g[f]=arguments[f];var p=[],_=new THREE.Scene,h={cp:void 0,frame:void 0,style:{vertex_radius:.01}},u;h.cp=g.filter(function(t){return"object"===e(t)&&null!=t.vertices_coords}).shift(),null==h.cp&&(h.cp=CreasePattern(yc));var m=function(){var e=g.filter(function(e){return"function"==typeof e}),i=g.filter(function(e){return!isNaN(e)}),n=g.filter(function(e){return e instanceof HTMLElement}).shift(),r=g.filter(function(e){return"string"==typeof e||e instanceof String}).map(function(e){return document.getElementById(e)}).shift();if(u=null==n?null==r?document.body:r:n,t(u),2<=i.length);1<=e.length&&e[0]()};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",m):m();var v=function(e){h.cp=e,i(),h.cp.onchange=i};return{set cp(e){v(e),i()},get cp(){return h.cp},draw:i,get frame(){return h.frame},set frame(e){h.frame=e,i()},get frames(){var e=JSON.parse(JSON.stringify(h.cp));return delete e.file_frames,[e].concat(JSON.parse(JSON.stringify(h.cp.file_frames)))}}}var Xe="undefined"!=typeof window&&"undefined"!=typeof window.document,We="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,Ge="object"===("undefined"==typeof self?"undefined":e(self))&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,Ye=function(e){var t=e.map(function(e){return e*e}).reduce(function(e,t){return e+t},0);return qe(t)},Ue=function(e){var t=Ye(e);return e.map(function(e){return e/t})},Ke=function(e,t){return e.map(function(n,r){return e[r]*t[r]}).reduce(function(e,t){return e+t},0)},He=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=0<t.length?t[0].length:0,r=Array(n).fill(0);return t.forEach(function(e){return r.forEach(function(t,n){r[n]+=e[n]||0})}),r.map(function(e){return e/t.length})},Ze=function(e,t){return[e[1]*t[2]-e[2]*t[1],e[0]*t[2]-e[2]*t[0],e[0]*t[1]-e[1]*t[0]]},Qe=function(e,t){var i=e[0]-t[0],n=e[1]-t[1];return qe(i*i+n*n)},Je=function(e,t){for(var n=e.length,r=0,s=0;s<n;s+=1)r+=Re(e[s]-t[s],2);return qe(r)},$e=function(e,t){return e.map(function(n,r){return(e[r]+t[r])/2})},et=Object.freeze({magnitude:Ye,normalize:Ue,dot:Ke,average:He,cross2:function(e,t){return[e[0]*t[1],e[1]*t[0]]},cross3:Ze,distance2:Qe,distance3:function(t,i){var n=t[0]-i[0],r=t[1]-i[1],s=t[2]-i[2];return qe(n*n+r*r+s*s)},distance:Je,midpoint2:$e}),tt=function(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]},it=function(e,t,i){var n=tt(e,i),r=t.map(function(n,r){return t[r]+e[r]}),s=tt(r,i).map(function(e,t){return e-n[t]});return[n,s]},nt=function(e,t){var i=e[0]*t[0]+e[2]*t[1],n=e[0]*t[2]+e[2]*t[3],r=e[0]*t[4]+e[2]*t[5]+e[4],s=e[1]*t[0]+e[3]*t[1],a=e[1]*t[2]+e[3]*t[3],o=e[1]*t[4]+e[3]*t[5]+e[5];return[i,s,n,a,r,o]},rt=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0],i=e*-t[0]+t[0],n=e*-t[1]+t[1];return[e,0,0,e,i,n]},st=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0],i=De(e),n=Ve(e),r=t[0],s=t[1];return[i,n,-n,i,r,s]},at=function(e,t){var i=t&&t[0]?t[0]:0,n=t&&t[1]?t[1]:0,r=Te(e[1],e[0]),s=De(r),o=Ve(r),l=De(-r),g=Ve(-r),f=s*l+o*g,a=s*-g+o*l,p=o*l+-s*g,c=o*-g+-s*l;return[f,a,p,c,i+f*-i+-n*p,n+a*-i+-n*c]},ot=function(e){var t=e[0]*e[3]-e[1]*e[2];return t&&!isNaN(t)&&isFinite(e[4])&&isFinite(e[5])?[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[3]*e[4])/t,(e[1]*e[4]-e[0]*e[5])/t]:void 0},dt=function(e,t){var i=[];return i[0]=t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3],i[1]=t[4]*e[0]+t[5]*e[1]+t[6]*e[2]+t[7]*e[3],i[2]=t[8]*e[0]+t[9]*e[1]+t[10]*e[2]+t[11]*e[3],i[3]=t[12]*e[0]+t[13]*e[1]+t[14]*e[2]+t[15]*e[3],i},ct=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0,0],i=e*-t[0]+t[0],n=e*-t[1]+t[1],r=e*-t[2]+t[2];return[e,0,0,0,0,e,0,0,0,0,e,0,i,n,r,1]},lt=function(e){var t=[];t[0]=e[5]*e[10]*e[15]-e[5]*e[11]*e[14]-e[9]*e[6]*e[15]+e[9]*e[7]*e[14]+e[13]*e[6]*e[11]-e[13]*e[7]*e[10],t[4]=-e[4]*e[10]*e[15]+e[4]*e[11]*e[14]+e[8]*e[6]*e[15]-e[8]*e[7]*e[14]-e[12]*e[6]*e[11]+e[12]*e[7]*e[10],t[8]=e[4]*e[9]*e[15]-e[4]*e[11]*e[13]-e[8]*e[5]*e[15]+e[8]*e[7]*e[13]+e[12]*e[5]*e[11]-e[12]*e[7]*e[9],t[12]=-e[4]*e[9]*e[14]+e[4]*e[10]*e[13]+e[8]*e[5]*e[14]-e[8]*e[6]*e[13]-e[12]*e[5]*e[10]+e[12]*e[6]*e[9],t[1]=-e[1]*e[10]*e[15]+e[1]*e[11]*e[14]+e[9]*e[2]*e[15]-e[9]*e[3]*e[14]-e[13]*e[2]*e[11]+e[13]*e[3]*e[10],t[5]=e[0]*e[10]*e[15]-e[0]*e[11]*e[14]-e[8]*e[2]*e[15]+e[8]*e[3]*e[14]+e[12]*e[2]*e[11]-e[12]*e[3]*e[10],t[9]=-e[0]*e[9]*e[15]+e[0]*e[11]*e[13]+e[8]*e[1]*e[15]-e[8]*e[3]*e[13]-e[12]*e[1]*e[11]+e[12]*e[3]*e[9],t[13]=e[0]*e[9]*e[14]-e[0]*e[10]*e[13]-e[8]*e[1]*e[14]+e[8]*e[2]*e[13]+e[12]*e[1]*e[10]-e[12]*e[2]*e[9],t[2]=e[1]*e[6]*e[15]-e[1]*e[7]*e[14]-e[5]*e[2]*e[15]+e[5]*e[3]*e[14]+e[13]*e[2]*e[7]-e[13]*e[3]*e[6],t[6]=-e[0]*e[6]*e[15]+e[0]*e[7]*e[14]+e[4]*e[2]*e[15]-e[4]*e[3]*e[14]-e[12]*e[2]*e[7]+e[12]*e[3]*e[6],t[10]=e[0]*e[5]*e[15]-e[0]*e[7]*e[13]-e[4]*e[1]*e[15]+e[4]*e[3]*e[13]+e[12]*e[1]*e[7]-e[12]*e[3]*e[5],t[14]=-e[0]*e[5]*e[14]+e[0]*e[6]*e[13]+e[4]*e[1]*e[14]-e[4]*e[2]*e[13]-e[12]*e[1]*e[6]+e[12]*e[2]*e[5],t[3]=-e[1]*e[6]*e[11]+e[1]*e[7]*e[10]+e[5]*e[2]*e[11]-e[5]*e[3]*e[10]-e[9]*e[2]*e[7]+e[9]*e[3]*e[6],t[7]=e[0]*e[6]*e[11]-e[0]*e[7]*e[10]-e[4]*e[2]*e[11]+e[4]*e[3]*e[10]+e[8]*e[2]*e[7]-e[8]*e[3]*e[6],t[11]=-e[0]*e[5]*e[11]+e[0]*e[7]*e[9]+e[4]*e[1]*e[11]-e[4]*e[3]*e[9]-e[8]*e[1]*e[7]+e[8]*e[3]*e[5],t[15]=e[0]*e[5]*e[10]-e[0]*e[6]*e[9]-e[4]*e[1]*e[10]+e[4]*e[2]*e[9]+e[8]*e[1]*e[6]-e[8]*e[2]*e[5];var i=e[0]*t[0]+e[1]*t[4]+e[2]*t[8]+e[3]*t[12];if(!(1e-6>i&&-1e-6<i)){return t.map(function(e){return e*(1/i)})}},gt=function(e,t){return[e[0]*t[0]+e[1]*t[4]+e[2]*t[8]+e[3]*t[12],e[0]*t[1]+e[1]*t[5]+e[2]*t[9]+e[3]*t[13],e[0]*t[2]+e[1]*t[6]+e[2]*t[10]+e[3]*t[14],e[0]*t[3]+e[1]*t[7]+e[2]*t[11]+e[3]*t[15],e[4]*t[0]+e[5]*t[4]+e[6]*t[8]+e[7]*t[12],e[4]*t[1]+e[5]*t[5]+e[6]*t[9]+e[7]*t[13],e[4]*t[2]+e[5]*t[6]+e[6]*t[10]+e[7]*t[14],e[4]*t[3]+e[5]*t[7]+e[6]*t[11]+e[7]*t[15],e[8]*t[0]+e[9]*t[4]+e[10]*t[8]+e[11]*t[12],e[8]*t[1]+e[9]*t[5]+e[10]*t[9]+e[11]*t[13],e[8]*t[2]+e[9]*t[6]+e[10]*t[10]+e[11]*t[14],e[8]*t[3]+e[9]*t[7]+e[10]*t[11]+e[11]*t[15],e[12]*t[0]+e[13]*t[4]+e[14]*t[8]+e[15]*t[12],e[12]*t[1]+e[13]*t[5]+e[14]*t[9]+e[15]*t[13],e[12]*t[2]+e[13]*t[6]+e[14]*t[10]+e[15]*t[14],e[12]*t[3]+e[13]*t[7]+e[14]*t[11]+e[15]*t[15]]},ft=Object.freeze({multiply_vector2_matrix2:tt,multiply_line_matrix2:it,multiply_matrices2:nt,make_matrix2_translation:function(e,t){return[1,0,0,1,e,t]},make_matrix2_scale:rt,make_matrix2_rotation:st,make_matrix2_reflection:at,make_matrix2_inverse:ot,multiply_vector4_matrix4:dt,make_matrix4_scale:ct,make_matrix4_inverse:lt,transpose_matrix4:function(e){return[e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]]},multiply_matrices4:gt}),pt=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:15;return parseFloat(e.toFixed(t))},_t=function(e){return null!=e&&"function"==typeof e[Symbol.iterator]},ht=function e(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];switch(i.length){case void 0:case 0:return i;case 1:return _t(i[0])&&"string"!=typeof i[0]?e.apply(void 0,f(i[0])):[i[0]];default:return Array.from(i).map(function(t){return _t(t)?f(e(t)):t}).reduce(function(e,t){return e.concat(t)},[]);}},ut=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];for(var n=t;1===n.length&&n[0].length;){var r=n,s=g(r,1);n=s[0]}return n},mt=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=ht(t).filter(function(e){return void 0!==e});if(void 0!==n)return 0===n.length?void 0:(isNaN(n[0].x)||(n=["x","y","z"].map(function(e){return n[0][e]}).filter(function(e){return void 0!==e})),n.filter(function(e){return"number"==typeof e}))},vt=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return ut(t).map(function(e){return mt(e)})},yt=[1,0,0,1,0,0],xt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],kt=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=mt(t);return void 0===r?void 0:6===r.length?r:6<r.length?[r[0],r[1],r[2],r[3],r[4],r[5]]:6>r.length?yt.map(function(e,t){return r[t]||e}):void 0},bt=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=mt(t);return void 0===r?void 0:16===r.length?r:9===r.length?[r[0],r[1],r[2],0,r[3],r[4],r[5],0,r[6],r[7],r[8],0,0,0,0,1]:6===r.length?[r[0],r[1],0,0,r[2],r[3],0,0,0,0,1,0,r[4],r[5],0,1]:4===r.length?[r[0],r[1],0,0,r[2],r[3],0,0,0,0,1,0,0,0,0,1]:16<r.length?[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15]]:16>r.length?xt.map(function(e,t){return r[t]||e}):void 0},wt=1e-6,Et=function(e,t){return Array.from(Array(e.length-1)).map(function(n,r){return t(e[0],e[r+1])}).reduce(function(e,t){return e&&t},!0)},Pt=function e(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=vt(i);if(0===r.length)return!1;if(1===r.length&&void 0!==r[0])return e.apply(void 0,f(r[0]));var s=r[0].length,a=Array.from(Array(s));return Array.from(Array(r.length-1)).map(function(e,t){return a.map(function(e,i){return ze(r[t][i]-r[t+1][i])<wt}).reduce(function(e,t){return e&&t},!0)}).reduce(function(e,t){return e&&t},!0)&&Array.from(Array(r.length-1)).map(function(e,t){return r[0].length===r[t+1].length}).reduce(function(e,t){return e&&t},!0)},At=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=ut(t);if(1>n.length)return!1;var r=l(n[0]);if("undefined"===r)return!1;switch(n[0].constructor===Array&&(n=n.map(function(e){return ut(e)})),r){case"number":return Et(n,function(e,t){return ze(e-t)<wt});case"boolean":return Et(n,function(e,t){return e===t});case"object":return n[0].constructor===Array?Pt(n):(console.warn("comparing array of objects for equivalency by slow stringify and no-epsilon"),Et(n,function(e,t){return JSON.stringify(e)===JSON.stringify(t)}));default:console.warn("incapable of determining comparison method");}return!1},St=Object.freeze({EPSILON:wt,equivalent_numbers:function e(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return 0!==i.length&&(1===i.length&&void 0!==i[0]?e.apply(void 0,f(i[0])):Et(i,function(e,t){return ze(e-t)<wt}))},equivalent_vectors:Pt,equivalent:At}),Nt=function(e,t,i,n,r){var s=function(e,t){return e[0]*t[1]-t[0]*e[1]},a=s(t,n),o=s([i[0]-e[0],i[1]-e[1]],n),d=s([e[0]-i[0],e[1]-i[1]],t);if(ze(a)<wt)return!1;return r(o/a,d/-a)},Lt=function(e,t){return e>=-wt&&e<=1+wt&&t>=-wt&&t<=1+wt},jt=function(e,t,i,n){var r=[t[0]-e[0],t[1]-e[1]],s=[n[0]-i[0],n[1]-i[1]];return Nt(e,r,i,s,Lt)},Mt=function(e){return ze(e.reduce(function(e,t){return e+t},0))<wt},Ct=function(e,t){return 1-ze(Ke(Ue(e),Ue(t)))<wt},Ot=function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:wt,r=[i[0]-e[0],i[1]-e[1]],s=r[0]*t[1]-r[1]*t[0];return ze(s)<n},Bt=function(e,t){for(var n=!1,r=0,s=t.length-1;r<t.length;s=r++)t[r][1]>e[1]!=t[s][1]>e[1]&&e[0]<(t[s][0]-t[r][0])*(e[1]-t[r][1])/(t[s][1]-t[r][1])+t[r][0]&&(n=!n);return n},Ft=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:wt;return!!(null!=t&&0<t.length)&&t.map(function(t,r,i){var s=i[(r+1)%i.length],o=[s[0]-t[0],s[1]-t[1]],a=[e[0]-t[0],e[1]-t[1]];return o[0]*a[1]-o[1]*a[0]>-n}).map(function(e,t,i){return e===i[0]}).reduce(function(e,t){return e&&t},!0)},It=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:wt;return!!(null!=t&&0<t.length)&&t.map(function(t,r,i){var s=i[(r+1)%i.length],o=[s[0]-t[0],s[1]-t[1]],a=[e[0]-t[0],e[1]-t[1]];return o[0]*a[1]-o[1]*a[0]>n}).map(function(e,t,i){return e===i[0]}).reduce(function(e,t){return e&&t},!0)},zt=function(e,t){for(var n=e.map(function(e,t,i){return[e,i[(t+1)%i.length]]}),r=t.map(function(e,t,i){return[e,i[(t+1)%i.length]]}),s=0;s<n.length;s+=1)for(var a=0;a<r.length;a+=1)if(jt(n[s][0],n[s][1],r[a][0],r[a][1]))return!0;return!!Bt(t[0],e)||!!Bt(e[0],t)},Vt=Object.freeze({overlap_function:Nt,edge_edge_overlap:jt,degenerate:Mt,parallel:Ct,point_on_line:Ot,point_on_edge:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:wt,r=[e[0]-t[0],e[1]-t[1]],s=[e[0]-i[0],e[1]-i[1]],a=[t[0]-i[0],t[1]-i[1]],o=qe(r[0]*r[0]+r[1]*r[1]),d=qe(s[0]*s[0]+s[1]*s[1]),c=qe(a[0]*a[0]+a[1]*a[1]);return ze(o-d-c)<n},point_in_poly:Bt,point_in_convex_poly:Ft,point_in_convex_poly_exclusive:It,convex_polygons_overlap:zt,convex_polygon_is_enclosed:function(e,t){var i=t.map(function(t){return Ft(t,e)}).reduce(function(e,t){return e||t},!1);return!i&&void 0},convex_polygons_enclose:function(e,t){var i=t.map(function(t){return Ft(t,e)}).reduce(function(e,t){return e||t},!1),n=e.map(function(t){return Ft(t,e)}).reduce(function(e,t){return e&&t},!0);return!i&&n},is_counter_clockwise_between:function(e,t,i){for(;i<t;)i+=2*Ie;for(;e<t;)e+=2*Ie;return e<i}}),Dt=function(){return!0},Tt=function(e,t){return t>=-wt},qt=function(e,t){return t>=-wt&&t<=1+wt},Rt=function(e,t){return e>=-wt&&t>=-wt},Xt=function(e,t){return e>=-wt&&t>=-wt&&t<=1+wt},Wt=function(e,t){return e>=-wt&&e<=1+wt&&t>=-wt&&t<=1+wt},Gt=function(e,t){return t>wt},Yt=function(e,t){return t>wt&&t<1-wt},Ut=function(e,t){return e>wt&&t>wt},Kt=function(e,t){return e>wt&&t>wt&&t<1-wt},Ht=function(e,t){return e>wt&&e<1-wt&&t>wt&&t<1-wt},Zt=function(e){return e},Qt=function(e){return e<-wt?0:e},Jt=function(e){return e<-wt?0:e>1+wt?1:e},$t=function(e,t,i,n,r){function s(e,t){return e[0]*t[1]-t[0]*e[1]}var a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:wt,o=s(t,n);if(!(ze(o)<a)){var d=s([i[0]-e[0],i[1]-e[1]],n),c=s([e[0]-i[0],e[1]-i[1]],t),l=d/o;return r(l,c/-o,a)?[e[0]+t[0]*l,e[1]+t[1]*l]:void 0}},ei=function(e,t,i,n,r){var s=[n[0]-i[0],n[1]-i[1]];return $t(e,t,i,s,qt,r)},ti=function(e,t,i,n,r){var s=[n[0]-i[0],n[1]-i[1]];return $t(e,t,i,s,Xt,r)},ii=function(e,t,i,n,r){var s=[n[0]-i[0],n[1]-i[1]];return $t(e,t,i,s,Yt,r)},ni=function(e,t,i,n,r){var s=[n[0]-i[0],n[1]-i[1]];return $t(e,t,i,s,Kt,r)},ri=function(e,t,i,n,r){var s=[t[0]-e[0],t[1]-e[1]],a=[n[0]-i[0],n[1]-i[1]];return $t(e,s,i,a,Ht,r)},si=function(e,t,i,n){function r(e){return e<-s?-1:1}var s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:wt,a=i[0]-e[0],o=i[1]-e[1],d=n[0]-e[0],c=n[1]-e[1],l=d-a,g=c-o,f=a*c-d*o,p=f*f,_=t*t,h=ze(l*l+g*g),u=_*h-p;if(!(u<-s)){var m=qe(_*h-p),v=[e[0]+(f*g+r(g)*l*m)/h,e[1]+(-f*l+ze(g)*m)/h];if(u>s){var y=[e[0]+(f*g-r(g)*l*m)/h,e[1]+(-f*l-ze(g)*m)/h];return[v,y]}return[v]}},ai=function(){throw"circle_ray has not been written yet"},oi=function(e,t,i,n){function r(e){return 0>e?-1:1}var s=Re(t,2),a=i[0]-e[0],o=i[1]-e[1],d=n[0]-e[0],c=n[1]-e[1],l=d-a,g=c-o,f=l*l+g*g,p=a*c-d*o,_=(p*g+r(g)*l*qe(s*f-p*p))/f,h=(p*g-r(g)*l*qe(s*f-p*p))/f,u=(-p*l+ze(g)*qe(s*f-p*p))/f,m=(-p*l-ze(g)*qe(s*f-p*p))/f,v=isNaN(_),y=isNaN(h);return v||y?v&&y?void 0:v?y?void 0:[[h+e[0],m+e[1]]]:[[_+e[0],u+e[1]]]:[[_+e[0],u+e[1]],[h+e[0],m+e[1]]]},di=function(e,t){return ze(e[0]-t[0])<wt&&ze(e[1]-t[1])<wt},ci=function(e,t,n){var r=e.map(function(e,t,i){return[e,i[(t+1)%i.length]]}).map(function(e){return ei(t,n,e[0],e[1])}).filter(function(e){return null!=e});switch(r.length){case 0:return;case 1:return[r[0],r[0]];case 2:return r;default:for(var s=1;s<r.length;s+=1)if(!di(r[0],r[s]))return[r[0],r[s]];}},li=function(e,t,n){var r=e.map(function(e,t,i){return[e,i[(t+1)%i.length]]}).map(function(e){return ti(t,n,e[0],e[1])}).filter(function(e){return null!=e});switch(r.length){case 0:return;case 1:return[t,r[0]];case 2:return r;default:for(var s=1;s<r.length;s+=1)if(!di(r[0],r[s]))return[r[0],r[s]];}},gi=function(e,t,i){var n=e.map(function(e,t,i){return[e,i[(t+1)%i.length]]}).map(function(e){return ri(t,i,e[0],e[1])}).filter(function(e){return null!=e}),r=It(t,e),s=It(i,e),a=Ft(t,e),o=Ft(i,e);if(0===n.length&&(r||s))return[t,i];if(0===n.length&&a&&o)return[t,i];switch(n.length){case 0:return r?[f(t),f(i)]:void 0;case 1:return a?[f(t),n[0]]:[f(i),n[0]];case 2:return n;default:throw new Error("clipping edge in a convex polygon resulting in 3 or more points");}},fi=Object.freeze({limit_line:Zt,limit_ray:Qt,limit_edge:Jt,intersection_function:$t,line_line:function(e,t,i,n,r){return $t(e,t,i,n,Dt,r)},line_ray:function(e,t,i,n,r){return $t(e,t,i,n,Tt,r)},line_edge:ei,ray_ray:function(e,t,i,n,r){return $t(e,t,i,n,Rt,r)},ray_edge:ti,edge_edge:function(e,t,i,n,r){var s=[t[0]-e[0],t[1]-e[1]],a=[n[0]-i[0],n[1]-i[1]];return $t(e,s,i,a,Wt,r)},line_ray_exclusive:function(e,t,i,n,r){return $t(e,t,i,n,Gt,r)},line_edge_exclusive:ii,ray_ray_exclusive:function(e,t,i,n,r){return $t(e,t,i,n,Ut,r)},ray_edge_exclusive:ni,edge_edge_exclusive:ri,circle_line:si,circle_ray:ai,circle_edge:oi,convex_poly_line:ci,convex_poly_ray:li,convex_poly_edge:gi,convex_poly_ray_exclusive:function(e,t,n){var r=e.map(function(e,t,i){return[e,i[(t+1)%i.length]]}).map(function(e){return ni(t,n,e[0],e[1])}).filter(function(e){return null!=e});switch(r.length){case 0:return;case 1:return[t,r[0]];case 2:return r;default:for(var s=1;s<r.length;s+=1)if(!di(r[0],r[s]))return[r[0],r[s]];}}}),pi=function(e,t){var i=e[0]*t[0]+e[1]*t[1],n=e[0]*t[1]-e[1]*t[0],r=Te(n,i);return 0>r&&(r+=2*Ie),r},_i=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=t.map(function(e){return Te(e[1],e[0])}),r=Array.from(Array(n.length)).map(function(e,t){return t}).sort(function(e,t){return n[e]-n[t]});return r.slice(r.indexOf(0),r.length).concat(r.slice(0,r.indexOf(0)))},hi=function(e,t){var n=Ue(e),r=Ue(t),i=n.map(function(e,t){return n[t]+r[t]}),s=Ue(i),a=n.map(function(e,t){return-n[t]+-r[t]});return[s,Ue(a)]},ui=function(e,t,i){var n=pi(t,i)/e;return Array.from(Array(e-1)).map(function(e,r){return t+n*r})},mi=function(e,t,i){var n=Te(t[1],t[0]),r=Te(i[1],i[0]);return ui(e,n,r).map(function(e){return[De(e),Ve(e)]})},vi=function(e){return .5*e.map(function(e,t,i){var n=i[(t+1)%i.length];return e[0]*n[1]-n[0]*e[1]}).reduce(function(e,t){return e+t},0)},yi=function(e){var t=1/(6*vi(e));return e.map(function(e,t,i){var n=i[(t+1)%i.length],r=e[0]*n[1]-n[0]*e[1];return[(e[0]+n[0])*r,(e[1]+n[1])*r]}).reduce(function(e,t){return[e[0]+t[0],e[1]+t[1]]},[0,0]).map(function(e){return e*t})},xi=function(e){var t=e[0].length,n=Array.from(Array(t)).map(function(){return 1/0}),r=Array.from(Array(t)).map(function(){return-Infinity});e.forEach(function(e){return e.forEach(function(e,t){e<n[t]&&(n[t]=e),e>r[t]&&(r[t]=e)})});var s=r.map(function(e,t){return e-n[t]});return[n,s]},ki=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,s=.5*(2*Ie/e),o=i/De(s);return Array.from(Array(Ce(e))).map(function(r,d){var i=-2*Ie*d/e+s,a=pt(t+o*Ve(i),14),c=pt(n+o*De(i),14);return[a,c]})},bi=function(e,t,n){for(var r=t.map(function(t,r){return{o:t,i:r,d:n(e,t)}}),s=1/0,a=0,o;a<r.length;a+=1)r[a].d<s&&(o=a,s=r[a].d);return o},wi=function(e,t,n,r){var s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:wt,a=Re(t[0],2)+Re(t[1],2),o=[0,1].map(function(t,r){return n[r]-e[r]}),c=[0,1].map(function(t,r){return n[r]-e[r]}),l=[0,1].map(function(e,n){return t[n]*o[n]}).reduce(function(e,t){return e+t},0),g=r(l/a,s);return[0,1].map(function(n,r){return e[r]+t[r]*g})},Ei=function(e,t,n){var r=e.map(function(e,r){var i=Ot(t,n,e);return{type:"v",point:i?e:null,at_index:r}}).filter(function(e){return null!=e.point}),s=e.map(function(e,r,i){var s=ii(t,n,e,i[(r+1)%i.length]);return{type:"e",point:s,at_index:r}}).filter(function(e){return null!=e.point}),a=r.concat(s).sort(function(e,t){return ze(e.point[0]-t.point[0])<wt?e.point[1]-t.point[1]:e.point[0]-t.point[0]});return console.log(a),e},Pi=function(e,t,n){var r=e.map(function(e,r){var i=Ot(t,n,e);return{point:i?e:null,at_index:r}}).filter(function(e){return null!=e.point}),s=e.map(function(e,r,i){var s=ii(t,n,e,i[(r+1)%i.length]);return{point:s,at_index:r}}).filter(function(e){return null!=e.point});if(2==s.length){var a=s.slice().sort(function(e,t){return e.at_index-t.at_index}),o=e.slice(a[1].at_index+1).concat(e.slice(0,a[0].at_index+1));o.push(a[0].point),o.push(a[1].point);var d=e.slice(a[0].at_index+1,a[1].at_index+1);return d.push(a[1].point),d.push(a[0].point),[o,d]}if(1==s.length&&1==r.length){r[0].type="v",s[0].type="e";var c=r.concat(s).sort(function(e,t){return e.at_index-t.at_index}),l=e.slice(c[1].at_index+1).concat(e.slice(0,c[0].at_index+1));"e"===c[0].type&&l.push(c[0].point),l.push(c[1].point);var g=e.slice(c[0].at_index+1,c[1].at_index+1);return"e"===c[1].type&&g.push(c[1].point),g.push(c[0].point),[l,g]}if(2==r.length){var f=r.slice().sort(function(e,t){return e.at_index-t.at_index}),p=e.slice(f[1].at_index).concat(e.slice(0,f[0].at_index+1)),_=e.slice(f[0].at_index,f[1].at_index+1);return[p,_]}return[e.slice()]},Ai=function(e){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:wt,i=e.slice().sort(function(e,i){return ze(e[1]-i[1])<t?e[0]-i[0]:e[1]-i[1]}),n=[];n.push(i[0]);var r=0,s=0,a=function(){s+=1;var e=n.length-1,a=i.filter(function(i){return!(ze(i[0]-n[e][0])<t&&ze(i[1]-n[e][1])<t)}).map(function(t){for(var i=Te(n[e][1]-t[1],n[e][0]-t[0]);i<r;)i+=2*Ie;return{node:t,angle:i,distance:void 0}}).sort(function(e,t){return e.angle<t.angle?-1:e.angle>t.angle?1:0});if(0===a.length)return{v:void 0};var o=a[0];return a=a.filter(function(e){return ze(o.angle-e.angle)<t}).map(function(t){var i=qe(Re(n[e][0]-t.node[0],2)+Re(n[e][1]-t.node[1],2));return t.distance=i,t}).sort(function(e,t){return e.distance<t.distance?1:e.distance>t.distance?-1:0}),0<n.filter(function(e){return e===a[0].node}).length?{v:n}:void(n.push(a[0].node),r=Te(n[e][1]-a[0].node[1],n[e][0]-a[0].node[0]))};do{var o=a();if("object"===l(o))return o.v}while(s<1e4)},Ni=Object.freeze({clockwise_angle2_radians:function(e,t){for(;0>e;)e+=2*Ie;for(;0>t;)t+=2*Ie;var i=e-t;return 0<=i?i:2*Ie-(t-e)},counter_clockwise_angle2_radians:function(e,t){for(;0>e;)e+=2*Ie;for(;0>t;)t+=2*Ie;var i=t-e;return 0<=i?i:2*Ie-(e-t)},clockwise_angle2:function(e,t){var i=t[0]*e[0]+t[1]*e[1],n=t[0]*e[1]-t[1]*e[0],r=Te(n,i);return 0>r&&(r+=2*Ie),r},counter_clockwise_angle2:pi,counter_clockwise_vector_order:_i,interior_angles2:function(e,t){var i=pi(e,t);return[i,2*Ie-i]},interior_angles:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.map(function(e,t,i){return pi(e,i[(t+1)%i.length])})},bisect_vectors:hi,bisect_lines2:function(e,i,n,r){var s=i[0]*r[1]-r[0]*i[1];if(ze(s)<wt){var a=[$e(e,n),[i[0],i[1]]],o=[a,a],d=i[0]*r[0]+i[1]*r[1];return delete(0<d?o[1]:o[0]),o}var c=(n[0]-e[0])*r[1]-r[0]*(n[1]-e[1]),l=c/s,t=e[0]+i[0]*l,g=e[1]+i[1]*l,f=hi(i,r);return f[1]=[f[1][1],-f[1][0]],f.map(function(e){return[[t,g],e]})},subsect_radians:ui,subsect:mi,signed_area:vi,centroid:yi,enclosing_rectangle:xi,make_regular_polygon:ki,nearest_point2:function(e,t){var i=bi(e,t,Qe);return void 0===i?void 0:t[i]},nearest_point:function(e,t){var i=bi(e,t,Je);return void 0===i?void 0:t[i]},nearest_point_on_line:wi,split_polygon:Ei,split_convex_polygon:Pi,convex_hull:Ai}),Li=function(e){var t=[],n=e,r=function(){return n(Ue(E))},s=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=mt(t);return this.length>n.length?Ke(n,E):Ke(E,n)},a=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=mt(t),s=E.slice();return null==s[2]&&(s[2]=0),null==r[2]&&(r[2]=0),n(Ze(s,r))},o=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=mt(t),r=E.length<n.length?E.length:n.length,s=Array.from(Array(r)).map(function(e,t){return Re(E[t]-n[t],2)}).reduce(function(e,t){return e+t},0);return qe(s)},d=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=kt(t);return n(tt(E,r))},c=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=mt(t);return n(E.map(function(e,t){return e+r[t]}))},l=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=mt(t);return n(E.map(function(e,t){return e-r[t]}))},g=function(e,t){var i=st(e,t);return n(tt(E,i))},p=function(){return n(-E[1],E[0])},_=function(){return n(-E[0],-E[1])},h=function(){return n(E[1],-E[0])},u=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=w(t),s=at(r.vector,r.point);return n(tt(E,s))},m=function(e,t){var r=mt(e),s=E.length<r.length?E.length:r.length,a=Array.from(Array(s)).map(function(e,n){return E[n]*t+r[n]*(1-t)});return n(a)},v=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=mt(t),r=E.length<n.length?E:n,s=E.length<n.length?n:E;return At(r,s)},y=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=mt(t),r=E.length<n.length?E:n,s=E.length<n.length?n:E;return Ct(r,s)},x=function(e){return n(E.map(function(t){return t*e}))},k=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var s=mt(t),a=E.length<s.length?E.slice():s,o=E.length<s.length?s:E.slice(),d=a.length;d<o.length;d+=1)a[d]=0;return n(o.map(function(e,t){return .5*(a[t]+o[t])}))},b=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=mt(t);return hi(E,r).map(function(e){return n(e)})},E;return Object.defineProperty(t,"normalize",{value:r}),Object.defineProperty(t,"dot",{value:s}),Object.defineProperty(t,"cross",{value:a}),Object.defineProperty(t,"distanceTo",{value:o}),Object.defineProperty(t,"transform",{value:d}),Object.defineProperty(t,"add",{value:c}),Object.defineProperty(t,"subtract",{value:l}),Object.defineProperty(t,"rotateZ",{value:g}),Object.defineProperty(t,"rotateZ90",{value:p}),Object.defineProperty(t,"rotateZ180",{value:_}),Object.defineProperty(t,"rotateZ270",{value:h}),Object.defineProperty(t,"reflect",{value:u}),Object.defineProperty(t,"lerp",{value:m}),Object.defineProperty(t,"isEquivalent",{value:v}),Object.defineProperty(t,"isParallel",{value:y}),Object.defineProperty(t,"scale",{value:x}),Object.defineProperty(t,"midpoint",{value:k}),Object.defineProperty(t,"bisect",{value:b}),Object.defineProperty(t,"copy",{value:function(){return n.apply(void 0,f(E))}}),Object.defineProperty(t,"magnitude",{get:function(){return Ye(E)}}),Object.defineProperty(t,"bind",{value:function(e){E=e}}),t},ji=function e(){var t=Li(e),i=Object.create(t);t.bind(i);for(var n=arguments.length,r=Array(n),s=0;s<n;s++)r[s]=arguments[s];return mt(r).forEach(function(e){return i.push(e)}),Object.defineProperty(i,"x",{get:function(){return i[0]}}),Object.defineProperty(i,"y",{get:function(){return i[1]}}),Object.defineProperty(i,"z",{get:function(){return i[2]}}),i},Mi=function e(){for(var t=[1,0,0,1,0,0],i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];var s=kt(n);void 0!==s&&s.forEach(function(e,n){t[n]=e});return Object.defineProperty(t,"inverse",{value:function(){return e(ot(t).map(function(e){return pt(e,13)}))}}),Object.defineProperty(t,"multiply",{value:function(){for(var i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];var s=kt(n);return e(nt(t,s).map(function(e){return pt(e,13)}))}}),Object.defineProperty(t,"transform",{value:function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];var r=mt(i);return ji(tt(r,t).map(function(e){return pt(e,13)}))}}),Object.freeze(t)};Mi.makeIdentity=function(){return Mi(1,0,0,1,0,0)},Mi.makeTranslation=function(e,t){return Mi(1,0,0,1,e,t)},Mi.makeScale=function(){return Mi.apply(void 0,f(rt.apply(void 0,arguments)))},Mi.makeRotation=function(e,t){return Mi(st(e,t).map(function(e){return pt(e,13)}))},Mi.makeReflection=function(e,t){return Mi(at(e,t).map(function(e){return pt(e,13)}))};var Ci=function e(){for(var t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];var s=bt(n);void 0!==s&&s.forEach(function(e,n){t[n]=e});return Object.defineProperty(t,"inverse",{value:function(){return e(lt(t).map(function(e){return pt(e,13)}))}}),Object.defineProperty(t,"multiply",{value:function(){for(var i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];var s=bt(n);return e(gt(t,s).map(function(e){return pt(e,13)}))}}),Object.defineProperty(t,"transform",{value:function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];var r=mt(i);return ji(dt(r,t).map(function(e){return pt(e,13)}))}}),Object.freeze(t)};Ci.makeIdentity=function(){return Ci(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},Ci.makeTranslation=function(e,t,i){return Ci(1,0,0,0,0,1,0,0,0,0,1,0,e,t,i,1)},Ci.makeScale=function(){return Ci.apply(void 0,f(ct.apply(void 0,arguments)))};var Oi=function e(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=w(i),s=r.point,a=r.vector,o=N.bind(this),d=Object.create(o(e));return Object.defineProperty(d,"compare_function",{value:function(){return!0}}),Object.defineProperty(d,"clip_function",{value:Zt}),Object.defineProperty(d,"point",{get:function(){return ji(s)}}),Object.defineProperty(d,"vector",{get:function(){return ji(a)}}),Object.defineProperty(d,"length",{get:function(){return 1/0}}),Object.defineProperty(d,"transform",{value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=kt(i),o=it(s,a,r);return e(o[0],o[1])}}),d};Oi.fromPoints=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=P(t);return Oi({point:n[0],vector:Ue([n[1][0]-n[0][0],n[1][1]-n[0][1]])})},Oi.perpendicularBisector=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=P(t),r=Ue([n[1][0]-n[0][0],n[1][1]-n[0][1]]);return Oi({point:He(n[0],n[1]),vector:[r[1],-r[0]]})};var Bi=function e(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=w(i),s=r.point,a=r.vector,o=N.bind(this),d=Object.create(o(e));return Object.defineProperty(d,"point",{get:function(){return ji(s)}}),Object.defineProperty(d,"vector",{get:function(){return ji(a)}}),Object.defineProperty(d,"length",{get:function(){return 1/0}}),Object.defineProperty(d,"transform",{value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=kt(i),o=tt(s,r),d=a.map(function(e,t){return e+s[t]}),c=tt(d,r).map(function(e,t){return e-o[t]});return e(o,c)}}),Object.defineProperty(d,"rotate180",{value:function(){return e(s[0],s[1],-a[0],-a[1])}}),Object.defineProperty(d,"compare_function",{value:function(e,t){return e>=-t}}),Object.defineProperty(d,"clip_function",{value:Qt}),d};Bi.fromPoints=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=P(t);return Bi({point:n[0],vector:Ue([n[1][0]-n[0][0],n[1][1]-n[0][1]])})};var Fi=function e(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=P(i),s=N.bind(this),a=Object.create(s(e,[])),o=0<r.length?r.map(function(e){return ji(e)}):void 0;if(void 0!==o){o.forEach(function(e,t){a[t]=e});var d=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=kt(i),s=a.map(function(e){return tt(e,r)});return e(s)},c=function(){return ji(a[1][0]-a[0][0],a[1][1]-a[0][1])},l=function(){return ji(He(a[0],a[1]))},g=function(){return qe(Re(a[1][0]-a[0][0],2)+Re(a[1][1]-a[0][1],2))},f=function(e,t){return e>=-t&&e<=1+t};return Object.defineProperty(a,"point",{get:function(){return a[0]}}),Object.defineProperty(a,"vector",{get:function(){return c()}}),Object.defineProperty(a,"midpoint",{value:l}),Object.defineProperty(a,"length",{get:function(){return g()}}),Object.defineProperty(a,"transform",{value:d}),Object.defineProperty(a,"compare_function",{value:f}),Object.defineProperty(a,"clip_function",{value:Jt}),a}},Ii=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[0,0],s=[mt(e),mt(t)];return{contains:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=mt(t).map(function(e,t){return e+r[t]}),a=(n[1]-s[0][1])*-s[0][0]-(n[0]-s[0][0])*-s[0][1],o=n[1]*s[1][0]-n[0]*s[1][1];return 0>a&&0>o},bisect:function(){var e=pi(s[0],s[1]),t=s.map(function(e){return Te(e[1],e[0])}),i=t[0]+.5*e;return[De(i),Ve(i)]},subsect:function(e){return mi(e,s[0],s[1]).map(function(e){return[e[0],e[1]]})},get center(){return r},get vectors(){return s},get angle(){return pi(s[0],s[1])}}};Ii.fromVectors=function(e,t){return Ii(e,t)},Ii.fromPoints=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[0,0],r=[e,t].map(function(e){return e.map(function(t,r){return e[r]-n[r]})});return Ii(r[0],r[1],n)};var zi=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=vt(t).map(function(e){return ji(e)});if(void 0!==n){var r=n.map(function(e,t,i){return[e,i[(t+1)%i.length]]}).map(function(e){return Fi(e[0][0],e[0][1],e[1][0],e[1][1])}),s=L.bind(this),a=Object.create(s());return Object.defineProperty(a,"points",{get:function(){return n}}),Object.defineProperty(a,"sides",{get:function(){return r}}),a}};zi.regularPolygon=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,r=ki(e,t,i,n);return zi(r)},zi.convexHull=function(e){var t=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],i=Ai(e,t);return zi(i)};var Vi=function e(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=A(i).map(function(e){return ji(e)});if(void 0!==r){var s=r.map(function(e,t,i){return[e,i[(t+1)%i.length]]}).map(function(e){return Fi(e[0][0],e[0][1],e[1][0],e[1][1])}),a=L.bind(this),o=Object.create(a(e)),d=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var s=w(i);return Pi(r,s.point,s.vector).map(function(t){return e(t)})},c=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=A(t);return zt(r,n)},l=function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:yi(o.points),r=o.points.map(function(e){return[0,1].map(function(t,r){return e[r]-n[r]})}).map(function(e){return e.map(function(r,s){return n[s]+e[s]*t})});return e(r)},g=function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:yi(o.points),n=o.points.map(function(e){var n=[e[0]-i[0],e[1]-i[1]],r=qe(Re(n[0],2)+Re(n[1],2)),s=Te(n[1],n[0]);return[i[0]+De(s+t)*r,i[1]+Ve(s+t)*r]});return e(n)};return Object.defineProperty(o,"points",{get:function(){return r}}),Object.defineProperty(o,"sides",{get:function(){return s}}),Object.defineProperty(o,"split",{value:d}),Object.defineProperty(o,"overlaps",{value:c}),Object.defineProperty(o,"scale",{value:l}),Object.defineProperty(o,"rotate",{value:g}),o}};Vi.regularPolygon=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,r=ki(e,t,i,n);return Vi(r)},Vi.convexHull=function(e){var t=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],i=Ai(e,t);return Vi(i)};var Di=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=vt(t);if(void 0!==n){var r=_i.apply(void 0,f(n)),s=function(){return r.map(function(e){return n[e]}).map(function(e,t,i){return[e,i[(t+1)%i.length]]}).map(function(e){return Ii.fromVectors(e[0],e[1])})},a=function(){return r.map(function(e){return n[e]}).map(function(e,t,i){return[e,i[(t+1)%i.length]]}).map(function(e){return pi(e[0],e[1])})};return{sectors:s,angles:a,get vectors(){return n},get vectorOrder(){return f(r)}}}};Di.fromVectors=function(){return Di.apply(void 0,arguments)},Di.fromPoints=function(e,t){var i=t.map(function(t){return t.map(function(n,r){return t[r]-e[r]})});return Di.fromVectors(i)};var Ti=Object.create(null);Object.assign(Ti,et,ft,Ni,Vt,St),Ti.clean_number=pt,Ti.is_number=function(e){return null!=e&&!isNaN(e)},Ti.is_vector=function(e){return null!=e&&null!=e[0]&&!isNaN(e[0])},Ti.is_iterable=_t,Ti.flatten_input=ht,Ti.semi_flatten_input=ut,Ti.get_vector=mt,Ti.get_vector_of_vectors=vt,Ti.get_matrix2=kt,Ti.get_edge=k,Ti.get_line=w,Ti.get_ray=E,Ti.get_two_vec2=P,Ti.get_array_of_vec=A,Ti.get_array_of_vec2=function(){var e=Array.from(arguments),t=e.filter(function(e){return e.constructor===Array});return 2<=t.length&&!isNaN(t[0][0])?t:1===t.length&&1<=t[0].length?t[0]:e},Ti.intersection=fi,Object.freeze(Ti);var qi={vector:ji,matrix2:Mi,matrix:Ci,line:Oi,ray:Bi,segment:Fi,circle:function(){for(var e=arguments.length,t=Array(e),i=0,n,r;i<e;i++)t[i]=arguments[i];var s=Array.from(t),a=s.filter(function(e){return!isNaN(e)});if(3===a.length){n=ji(a[0],a[1]);var o=g(a,3);r=o[2]}var d=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var s=w(t),a=[s.point[0]+s.vector[0],s.point[1]+s.vector[1]],o=si(n,r,s.point,a);return void 0===o?void 0:o.map(function(e){return ji(e)})},c=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var s=E(t),a=ai(n,r,s[0],s[1]);return void 0===a?void 0:a.map(function(e){return ji(e)})},l=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var s=P(t),a=oi(n,r,s[0],s[1]);return void 0===a?void 0:a.map(function(e){return ji(e)})};return{intersectionLine:d,intersectionRay:c,intersectionEdge:l,get origin(){return n},get radius(){return r},set origin(e){n=ji(e)},set radius(e){r=e}}},polygon:zi,convexPolygon:Vi,rectangle:function e(){for(var t=arguments.length,i=Array(t),n=0,r,s,a;n<t;n++)i[n]=arguments[n];var o=Array.from(i),d=o.filter(function(e){return!isNaN(e)}),c=o.filter(function(e){return e.constructor===Array});if(4===d.length){r=d.slice(0,2);var l=g(d,4);s=l[2],a=l[3]}1===c.length&&(c=c[0]),2===c.length&&"number"==typeof c[0][0]&&(r=c[0].slice(),s=c[1][0],a=c[1][1]);var f=[[r[0],r[1]],[r[0]+s,r[1]],[r[0]+s,r[1]+a],[r[0],r[1]+a]],p=L.bind(this),_=Object.create(p(e)),h=function(t,i){var n=null==i?[r[0]+s,r[1]+a]:i,o=r[0]+(n[0]-r[0])*(1-t),d=r[1]+(n[1]-r[1])*(1-t);return e(o,d,s*t,a*t)};return Object.defineProperty(_,"origin",{get:function(){return r}}),Object.defineProperty(_,"width",{get:function(){return s}}),Object.defineProperty(_,"height",{get:function(){return a}}),Object.defineProperty(_,"area",{get:function(){return s*a}}),Object.defineProperty(_,"scale",{value:h}),Object.defineProperty(_,"rotate",{value:function(){var e;return(e=Vi(f)).rotate.apply(e,arguments)}}),Object.defineProperty(_,"transform",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return Vi(f).transform(t)}}),_},junction:Di,sector:Ii,core:Ti},Ri=function(){var e=Object.create(null);return Object.defineProperty(e,"join",{value:function(e){return null==e?this:(this.nodes.total+=e.nodes.total,this.edges.total+=e.edges.total,this.nodes.isolated+=e.nodes.isolated,this.edges.duplicate+=e.edges.duplicate,this.edges.circular+=e.edges.circular,this)}}),Object.defineProperty(e,"isolatedNodes",{value:function(e){return this.nodes.isolated=e,this.nodes.total+=e,this}}),Object.defineProperty(e,"duplicateEdges",{value:function(e){return this.edges.duplicate=e,this.edges.total+=e,this}}),Object.defineProperty(e,"circularEdges",{value:function(e){return this.edges.circular=e,this.edges.total+=e,this}}),Object.freeze(e)},Xi=function(e,t){var i=Object.create(Ri());return i.nodes={total:0,isolated:0},i.edges={total:0,duplicate:0,circular:0},null!=e&&(i.nodes.total=e),null!=t&&(i.edges.total=t),i},Wi=function(e){var t=Object.create(null);t.graph=e;var i=function(){return t.graph.edges.filter(function(e){return e.nodes[0]===t||e.nodes[1]===t})},r=function(){var e=[];return i().filter(function(e){return!e.isCircular}).map(function(e){return e.nodes[0]===t?e.nodes[1]:e.nodes[0]}).filter(function(t){return!(0<=e.indexOf(t))&&e.push(t)})},s=function(){var e=Object.create(null);e.edges=i();var n=[];return e.nodes=e.edges.filter(function(e){return!e.isCircular}).map(function(e){return e.nodes[0]===t?e.nodes[1]:e.nodes[0]}).filter(function(e){return!(0<=n.indexOf(e))&&n.push(e)}),e},a=function(){return t.graph.edges.map(function(e){return e.nodes.map(function(e){return e===t?1:0}).reduce(function(e,t){return e+t},0)}).reduce(function(e,t){return e+t},0)};return Object.defineProperty(t,"adjacent",{get:function(){return s()}}),Object.defineProperty(t,"degree",{get:function(){return a()}}),Object.defineProperty(t,"isAdjacentToNode",{value:function(e){return 0<r.filter(function(t){return t===e}).length}}),t},Gi=function(e,t,i){var r=Object.create(null);r.graph=e,r.nodes=[t,i];var s=function(){return r.graph.edges.filter(function(t){return t!==r&&(t.nodes[0]===r.nodes[0]||t.nodes[0]===r.nodes[1]||t.nodes[1]===r.nodes[0]||t.nodes[1]===r.nodes[1])})},a=function(){return n(r.nodes)},o=function(){var e=Object.create(null);return e.nodes=a(),e.edges=s(),e},d=function(){return r.nodes[0]===r.nodes[1]};return Object.defineProperty(r,"adjacent",{get:function(){return o()}}),Object.defineProperty(r,"isAdjacentToEdge",{value:function(t){return r.nodes[0]===t.nodes[0]||r.nodes[1]===t.nodes[1]||r.nodes[0]===t.nodes[1]||r.nodes[1]===t.nodes[0]}}),Object.defineProperty(r,"isSimilarToEdge",{value:function(t){return r.nodes[0]===t.nodes[0]&&r.nodes[1]===t.nodes[1]||r.nodes[0]===t.nodes[1]&&r.nodes[1]===t.nodes[0]}}),Object.defineProperty(r,"otherNode",{value:function(e){return r.nodes[0]===e?r.nodes[1]:r.nodes[1]===e?r.nodes[0]:void 0}}),Object.defineProperty(r,"isCircular",{get:function(){return d()}}),Object.defineProperty(r,"duplicateEdges",{value:function(){return r.graph.edges.filter(function(e){return r.isSimilarToEdge(e)})}}),Object.defineProperty(r,"commonNodeWithEdge",{value:function(e){return r===e?void 0:r.nodes[0]===e.nodes[0]||r.nodes[0]===e.nodes[1]?r.nodes[0]:r.nodes[1]===e.nodes[0]||r.nodes[1]===e.nodes[1]?r.nodes[1]:void 0}}),Object.defineProperty(r,"uncommonNodeWithEdge",{value:function(e){return r===e?void 0:r.nodes[0]===e.nodes[0]||r.nodes[0]===e.nodes[1]?r.nodes[1]:r.nodes[1]===e.nodes[0]||r.nodes[1]===e.nodes[1]?r.nodes[0]:void 0}}),r},Yi="undefined"!=typeof window&&"undefined"!=typeof window.document,Ui="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,Ki="object"===("undefined"==typeof self?"undefined":j(self))&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,Hi={};if(Ui){var Zi=require("xmldom"),Qi=Zi.DOMParser,Ji=Zi.XMLSerializer;Hi.DOMParser=Qi,Hi.XMLSerializer=Ji,Hi.document=new Qi().parseFromString("<!DOCTYPE html><title>a</title>","text/html")}else Yi&&(Hi.DOMParser=window.DOMParser,Hi.XMLSerializer=window.XMLSerializer,Hi.document=window.document);var $i=function(e){for(;e.lastChild;)e.removeChild(e.lastChild)},en=function(e){var t=parseInt(e.getAttributeNS(null,"width"),10);return null==t||isNaN(t)?e.getBoundingClientRect().width:t},tn=function(e){var t=parseInt(e.getAttributeNS(null,"height"),10);return null==t||isNaN(t)?e.getBoundingClientRect().height:t},nn=function(e){var t=e.getAttribute("class");return null==t?[]:t.split(" ").filter(function(e){return""!==e})},rn=function(e,t){if(null==e)return e;var i=nn(e).filter(function(e){return e!==t});return i.push(t),e.setAttributeNS(null,"class",i.join(" ")),e},sn=function(e,t){if(null==e)return e;var i=nn(e).filter(function(e){return e!==t});return e.setAttributeNS(null,"class",i.join(" ")),e},an=function(e,t){return e.setAttributeNS(null,"class",t),e},on=function(e,t){return e.setAttributeNS(null,"id",t),e},dn=function(e,t){var i=new window.Blob([t],{type:"text/plain"}),n=document.createElement("a");n.setAttribute("href",window.URL.createObjectURL(i)),n.setAttribute("download",e),document.body.appendChild(n),n.click(),n.remove()},cn=function(){for(var e=[],t=0,i;t<document.styleSheets.length;t+=1){i=document.styleSheets[t];try{for(var n=("cssRules"in i)?i.cssRules:i.rules,a=0,o;a<n.length;a+=1)o=n[a],"cssText"in o?e.push(o.cssText):e.push("".concat(o.selectorText," {\n").concat(o.style.cssText,"\n}\n"))}catch(e){console.warn(e)}}return e.join("\n")},ln=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"image.svg",i=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];if(i){var n=document.createElementNS("http://www.w3.org/2000/svg","style");n.setAttribute("type","text/css"),n.innerHTML=cn(),e.appendChild(n)}var r=new XMLSerializer().serializeToString(e),s=T(r);null==window?console.warn("save() meant for in-browser use"):dn(t,s)},gn=function(e,t){if("string"==typeof e||e instanceof String){var i=new DOMParser().parseFromString(e,"text/xml"),n=i.getElementsByTagName("parsererror");if(0===n.length){var r=i.documentElement;return null!=t&&t(r),r}fetch(e).then(function(e){return e.text()}).then(function(e){return new DOMParser().parseFromString(e,"text/xml")}).then(function(e){var i=e.getElementsByTagName("svg");if(null==i||0===i.length)throw"error, valid XML found, but no SVG element";return null!=t&&t(i[0]),i[0]})}else if(e instanceof Document)return t(e),e},fn=Object.freeze({removeChildren:$i,getWidth:en,getHeight:tn,addClass:rn,removeClass:sn,setClass:an,setID:on,getPageCSS:cn,save:ln,load:gn}),pn=function(e,t,i,n,r){var s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,a=n/1-n,o=[t-a-s,i-a-s,n+2*a+2*s,r+2*a+2*s].join(" ");e.setAttributeNS(null,"viewBox",o)},_n=function(e){var t=e.getBoundingClientRect(),i=0===t.width?640:t.width,n=0===t.height?480:t.height;pn(e,0,0,i,n)},hn=function(e){var t=e.getAttribute("viewBox");return null==t?void 0:t.split(" ").map(function(e){return parseFloat(e)})},un=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;1e-8>t&&(t=.01);var r=e.createSVGMatrix().translate(i,n).scale(1/t).translate(-i,-n),s=hn(e);null==s&&_n(e);var a=e.createSVGPoint(),o=e.createSVGPoint(),d=M(s,2);a.x=d[0],a.y=d[1],o.x=s[0]+s[2],o.y=s[1]+s[3];var c=a.matrixTransform(r),l=o.matrixTransform(r);pn(e,c.x,c.y,l.x-c.x,l.y-c.y)},mn=function(e,t,i){var n=hn(e);null==n&&_n(e),n[0]+=t,n[1]+=i,e.setAttributeNS(null,"viewBox",n.join(" "))},vn=function(e,t,i){var n=e.createSVGPoint();n.x=t,n.y=i;var r=n.matrixTransform(e.getScreenCTM().inverse()),s=[r.x,r.y];return s.x=r.x,s.y=r.y,s},yn=Object.freeze({setViewBox:pn,getViewBox:hn,scaleViewBox:un,translateViewBox:mn,convertToViewBox:vn}),xn=function(e){var t=e;t.removeChildren=function(){return $i(e)},t.addClass=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return rn.apply(fn,[e].concat(i))},t.removeClass=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return sn.apply(fn,[e].concat(i))},t.setClass=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return an.apply(fn,[e].concat(i))},t.setID=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return on.apply(fn,[e].concat(i))}},kn=function(e){var t=e;["setViewBox","getViewBox","scaleViewBox","translateViewBox","convertToViewBox"].forEach(function(e){t[e]=function(){for(var i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];return yn[e].apply(yn,[t].concat(n))}})},bn=function(e,t){Object.keys(t).forEach(function(i){e[i]=function(){var n=t[i].apply(t,arguments);return e.appendChild(n),n}})},wn="http://www.w3.org/2000/svg",En=function(e,t){if(null!=t&&t.constructor===Array){var i=t.map(function(e){return e.constructor===Array?e:[e.x,e.y]}).reduce(function(e,t){return"".concat(e).concat(t[0],",").concat(t[1]," ")},"");e.setAttributeNS(null,"points",i)}},Pn=function(e,t,i,n,r,s){var a=!!(6<arguments.length&&void 0!==arguments[6])&&arguments[6],o=[t+De(r)*n,i+Ve(r)*n],c=[De(r)*n,Ve(r)*n],l=[De(s)*n,Ve(s)*n],g=[l[0]-c[0],l[1]-c[1]],f=c[0]*l[1]-c[1]*l[0],p=c[0]*l[0]+c[1]*l[1],_=0<Te(f,p)?0:1,h=a?"M ".concat(t,",").concat(i," l ").concat(c[0],",").concat(c[1]," "):"M ".concat(o[0],",").concat(o[1]," ");h+=["a ",n,n,0,_,1,g[0],g[1]].join(" "),a&&(h+=" Z"),e.setAttributeNS(null,"d",h)},An=function(e,t,i,n){var r=Hi.document.createElementNS(wn,"line");return e&&r.setAttributeNS(null,"x1",e),t&&r.setAttributeNS(null,"y1",t),i&&r.setAttributeNS(null,"x2",i),n&&r.setAttributeNS(null,"y2",n),xn(r),r},Sn=function(e,t,i){var n=Hi.document.createElementNS(wn,"circle");return e&&n.setAttributeNS(null,"cx",e),t&&n.setAttributeNS(null,"cy",t),i&&n.setAttributeNS(null,"r",i),xn(n),n},Nn=function(e,t,i,n){var r=Hi.document.createElementNS(wn,"ellipse");return e&&r.setAttributeNS(null,"cx",e),t&&r.setAttributeNS(null,"cy",t),i&&r.setAttributeNS(null,"rx",i),n&&r.setAttributeNS(null,"ry",n),xn(r),r},Ln=function(e,t,i,n){var r=Hi.document.createElementNS(wn,"rect");return e&&r.setAttributeNS(null,"x",e),t&&r.setAttributeNS(null,"y",t),i&&r.setAttributeNS(null,"width",i),n&&r.setAttributeNS(null,"height",n),xn(r),r},jn=function(e){var t=Hi.document.createElementNS(wn,"polygon");return En(t,e),xn(t),t},Mn=function(e){var t=Hi.document.createElementNS(wn,"polyline");return En(t,e),xn(t),t},Cn=function(e,t,i,n,r,s,a,o){var c=[[e,t],[i,n],[r,s],[a,o]].map(function(e){return e.join(",")}),l="M ".concat(c[0]," C ").concat(c[1]," ").concat(c[2]," ").concat(c[3]),d=Hi.document.createElementNS(wn,"path");return d.setAttributeNS(null,"d",l),xn(d),d},On=function(e,t,i){var n=Hi.document.createElementNS(wn,"text");return n.innerHTML=e,n.setAttributeNS(null,"x",t),n.setAttributeNS(null,"y",i),xn(n),n},Bn=function(e,t,i,n,r){var s=Hi.document.createElementNS(wn,"path");return Pn(s,e,t,i,n,r,!0),xn(s),s},Fn=function(e,t,i,n,r){var s=Hi.document.createElementNS(wn,"path");return Pn(s,e,t,i,n,r,!1),xn(s),s},In=function(e,t,i,n){var s=.5*(2*Ie/n),o=De(s)*i,r=Array.from(Array(n)).map(function(r,d){var i=-2*Ie*d/n+s,a=e+o*Ve(i),c=t+o*De(i);return[a,c]});return jn(r)},zn="http://www.w3.org/2000/svg",Vn=function(e,t,i){var n={color:"#000",strokeWidth:.5,strokeStyle:"",fillStyle:"",highlight:void 0,highlightStrokeStyle:"",highlightFillStyle:"",width:.5,length:2,padding:0,start:!1,end:!0};"object"===j(i)&&null!==i&&Object.assign(n,i);var r=["stroke:none","fill:".concat(n.color),n.fillStyle,"pointer-events:none"].filter(function(e){return""!==e}).join(";"),s=["fill:none","stroke:".concat(n.color),"stroke-width:".concat(n.strokeWidth),n.strokeStyle].filter(function(e){return""!==e}).join(";"),a=Ce(3*n.strokeWidth)/10,o=Ce(6*n.strokeWidth)/10,d=["fill:none","stroke:".concat(n.highlight),"stroke-width:".concat(.5*n.strokeWidth),"stroke-dasharray:".concat(a," ").concat(o),"stroke-linecap:round",n.strokeStyle].filter(function(e){return""!==e}).join(";"),c=["stroke:none","fill:".concat(n.highlight),n.fillStyle,"pointer-events:none"].filter(function(e){return""!==e}).join(";"),g=e,f=t,p=[f[0]-g[0],f[1]-g[1]],_=qe(p[0]*p[0]+p[1]*p[1]),h=[p[0]/_,p[1]/_],u=[h[1],-h[0]];g=[e[0]+h[0]*(n.start?1:0)*n.padding,e[1]+h[1]*(n.start?1:0)*n.padding],f=[t[0]-h[0]*(n.end?1:0)*n.padding,t[1]-h[1]*(n.end?1:0)*n.padding];var m=[[f[0]+u[0]*n.width,f[1]+u[1]*n.width],[f[0]-u[0]*n.width,f[1]-u[1]*n.width],[f[0]+h[0]*n.length,f[1]+h[1]*n.length]],v=[[g[0]-u[0]*n.width,g[1]-u[1]*n.width],[g[0]+u[0]*n.width,g[1]+u[1]*n.width],[g[0]-h[0]*n.length,g[1]-h[1]*n.length]],y=Hi.document.createElementNS(zn,"g"),x=An(g[0],g[1],f[0],f[1]);if(x.setAttribute("style",s),y.appendChild(x),n.end){var l=jn(m);l.setAttribute("style",r),y.appendChild(l)}if(n.start){var k=jn(v);k.setAttribute("style",r),y.appendChild(k)}if(void 0!==n.highlight){var b=.6,w=[.09*(h[0]*n.length),.09*(h[1]*n.length)],E=[[w[0]+f[0]+u[0]*(n.width*b),w[1]+f[1]+u[1]*(n.width*b)],[w[0]+f[0]-u[0]*(n.width*b),w[1]+f[1]-u[1]*(n.width*b)],[w[0]+f[0]+h[0]*(n.length*b),w[1]+f[1]+h[1]*(n.length*b)]],P=[[-w[0]+g[0]-u[0]*(n.width*b),-w[1]+g[1]-u[1]*(n.width*b)],[-w[0]+g[0]+u[0]*(n.width*b),-w[1]+g[1]+u[1]*(n.width*b)],[-w[0]+g[0]-h[0]*(n.length*b),-w[1]+g[1]-h[1]*(n.length*b)]],A=An(g[0],g[1],f[0],f[1]);if(A.setAttribute("style",d),y.appendChild(A),n.end){var S=jn(E);S.setAttribute("style",c),y.appendChild(S)}if(n.start){var N=jn(P);N.setAttribute("style",c),y.appendChild(N)}}return y},Dn=function(e,t,i){var n={color:"#000",strokeWidth:.5,width:.5,length:2,bend:.3,pinch:.618,padding:.5,side:!0,start:!1,end:!0,strokeStyle:"",fillStyle:""};"object"===j(i)&&null!==i&&Object.assign(n,i);var r=["stroke:none","fill:".concat(n.color),n.fillStyle].filter(function(e){return""!==e}).join(";"),s=["fill:none","stroke:".concat(n.color),"stroke-width:".concat(n.strokeWidth),n.strokeStyle].filter(function(e){return""!==e}).join(";"),a=e,o=t,d=[o[0]-a[0],o[1]-a[1]],c=[a[0]+d[0]/2,a[1]+d[1]/2],l=qe(d[0]*d[0]+d[1]*d[1]),g=2.5*((n.start?1+n.padding:0+n.end?1+n.padding:0)*n.length);if(l<g){var f=[d[0]/l*g,d[1]/l*g];a=[c[0]-.5*f[0],c[1]-.5*f[1]],o=[c[0]+.5*f[0],c[1]+.5*f[1]],d=[o[0]-a[0],o[1]-a[1]]}var p=[d[1],-d[0]],_=[c[0]+p[0]*(n.side?1:-1)*n.bend,c[1]+p[1]*(n.side?1:-1)*n.bend],h=[_[0]-a[0],_[1]-a[1]],u=[_[0]-o[0],_[1]-o[1]],m=qe(h[0]*h[0]+h[1]*h[1]),v=qe(u[0]*u[0]+u[1]*u[1]),y=[h[0]/m,h[1]/m],x=[u[0]/v,u[1]/v],k=[-y[0],-y[1]],b=[-x[0],-x[1]],w=[k[1],-k[0]],E=[b[1],-b[0]],P=[a[0]+y[0]*n.length*((n.start?1:0)+n.padding),a[1]+y[1]*n.length*((n.start?1:0)+n.padding)],A=[o[0]+x[0]*n.length*((n.end?1:0)+n.padding),o[1]+x[1]*n.length*((n.end?1:0)+n.padding)];d=[A[0]-P[0],A[1]-P[1]],p=[d[1],-d[0]],c=[P[0]+d[0]/2,P[1]+d[1]/2],_=[c[0]+p[0]*(n.side?1:-1)*n.bend,c[1]+p[1]*(n.side?1:-1)*n.bend];var S=[P[0]+(_[0]-P[0])*n.pinch,P[1]+(_[1]-P[1])*n.pinch],N=[A[0]+(_[0]-A[0])*n.pinch,A[1]+(_[1]-A[1])*n.pinch],L=[[P[0]+w[0]*-n.width,P[1]+w[1]*-n.width],[P[0]+w[0]*n.width,P[1]+w[1]*n.width],[P[0]+k[0]*n.length,P[1]+k[1]*n.length]],M=[[A[0]+E[0]*-n.width,A[1]+E[1]*-n.width],[A[0]+E[0]*n.width,A[1]+E[1]*n.width],[A[0]+b[0]*n.length,A[1]+b[1]*n.length]],C=Hi.document.createElementNS(zn,"g"),O=Cn(P[0],P[1],S[0],S[1],N[0],N[1],A[0],A[1]);if(O.setAttribute("style",s),C.appendChild(O),n.start){var B=jn(L);B.setAttribute("style",r),C.appendChild(B)}if(n.end){var F=jn(M);F.setAttribute("style",r),C.appendChild(F)}return C},Tn="http://www.w3.org/2000/svg",qn={line:An,circle:Sn,ellipse:Nn,rect:Ln,polygon:jn,polyline:Mn,bezier:Cn,text:On,wedge:Bn,arc:Fn,straightArrow:Vn,arcArrow:Dn,regularPolygon:In},Rn=function(e){xn(e),kn(e),bn(e,qn)},Xn=function(){var e=Hi.document.createElementNS(Tn,"svg");return e.setAttribute("version","1.1"),e.setAttribute("xmlns",Tn),Rn(e),e},Wn=function(){var e=Hi.document.createElementNS(Tn,"g");return xn(e),bn(e,qn),e};qn.group=Wn;var Gn={begin:"onMouseDown",enter:"onMouseEnter",leave:"onMouseLeave",move:"onMouseMove",end:"onMouseUp",scroll:"onScroll"},Yn=function(e){var t=e,i=Object.create(null);Object.assign(i,{isPressed:!1,position:[0,0],pressed:[0,0],drag:[0,0],prev:[0,0],x:0,y:0});var n=function(e,n){i.position=vn(t,e,n),i.x=i.position[0],i.y=i.position[1]},r=function(e,r){i.isPressed=!0,i.pressed=vn(t,e,r),n(e,r)},s=function(){i.drag=[i.position[0]-i.pressed[0],i.position[1]-i.pressed[1]],i.drag.x=i.drag[0],i.drag.y=i.drag[1]},a={};return Object.defineProperty(a,"getPointer",{value:function(){var e=i.position.slice();return Object.keys(i).filter(function(e){return"object"===j(e)}).forEach(function(t){return e[t]=i[t].slice()}),Object.keys(i).filter(function(e){return"object"!==j(e)}).forEach(function(t){return e[t]=i[t]}),Object.freeze(e)}}),Object.defineProperty(a,"didMove",{value:function(e,t){i.prev=i.position,n(e,t),i.isPressed&&s()}}),Object.defineProperty(a,"didPress",{value:r}),Object.defineProperty(a,"didRelease",{value:function(){i.isPressed=!1}}),Object.defineProperty(a,"node",{set:function(e){t=e}}),a},Un=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=t.filter(function(e){return e instanceof HTMLElement}).shift(),r=t.filter(function(e){return"string"==typeof e||e instanceof String}).map(function(e){return Hi.document.getElementById(e)}).shift();return null==n?null==r?Hi.document.body:r:n},Kn=function(e,t){var i=t.filter(function(e){return!isNaN(e)});if(2<=i.length)e.setAttributeNS(null,"width",i[0]),e.setAttributeNS(null,"height",i[1]),pn(e,0,0,i[0],i[1]);else if(null==e.getAttribute("viewBox")){var n=e.getBoundingClientRect();pn(e,0,0,n.width,n.height)}},Hn=function e(t){Object.defineProperty(t,"w",{get:function(){return en(t)},set:function(e){return t.setAttributeNS(null,"width",e)}}),Object.defineProperty(t,"h",{get:function(){return tn(t)},set:function(e){return t.setAttributeNS(null,"height",e)}}),t.getWidth=function(){return en(t)},t.getHeight=function(){return tn(t)},t.setWidth=function(e){return t.setAttributeNS(null,"width",e)},t.setHeight=function(e){return t.setAttributeNS(null,"height",e)},t.save=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"image.svg";return ln(t,e)},t.load=function(i,n){gn(i,function(i,r){var s=t.parentNode;null!=i&&(i.events=t.events,Rn(i),null==i.events?i.events=q(i):i.events.setup(i),e(i),null!=s&&s.insertBefore(i,t),t.remove(),t=i),null!=n&&n(t,r)})}},Zn=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=Xn();Kn(n,t),Hn(n),n.events=q(n);var r=function(){Kn(n,t);var e=Un.apply(void 0,t);null!=e&&e.appendChild(n),t.filter(function(e){return"function"==typeof e}).forEach(function(e){return e()})};return"loading"===Hi.document.readyState?Hi.document.addEventListener("DOMContentLoaded",r):r(),n},Qn=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};null==t.radius&&(t.radius=1),null==t.fill&&(t.fill="#000"),null==t.stroke&&(t.stroke="none");var i=Sn(0,0,t.radius);i.setAttribute("style","fill:".concat(t.fill,";stroke:").concat(t.stroke,";"));var n=[0,0],r=!1;null!=e&&e.appendChild(i);var s=function(e,t){n[0]=e,n[1]=t,i.setAttribute("cx",e),i.setAttribute("cy",t)};if("position"in t){var a=t.position;null==a[0]?null!=a.x&&s(a.x,a.y):s.apply(void 0,C(a))}var o=function(e){return e},d=function(e){if(r){var t=o(e);s(t[0],t[1])}};return{circle:i,set position(e){null==e[0]?null!=e.x&&s(e.x,e.y):s(e[0],e[1])},get position(){return[].concat(n)},onMouseUp:function(){r=!1},onMouseMove:d,distance:function(e){return qe(Re(e[0]-n[0],2)+Re(e[1]-n[1],2))},remove:function(){e.removeChild(i)},set positionDidUpdate(e){o=e},set selected(e){r=!0}}},Jn=/*#__PURE__*/Object.freeze({svg:Xn,group:Wn,style:function(){var e=Hi.document.createElementNS(Tn,"style");return e.setAttribute("type","text/css"),e},line:An,circle:Sn,ellipse:Nn,rect:Ln,polygon:jn,polyline:Mn,bezier:Cn,text:On,wedge:Bn,arc:Fn,setPoints:En,setArc:Pn,regularPolygon:In,straightArrow:Vn,arcArrow:Dn,setViewBox:pn,getViewBox:hn,scaleViewBox:un,translateViewBox:mn,convertToViewBox:vn,removeChildren:$i,save:ln,load:gn,image:Zn,controls:function(e,t,i){null==i&&(i={}),null==i.parent&&(i.parent=e),null==i.radius&&(i.radius=1),null==i.fill&&(i.fill="#000000");var n=Array.from(Array(t)).map(function(){return Qn(i.parent,i)}),r=function(t){t.preventDefault();var r=vn(e,t.clientX,t.clientY);0<n.length&&(o=n.map(function(e,t){return{i:t,d:e.distance(r)}}).sort(function(e,t){return e.d-t.d}).shift().i,n[o].selected=!0)},s=function(t){t.preventDefault();var i=t.touches[0];if(null!=i){var r=vn(e,i.clientX,i.clientY);0<n.length&&(o=n.map(function(e,t){return{i:t,d:e.distance(r)}}).sort(function(e,t){return e.d-t.d}).shift().i,n[o].selected=!0)}},a=function(e){e.preventDefault(),n.forEach(function(e){return e.onMouseUp()}),o=void 0},o;return e.addEventListener("touchstart",s,!1),e.addEventListener("touchend",a,!1),e.addEventListener("touchcancel",a,!1),e.addEventListener("touchmove",function(t){t.preventDefault();var i=t.touches[0];if(null!=i){var r=vn(e,i.clientX,i.clientY);n.forEach(function(e){return e.onMouseMove(r)})}},!1),e.addEventListener("mousedown",r,!1),e.addEventListener("mouseup",function(e){e.preventDefault(),n.forEach(function(e){return e.onMouseUp()}),o=void 0},!1),e.addEventListener("mousemove",function(t){t.preventDefault();var i=vn(e,t.clientX,t.clientY);n.forEach(function(e){return e.onMouseMove(i)})},!1),Object.defineProperty(n,"selectedIndex",{get:function(){return o}}),Object.defineProperty(n,"selected",{get:function(){return n[o]}}),Object.defineProperty(n,"removeAll",{value:function(){n.forEach(function(e){return e.remove()}),n.splice(0,n.length),o=void 0}}),Object.defineProperty(n,"add",{value:function(t){n.push(Qn(e,t))}}),n},controlPoint:Qn}),$n=function(e){var t=e.edges_vertices,n=[];return t.forEach(function(e,t){return e.forEach(function(e){void 0===n[e]&&(n[e]=[]),n[e].push(t)})}),n},er=function(e){var t=e.faces_vertices,i=t.length,n=Array.from(Array(i)).map(function(){return[]}),r={};return t.forEach(function(e,t){if(void 0!==e){var s=e.length;e.forEach(function(e,a,i){var o=i[(a+1)%s];if(o<e){var d=[o,e];e=d[0],o=d[1]}var c="".concat(e," ").concat(o);if(c in r){var l=r[c];n[t].push(l),n[l].push(t)}else r[c]=t})}}),n},tr=function(e){var t=e.edges_vertices,i=e.faces_edges,n=Array.from(Array(t.length)).map(function(){return[]});return i.forEach(function(e,t){return e.forEach(function(e){return n[e].push(t)})}),n},ir=function(e){return e.edges_vertices.map(function(t){return t.map(function(t){return e.vertices_coords[t]})}).map(function(e){var t;return(t=qi.core).distance.apply(t,n(e))})},nr=function(e){var t=e.edges_vertices,n={};return t.map(function(e){return e.sort(function(e,t){return e-t}).join(" ")}).forEach(function(e,t){n[e]=t}),n},rr=function(e){var t=e.vertices_coords,i=e.faces_vertices,n=Array.from(Array(t.length)).map(function(){return[]});return i.forEach(function(e,t){return e.forEach(function(e){return n[e].push(t)})}),n},sr=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=nr(e),n=er(e);if(0>=n.length)return[];var r=[t],s=[[{face:t,parent:void 0,edge:void 0,level:0}]];do s[s.length]=s[s.length-1].map(function(t){var s=n[t.face].filter(function(e){return-1===r.indexOf(e)});return r=r.concat(s),s.map(function(n){var r=e.faces_vertices[n].filter(function(i){return-1!==e.faces_vertices[t.face].indexOf(i)}).sort(function(e,t){return e-t}),s=i[r.join(" ")];return{face:n,parent:t.face,edge:s,edge_vertices:r}})}).reduce(function(e,t){return e.concat(t)},[]);while(0<s[s.length-1].length);return 0<s.length&&0===s[s.length-1].length&&s.pop(),s},ar=function(e){return"f"===e||"F"===e||"u"===e||"U"===e},or=function(e,t){var i=!0=="edges_assignment"in e,n=i?e.edges_assignment.map(function(e){return!ar(e)}):e.edges_vertices.map(function(){return!0}),r=e.faces_vertices.map(function(){return[1,0,0,1,0,0]});return sr(e,t).forEach(function(t){t.filter(function(e){return null!=e.parent}).forEach(function(t){var i=t.edge_vertices.map(function(t){return e.vertices_coords[t]}),s=[i[1][0]-i[0][0],i[1][1]-i[0][1]],a=n[t.edge]?qi.core.make_matrix2_reflection(s,i[0]):[1,0,0,1,0,0];r[t.face]=qi.core.multiply_matrices2(r[t.parent],a)})}),r},dr=function(e,t){var i=!0=="edges_assignment"in e?e.edges_assignment.map(function(e){return!ar(e)}):e.edges_vertices.map(function(){return!0}),n=e.faces_vertices.map(function(){return[1,0,0,1,0,0]});return sr(e,t).forEach(function(t){t.filter(function(e){return null!=e.parent}).forEach(function(t){var r=t.edge_vertices.map(function(t){return e.vertices_coords[t]}),s=[r[1][0]-r[0][0],r[1][1]-r[0][1]],a=i[t.edge]?qi.core.make_matrix2_reflection(s,r[0]):[1,0,0,1,0,0];n[t.face]=qi.core.multiply_matrices2(a,n[t.parent])})}),n},cr=function(e,t,n){if(null==t&&(t=0),null==n)n=or(e,t);else{var r=null==e.faces_vertices?e.faces_edges:e.faces_vertices,s=null==r?0:r.length;n.length!==s&&(n=or(e,t))}var a=e.vertices_coords.map(function(t,n){for(var i=0;i<e.faces_vertices.length;i+=1)if(e.faces_vertices[i].includes(n))return i});return e.vertices_coords.map(function(e,t){return qi.core.multiply_vector2_matrix2(e,n[a[t]]).map(function(e){return qi.core.clean_number(e)})})},lr=function(e){var t=$n(e),i=e.edges_assignment.map(function(e){return"b"===e||"B"===e});return t.map(function(e){return e.map(function(t){return i[t]}).reduce(function(e,t){return e||t},!1)})},gr=function(e){return e.map(function(e){return e[0]*e[3]-e[1]*e[2]}).map(function(e){return 0<=e})},fr=/*#__PURE__*/Object.freeze({make_vertices_edges:$n,make_faces_faces:er,make_edges_faces:tr,make_edges_length:ir,make_vertex_pair_to_edge_map:nr,make_vertices_faces:rr,make_face_walk_tree:sr,make_faces_matrix:or,make_faces_matrix_inv:dr,make_vertices_coords_folded:cr,make_vertices_isBoundary:lr,faces_coloring_from_faces_matrix:gr}),pr=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return Fe.apply(Math,n(t.filter(function(e){return void 0!==e}).map(function(e){return e.length})))},_r=function(e){var t=e.vertices_coords,i=e.vertices_faces,n=e.vertices_vertices;return pr([],t,i,n)},hr=function(e){var t=e.edges_vertices,i=e.edges_faces;return pr([],t,i)},ur=function(e){var t=e.faces_vertices,i=e.faces_edges;return pr([],t,i)},mr=function(e,t){var i=e.vertices_coords;if(void 0!==i&&0!==i.length){var r=n(t);return null==r[2]&&(r[2]=0),i.map(function(e){return e.map(function(e,t){return Re(e-r[t],2)}).reduce(function(e,t){return e+t},0)}).map(function(e,t){return{d:qe(e),i:t}}).sort(function(e,t){return e.d-t.d}).shift().i}},vr=function(e,t){var n=e.vertices_coords,r=e.edges_vertices;if(null!=n&&0!==n.length&&null!=r&&0!==r.length){for(var s=function(e){return e<-qi.core.EPSILON?0:e>1+qi.core.EPSILON?1:e},a=r.map(function(t){return t.map(function(e){return n[e]})}).map(function(t){return[t[0],[t[1][0]-t[0][0],t[1][1]-t[0][1]]]}).map(function(e){return qi.core.nearest_point_on_line(e[0],e[1],t,s)}).map(function(e,n){return{p:e,i:n,d:qi.core.distance2(t,e)}}),o=1/0,d=0,c;d<a.length;d+=1)a[d].d<o&&(c=d,o=a[d].d);return c}},yr=function(e,t){var i=e.vertices_coords,n=e.faces_vertices;if(null!=i&&0!==i.length&&null!=n&&0!==n.length){var r=n.map(function(e,t){return{face:e.map(function(e){return i[e]}),i:t}}).filter(function(e){return qi.core.point_in_poly(t,e.face)}).shift();return null==r?void 0:r.i}},xr=function(e,t){var i=e.vertices_coords,n=e.faces_vertices;return n.map(function(e,t){return{face:e.map(function(e){return i[e]}),i:t}}).filter(function(e){return qi.core.point_in_poly(t,e.face)}).map(function(e){return e.i})},kr=function(e,t){if(null==t&&(t=Array.from(Array(ur(e))).map(function(e,t){return t})),0!==t.length){if(1===t.length)return t[0];for(var n=e["faces_re:layer"].map(function(e,t){return{layer:e,i:t}}).sort(function(e,t){return t.layer-e.layer}).map(function(e){return e.i}),r=0;r<n.length;r+=1)if(t.includes(n[r]))return n[r]}},br=function(e){var t=e.vertices_coords;if(null==t||0>=t.length)return[0,0,0,0];var i=t[0].length,r=Array(i).fill(1/0),s=Array(i).fill(-Infinity);return t.forEach(function(e){return e.forEach(function(e,t){e<r[t]&&(r[t]=e),e>s[t]&&(s[t]=e)})}),isNaN(r[0])||isNaN(r[1])||isNaN(s[0])||isNaN(s[1])?[0,0,0,0]:[r[0],r[1],s[0]-r[0],s[1]-r[1]]},wr=function(e){for(var n=e.edges_vertices,r=e.edges_assignment,s=r.map(function(e){return"B"===e||"b"===e}),a=$n({edges_vertices:n}),o=[],d=[],c=-1,l=0;l<s.length;l+=1)if(s[l]){c=l;break}if(-1===c)return{vertices:[],edges:[]};s[c]=!1,o.push(c),d.push(n[c][0]);for(var g=n[c][1];d[0]!==g;){if(d.push(g),c=a[g].filter(function(e){return s[e]}).shift(),void 0===c)return{vertices:[],edges:[]};if(n[c][0]===g){var f=t(n[c],2);g=f[1]}else{var p=t(n[c],1);g=p[0]}s[c]=!1,o.push(c)}return{vertices:d,edges:o}},Er=function(t){for(var n=t.edges_vertices,r=t.vertices_coords,s=r.length,a=Array(s).fill(!0),o=s,d=0;d<n.length&&0<o;d+=1)for(var c=0,l;c<n[d].length;c+=1)l=n[d][c],a[l]&&(o-=1,a[l]=!1);return 0===o?[]:a.map(function(e,t){return e?t:void 0}).filter(function(e){return void 0!==e})},Pr=function(e){for(var t=function(e,t){return e[0]===t[0]&&e[1]===t[1]||e[0]===t[1]&&e[1]===t[0]},n=Array.from(Array(e.edges_vertices.length)).map(function(){return[]}),r=0;r<e.edges_vertices.length-1;r+=1)for(var s=r+1;s<e.edges_vertices.length;s+=1)n[r][s]=t(e.edges_vertices[r],e.edges_vertices[s]);var a=e.edges_vertices.map(function(){});n.forEach(function(e,t){return e.forEach(function(e,i){e&&(a[i]=void 0===a[t]?t:a[t])})});var o=a.map(function(e){return void 0!==e});return a.forEach(function(e,t){void 0===e&&(a[t]=t)}),o.map(function(e,t){return e?t:void 0}).filter(function(e){return void 0!==e})},Ar=/*#__PURE__*/Object.freeze({vertices_count:_r,edges_count:hr,faces_count:ur,implied_vertices_count:function(e){var t=e.faces_vertices,i=e.edges_vertices,n=0;return[t,i].filter(function(e){return void 0!==e}).forEach(function(e){return e.forEach(function(e){return e.forEach(function(t){t>n&&(n=t)})})}),n},implied_edges_count:function(e){var t=e.faces_edges,i=e.vertices_edges,n=e.edgeOrders,r=0;return[t,i].filter(function(e){return void 0!==e}).forEach(function(e){return e.forEach(function(e){return e.forEach(function(t){t>r&&(r=t)})})}),void 0!==n&&n.forEach(function(e){return e.forEach(function(t,e){2!==e&&t>r&&(r=t)})}),r},implied_faces_count:function(e){var t=e.vertices_faces,i=e.edges_faces,n=e.facesOrders,r=0;return[t,i].filter(function(e){return void 0!==e}).forEach(function(e){return e.forEach(function(e){return e.forEach(function(e){e>r&&(r=e)})})}),void 0!==n&&n.forEach(function(e){return e.forEach(function(e,t){2!==t&&e>r&&(r=e)})}),r},nearest_vertex:mr,nearest_edge:vr,face_containing_point:yr,folded_faces_containing_point:function(e,t,i){var n=e.vertices_coords,r=e.faces_vertices,s=i.map(function(e){return qi.core.multiply_vector2_matrix2(t,e)});return r.map(function(e,t){return{face:e.map(function(e){return n[e]}),i:t}}).filter(function(e,t){return qi.core.intersection.point_in_poly(s[t],e.face)}).map(function(e){return e.i})},faces_containing_point:xr,topmost_face:kr,bounding_rect:br,get_boundary:wr,get_collinear_vertices:function(e){var t=e.edges_vertices,i=e.vertices_coords,n=$n({edges_vertices:t});return Array.from(Array(i.length)).map(function(e,t){return t}).filter(function(){return 2===n.length}).map(function(e){var t=n[e],r=t[0][0]===e?t[0][1]:t[0][0],s=t[1][0]===e?t[1][1]:t[1][0],a=qi.core.distance2(i[r],i[e]),o=qi.core.distance2(i[s],i[e]),d=qi.core.distance2(i[r],i[s]);return ze(d-a-o)<qi.core.EPSILON?e:void 0}).filter(function(e){return void 0!==e})},get_isolated_vertices:Er,get_duplicate_vertices:function(e){for(var t=e.vertices_coords,n=Array.from(Array(t.length)).map(function(){return[]}),r=0;r<t.length-1;r+=1)for(var s=r+1;s<t.length;s+=1)n[r][s]=qi.core.equivalent_vectors(t[r],t[s]);var a=t.map(function(){});n.forEach(function(e,t){return e.forEach(function(e,i){e&&(a[i]=void 0===a[t]?t:a[t])})});var o=a.map(function(e){return void 0!==e});return a.forEach(function(e,t){void 0===e&&(a[t]=t)}),o.map(function(e,t){return e?t:void 0}).filter(function(e){return void 0!==e})},get_duplicate_edges:function(e){for(var t=e.edges_vertices,n=function(e,t){return e[0]===t[0]&&e[1]===t[1]||e[0]===t[1]&&e[1]===t[0]},r=Array.from(Array(t.length)).map(function(){return[]}),s=0;s<t.length-1;s+=1)for(var a=s+1;a<t.length;a+=1)r[s][a]=n(t[s],t[a]);var o=[];return r.forEach(function(e,t){return e.forEach(function(e,i){e&&(o[i]=void 0===o[t]?t:o[t])})}),o},get_duplicate_edges_old:Pr,find_collinear_face_edges:function(e,t,i){var n=t.map(function(e){return i[e]}).map(function(e,t,i){return[e,i[(t+1)%i.length]]});return e.map(function(r){var s=n.map(function(e,t){return{index:t,edge:e}}).filter(function(t){return qi.core.intersection.point_on_edge(t.edge[0],t.edge[1],r)}).shift().index;return[t[s],t[(s+1)%t.length]].sort(function(e,t){return e-t})})}}),Nr=function(e,t){var i=e.parameters.points;e.valid=qi.core.point_in_convex_poly(i[0],t)&&qi.core.point_in_convex_poly(i[1],t),e.valid_solutions=[e.valid]},Lr=[null,Nr,Nr,function(e,t){var i=qi.core.intersection,n=e.parameters.lines,r=i.convex_poly_line(t,n[0][0],n[0][1]),s=i.convex_poly_line(t,n[1][0],n[1][1]);e.valid=void 0!==r&&void 0!==s,e.valid_solutions=e.solutions.map(function(e){return void 0!==e&&void 0!==i.convex_poly_line(t,e[0],e[1])})},function(e,t){var i=e.parameters,n=qi.core.intersection.line_line(i.lines[0][0],i.lines[0][1],i.points[0],[i.lines[0][1][1],-i.lines[0][1][0]]);void 0===n&&(e.valid=!1,e.valid_solutions=[!1]),e.valid=qi.core.point_in_convex_poly(n,t)&&qi.core.point_in_convex_poly(i.points[0],t),e.valid_solutions=[e.valid]},function(e,t){if(0===e.solutions.length)return e.valid=!1,void(e.valid_solutions=[!1,!1]);var i=e.parameters;e.test={},e.test.points_reflected=e.solutions.map(function(e){return qi.core.make_matrix2_reflection(e[1],e[0])}).map(function(e){return qi.core.multiply_vector2_matrix2(i.points[1],e)}),e.valid=qi.core.point_in_convex_poly(i.points[0],t)&&qi.core.point_in_convex_poly(i.points[1],t),e.valid_solutions=e.test.points_reflected.map(function(e){return qi.core.point_in_convex_poly(e,t)})},function(e,t){var i=qi.core.intersection,n=e.solutions.map(function(e){return i.convex_poly_line(t,e[0],e[1])}).filter(function(e){return void 0!==e});if(0===n.length)return e.valid=!1,void(e.valid_solutions=[!1,!1,!1]);var r=e.parameters.lines,s=i.convex_poly_line(t,r[0][0],r[0][1]),a=i.convex_poly_line(t,r[1][0],r[1][1]),o=e.parameters;for(e.test={},e.test.points_reflected=e.solutions.map(function(e){return qi.core.make_matrix2_reflection(e[1],e[0])}).map(function(e){return o.points.map(function(t){return qi.core.multiply_vector2_matrix2(t,e)})}).reduce(function(e,t){return e.concat(t)},[]),e.valid=void 0!==s&&void 0!==a&&qi.core.point_in_convex_poly(o.points[0],t)&&qi.core.point_in_convex_poly(o.points[1],t),e.valid_solutions=e.solutions.map(function(t,n){return[e.test.points_reflected[2*n],e.test.points_reflected[2*n+1]]}).map(function(e){return qi.core.point_in_convex_poly(e[0],t)&&qi.core.point_in_convex_poly(e[1],t)});3>e.valid_solutions.length;)e.valid_solutions.push(!1)},function(e,t){0===e.solutions.length&&(e.valid=!1,e.valid_solutions=[!1]);var i=e.solutions[0],n=e.parameters,r=qi.core.make_matrix2_reflection(i[1],i[0]),s=qi.core.multiply_vector2_matrix2(n.points[0],r),a=qi.core.intersection.line_line(n.lines[1][0],n.lines[1][1],i[0],i[1]);e.test={points_reflected:[s]},e.valid=qi.core.point_in_convex_poly(n.points[0],t)&&qi.core.point_in_convex_poly(s,t)&&qi.core.point_in_convex_poly(a,t),e.valid_solutions=[e.valid]}],jr=function(e,t){return Lr[e.axiom].call(null,e,t),e},Mr=function(e,t,i){var n={axiom:e,parameters:t,solutions:i};return Object.defineProperty(n,"apply",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return jr.apply(void 0,[n].concat(t))}}),n},Cr=function(e,t){var n=qi.core.get_vector(e),r=qi.core.get_vector(t),i=n.map(function(e,t){return r[t]-n[t]});return Mr(1,{points:[n,r]},[[n,i]])},Or=function(e,t){var i=qi.core.midpoint2(e,t),n=qi.core.normalize(e.map(function(n,r){return t[r]-e[r]})),r=[i,[-n[1],n[0]]];return Mr(2,{points:[e,t]},[r])},Br=function(e,t,i,n){var r=qi.core.bisect_lines2(e,t,i,n);return Mr(3,{lines:[[e,t],[i,n]]},r)},Fr=function(e,t,i){var r=qi.core.normalize(t),s=[n(i),[r[1],-r[0]]];return Mr(4,{points:[i],lines:[[e,t]]},[s])},Ir=function(e,t,i,n){var r=qi.core.get_vector(e),s=qi.core.get_vector(t),a=qi.core.get_vector(i),o=qi.core.get_vector(n),d=qe(Re(a[0]-o[0],2)+Re(a[1]-o[1],2)),c=[r[0]+s[0],r[1]+s[1]],l=qi.core.intersection.circle_line(a,d,r,c)||[],g=l.map(function(e){var t=qi.core.midpoint2(o,e),i=qi.core.normalize(e.map(function(t,n){return e[n]-o[n]}));return[t,[i[1],-i[0]]]});return Mr(5,{points:[a,o],lines:[[r,s]]},g)},zr=function(e,t,i,n,r){var s=qi.core.get_vector(e),a=qi.core.get_vector(i),o=qi.core.get_vector(r),d=qi.core.get_vector(t),c=qi.core.get_vector(n),l={points:[o],lines:[[s,d],[a,c]]},g=qi.core.intersection.line_line(s,d,o,c);if(void 0===g)return Mr(7,l,[]);var f=qi.core.midpoint2(o,g),p=qi.core.normalize(o.map(function(e,t){return g[t]-o[t]})),_=[f,[-p[1],p[0]]];return Mr(7,l,[_])},Vr=function(e){var t=Re(ze(e),1/3);return 0>e?-t:t},Dr=function(e,n,r,s){if(1e-8>ze(e)){if(e=n,n=r,r=s,1e-8>ze(e))return e=n,n=r,1e-8>ze(e)?[]:[-n/e];var o=n*n-4*e*r;return 1e-8>ze(o)?[-n/(2*e)]:0<o?[(-n+qe(o))/(2*e),(-n-qe(o))/(2*e)]:[]}var d=(3*e*r-n*n)/(3*e*e),l=(2*n*n*n-9*e*n*r+27*e*e*s)/(27*e*e*e),g;if(1e-8>ze(d))g=[Vr(-l)];else if(1e-8>ze(l))g=[0].concat(0>d?[qe(-d),-qe(-d)]:[]);else{var o=l*l/4+d*d*d/27;if(1e-8>ze(o))g=[-1.5*l/d,3*l/d];else if(0<o){var f=Vr(-l/2-qe(o));g=[f-d/(3*f)]}else{var f=2*qe(-d/3),p=Oe(3*l/d/f)/3,t=2*Ie/3;g=[f*De(p),f*De(p-t),f*De(p-2*t)]}}for(var _=0;_<g.length;_++)g[_]-=n/(3*e);return g},Tr=function(e,t,n,r,s,a){var o=s[0],d=s[1];if(ze(t[0])>qi.core.EPSILON)var c=t[1]/t[0],l=e[1]-c*e[0];else var g=e[0];var f=a[0],p=a[1];if(ze(r[0])>qi.core.EPSILON)var _=r[1]/r[0],h=n[1]-_*n[0];else var u=n[0];if(void 0!==c&&void 0!==_)var m=c*c+1,v=2*c*l,y=l*l-o*o-d*d,x=_*_+1,k=2*_*h,b=h*h-f*f-p*p,w=_*o+(l-d),E=o*(h-p)-f*(l-d),P=_-c,A=c*f+(h-p),S=c*o+(l-d);else if(void 0===c&&void 0===_)m=1,v=0,y=g*g-o*o-d*d,x=1,k=0,b=u*u-f*f-p*p,w=g-o,E=d*(u-f)-p*(g-o),P=0,A=u-f,S=w;else{if(void 0===c){var N=o;o=f,f=N;var L=d;d=p,p=L,c=_,_=void 0,l=h,h=void 0,u=g,g=void 0}m=c*c+1,v=2*c*l,y=l*l-o*o-d*d,x=1,k=0,b=u*u-f*f-p*p,w=o,E=(l-d)*(u-f)-o*p,P=1,A=-c*(u-f)-p,S=c*o+(l-d)}var j=m*w*w+v*w*P+y*P*P,M=2*m*w*E+v*(w*A+E*P)+2*y*P*A,C=m*E*E+v*E*A+y*A*A,O=x*P*S,B=(x*A+k*P)*S-j,F=(k*A+b*P)*S-M,I=b*A*S-C,V=Dr(O,B,F,I),D=[];if(null!=V&&0<V.length)for(var T=0;T<V.length;++T){if(void 0!==c&&void 0!==_)var q=V[T],R=_*q+h;else void 0===c&&void 0===_?(R=V[T],q=u):(R=V[T],q=u);if(R!=p){var X=-1*(q-f)/(R-p),W=(R*R-p*p+q*q-f*f)/(2*(R-p));D.push([[0,W],[1,X]])}else{var G=(q+f)/2;D.push([[G,0],[0,1]])}}return Mr(6,{points:[s,a],lines:[[e,t],[n,r]]},D)},qr=function(e){return 0<=e?Re(e,1/3):-Re(-e,1/3)},Rr=function(e,t,i,n,r,s,o){var l=qi.core.get_vector(e),g=qi.core.get_vector(i),f=qi.core.get_vector(r),p=qi.core.get_vector(s),_=qi.core.get_vector(t),h=qi.core.get_vector(n),u=f,m=qi.line(l,_),v=[-_[1],_[0]],y=m.nearestPoint(0,0).magnitude,x=p,k=qi.line(g,h),w=[-h[1],h[0]],E=k.nearestPoint(0,0).magnitude;0>qi.core.dot(v,m.nearestPoint(0,0))&&(v=[_[1],-_[0]]),0>qi.core.dot(w,k.nearestPoint(0,0))&&(w=[h[1],-h[0]]);var P=[v[1],-v[0]];if(!(ze(u[0]-x[0])<qi.core.EPSILON&&ze(u[1]-x[1])<qi.core.EPSILON)){var A=0;switch(o){case 0:var S=[u[0]+y*v[0]-2*x[0],u[1]+y*v[1]-2*x[1]],N=[y*v[0]-u[0],y*v[1]-u[1]],L=qi.core.dot(x,w)-E,j=2*qi.core.dot(N,P),M=qi.core.dot(N,N),C=qi.core.dot(S.map(function(e,t){return S[t]+N[t]}),P),O=qi.core.dot(S,N),B=qi.core.dot(P,w),F=qi.core.dot(N,w),I=B,a=L+C*B+F,b=L*j+O*B+C*F,c=L*M+O*F;switch(gs=ze(I)>qi.core.EPSILON?3:ze(a)>qi.core.EPSILON?2:ze(b)>qi.core.EPSILON?1:0,gs){case 0:return;case 1:A=-c/b;break;case 2:var d=Re(b,2)-4*a*c;if(ps=-b/(2*a),0>d)return void(fs=-1);ze(d)<qi.core.EPSILON?(fs=0,A=ps):(fs=1,_s=qe(d)/(2*a),A=ps+_s);break;case 3:var z=a/I,V=b/I,q=(3*V-Re(z,2))/9,X=(9*z*V-27*(c/I)-2*Re(z,3))/54,R=Re(q,3)+Re(X,2);if(vs=-z/3,0<R){fs=0;var D=qe(R);hs=qr(X+D);var W=qr(X-D);A=vs+hs+W}else if(ze(R)<qi.core.EPSILON)fs=1,hs=Re(X,1/3),A=vs+2*hs;else{fs=2;var T=qe(-R),G=Te(T,X)/3,Y=Re(Re(X,2)-R,1/6);us=Y*De(G),ms=Y*Ve(G),A=vs+2*us}}break;case 1:if(1>fs)return;2===gs?A=ps-_s:3===gs?A=1===fs?vs-hs:vs-us-qe(3)*ms:void 0;break;case 2:if(2>fs)return;3===gs?A=vs-us+qe(3)*ms:void 0;}var U=[y*v[0]+A*P[0],y*v[1]+A*P[1]],K=qi.core.normalize([U[0]-u[0],U[1]-u[1]]),H=qi.core.dot(K,qi.core.midpoint2(U,u)),Z=[H*K[0],H*K[1]],Q=[-K[1],K[0]];return[Z,Q]}},Xr=function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return 1===e?Cr.apply(void 0,i):2===e?Or.apply(void 0,i):3===e?Br.apply(void 0,i):4===e?Fr.apply(void 0,i):5===e?Ir.apply(void 0,i):6===e?Tr.apply(void 0,i):7===e?zr.apply(void 0,i):void 0},Wr=/*#__PURE__*/Object.freeze({axiom1:Cr,axiom2:Or,axiom3:Br,axiom4:Fr,axiom5:Ir,axiom7:zr,axiom6:Tr,axiom6RefFinder:function(e,t,i,n,r,s){gs=0,fs=0,ps=0,_s=0,hs=0,us=0,ms=0,vs=0;var a=[Rr(e,t,i,n,r,s,0),Rr(e,t,i,n,r,s,1),Rr(e,t,i,n,r,s,2)];return a.filter(function(e){return null!=e})},axiom6RefFinderFunc:Rr,axiom:Xr}),Gr=function t(n){var r,s;if("object"!==e(n))return n;if(!n)return n;if("[object Array]"===Object.prototype.toString.apply(n)){for(r=[],s=0;s<n.length;s+=1)r[s]=t(n[s]);return r}for(s in r={},n)n.hasOwnProperty(s)&&(r[s]=t(n[s]));return r},Yr=/*#__PURE__*/Object.freeze({clone:Gr,recursive_freeze:function t(i){return(Object.freeze(i),void 0===i)?i:(Object.getOwnPropertyNames(i).filter(function(t){return null!==i[t]&&("object"===e(i[t])||"function"==typeof i[t])&&!Object.isFrozen(i[t])}).forEach(function(e){return t(i[e])}),i)}}),Ur=function(e,t){if(!1=="file_frames"in e||e.file_frames.length<t)return e;var i=["frame_parent","frame_inherit"],n={visited_frames:[]};return function e(t,i,r){if(-1!==n.visited_frames.indexOf(i))throw new Error("encountered a cycle in file_frames. can't flatten.");return n.visited_frames.push(i),r=[i].concat(r),0===i?r:t.file_frames[i-1].frame_inherit&&null!=t.file_frames[i-1].frame_parent?e(t,t.file_frames[i-1].frame_parent,r):r}(e,t,[]).map(function(t){if(0===t){var n=e.file_frames;e.file_frames=null;var r=Gr(e);return e.file_frames=n,delete r.file_frames,i.forEach(function(e){return delete r[e]}),r}var s=Gr(e.file_frames[t-1]);return i.forEach(function(e){return delete s[e]}),s}).reduce(function(e,t){return Object.assign(e,t)},{})},Kr=/*#__PURE__*/Object.freeze({flatten_frame:Ur,merge_frame:function(e,t){var i=Gr(t);["frame_parent","frame_inherit"].forEach(function(e){return delete i[e]});var n=e.file_frames;e.file_frames=null;var r=Gr(e);return e.file_frames=n,delete r.file_frames,Object.assign(r,t),r}}),Hr={file:["file_spec","file_creator","file_author","file_title","file_description","file_classes","file_frames"],frame:["frame_author","frame_title","frame_description","frame_attributes","frame_classes","frame_unit","frame_parent","frame_inherit"],graph:["vertices_coords","vertices_vertices","vertices_faces","edges_vertices","edges_faces","edges_assignment","edges_foldAngle","edges_length","faces_vertices","faces_edges"],orders:["edgeOrders","faceOrders"],rabbitEar:["vertices_re:foldedCoords","vertices_re:unfoldedCoords","faces_re:matrix","faces_re:layer"]},Zr=Object.freeze([].concat(Hr.file).concat(Hr.frame).concat(Hr.graph).concat(Hr.orders).concat(Hr.rabbitEar)),Qr={en:{B:"boundary",b:"boundary",M:"mountain",m:"mountain",V:"valley",v:"valley",F:"mark",f:"mark",U:"unassigned",u:"unassigned"}},Jr=["B","b","M","m","V","v","F","f","U","u"],$r={M:-180,m:-180,V:180,v:180},es=function(e){return $r[e]||0},ts=function(e,t){var i="".concat(t,"_");return Object.keys(e).map(function(e){return e.substring(0,i.length)===i?e:void 0}).filter(function(e){return void 0!==e})},is=function(e,t){return Object.keys(e).map(function(e){return e.substring(e.length-t.length,e.length)===t?e:void 0}).filter(function(e){return void 0!==e})},ns=function(e,t){var i=ts(e,t);if(0===i.length)return[];var r=Fe.apply(Math,n(i.map(function(t){return e[t].length}))),s=Array.from(Array(r)).map(function(){return{}});return i.map(function(e){return{long:e,short:e.substring(t.length+1)}}).forEach(function(t){return s.forEach(function(n,r){s[r][t.short]=e[t.long][r]})}),s},rs=function(e,t,i){var n=ts(e,t);if(0===n.length)return[];var r={};return n.map(function(e){return{long:e,short:e.substring(t.length+1)}}).forEach(function(t){r[t.short]=e[t.long][i]}),r},ss=/*#__PURE__*/Object.freeze({keys_types:Hr,file_classes:["singleModel","multiModel","animation","diagrams"],frame_classes:["creasePattern","foldedForm","graph","linkage"],frame_attributes:["2D","3D","abstract","manifold","nonManifold","orientable","nonOrientable","selfTouching","nonSelfTouching","selfIntersecting","nonSelfIntersecting"],keys:Zr,edges_assignment_names:Qr,edges_assignment_values:Jr,edge_assignment_to_foldAngle:es,get_geometry_keys_with_prefix:ts,get_geometry_keys_with_suffix:function(e,t){var i="_".concat(t);return Object.keys(e).map(function(e){return e.substring(e.length-i.length,e.length)===i?e:void 0}).filter(function(e){return void 0!==e})},get_keys_with_ending:is,transpose_geometry_arrays:ns,transpose_geometry_array_at_index:rs}),as=function(t){if("object"!==e(t)||null===t)return!1;for(var n=Object.keys(t),r=0;r<n.length;r+=1)if(Zr.includes(n[r]))return!0;return!1},os=function(e){return!1!="edges_assignment"in e&&e.edges_assignment.length===e.edges_vertices.length&&e.edges_assignment.filter(function(e){return Jr.includes(e)}).reduce(function(e,t){return e&&t},!0)},ds=function(e){var t={vertices:["coords","vertices","faces"],edges:["vertices","faces","assignment","foldAngle","length"],faces:["vertices","edges"]};["vertices_coords","vertices_vertices","vertices_faces","edges_vertices","edges_faces","faces_vertices","faces_edges"].filter(function(t){return t in e}).forEach(function(t){if(e[t].map(function(e){return 0<e.filter(function(e){return null==e}).length}).reduce(function(e,t){return e||t},!1))throw new Error("".concat(t," contains a null"))}),["edges_assignment","edges_foldAngle","edges_length"].filter(function(t){return t in e}).forEach(function(t){if(0<e[t].filter(function(e){return null==e}).length)throw new Error("".concat(t," contains a null"))});var i=Object.keys(t).map(function(e){return{prefix:e,suffixes:t[e]}}).map(function(t){return t.suffixes.map(function(e){return"".concat(t.prefix,"_").concat(e)}).filter(function(t){return null!=e[t]}).map(function(t,i,n){return e[t].length===e[n[0]].length}).reduce(function(e,t){return e&&t},!0)}).reduce(function(e,t){return e&&t},!0);if(!i)throw new Error("validate failed: arrays with common keys have mismatching lengths");var n={vertices:e.vertices_coords.length,edges:e.edges_vertices.length,faces:e.faces_vertices.length||e.faces_edges.length},r=Object.keys(t).map(function(e){return{prefix:e,suffixes:t[e]}}).map(function(t){return t.suffixes.map(function(e){return{key:"".concat(t.prefix,"_").concat(e),suffix:e}}).filter(function(t){return null!=e[t.key]&&null!=n[t.suffix]}).map(function(t){return{key:t.key,test:e[t.key].reduce(function(e,i){return i.reduce(function(e,i){return e&&i<n[t.suffix]},!0)},!0)}})}).reduce(function(e,t){return e.concat(t)},[]);if(r.filter(function(e){return!e.test}).forEach(function(t){throw console.log(e),new Error("".concat(t.key," contains a index too large, larger than the reference array to which it points"))}),"vertices_vertices"in e){var s=e.vertices_vertices.map(function(e,t){return e.map(function(e){return[t,e]})}).reduce(function(e,t){return e.concat(t)},[]),a=s.map(function(t){return 0<e.edges_vertices.filter(function(i){return t[0]===i[0]&&t[1]===i[1]||t[0]===i[1]&&t[1]===i[0]}).length}).map(function(e,t){return{test:e,i:t}}).filter(function(e){return!e.test});if(0<a.length)throw new Error("vertices_vertices at index ".concat(a[0].i," declares an edge that doesn't exist in edges_vertices"))}if("vertices_faces"in e){var o=e.vertices_faces.map(function(t,n){return t.map(function(t){return{test:-1!==e.faces_vertices[t].indexOf(n),face:t,i:n}}).filter(function(e){return!e.test})}).reduce(function(e,t){return e.concat(t)},[]);if(0<o.length)throw new Error("vertex ".concat(o[0].i," in vertices_faces connects to face ").concat(o[0].face,", whereas in faces_vertices this same connection in reverse doesn't exist."))}if("edges_faces"in e){var d=e.edges_faces.map(function(t,n){return t.map(function(t){return{test:-1!==e.faces_edges[t].indexOf(n),face:t,i:n}}).filter(function(e){return!e.test})}).reduce(function(e,t){return e.concat(t)},[]);if(0<d.length)throw new Error("edges_faces ".concat(d[0].i," connects to face ").concat(d[0].face,", whereas in faces_edges this same connection in reverse doesn't exist."))}if("faces_vertices"in e&&"vertices_faces"in e)e.faces_vertices.map(function(t,n){return t.map(function(t){return{test:-1!==e.vertices_faces[t].indexOf(n),face:t,i:n}}).filter(function(e){return!e.test})}).reduce(function(e,t){return e.concat(t)},[]);return!0},cs=/*#__PURE__*/Object.freeze({possibleFoldObject:as,edges_assignment:os,validate:ds}),ls=We?{}:window,gs,fs,ps,_s,hs,us,ms,vs;if(We){var ys=require("xmldom"),xs=ys.DOMParser,ks=ys.XMLSerializer;ls.DOMParser=xs,ls.XMLSerializer=ks,ls.document=new xs().parseFromString("<!DOCTYPE html><title> </title>","text/html")}var bs=function(e){return 128>e.length&&-1!==e.indexOf(".")},ws=function(e){return"svg"===e.tagName||0<e.getElementsByTagName("svg").length},Es=function(e){var t=e.getElementsByTagName("object");return!!(0<t.length)&&0<Array.from(t).filter(function(e){return"oripa.DataSet"===e.className}).length},Ps={SVG:"svg",Svg:"svg",svg:"svg",FOLD:"fold",Fold:"fold",fold:"fold",ORIPA:"oripa",Oripa:"oripa",oripa:"oripa",".SVG":"svg",".Svg":"svg",".svg":"svg",".FOLD":"fold",".Fold":"fold",".fold":"fold",".ORIPA":"oripa",".Oripa":"oripa",".oripa":"oripa"},As=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];if(0>=i.length)throw new Error("convert(), load(), missing a file as a parameter");var r=i[0],s;if(2<=i.length&&"string"==typeof i[1]&&(s=Ps[i[1]],void 0===s))throw new Error("expected a file type (like 'svg'), ".concat(i[1]," is unsupported"));if(void 0!==s)return"string"==typeof r?"fold"===s?{data:JSON.parse(r),type:s}:"svg"===s||"oripa"===s?{data:new ls.DOMParser().parseFromString(r,"text/xml").documentElement,type:s}:{data:r,type:s}:{data:r,type:s};var a=e(r);if("string"===a){try{var o=JSON.parse(r);if(as(o))return{data:o,type:"fold"}}catch(e){var d=new ls.DOMParser().parseFromString(r,"text/xml").documentElement;if(!(0<d.getElementsByTagName("parsererror").length))return ws(d)?{data:d,type:"svg"}:Es(d)?{data:d,type:"oripa"}:void 0;if(bs(r))throw new Error("did you provide a file name? please load the file first and pass in the data.");else throw new Error("unable to load file. tried XML, JSON")}return}if("object"===a)try{var c=JSON.parse(JSON.stringify(r));if(as(c))return{data:c,type:"fold"}}catch(e){return"function"==typeof r.getElementsByTagName?ws(r)?{data:r,type:"svg"}:Es(r)?{data:r,type:"oripa"}:void 0:void 0}},Ss=function(e){var t=e.vertices_coords.map(function(){return[]});return e.edges_vertices.forEach(function(e,n){return e.forEach(function(e){return t[e].push(n)})}),t},Ns=function(e){for(var t=e.edges_assignment.map(function(e){return"B"===e||"b"===e}),n=Ss(e),r=[],s=[],a=-1,o=0;o<t.length;o+=1)if(t[o]){a=o;break}if(-1===a)return{vertices:[],edges:[]};t[a]=!1,r.push(a),s.push(e.edges_vertices[a][0]);for(var d=e.edges_vertices[a][1];s[0]!==d;){if(s.push(d),a=n[d].filter(function(e){return t[e]}).shift(),void 0===a)return{vertices:[],edges:[]};if(e.edges_vertices[a][0]===d){var c=X(e.edges_vertices[a],2);d=c[1]}else{var l=X(e.edges_vertices[a],1);d=l[0]}t[a]=!1,r.push(a)}return{vertices:s,edges:r}},Ls=function(e){if(!1=="vertices_coords"in e||0>=e.vertices_coords.length)return[0,0,0,0];var t=e.vertices_coords[0].length,r=Array(t).fill(1/0),s=Array(t).fill(-Infinity);return e.vertices_coords.forEach(function(e){return e.forEach(function(e,t){e<r[t]&&(r[t]=e),e>s[t]&&(s[t]=e)})}),isNaN(r[0])||isNaN(r[1])||isNaN(s[0])||isNaN(s[1])?[0,0,0,0]:[r[0],r[1],s[0]-r[0],s[1]-r[1]]},js=function(e){var t=e.faces_vertices.length,i=Array.from(Array(t)).map(function(){return[]}),r={};return e.faces_vertices.forEach(function(e,t){if(void 0!==e){var s=e.length;e.forEach(function(e,n,a){var o=a[(n+1)%s];if(o<e){var d=[o,e];e=d[0],o=d[1]}var c="".concat(e," ").concat(o);if(c in r){var l=r[c];i[t].push(l),i[l].push(t)}else r[c]=t})}}),i},Ms=function(e){return e.map(function(e){return e[0]*e[3]-e[1]*e[2]}).map(function(e){return 0<=e})},Cs=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=[];return n[t]=!0,Os(e,t).forEach(function(e,t){e.forEach(function(e){n[e.face]=0==t%2})}),n},Os=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=make_vertex_pair_to_edge_map(e),n=js(e);if(0>=n.length)return[];var r=[t],s=[[{face:t,parent:void 0,edge:void 0,level:0}]];do s[s.length]=s[s.length-1].map(function(t){var s=n[t.face].filter(function(e){return-1===r.indexOf(e)});return r=r.concat(s),s.map(function(n){var r=e.faces_vertices[n].filter(function(i){return-1!==e.faces_vertices[t.face].indexOf(i)}).sort(function(e,t){return e-t}),s=i[r.join(" ")];return{face:n,parent:t.face,edge:s,edge_vertices:r}})}).reduce(function(e,t){return e.concat(t)},[]);while(0<s[s.length-1].length);return 0<s.length&&0===s[s.length-1].length&&s.pop(),s},Bs=function e(t){var n,r;if("object"!==R(t))return t;if(!t)return t;if("[object Array]"===Object.prototype.toString.apply(t)){for(n=[],r=0;r<t.length;r+=1)n[r]=e(t[r]);return n}for(r in n={},t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n},Fs=function(e,t){if(!1=="file_frames"in e||e.file_frames.length<t)return e;var i=["frame_parent","frame_inherit"],n={visited_frames:[]};return function e(t,i,r){if(-1!==n.visited_frames.indexOf(i))throw new Error("encountered a cycle in file_frames. can't flatten.");return n.visited_frames.push(i),r=[i].concat(r),0===i?r:t.file_frames[i-1].frame_inherit&&null!=t.file_frames[i-1].frame_parent?e(t,t.file_frames[i-1].frame_parent,r):r}(e,t,[]).map(function(t){if(0===t){var n=e.file_frames;e.file_frames=null;var r=Bs(e);return e.file_frames=n,delete r.file_frames,i.forEach(function(e){return delete r[e]}),r}var s=Bs(e.file_frames[t-1]);return i.forEach(function(e){return delete s[e]}),s}).reduce(function(e,t){return Object.assign(e,t)},{})},Is="undefined"!=typeof window&&"undefined"!=typeof window.document,zs="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,Vs="object"===("undefined"==typeof self?"undefined":R(self))&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,Ds=!zs&&Is?window:{};if(zs){var Ts=require("xmldom"),qs=Ts.DOMParser,Rs=Ts.XMLSerializer;Ds.DOMParser=qs,Ds.XMLSerializer=Rs,Ds.document=new qs().parseFromString("<!DOCTYPE html><title>a</title>","text/html")}var Xs=function(){var e=Ds.document.createElementNS("http://www.w3.org/2000/svg","svg");return e.setAttribute("version","1.1"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),e},Ws=function(){var e=Ds.document.createElementNS("http://www.w3.org/2000/svg","g");return e},Gs=function(){var e=Ds.document.createElementNS("http://www.w3.org/2000/svg","style");return e.setAttribute("type","text/css"),e},Ys=function(e,t,i,n,r){var s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,a=n/1-n,o=[t-a-s,i-a-s,n+2*a+2*s,r+2*a+2*s].join(" ");e.setAttributeNS(null,"viewBox",o)},Us=function(e,t,i,n){var r=Ds.document.createElementNS("http://www.w3.org/2000/svg","line");return r.setAttributeNS(null,"x1",e),r.setAttributeNS(null,"y1",t),r.setAttributeNS(null,"x2",i),r.setAttributeNS(null,"y2",n),r},Ks=function(e,t,i){var n=Ds.document.createElementNS("http://www.w3.org/2000/svg","circle");return n.setAttributeNS(null,"cx",e),n.setAttributeNS(null,"cy",t),n.setAttributeNS(null,"r",i),n},Hs=function(e){var t=Ds.document.createElementNS("http://www.w3.org/2000/svg","polygon"),i=e.reduce(function(e,t){return"".concat(e).concat(t[0],",").concat(t[1]," ")},"");return t.setAttributeNS(null,"points",i),t},Zs=function(e,t,i,n,r,s,a,o){var c=[[e,t],[i,n],[r,s],[a,o]].map(function(e){return e.join(",")}),l="M ".concat(c[0]," C ").concat(c[1]," ").concat(c[2]," ").concat(c[3]),d=Ds.document.createElementNS("http://www.w3.org/2000/svg","path");return d.setAttributeNS(null,"d",l),d},Qs=function(e,t,i){var n={color:"#000",strokeWidth:.5,width:.5,length:2,bend:.3,pinch:.618,padding:.5,side:!0,start:!1,end:!0,strokeStyle:"",fillStyle:""};"object"===R(i)&&null!==i&&Object.assign(n,i);var r=["stroke:none","fill:".concat(n.color),n.fillStyle].filter(function(e){return""!==e}).join(";"),s=["fill:none","stroke:".concat(n.color),"stroke-width:".concat(n.strokeWidth),n.strokeStyle].filter(function(e){return""!==e}).join(";"),a=e,o=t,d=[o[0]-a[0],o[1]-a[1]],c=[a[0]+d[0]/2,a[1]+d[1]/2],l=qe(d[0]*d[0]+d[1]*d[1]),g=2.5*((n.start?1+n.padding:0+n.end?1+n.padding:0)*n.length);if(l<g){var f=[d[0]/l*g,d[1]/l*g];a=[c[0]-.5*f[0],c[1]-.5*f[1]],o=[c[0]+.5*f[0],c[1]+.5*f[1]],d=[o[0]-a[0],o[1]-a[1]]}var p=[d[1],-d[0]],_=[c[0]+p[0]*(n.side?1:-1)*n.bend,c[1]+p[1]*(n.side?1:-1)*n.bend],h=[_[0]-a[0],_[1]-a[1]],u=[_[0]-o[0],_[1]-o[1]],m=qe(h[0]*h[0]+h[1]*h[1]),v=qe(u[0]*u[0]+u[1]*u[1]),y=[h[0]/m,h[1]/m],x=[u[0]/v,u[1]/v],k=[-y[0],-y[1]],b=[-x[0],-x[1]],w=[k[1],-k[0]],E=[b[1],-b[0]],P=[a[0]+y[0]*n.length*((n.start?1:0)+n.padding),a[1]+y[1]*n.length*((n.start?1:0)+n.padding)],A=[o[0]+x[0]*n.length*((n.end?1:0)+n.padding),o[1]+x[1]*n.length*((n.end?1:0)+n.padding)];d=[A[0]-P[0],A[1]-P[1]],p=[d[1],-d[0]],c=[P[0]+d[0]/2,P[1]+d[1]/2],_=[c[0]+p[0]*(n.side?1:-1)*n.bend,c[1]+p[1]*(n.side?1:-1)*n.bend];var S=[P[0]+(_[0]-P[0])*n.pinch,P[1]+(_[1]-P[1])*n.pinch],N=[A[0]+(_[0]-A[0])*n.pinch,A[1]+(_[1]-A[1])*n.pinch],L=[[P[0]+w[0]*-n.width,P[1]+w[1]*-n.width],[P[0]+w[0]*n.width,P[1]+w[1]*n.width],[P[0]+k[0]*n.length,P[1]+k[1]*n.length]],j=[[A[0]+E[0]*-n.width,A[1]+E[1]*-n.width],[A[0]+E[0]*n.width,A[1]+E[1]*n.width],[A[0]+b[0]*n.length,A[1]+b[1]*n.length]],M=Ds.document.createElementNS("http://www.w3.org/2000/svg","g"),C=Zs(P[0],P[1],S[0],S[1],N[0],N[1],A[0],A[1]);if(C.setAttribute("style",s),M.appendChild(C),n.start){var O=Hs(L);O.setAttribute("style",r),M.appendChild(O)}if(n.end){var B=Hs(j);B.setAttribute("style",r),M.appendChild(B)}return M},Js={B:"boundary",b:"boundary",M:"mountain",m:"mountain",V:"valley",v:"valley",F:"mark",f:"mark",U:"mark",u:"mark"},$s=function(e){return e.map(function(e,t){return{layer:e,i:t}}).sort(function(e,t){return e.layer-t.layer}).map(function(e){return e.i})},ea=function(e){var t=e["faces_re:coloring"];return null==t&&(t="faces_re:matrix"in e?Ms(e["faces_re:matrix"]):Cs(e,0)),t.map(function(e){return e?"front":"back"})},ta=function(e,t){var i=null!=e["faces_re:layer"]&&e["faces_re:layer"].length===e.faces_vertices.length;return i&&ea(e).forEach(function(e,n){return t[n].setAttribute("class",e)}),i?$s(e["faces_re:layer"]).map(function(e){return t[e]}):t},ia=function(e){return null==e.edges_vertices||null==e.edges_assignment||e.edges_vertices.length!==e.edges_assignment.length?[]:e.edges_assignment.map(function(e){return Js[e]})},na=function(e){if(!1=="vertices_coords"in e||!1=="edges_vertices"in e||!1=="edges_assignment"in e)return[];var t=Ns(e).vertices.map(function(t){return e.vertices_coords[t]}),i=Hs(t);return i.setAttribute("class","boundary"),[i]},ra=function(e,t){if(!1=="vertices_coords"in e)return[];var i=t&&t.radius?t.radius:.01,n=e.vertices_coords.map(function(e){return Ks(e[0],e[1],i)});return n.forEach(function(e,t){return e.setAttribute("id","".concat(t))}),n},sa=function(e){if(!1=="edges_vertices"in e||!1=="vertices_coords"in e)return[];var t=e.edges_vertices.map(function(t){return t.map(function(t){return e.vertices_coords[t]})}).map(function(t){return Us(t[0][0],t[0][1],t[1][0],t[1][1])});return t.forEach(function(e,t){return e.setAttribute("id","".concat(t))}),ia(e).forEach(function(e,n){return t[n].setAttribute("class",e)}),t},aa=function(e){if(!1=="faces_vertices"in e||!1=="vertices_coords"in e)return[];var t=e.faces_vertices.map(function(t){return t.map(function(t){return e.vertices_coords[t]})}).map(function(e){return Hs(e)});return t.forEach(function(e,t){return e.setAttribute("id","".concat(t))}),ta(e,t)},oa=function(e){if(!1=="faces_edges"in e||!1=="edges_vertices"in e||!1=="vertices_coords"in e)return[];var t=e.faces_edges.map(function(t){return t.map(function(t){return e.edges_vertices[t]}).map(function(e,t,i){var n=i[(t+1)%i.length];return e[1]===n[0]||e[1]===n[1]?e[0]:e[1]}).map(function(t){return e.vertices_coords[t]})}).map(function(e){return Hs(e)});return t.forEach(function(e,t){return e.setAttribute("id","".concat(t))}),ta(e,t)},da=Ds.document,ca="http://www.w3.org/2000/svg",la=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"shadow",t=da.createElementNS(ca,"defs"),i=da.createElementNS(ca,"filter");i.setAttribute("width","200%"),i.setAttribute("height","200%"),i.setAttribute("id",e);var n=da.createElementNS(ca,"feGaussianBlur");n.setAttribute("in","SourceAlpha"),n.setAttribute("stdDeviation","0.005"),n.setAttribute("result","blur");var r=da.createElementNS(ca,"feOffset");r.setAttribute("in","blur"),r.setAttribute("result","offsetBlur");var s=da.createElementNS(ca,"feFlood");s.setAttribute("flood-color","#000"),s.setAttribute("flood-opacity","0.3"),s.setAttribute("result","offsetColor");var a=da.createElementNS(ca,"feComposite");a.setAttribute("in","offsetColor"),a.setAttribute("in2","offsetBlur"),a.setAttribute("operator","in"),a.setAttribute("result","offsetBlur");var o=da.createElementNS(ca,"feMerge"),d=da.createElementNS(ca,"feMergeNode"),c=da.createElementNS(ca,"feMergeNode");return c.setAttribute("in","SourceGraphic"),o.appendChild(d),o.appendChild(c),t.appendChild(i),i.appendChild(n),i.appendChild(r),i.appendChild(s),i.appendChild(a),i.appendChild(o),t},ga={vertices:"vertices",edges:"creases",faces:"faces",boundaries:"boundaries"},fa=function(e){return!0=="faces_vertices"in e?aa(e):!0=="faces_edges"in e?oa(e):[]},pa={vertices:ra,edges:sa,faces:fa,boundaries:na},_a=function(e){var t=(null==e.file_classes?[]:e.file_classes).join(" "),i=(null==e.frame_classes?[]:e.frame_classes).join(" ");return[t,i].filter(function(e){return""!==e}).join(" ")},ha=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:14;return parseFloat(e.toFixed(t))},ua=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=e;null!=i.vertices_coords&&(i.vertices_coordsPreClean=i.vertices_coords,i.vertices_coords=JSON.parse(JSON.stringify(i.vertices_coords)).map(function(e){return e.map(function(e){return ha(e)})}));var n={defaults:!0,width:"500px",height:"500px",inlineStyle:!0,stylesheet:"svg * {\n  stroke-width: var(--crease-width);\n  stroke-linecap: round;\n  stroke: black;\n}\nline.mountain { stroke: red; }\nline.mark { stroke: lightgray; }\nline.valley { stroke: blue;\n  stroke-dasharray: calc(var(--crease-width) * 2) calc(var(--crease-width) * 2);\n}\npolygon { stroke: none; stroke-linejoin: bevel; }\n.foldedForm polygon { stroke: black; fill: #8881; }\n.foldedForm polygon.front { fill: white; }\n.foldedForm polygon.back { fill: lightgray; }\n.creasePattern polygon { fill: white; stroke: none; }\n.foldedForm .boundaries polygon { fill: none; stroke: none; }\n.foldedForm line { stroke: none; }\n",shadows:!1,padding:0,viewBox:null,diagram:!0,boundaries:!0,faces:!0,edges:!0,vertices:!1};Object.assign(n,t),null!=n.frame&&(i=Fs(e,n.frame)),null==n.svg&&(n.svg=Xs()),n.svg.setAttribute("class",_a(i)),n.svg.setAttribute("width",n.width),n.svg.setAttribute("height",n.height);var r=Gs();n.svg.appendChild(r);var s={};if(["boundaries","faces","edges","vertices"].filter(function(e){return n[e]}).forEach(function(e){s[e]=Ws(),s[e].setAttribute("class",ga[e]),n.svg.appendChild(s[e])}),Object.keys(s).forEach(function(e){return pa[e](i).forEach(function(t){return s[e].appendChild(t)})}),"re:diagrams"in i&&n.diagram){var a=Ws();n.svg.appendChild(a),$(i,a)}if(n.shadows){var o=la("face_shadow");n.svg.appendChild(o),Array.from(s.faces.childNodes).forEach(function(e){return e.setAttribute("filter","url(#".concat("face_shadow",")"))})}var d=Ls(i);if(null==n.viewBox?Ys.apply(void 0,[n.svg].concat(W(d),[n.padding])):Ys.apply(void 0,[n.svg].concat(W(n.viewBox),[n.padding])),null!=i.vertices_coordsPreClean&&(i.vertices_coords=i.vertices_coordsPreClean,delete i.vertices_coordsPreClean),n.inlineStyle){var c=d[2]>d[3]?d[3]:d[2],l="\nsvg { --crease-width: ".concat(.005*c,"; }\n").concat(n.stylesheet),g=new Ds.DOMParser().parseFromString("<xml></xml>","application/xml"),f=g.createCDATASection(l);r.appendChild(f)}var p=new Ds.XMLSerializer().serializeToString(n.svg),_=J(p);return _},ma=function(e){if("object"===R(e)&&null!==e)return e;if("string"==typeof e||e instanceof String)try{var t=JSON.parse(e);return t}catch(e){throw e}throw new Error("couldn't recognize input. looking for string or object")},va={svg:function(e,t){try{var i=ma(e);return ua(i,t)}catch(e){throw e}},webGL:function(){},components:{svg:{boundaries:na,vertices:ra,edges:sa,faces:aa,faces_vertices:aa,faces_edges:oa},webGL:{}}},ya={},xa=function(e,t){return(+e%(t=+t)+t)%t};ya.EPS=1e-6,ya.sum=function(e,t){return e+t},ya.min=function(e,t){return e<t?e:t},ya.max=function(e,t){return e>t?e:t},ya.all=function(e,t){return e&&t},ya.next=function(e,t,n){return null==n&&(n=1),xa(e+n,t)},ya.rangesDisjoint=function(e,t){var i,n,r,s,a,o;return i=e[0],n=e[1],r=t[0],s=t[1],r<(a=Be(i,n))&&a>s||r>(o=Fe(i,n))&&o<s},ya.topologicalSort=function(e){var t,i,n,r,s,a,o;for(t=0,n=e.length;t<n;t++)o=e[t],a=[!1,null],o.visited=a[0],o.parent=a[1];for(s=[],i=0,r=e.length;i<r;i++)o=e[i],o.visited||(s=ya.visit(o,s));return s},ya.visit=function(e,t){var i,n,r,s;for(e.visited=!0,r=e.children,(i=0,n=r.length);i<n;i++)(s=r[i],!!!s.visited)&&(s.parent=e,t=ya.visit(s,t));return t.concat([e])},ya.magsq=function(e){return ya.dot(e,e)},ya.mag=function(e){return qe(ya.magsq(e))},ya.unit=function(e,t){var i;return null==t&&(t=ya.EPS),i=ya.magsq(e),i<t?null:ya.mul(e,1/ya.mag(e))},ya.ang2D=function(e,t){return null==t&&(t=ya.EPS),ya.magsq(e)<t?null:Te(e[1],e[0])},ya.mul=function(e,t){var n,r,s,a;for(a=[],r=0,s=e.length;r<s;r++)n=e[r],a.push(n*t);return a},ya.linearInterpolate=function(e,t,i){return ya.plus(ya.mul(t,1-e),ya.mul(i,e))},ya.plus=function(e,t){var n,r,s,a,o;for(o=[],r=s=0,a=e.length;s<a;r=++s)n=e[r],o.push(n+t[r]);return o},ya.sub=function(e,t){return ya.plus(e,ya.mul(t,-1))},ya.dot=function(e,t){var n,r;return function(){var i,s,a;for(a=[],r=i=0,s=e.length;i<s;r=++i)n=e[r],a.push(n*t[r]);return a}().reduce(ya.sum)},ya.distsq=function(e,t){return ya.magsq(ya.sub(e,t))},ya.dist=function(e,t){return qe(ya.distsq(e,t))},ya.closestIndex=function(e,t){var n,r,s,a,o,d,c;for(d=2e308,s=a=0,o=t.length;a<o;s=++a)n=t[s],d>(r=ya.dist(e,n))&&(d=r,c=s);return c},ya.dir=function(e,t){return ya.unit(ya.sub(t,e))},ya.ang=function(e,t){var i,n,r,s;return i=function(){var i,n,r,a;for(r=[e,t],a=[],(i=0,n=r.length);i<n;i++)s=r[i],a.push(ya.unit(s));return a}(),n=i[0],r=i[1],null==n||null==r?null:Oe(ya.dot(n,r))},ya.cross=function(e,t){var n,r,s,a;return e.length===(s=t.length)&&2===s?e[0]*t[1]-e[1]*t[0]:e.length===(a=t.length)&&3===a?function(){var i,s,a,o,d;for(a=[[1,2],[2,0],[0,1]],d=[],(i=0,s=a.length);i<s;i++)o=a[i],n=o[0],r=o[1],d.push(e[n]*t[r]-e[r]*t[n]);return d}():null},ya.parallel=function(e,t,i){var n,r,s,a;return null==i&&(i=ya.EPS),n=function(){var i,n,r,s;for(r=[e,t],s=[],(i=0,n=r.length);i<n;i++)a=r[i],s.push(ya.unit(a));return s}(),r=n[0],s=n[1],null==r||null==s?null:1-ze(ya.dot(r,s))<i},ya.rotate=function(e,n,r){var t,s,a,o,d,c,l,g,f,_;if(n=ya.unit(n),null==n)return null;for(l=[De(r),Ve(r)],t=l[0],_=l[1],g=[[0,1,2],[1,2,0],[2,0,1]],f=[],(a=0,o=g.length);a<o;a++)d=g[a],f.push(function(){var i,r,a,o;for(a=[t,-_*n[d[2]],_*n[d[1]]],o=[],(s=i=0,r=a.length);i<r;s=++i)c=a[s],o.push(e[d[s]]*(n[d[0]]*n[d[s]]*(1-t)+c));return o}().reduce(ya.sum));return f},ya.interiorAngle=function(e,t,i){var n;return n=ya.ang2D(ya.sub(e,t))-ya.ang2D(ya.sub(i,t)),n+(0>n?2*Ie:0)},ya.turnAngle=function(e,t,i){return Ie-ya.interiorAngle(e,t,i)},ya.triangleNormal=function(e,t,i){return ya.unit(ya.cross(ya.sub(t,e),ya.sub(i,t)))},ya.polygonNormal=function(e,t){var n,r;return null==t&&(t=ya.EPS),ya.unit(function(){var t,i,s;for(s=[],n=t=0,i=e.length;t<i;n=++t)r=e[n],s.push(ya.cross(r,e[ya.next(n,e.length)]));return s}().reduce(ya.plus),t)},ya.twiceSignedArea=function(e){var t,n,r;return function(){var i,s,a;for(a=[],t=i=0,s=e.length;i<s;t=++i)n=e[t],r=e[ya.next(t,e.length)],a.push(n[0]*r[1]-r[0]*n[1]);return a}().reduce(ya.sum)},ya.polygonOrientation=function(e){var t=Math.sign;return t(ya.twiceSignedArea(e))},ya.sortByAngle=function(e,t,i){return null==t&&(t=[0,0]),null==i&&(i=function(e){return e}),t=i(t),e.sort(function(e,n){var r,s;return r=ya.ang2D(ya.sub(i(e),t)),s=ya.ang2D(ya.sub(i(n),t)),r-s})},ya.segmentsCross=function(e,t){var i,n,r,s;return i=e[0],r=e[1],n=t[0],s=t[1],!(ya.rangesDisjoint([i[0],r[0]],[n[0],s[0]])||ya.rangesDisjoint([i[1],r[1]],[n[1],s[1]]))&&ya.polygonOrientation([i,r,n])!==ya.polygonOrientation([i,r,s])&&ya.polygonOrientation([n,s,i])!==ya.polygonOrientation([n,s,r])},ya.parametricLineIntersect=function(e,t){var i,n,r,s,a;return n=e[0],r=e[1],s=t[0],a=t[1],i=(a[1]-s[1])*(r[0]-n[0])+(s[0]-a[0])*(r[1]-n[1]),0===i?[null,null]:[(a[0]*(n[1]-s[1])+a[1]*(s[0]-n[0])+s[1]*n[0]-n[1]*s[0])/i,(s[0]*(r[1]-n[1])+s[1]*(n[0]-r[0])+n[1]*r[0]-r[1]*n[0])/i]},ya.segmentIntersectSegment=function(e,i){var n,r,a;return n=ya.parametricLineIntersect(e,i),r=n[0],a=n[1],null!=r&&0<=r&&1>=r&&0<=a&&1>=a?ya.linearInterpolate(r,e[0],e[1]):null},ya.lineIntersectLine=function(e,i){var n,r,a;return n=ya.parametricLineIntersect(e,i),r=n[0],a=n[1],null==r?null:ya.linearInterpolate(r,e[0],e[1])},ya.pointStrictlyInSegment=function(e,t,i){var n,r;return null==i&&(i=ya.EPS),n=ya.sub(e,t[0]),r=ya.sub(e,t[1]),ya.parallel(n,r,i)&&0>ya.dot(n,r)},ya.centroid=function(e){return ya.mul(e.reduce(ya.plus),1/e.length)},ya.basis=function(e,t){var i,r,s,a,o,c,l,g;return(null==t&&(t=ya.EPS),function(){var t,i,n;for(n=[],t=0,i=e.length;t<i;t++)o=e[t],n.push(3!==o.length);return n}().reduce(ya.all))?null:(r=function(){var i,n,r;for(r=[],i=0,n=e.length;i<n;i++)o=e[i],ya.distsq(o,e[0])>t&&r.push(ya.dir(o,e[0]));return r}(),0===r.length)?[]:(c=r[0],function(){var e,n,s;for(s=[],e=0,n=r.length;e<n;e++)i=r[e],s.push(ya.parallel(i,c,t));return s}().reduce(ya.all))?[c]:(a=function(){var e,t,n;for(n=[],e=0,t=r.length;e<t;e++)i=r[e],n.push(ya.unit(ya.cross(i,c)));return n}(),a=function(){var e,t,i;for(i=[],e=0,t=a.length;e<t;e++)s=a[e],null!=s&&i.push(s);return i}(),g=a[0],l=ya.cross(g,c),function(){var e,i,n;for(n=[],e=0,i=a.length;e<i;e++)s=a[e],n.push(ya.parallel(s,g,t));return n}().reduce(ya.all)?[c,l]:[c,l,g])},ya.above=function(e,t,i,n){var r,s,a,o,d;return null==n&&(n=ya.EPS),a=function(){var n,r,s,a;for(s=[e,t],a=[],(n=0,r=s.length);n<r;n++)d=s[n],a.push(function(){var e,t,n;for(n=[],e=0,t=d.length;e<t;e++)o=d[e],n.push(ya.dot(o,i));return n}());return a}(),r=a[0],s=a[1],s.reduce(ya.max)-r.reduce(ya.min)<n?1:r.reduce(ya.max)-s.reduce(ya.min)<n?-1:0},ya.separatingDirection2D=function(e,r,s,n){var a,d,c,g,f,_,h,u,v,y,x,b,w,E;for(null==n&&(n=ya.EPS),b=[e,r],(c=0,f=b.length);c<f;c++)for(E=b[c],a=g=0,_=E.length;g<_;a=++g)for(y=E[a],d=v=0,h=E.length;v<h;d=++v)if((x=E[d],!!(a<d))&&(u=ya.unit(ya.cross(ya.sub(y,x),s)),null!=u&&(w=ya.above(e,r,u,n),0!==w)))return ya.mul(u,w);return null},ya.separatingDirection3D=function(e,t,n){var s,a,d,c,g,f,_,h,u,v,y,x,b,w,E,P,A,S,N;for(null==n&&(n=ya.EPS),E=[[e,t],[t,e]],(d=0,g=E.length);d<g;d++)for(P=E[d],S=P[0],N=P[1],(c=0,f=S.length);c<f;c++)for(y=S[c],s=v=0,_=N.length;v<_;s=++v)for(x=N[s],a=w=0,h=N.length;w<h;a=++w)if((b=N[a],!!(s<a))&&(u=ya.unit(ya.cross(ya.sub(y,x),ya.sub(y,b))),null!=u&&(A=ya.above(e,t,u,n),0!==A)))return ya.mul(u,A);return null},ya.circleCross=function(e,t,i){var n,r;return n=(e*e-i*i+t*t)/e/2,r=qe(t*t-n*n),[n,r]},ya.creaseDir=function(e,t,i,n,r){var s,a,o,d,c,l;return null==r&&(r=ya.EPS),s=De(i)+De(n),a=De(i)-De(n),o=ya.plus(e,t),d=ya.sub(e,t),c=ya.unit(ya.cross(d,o)),o=ya.mul(o,s/ya.magsq(o)),d=ya.mul(d,ya.magsq(d)<r?0:a/ya.magsq(d)),l=qe(1-ya.magsq(o)-ya.magsq(d)),c=ya.mul(c,l),[o,d,c].reduce(ya.plus)},ya.quadSplit=function(e,i,n,r){if(ya.magsq(i)>n*n)throw new Error("STOP! Trying to split expansive quad.");return ya.mul(e,(n*n-ya.magsq(i))/2/(n*De(r)-ya.dot(e,i)))};var ka={},ba=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};ka.edgesAssigned=function(e,t){var n,r,s,a,o,d;for(o=e.edges_assignment,d=[],(r=s=0,a=o.length);s<a;r=++s)n=o[r],n===t&&d.push(r);return d},ka.mountainEdges=function(e){return ka.edgesAssigned(e,"M")},ka.valleyEdges=function(e){return ka.edgesAssigned(e,"V")},ka.flatEdges=function(e){return ka.edgesAssigned(e,"F")},ka.boundaryEdges=function(e){return ka.edgesAssigned(e,"B")},ka.unassignedEdges=function(e){return ka.edgesAssigned(e,"U")},ka.keysStartingWith=function(e,t){var i,n;for(i in n=[],e)i.slice(0,t.length)===t&&n.push(i);return n},ka.keysEndingWith=function(e,t){var i,n;for(i in n=[],e)i.slice(-t.length)===t&&n.push(i);return n},ka.remapField=function(e,t,n){var r,s,a,o,d,c,g,f,p,_,h,u,v,y;for(h=[],s=o=0,g=n.length;o<g;s=++o)a=n[s],null!=a&&(h[a]=s);for(v=ka.keysStartingWith(e,t+"_"),c=0,f=v.length;c<f;c++)d=v[c],e[d]=function(){var t,i,n;for(n=[],i=0,t=h.length;i<t;i++)u=h[i],n.push(e[d][u]);return n}();for(y=ka.keysEndingWith(e,"_"+t),_=0,p=y.length;_<p;_++)d=y[_],e[d]=function(){var t,i,s,a;for(s=e[d],a=[],(i=0,t=s.length);i<t;i++)r=s[i],a.push(function(){var e,t,i;for(i=[],t=0,e=r.length;t<e;t++)u=r[t],i.push(n[u]);return i}());return a}();return e},ka.remapFieldSubset=function(e,t,i){var n,r,s;return n=0,r=function(){var e,t,r;for(r=[],e=0,t=i.length;e<t;e++)s=i[e],s?r.push(n++):r.push(null);return r}(),ka.remapField(e,t,r),r},ka.numType=function(e,t){var i,n,r;return i=function(){var i,s,a,o;for(a=ka.keysStartingWith(e,t+"_"),o=[],(i=0,s=a.length);i<s;i++)(n=a[i],r=e[n],null!=r.length)&&o.push(r.length);return o}(),i.length||(i=function(){var i,r,s,a;for(s=ka.keysEndingWith(e,"_"+t),a=[],(i=0,r=s.length);i<r;i++)n=s[i],a.push(1+Fe.apply(Math,e[n]));return a}()),i.length?Fe.apply(Math,i):0},ka.numVertices=function(e){return ka.numType(e,"vertices")},ka.numEdges=function(e){return ka.numType(e,"edges")},ka.numFaces=function(e){return ka.numType(e,"faces")},ka.removeDuplicateEdges_vertices=function(e){var t,i,n,r,s,a,o;return s={},i=0,r=function(){var r,d,c,l;for(c=e.edges_vertices,l=[],(r=0,d=c.length);r<d;r++)t=c[r],a=t[0],o=t[1],n=a<o?a+","+o:o+","+a,n in s||(s[n]=i,i+=1),l.push(s[n]);return l}(),ka.remapField(e,"edges",r),r},ka.edges_verticesIncident=function(e,t){var i,n,r;for(i=0,n=e.length;i<n;i++)if(r=e[i],0<=ba.call(t,r))return r;return null};var wa=function(){var t=Math.round;function e(e,t){var i,n,r,s,a,o,d;for(this.vertices_coords=e,this.epsilon=t,this.hash={},o=this.vertices_coords,(d=r=0,s=o.length);r<s;d=++r)n=o[d],(null==(i=this.hash)[a=this.key(n)]?i[a]=[]:i[a]).push(d)}return e.prototype.lookup=function(e){var i,n,r,s,a,o,d,c,g,f,p,_,h,u,b,w,E,P;for(h=e[0],w=e[1],u=t(h/this.epsilon),E=t(w/this.epsilon),c=[u,u-1,u+1],(i=0,s=c.length);i<s;i++)for(b=c[i],g=[E,E-1,E+1],(r=0,a=g.length);r<a;r++)for(P=g[r],n=b+","+P,p=null==(f=this.hash[n])?[]:f,(d=0,o=p.length);d<o;d++)if(_=p[d],this.epsilon>ya.dist(this.vertices_coords[_],e))return _;return null},e.prototype.key=function(e){var i,n,r,s,a;return n=e[0],s=e[1],r=t(n/this.epsilon),a=t(s/this.epsilon),i=r+","+a},e.prototype.insert=function(e){var t,i,n;return(n=this.lookup(e),null!=n)?n:((null==(t=this.hash)[i=this.key(e)]?t[i]=[]:t[i]).push(n=this.vertices_coords.length),this.vertices_coords.push(e),n)},e}();ka.collapseNearbyVertices=function(e,t){var i,n,r;return r=new wa([],t),n=function(){var t,n,s,a;for(s=e.vertices_coords,a=[],(t=0,n=s.length);t<n;t++)i=s[t],a.push(r.insert(i));return a}(),ka.remapField(e,"vertices",n)},ka.maybeAddVertex=function(e,t,n){var r;return r=ya.closestIndex(t,e.vertices_coords),null!=r&&n>=ya.dist(t,e.vertices_coords[r])?r:e.vertices_coords.push(t)-1},ka.addVertexLike=function(e,t){var i,n,r,s,a;for(a=ka.numVertices(e),s=ka.keysStartingWith(e,"vertices_"),(i=0,r=s.length);i<r;i++)switch(n=s[i],n.slice(6)){case"vertices":break;default:e[n][a]=e[n][t];}return a},ka.addEdgeLike=function(e,t,i,n){var r,s,a,o,d;for(r=e.edges_vertices.length,d=ka.keysStartingWith(e,"edges_"),(s=0,o=d.length);s<o;s++)switch(a=d[s],a.slice(6)){case"vertices":e.edges_vertices.push([null==i?e.edges_vertices[t][0]:i,null==n?e.edges_vertices[t][1]:n]);break;case"edges":break;default:e[a][r]=e[a][t];}return r},ka.addVertexAndSubdivide=function(t,n,r){var a,o,d,c,l,g,f,p,_,h;if(h=ka.maybeAddVertex(t,n,r),a=[],h===t.vertices_coords.length-1)for(f=t.edges_vertices,d=l=0,g=f.length;l<g;d=++l)(o=f[d],!(0<=ba.call(o,h)))&&(p=function(){var e,i,n;for(n=[],e=0,i=o.length;e<i;e++)_=o[e],n.push(t.vertices_coords[_]);return n}(),ya.pointStrictlyInSegment(n,p)&&(c=ka.addEdgeLike(t,d,h,o[1]),a.push(d,c),o[1]=h));return[h,a]},ka.removeLoopEdges=function(e){var t;return ka.remapFieldSubset(e,"edges",function(){var i,n,r,s;for(r=e.edges_vertices,s=[],(i=0,n=r.length);i<n;i++)t=r[i],s.push(t[0]!==t[1]);return s}())},ka.subdivideCrossingEdges_vertices=function(t,r,a){var o,d,c,g,f,_,h,y,x,b,w,E,P,A,S,N,L,j,M,C,O,B,F,I,z,V,D,T,q,R;for(d=[[],[]],o=function(e,i,n,r){var s;return s=ka.addEdgeLike(t,n,e,i),d[r].push(n,s)},y=null==a?0:a;y<t.edges_vertices.length;){for(f=t.edges_vertices[y],z=function(){var e,i,n;for(n=[],e=0,i=f.length;e<i;e++)T=f[e],n.push(t.vertices_coords[T]);return n}(),O=t.vertices_coords,(q=w=0,P=O.length);w<P;q=++w)(C=O[q],!(0<=ba.call(f,q)))&&ya.pointStrictlyInSegment(C,z)&&(o(q,f[1],y,0),f[1]=q);y++}for(R=new wa(t.vertices_coords,r),x=null==a?0:a;x<t.edges_vertices.length;){for(_=t.edges_vertices[x],V=function(){var e,i,n;for(n=[],e=0,i=_.length;e<i;e++)q=_[e],n.push(t.vertices_coords[q]);return n}(),B=t.edges_vertices.slice(0,x),(b=E=0,A=B.length);E<A;b=++E)if(h=B[b],D=function(){var e,i,n;for(n=[],i=0,e=h.length;i<e;i++)q=h[i],n.push(t.vertices_coords[q]);return n}(),!ka.edges_verticesIncident(_,h)&&ya.segmentsCross(V,D)){if(c=ya.lineIntersectLine(V,D),null==c)continue;g=R.insert(c),0<=ba.call(_,g)&&0<=ba.call(h,g)||(0>ba.call(_,g)&&(o(g,_[1],x,0),_[1]=g,V[1]=t.vertices_coords[g]),0>ba.call(h,g)&&(o(g,h[1],b,1),h[1]=g))}x++}for(M=ka.removeDuplicateEdges_vertices(t),F=[0,1],(L=0,S=F.length);L<S;L++)y=F[L],d[y]=function(){var e,t,i,r;for(i=d[y],r=[],(t=0,e=i.length);t<e;t++)f=i[t],r.push(M[f]);return r}();for(M=ka.removeLoopEdges(t),I=[0,1],(j=0,N=I.length);j<N;j++)y=I[j],d[y]=function(){var e,t,i,n;for(i=d[y],n=[],(t=0,e=i.length);t<e;t++)f=i[t],n.push(M[f]);return n}();return null==a?d[0].concat(d[1]):d},ka.addEdgeAndSubdivide=function(t,n,r,s){var a,o,d,c,l,g,f,p,_,h,u,m,v;if(null!=n.length&&(_=ka.addVertexAndSubdivide(t,n,s),n=_[0],o=_[1]),null!=r.length&&(h=ka.addVertexAndSubdivide(t,r,s),r=h[0],d=h[1]),n===r)return[[],[]];for(u=t.edges_vertices,l=f=0,p=u.length;f<p;l=++f)if(c=u[l],c[0]===n&&c[1]===r||c[0]===r&&c[1]===n)return[[l],[]];return g=t.edges_vertices.push([n,r])-1,g?(a=ka.subdivideCrossingEdges_vertices(t,s,g),0>ba.call(a[0],g)&&a[0].push(g)):a=[[g],[]],null!=o&&(m=a[1]).push.apply(m,o),null!=d&&(v=a[1]).push.apply(v,d),a},ka.cutEdges=function(s,a){var d,c,g,f,p,_,h,u,y,x,b,w,E,P,A,S,N,L,j,M,C,O,B,F,I,z,V,D,T,R,X,W,G,Y,U,K,H,Z,Q,J,$,ee,te,ne,re,se,ae,oe,de;for(de=[],X=ka.boundaryEdges(s),(P=0,S=X.length);P<S;P++)for(f=X[P],W=s.edges_vertices[f],(A=0,N=W.length);A<N;A++)re=W[A],(null==de[re]?de[re]=[]:de[re]).push(f);for(F=0,L=a.length;F<L;F++){for(p=a[F],_=ka.addEdgeLike(s,p),Y=s.edges_vertices[p],(u=I=0,j=Y.length);I<j;u=++I)re=Y[u],oe=s.vertices_edges[re],oe.splice(oe.indexOf(p)+u,0,_);for(U=s.edges_vertices[p],u=D=0,M=U.length;D<M;u=++D)if(se=U[u],te=s.edges_vertices[p][1-u],ne=s.edges_vertices[_][1-u],g=null==(K=de[se])?void 0:K.length,2<=g){if(2<g)throw new Error(de[se].length+" boundary edges at vertex "+se);if(H=de[se],d=H[0],c=H[1],V=s.vertices_edges[se],y=V.indexOf(d),x=V.indexOf(c),x===(y+1)%V.length)0!==x&&(V=V.slice(x).concat(V.slice(0,+y+1||9e9)));else if(y===(x+1)%V.length)0!==y&&(V=V.slice(y).concat(V.slice(0,+x+1||9e9)));else throw new Error("Nonadjacent boundary edges at vertex "+se);for(w=V.indexOf(p),E=V.indexOf(_),b=Be(w,E),s.vertices_edges[se]=V.slice(0,+b+1||9e9),ae=ka.addVertexLike(s,se),s.vertices_edges[ae]=V.slice(1+b),Z=s.vertices_edges[ae],(T=0,C=Z.length);T<C;T++)z=Z[T],h=s.edges_vertices[z],h[h.indexOf(se)]=ae}for(null!=(Q=s.edges_assignment)&&(Q[p]="B"),null!=(J=s.edges_assignment)&&(J[_]="B"),$=s.edges_vertices[p],(u=R=0,O=$.length);R<O;u=++R)re=$[u],(null==de[re]?de[re]=[]:de[re]).push(p);for(G=s.edges_vertices[_],u=ee=0,B=G.length;ee<B;u=++ee)re=G[u],(null==de[re]?de[re]=[]:de[re]).push(_)}return delete s.vertices_vertices,s},ka.edges_vertices_to_vertices_vertices=function(e){var t,i,n,r,s,a,o,d;for(r=ka.numVertices(e),o=function(){var e,t,i;for(i=[],a=e=0,t=r;0<=t?e<t:e>t;a=0<=t?++e:--e)i.push([]);return i}(),s=e.edges_vertices,(i=0,n=s.length);i<n;i++){for(t=s[i],a=t[0],d=t[1];a>=o.length;)o.push([]);for(;d>=o.length;)o.push([]);o[a].push(d),o[d].push(a)}return o};var Ea={},Pa=function(e,t){return(+e%(t=+t)+t)%t},Aa={}.hasOwnProperty;Ea.edges_vertices_to_vertices_vertices_unsorted=function(e){return e.vertices_vertices=ka.edges_vertices_to_vertices_vertices(e),e},Ea.edges_vertices_to_vertices_vertices_sorted=function(e){return Ea.edges_vertices_to_vertices_vertices_unsorted(e),Ea.sort_vertices_vertices(e)},Ea.edges_vertices_to_vertices_edges_sorted=function(e){return Ea.edges_vertices_to_vertices_vertices_sorted(e),Ea.vertices_vertices_to_vertices_edges(e)},Ea.sort_vertices_vertices=function(e){var t,i,n,r,s;if(2!==(null==(i=e.vertices_coords)||null==(n=i[0])?void 0:n.length))throw console.log("fold.vertices_coords",e.vertices_coords),new Error("sort_vertices_vertices: Vertex coordinates missing or not two dimensional");for(s in null==e.vertices_vertices&&Ea.edges_vertices_to_vertices_vertices(e),r=e.vertices_vertices,r)t=r[s],ya.sortByAngle(t,s,function(t){return e.vertices_coords[t]});return e},Ea.vertices_vertices_to_faces_vertices=function(e){var t,n,r,s,a,o,d,c,g,f,p,_,h,m,y,b,E,P,A,S;for(p={},_=e.vertices_vertices,(P=r=0,d=_.length);r<d;P=++r)for(f=_[P],n=s=0,c=f.length;s<c;n=++s)b=f[n],p[b+","+P]=f[Pa(n-1,f.length)];for(e.faces_vertices=[],h=function(){var e;for(a in e=[],p)e.push(a);return e}(),(o=0,g=h.length);o<g;o++)if(E=h[o],A=p[E],null!=A){for(p[E]=null,m=E.split(","),b=m[0],P=m[1],b=parseInt(b),P=parseInt(P),t=[b,P];A!==t[0];){if(null==A){console.warn("Confusion with face "+t);break}t.push(A),y=[P,A],b=y[0],P=y[1],A=p[b+","+P],p[b+","+P]=null}p[t[t.length-1]+","+t[0]]=null,null!=A&&0<ya.polygonOrientation(function(){var i,n,r;for(r=[],n=0,i=t.length;n<i;n++)S=t[n],r.push(e.vertices_coords[S]);return r}())&&e.faces_vertices.push(t)}return e},Ea.vertices_edges_to_faces_vertices_edges=function(t){var n,r,s,a,o,d,c,g,f,p,_,h,u,y,b,w,E,P,A,S,N,L;for(b=[],E=t.vertices_edges,(A=d=0,f=E.length);d<f;A=++d)for(y=E[A],b[A]={},(o=c=0,p=y.length);c<p;o=++c)n=y[o],b[A][n]=y[Pa(o-1,y.length)];for(t.faces_vertices=[],t.faces_edges=[],(S=g=0,_=b.length);g<_;S=++g)for(r in w=b[S],w)if(s=w[r],null!=s){if(r=parseInt(r),w[r]=null,a=[r],N=[ka.edges_verticesIncident(t.edges_vertices[r],t.edges_vertices[s])],null==N[0])throw new Error("Confusion at edges "+r+" and "+s);for(;s!==a[0];){if(null==s){console.warn("Confusion with face containing edges "+a);break}for(a.push(s),P=t.edges_vertices[s],(u=0,h=P.length);u<h;u++)if(A=P[u],A!==N[N.length-1]){N.push(A);break}r=s,s=b[A][r],b[A][r]=null}null!=s&&0<ya.polygonOrientation(function(){var e,i,r;for(r=[],i=0,e=N.length;i<e;i++)L=N[i],r.push(t.vertices_coords[L]);return r}())&&(t.faces_vertices.push(N),t.faces_edges.push(a))}return t},Ea.edges_vertices_to_faces_vertices=function(e){return Ea.edges_vertices_to_vertices_vertices_sorted(e),Ea.vertices_vertices_to_faces_vertices(e)},Ea.edges_vertices_to_faces_vertices_edges=function(e){return Ea.edges_vertices_to_vertices_edges_sorted(e),Ea.vertices_edges_to_faces_vertices_edges(e)},Ea.vertices_vertices_to_vertices_edges=function(e){var t,n,r,s,a,o,d,c,l,g,f;for(n={},o=e.edges_vertices,(t=s=0,a=o.length);s<a;t=++s)d=o[t],c=d[0],l=d[1],n[c+","+l]=t,n[l+","+c]=t;return e.vertices_edges=function(){var t,i,s,a;for(s=e.vertices_vertices,a=[],(g=t=0,i=s.length);t<i;g=++t)f=s[g],a.push(function(){var e,t,i;for(i=[],r=e=0,t=f.length;0<=t?e<t:e>t;r=0<=t?++e:--e)i.push(n[g+","+f[r]]);return i}());return a}()},Ea.faces_vertices_to_faces_edges=function(e){var t,n,r,s,a,o,d,c,l,g,f;for(n={},d=e.edges_vertices,(t=a=0,o=d.length);a<o;t=++a)c=d[t],l=c[0],g=c[1],n[l+","+g]=t,n[g+","+l]=t;return e.faces_edges=function(){var t,i,a,o;for(a=e.faces_vertices,o=[],(r=t=0,i=a.length);t<i;r=++t)f=a[r],o.push(function(){var e,t,i;for(i=[],s=e=0,t=f.length;0<=t?e<t:e>t;s=0<=t?++e:--e)i.push(n[f[s]+","+f[(s+1)%f.length]]);return i}());return o}()},Ea.faces_vertices_to_edges=function(e){var t,n,r,s,a,o,d,c,l;for(r in e.edges_vertices=[],e.edges_faces=[],e.faces_edges=[],e.edges_assignment=[],n={},o=e.faces_vertices,o)l=o[r],r=parseInt(r),e.faces_edges.push(function(){var i,o,g;for(g=[],s=i=0,o=l.length;i<o;s=++i)d=l[s],d=parseInt(d),c=l[(s+1)%l.length],a=d<=c?d+","+c:c+","+d,a in n?t=n[a]:(t=n[a]=e.edges_vertices.length,d<=c?e.edges_vertices.push([d,c]):e.edges_vertices.push([c,d]),e.edges_faces.push([null,null]),e.edges_assignment.push("B")),d<=c?e.edges_faces[t][0]=r:e.edges_faces[t][1]=r,g.push(t);return g}());return e},Ea.deepCopy=function(t){var i,n,r,s,a,o,d,c;if("number"===(o=e(t))||"string"===o||"boolean"===o)return t;if(Array.isArray(t)){for(d=[],r=0,a=t.length;r<a;r++)n=t[r],d.push(Ea.deepCopy(n));return d}for(s in i={},t)Aa.call(t,s)&&(c=t[s],i[s]=Ea.deepCopy(c));return i},Ea.toJSON=function(e){var t,i,n;return"{\n"+function(){var r=[];for(var s=Object.keys(e),a=0;a<s.length;a++)t=s[a],n=e[t],r.push("  "+JSON.stringify(t)+": "+(Array.isArray(n)?"[\n"+function(){var e,t,r;for(r=[],e=0,t=n.length;e<t;e++)i=n[e],r.push("    "+JSON.stringify(i));return r}().join(",\n")+"\n  ]":JSON.stringify(n)));return r}().join(",\n")+"\n}\n"},Ea.extensions={},Ea.converters={},Ea.getConverter=function(e,t){return e===t?function(e){return e}:Ea.converters[""+e+t]},Ea.setConverter=function(e,t,i){return Ea.extensions[e]=!0,Ea.extensions[t]=!0,Ea.converters[""+e+t]=i},Ea.convertFromTo=function(e,t,i){var n;if("."!==t[0]&&(t="."+t),"."!==i[0]&&(i="."+i),n=Ea.getConverter(t,i),null==n){if(t===i)return e;throw new Error("No converter from "+t+" to "+i)}return n(e)},Ea.convertFrom=function(e,t){return Ea.convertFromTo(e,t,".fold")},Ea.convertTo=function(e,t){return Ea.convertFromTo(e,".fold",t)};var Sa={type2fold:{0:"F",1:"B",2:"M",3:"V"},fold2type:{}},Na=Sa.type2fold;for(var La in Na){var x=Na[La];Sa.fold2type[x]=La}Sa.fold2type_default=0,Sa.prop_xml2fold={editorName:"frame_author",originalAuthorName:"frame_designer",reference:"frame_reference",title:"frame_title",memo:"frame_description",paperSize:null,mainVersion:null,subVersion:null},Sa.POINT_EPS=1,Sa.toFold=function(e,t){var i,r,s,a,o,d,c,g,f,p,_,h,u,v,y,x,b,w,E,P,A,S,N,L,M,C,O,B,F,I,z,V,D,T;for(r={vertices_coords:[],edges_vertices:[],edges_assignment:[],file_creator:"oripa2fold"},F=function(e,t){var i;return i=r.vertices_coords.length,r.vertices_coords.push([parseFloat(e),parseFloat(t)]),i},y=function(e,t,i,n){return null!=t&&e.tagName!==t?(console.warn("ORIPA file has "+e.tagName+" where "+t+" was expected"),null):null==i||e.hasAttribute(i)&&(null==n||e.getAttribute(i)===n)?e:(console.warn("ORIPA file has "+e.tagName+" with "+i+" = "+e.getAttribute(i)+" where "+n+" was expected"),null)},i=function(e){var t,i,n,r,s;if(e){for(r=e.childNodes,s=[],(i=0,n=r.length);i<n;i++)t=r[i],1===t.nodeType&&s.push(t);return s}return[]},b=function(e,t,n,r){var s;return s=i(e),1===s.length?y(s[0],t,n,r):(console.warn("ORIPA file has "+e.tagName+" with "+e.childNodes.length+" children, not 1"),null)},w=function(e){var t;return 1<e.childNodes.length?(console.warn("ORIPA file has "+e.tagName+" with "+e.childNodes.length+" children, not 0 or 1"),null):0===e.childNodes.length?"":(t=e.childNodes[0],3===t.nodeType?t.data:console.warn("ORIPA file has nodeType "+t.nodeType+" where 3 (text) was expected"))},V=!0===t?e:new DOMParser().parseFromString(e,"text/xml").documentElement,A=i(V),(s=0,d=A.length);s<d;s++)if(O=A[s],y(O,"object","class","oripa.DataSet"))for(S=i(O),a=0,c=S.length;a<c;a++)if(P=S[a],"lines"===P.getAttribute("property")){for(h=b(P,"array","class","oripa.OriLineProxy"),N=i(h),(o=0,g=N.length);o<g;o++)if(_=N[o],y(_,"void","index"))for(L=i(_),u=0,f=L.length;u<f;u++)if(x=L[u],y(x,"object","class","oripa.OriLineProxy")){for(I=z=D=T=B=0,M=i(x),(v=0,p=M.length);v<p;v++)if(C=M[v],y(C,"void","property"))switch(C.getAttribute("property")){case"x0":I=w(b(C,"double"));break;case"x1":z=w(b(C,"double"));break;case"y0":D=w(b(C,"double"));break;case"y1":T=w(b(C,"double"));break;case"type":B=w(b(C,"int"));}null!=I&&null!=z&&null!=D&&null!=T?(r.edges_vertices.push([F(I,D),F(z,T)]),null!=B&&(B=parseInt(B)),r.edges_assignment.push(Sa.type2fold[B])):console.warn("ORIPA line has missing data: "+I+" "+z+" "+D+" "+T+" "+B)}}else P.getAttribute("property")in Sa.prop_xml2fold?(E=Sa.prop_xml2fold[P.getAttribute("property")],null!=E&&(r[E]=w(b(P,"string")))):console.warn("Ignoring "+P.tagName+" "+O.getAttribute("property")+" in ORIPA file");return ka.collapseNearbyVertices(r,Sa.POINT_EPS),ka.subdivideCrossingEdges_vertices(r,Sa.POINT_EPS),Ea.edges_vertices_to_faces_vertices(r),r},Sa.fromFold=function(e){var t,n,r,a,o,d,c,l,g,f,p,_,h;for(h in"string"==typeof e&&(e=JSON.parse(e)),f="<?xml version=\"1.0\" encoding=\"UTF-8\"?> \n<java version=\"1.5.0_05\" class=\"java.beans.XMLDecoder\"> \n <object class=\"oripa.DataSet\"> \n  <void property=\"mainVersion\"> \n   <int>1</int> \n  </void> \n  <void property=\"subVersion\"> \n   <int>1</int> \n  </void> \n  <void property=\"paperSize\"> \n   <double>400.0</double> \n  </void> \n",g=Sa.prop_xml2fold,g)r=g[h],f+=(".\n  <void property=\""+h+"\"> \n   <string>"+(e[r]||"")+"</string> \n  </void> \n").slice(2);for(l=function(){var i,r,s,a;for(s=e.edges_vertices,a=[],(n=i=0,r=s.length);i<r;n=++i)t=s[n],_=function(){var i,n,r,s,a,o;for(o=[],i=0,r=t.length;i<r;i++){for(p=t[i],a=e.vertices_coords[p].slice(2),(n=0,s=a.length);n<s;n++)a[n];o.push(e.vertices_coords[p])}return o}(),a.push({x0:_[0][0],y0:_[0][1],x1:_[1][0],y1:_[1][1],type:Sa.fold2type[e.edges_assignment[n]]||Sa.fold2type_default});return a}(),f+=(".\n  <void property=\"lines\"> \n   <array class=\"oripa.OriLineProxy\" length=\""+l.length+"\"> \n").slice(2),(a=o=0,d=l.length);o<d;a=++o)c=l[a],f+=(".\n    <void index=\""+a+"\"> \n     <object class=\"oripa.OriLineProxy\"> \n      <void property=\"type\"> \n       <int>"+c.type+"</int> \n      </void> \n      <void property=\"x0\"> \n       <double>"+c.x0+"</double> \n      </void> \n      <void property=\"x1\"> \n       <double>"+c.x1+"</double> \n      </void> \n      <void property=\"y0\"> \n       <double>"+c.y0+"</double> \n      </void> \n      <void property=\"y1\"> \n       <double>"+c.y1+"</double> \n      </void> \n     </object> \n    </void> \n").slice(2);return f+=".\n   </array> \n  </void> \n </object> \n</java> \n".slice(2),f};var y="undefined"!=typeof window&&"undefined"!=typeof window.document,ja="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,Ma="object"===("undefined"==typeof self?"undefined":e(self))&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,Ca=!ja&&y?window:{};if(ja){var Oa=require("xmldom"),Ba=Oa.DOMParser,Fa=Oa.XMLSerializer;Ca.DOMParser=Ba,Ca.XMLSerializer=Fa,Ca.document=new Ba().parseFromString("<!DOCTYPE html><title>a</title>","text/html")}var Ia={black:"#000000",silver:"#c0c0c0",gray:"#808080",white:"#ffffff",maroon:"#800000",red:"#ff0000",purple:"#800080",fuchsia:"#ff00ff",green:"#008000",lime:"#00ff00",olive:"#808000",yellow:"#ffff00",navy:"#000080",blue:"#0000ff",teal:"#008080",aqua:"#00ffff",orange:"#ffa500",aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",blanchedalmond:"#ffebcd",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",oldlace:"#fdf5e6",olivedrab:"#6b8e23",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",whitesmoke:"#f5f5f5",yellowgreen:"#9acd32"},za=Object.keys(Ia),Va=function(e){var t=0,i=0,n=0,s=255;return 4===e.length?(t="0x".concat(e[1]).concat(e[1]),i="0x".concat(e[2]).concat(e[2]),n="0x".concat(e[3]).concat(e[3])):7===e.length?(t="0x".concat(e[1]).concat(e[2]),i="0x".concat(e[3]).concat(e[4]),n="0x".concat(e[5]).concat(e[6])):5===e.length?(t="0x".concat(e[1]).concat(e[1]),i="0x".concat(e[2]).concat(e[2]),n="0x".concat(e[3]).concat(e[3]),s="0x".concat(e[4]).concat(e[4])):9===e.length&&(t="0x".concat(e[1]).concat(e[2]),i="0x".concat(e[3]).concat(e[4]),n="0x".concat(e[5]).concat(e[6]),s="0x".concat(e[7]).concat(e[8])),[+(t/255),+(i/255),+(n/255),+(s/255)]},Da=function(e){if(null==e||"string"!=typeof e)return"U";var t=[0,0,0,1];"#"===e[0]?t=Va(e):-1!==za.indexOf(e)&&(t=Va(Ia[e]));var i=.05;return t[0]<i&&t[1]<i&&t[2]<i?"U":t[0]>t[1]&&t[0]-t[2]>i?"M":t[2]>t[1]&&t[2]-t[0]>i?"V":"U"},Ta=1e-6,qa=function(e,t){return e>Ta&&e<1-Ta&&t>Ta&&t<1-Ta},Ra=function(e,t,i,n,r){function s(e,t){return e[0]*t[1]-t[0]*e[1]}var a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:Ta,o=s(t,n);if(!(ze(o)<a)){var d=s([i[0]-e[0],i[1]-e[1]],n),c=s([e[0]-i[0],e[1]-i[1]],t),l=d/o;return r(l,c/-o,a)?[e[0]+t[0]*l,e[1]+t[1]*l]:void 0}},Xa={core:{EPSILON:Ta,equivalent:function(e,t){for(var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:Ta,r=0;r<e.length;r+=1)if(ze(e[r]-t[r])>n)return!1;return!0},point_on_edge_exclusive:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:Ta,r=[t[0]-i[0],t[1]-i[1]],s=[t[0]-e[0],t[1]-e[1]],a=[i[0]-e[0],i[1]-e[1]],o=qe(r[0]*r[0]+r[1]*r[1]),d=qe(s[0]*s[0]+s[1]*s[1]),c=qe(a[0]*a[0]+a[1]*a[1]);return ze(o-d-c)<n},intersection:{edge_edge_exclusive:function(e,t,i,n,r){var s=[t[0]-e[0],t[1]-e[1]],a=[n[0]-i[0],n[1]-i[1]];return Ra(e,s,i,a,qa,r)}}}},Wa=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return Fe.apply(Math,n(t.filter(function(e){return void 0!==e}).map(function(e){return e.length})))},Ga={vertices:function(e){var t=e.vertices_coords,i=e.vertices_faces,n=e.vertices_vertices;return Wa([],t,i,n)},edges:function(e){var t=e.edges_vertices,i=e.edges_faces;return Wa([],t,i)},faces:function(e){var t=e.faces_vertices,i=e.faces_edges;return Wa([],t,i)}},Ya=function(e,t,i){var n=Ga[t](e),r=Array(n).fill(!1);i.forEach(function(e){r[e]=!0});var a=0,o=r.map(function(e){return e?--a:a});if(0===i.length)return o;var d="".concat(t,"_"),c="_".concat(t),l=Object.keys(e),g=l.map(function(e){return e.substring(0,d.length)===d?e:void 0}).filter(function(e){return void 0!==e}),f=l.map(function(e){return e.substring(e.length-c.length,e.length)===c?e:void 0}).filter(function(e){return void 0!==e});return f.forEach(function(t){return e[t].forEach(function(n,r){return e[t][r].forEach(function(i,n){e[t][r][n]+=o[i]})})}),g.forEach(function(t){e[t]=e[t].filter(function(e,t){return!r[t]})}),o},Ua=function(e,t){return e[0]===t[0]&&e[1]===t[1]||e[0]===t[1]&&e[1]===t[0]},Ka=function(e){var t=e.vertices_coords,i=e.edges_vertices,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Xa.core.EPSILON,r=i.map(function(e){return e.map(function(e){return t[e]})});return r.map(function(i){return t.filter(function(e){return Xa.core.point_on_edge_exclusive(e,i[0],i[1],n)})})},Ha=function(e){var t=e.vertices_coords,i=e.edges_vertices,n=i.map(function(e){return e.map(function(e){return t[e]})}),r=n.map(function(t){return[t[1][0]-t[0][0],t[1][1]-t[0][1]]}),s=r.map(function(t){return qe(t[0]*t[0]+t[1]*t[1])}),a=r.map(function(t,e){return[t[0]/s[e],t[1]/s[e]]});return a.map(function(t){return .707<ze(t[0])})},Za=function(e){for(var t=e.vertices_coords,n=e.edges_vertices,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Xa.core.EPSILON,s=n.length,a=n.map(function(e){return e.map(function(e){return t[e]})}),o=Array.from(Array(s-1)).map(function(){return[]}),d=0;d<a.length-1;d+=1)for(var c=d+1;c<a.length;c+=1)o[d][c]=Xa.core.intersection.edge_edge_exclusive(a[d][0],a[d][1],a[c][0],a[c][1],r);for(var l=Array.from(Array(s)).map(function(){return[]}),g=0;g<a.length-1;g+=1)for(var f=g+1;f<a.length;f+=1)null!=o[g][f]&&(l[g].push(o[g][f]),l[f].push(o[g][f]));return l},Qa=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Xa.core.EPSILON,n=function(e,t){return e[0]-t[0]},r=function(e,t){return e[1]-t[1]},s=Ha(e),a=e.edges_vertices.map(function(t){return t.map(function(t){return e.vertices_coords[t]})});a.forEach(function(t,e){return t.sort(s[e]?n:r)});var o=Za(e,t),d=Ka(e,t),c=o.map(function(e,t){return e.concat(d[t])});c.forEach(function(t,e){return t.sort(s[e]?n:r)});var l=c.map(function(e){return Array.from(Array(e.length-1)).map(function(t,n){return[e[n],e[n+1]]})});l=l.map(function(e){return e.filter(function(n){return!1===n.map(function(e,r){return ze(n[0][r]-n[1][r])<t}).reduce(function(e,t){return e&&t},!0)})});for(var g=l.map(function(e,t){return e.map(function(){return t})}).reduce(function(e,t){return e.concat(t)},[]),f=l.map(function(e){return e.reduce(function(e,t){return e.concat(t)},[])}).reduce(function(e,t){return e.concat(t)},[]),p=0,_=l.map(function(e){return e.map(function(){return[p++,p++]})}).reduce(function(e,t){return e.concat(t)},[]),h=Array.from(Array(f.length)).map(function(){return[]}),u=0;u<f.length-1;u+=1)for(var m=u+1;m<f.length;m+=1)h[u][m]=Xa.core.equivalent(f[u],f[m],t);var y=f.map(function(){});h.forEach(function(e,t){return e.forEach(function(e,i){e&&(y[i]=void 0===y[t]?t:y[t])})});var x=y.map(function(e){return void 0!==e});y.forEach(function(e,t){void 0===e&&(y[t]=t)}),_.forEach(function(e,t){return e.forEach(function(e,i){_[t][i]=y[e]})});for(var k=Array.from(Array(_.length)).map(function(){return[]}),b=0;b<_.length-1;b+=1)for(var w=b+1;w<_.length;w+=1)k[b][w]=Ua(_[b],_[w]);var E=_.map(function(){});k.forEach(function(e,t){return e.forEach(function(e,i){e&&(E[t]=void 0===E[i]?i:E[i])})});var P=E.map(function(e){return void 0===e});E.forEach(function(e,t){void 0===e&&(E[t]=t)});var A=_.filter(function(e,t){return P[t]}),S=g.filter(function(e,t){return P[t]}),N={vertices_coords:f,edges_vertices:A};!0=="edges_assignment"in e&&(N.edges_assignment=S.map(function(t){return e.edges_assignment[t]})),!0=="edges_foldAngle"in e&&(N.edges_foldAngle=S.map(function(t){return e.edges_foldAngle[t]}));var L=x.map(function(e,t){return e?t:void 0}).filter(function(e){return void 0!==e});return Ya(N,"vertices",L),N},Ja={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},$a=/([astvzqmhlc])([^astvzqmhlc]*)/ig,eo=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;oe.prototype={constructor:oe,init:function(){this.length=this.getArcLength([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y])},getTotalLength:function(){return this.length},getPointAtLength:function(e){var i=le(e,this.length,this.getArcLength,[this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y]);return this.getPoint([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],i)},getTangentAtLength:function(e){var i=le(e,this.length,this.getArcLength,[this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y]),t=this.getDerivative([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],i),n=qe(t.x*t.x+t.y*t.y),r;return r=0<n?{x:t.x/n,y:t.y/n}:{x:0,y:0},r},getPropertiesAtLength:function(e){var i=le(e,this.length,this.getArcLength,[this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y]),t=this.getDerivative([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],i),n=qe(t.x*t.x+t.y*t.y),r;r=0<n?{x:t.x/n,y:t.y/n}:{x:0,y:0};var s=this.getPoint([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],i);return{x:s.x,y:s.y,tangentX:r.x,tangentY:r.y}}};var to=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],io=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],no=[[1],[1,1],[1,2,1],[1,3,3,1]];me.prototype={constructor:me,init:function(){},getTotalLength:function(){return this.length},getPointAtLength:function(e){0>e?e=0:e>this.length&&(e=this.length);var t=ve({x:this.x0,y:this.y0},this.rx,this.ry,this.xAxisRotate,this.LargeArcFlag,this.SweepFlag,{x:this.x1,y:this.y1},e/this.length);return{x:t.x,y:t.y}},getTangentAtLength:function(e){0>e?e=0:e>this.length&&(e=this.length);var t=ve({x:this.x0,y:this.y0},this.rx,this.ry,this.xAxisRotate,this.LargeArcFlag,this.SweepFlag,{x:this.x1,y:this.y1},e/this.length);return{x:t.x,y:t.y}},getPropertiesAtLength:function(e){var t=this.getTangentAtLength(e),i=this.getPointAtLength(e);return{x:i.x,y:i.y,tangentX:t.x,tangentY:t.y}}},Ae.prototype.getTotalLength=function(){return qe(Re(this.x0-this.x1,2)+Re(this.y0-this.y1,2))},Ae.prototype.getPointAtLength=function(e){var t=e/qe(Re(this.x0-this.x1,2)+Re(this.y0-this.y1,2)),i=(this.x1-this.x0)*t,n=(this.y1-this.y0)*t;return{x:this.x0+i,y:this.y0+n}},Ae.prototype.getTangentAtLength=function(){var e=qe((this.x1-this.x0)*(this.x1-this.x0)+(this.y1-this.y0)*(this.y1-this.y0));return{x:(this.x1-this.x0)/e,y:(this.y1-this.y0)/e}},Ae.prototype.getPropertiesAtLength=function(e){var t=this.getPointAtLength(e),i=this.getTangentAtLength();return{x:t.x,y:t.y,tangentX:i.x,tangentY:i.y}};var ro=128,so={value:0},ao=function(e){return e.split(" ").filter(function(e){return""!==e}).map(function(e){return e.split(",").map(function(e){return parseFloat(e)})})},oo=function(e,t){var i=t.map(function(t){for(var n=0;n<e.attributes.length;n+=1)if(e.attributes[n].nodeName===t)return n});return i.map(function(t){return void 0===t?so:e.attributes[t]}).map(function(e){return void 0===e.value?e.baseVal.value:e.value})},co=function(e){for(var t="",n=0;n<e.attributes.length;n+=1)if("points"===e.attributes[n].nodeName){t=e.attributes[n].value;break}return ao(t).map(function(e,t,i){return[i[t][0],i[t][1],i[(t+1)%i.length][0],i[(t+1)%i.length][1]]})},lo={line:function(e){return[oo(e,["x1","y1","x2","y2"])]},rect:function(e){var t=oo(e,["x","y","width","height"]),i=parseFloat(t[0]),n=parseFloat(t[1]),r=parseFloat(t[2]),s=parseFloat(t[3]);return[[i,n,i+r,n],[i+r,n,i+r,n+s],[i+r,n+s,i,n+s],[i,n+s,i,n]]},circle:function(e){var t=oo(e,["cx","cy","r"]),n=parseFloat(t[0]),s=parseFloat(t[1]),a=parseFloat(t[2]);return Array.from(Array(64)).map(function(e,t){return[n+a*De(2*(t/64*Ie)),s+a*Ve(2*(t/64*Ie))]}).map(function(e,t,i){return[i[t][0],i[t][1],i[(t+1)%i.length][0],i[(t+1)%i.length][1]]})},ellipse:function(e){var t=oo(e,["cx","cy","rx","ry"]),n=parseFloat(t[0]),r=parseFloat(t[1]),s=parseFloat(t[2]),a=parseFloat(t[3]);return Array.from(Array(64)).map(function(e,t){return[n+s*De(2*(t/64*Ie)),r+a*Ve(2*(t/64*Ie))]}).map(function(e,t,i){return[i[t][0],i[t][1],i[(t+1)%i.length][0],i[(t+1)%i.length][1]]})},polygon:co,polyline:function(e){var t=co(e);return t.pop(),t},path:function(e){var t=e.getAttribute("d"),n=Se(t),r=n.getTotalLength(),s="Z"===t[t.length-1]||"z"===t[t.length-1],a=s?r/ro:r/(ro-1),o=Array.from(Array(ro)).map(function(e,t){return n.getPointAtLength(t*a)}).map(function(e){return[e.x,e.y]}),d=o.map(function(e,t,i){return[i[t][0],i[t][1],i[(t+1)%i.length][0],i[(t+1)%i.length][1]]});return s||d.pop(),d}},go={};if(function(){return"undefined"==typeof window&&"undefined"!=typeof process}()){var fo=require("xmldom"),po=fo.DOMParser,_o=fo.XMLSerializer;go.DOMParser=po,go.XMLSerializer=_o,go.document=new po().parseFromString("<!DOCTYPE html><title> </title>","text/html")}else(function(){return"undefined"!=typeof window})()&&(go.DOMParser=window.DOMParser,go.XMLSerializer=window.XMLSerializer,go.document=window.document);var ho=function(e){var t=e.match(/(\w+\((\-?\d+\.?\d*e?\-?\d*,?\s*)+\))+/g),i=t.map(function(e){return e.match(/[\w\.\-]+/g)});return i.map(function(e){return{transform:e.shift(),parameters:e.map(function(e){return parseFloat(e)})}})},uo=function(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5],e[2]*t[0]+e[3]*t[2]+t[4],e[2]*t[1]+e[3]*t[3]+t[5]]},mo=function(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]},vo=function(e){switch(e.length){case 1:return[1,0,0,1,e[0],0];case 2:return[1,0,0,1,e[0],e[1]];default:console.warn("improper translate, ".concat(e));}},yo=function(e){var t=De(e[0]/180*Ie),i=Ve(e[0]/180*Ie);switch(e.length){case 1:return[t,i,-i,t,0,0];case 3:return[t,i,-i,t,-e[1]*t+e[2]*i+e[1],-e[1]*i-e[2]*t+e[2]];default:console.warn("improper rotate, ".concat(e));}},xo=function(e){switch(e.length){case 1:return[e[0],0,0,e[0],0,0];case 2:return[e[0],0,0,e[1],0,0];default:console.warn("improper scale, ".concat(e));}},ko=function(e){return[1,0,Me(e[0]/180*Ie),1,0,0]},bo=function(e){return[1,Me(e[0]/180*Ie),0,1,0,0]},wo=function(e,t){switch(e){case"translate":return vo(t);case"rotate":return yo(t);case"scale":return xo(t);case"skewX":return ko(t);case"skewY":return bo(t);case"matrix":return t;default:console.warn("unknown transform type ".concat(e));}},Eo=function(e){return ho(e).map(function(e){return wo(e.transform,e.parameters)}).filter(function(e){return void 0!==e}).reduce(function(e,t){return mo(e,t)},[1,0,0,1,0,0])},Po=function(e){if("function"!=typeof e.getAttribute)return[1,0,0,1,0,0];var t=e.getAttribute("transform");return null!=t&&""!==t?Eo(t):[1,0,0,1,0,0]},Ao=function e(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[1,0,0,1,0,0],n=mo(i,Po(t));if(t.matrix=n,"g"===t.tagName||"svg"===t.tagName){if(null==t.childNodes)return;Array.from(t.childNodes).forEach(function(t){return e(t,n)})}},So=Object.keys(lo),No="http://www.w3.org/2000/svg",Lo={string:!0,svg:!1},jo=["version","xmlns","contentScriptType","contentStyleType","baseProfile","class","externalResourcesRequired","x","y","width","height","viewBox","preserveAspectRatio","zoomAndPan","style"],Mo={line:["x1","y1","x2","y2"],rect:["x","y","width","height"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],polygon:["points"],polyline:["points"],path:["d"]},Co=function(e){return"string"==typeof e||e instanceof String?new go.DOMParser().parseFromString(e,"text/xml").documentElement:e},Oo=function e(t){return"g"===t.tagName||"svg"===t.tagName?null==t.childNodes?[]:Array.from(t.childNodes).map(function(t){return e(t)}).reduce(function(e,t){return e.concat(t)},[]):[t]},Bo=function(e){return Array.from(e.attributes).filter(function(t){return-1===Mo[e.tagName].indexOf(t.name)})},Fo=function(e){var t={};return e.forEach(function(e){t[e.nodeName]=e.value}),t},Io=function(e,t){var i=Co(e);Ao(i);var n=Oo(i),r=n.filter(function(t){return-1!==So.indexOf(t.tagName)}).map(function(t){return lo[t.tagName](t).map(function(e){return uo(e,t.matrix)}).map(function(e){return[].concat(ee(e),[Bo(t)])})}).reduce(function(e,t){return e.concat(t)},[]);r.filter(function(e){return void 0!==e[4]}).forEach(function(e){var t=e[4].filter(function(e){return"transform"!==e.nodeName});e[4]=Fo(t)});var s=Object.assign(Object.assign({},Lo),t);if(s.svg){var a=go.document.createElementNS(No,"svg");jo.map(function(e){return{attribute:e,value:i.getAttribute(e)}}).filter(function(e){return null!=e.value&&""!==e.value}).forEach(function(e){return a.setAttribute(e.attribute,e.value)}),null===a.getAttribute("xmlns")&&a.setAttribute("xmlns",No);var o=n.filter(function(t){return"style"===t.tagName||"defs"===t.tagName});if(0<o.length&&o.map(function(e){return e.cloneNode(!0)}).forEach(function(e){return a.appendChild(e)}),r.forEach(function(e){var t=go.document.createElementNS(No,"line");t.setAttributeNS(null,"x1",e[0]),t.setAttributeNS(null,"y1",e[1]),t.setAttributeNS(null,"x2",e[2]),t.setAttributeNS(null,"y2",e[3]),null!=e[4]&&Object.keys(e[4]).forEach(function(i){return t.setAttribute(i,e[4][i])}),a.appendChild(t)}),!1===s.string)return a;var d=new go.XMLSerializer().serializeToString(a),c=Ne(d);return c}return r},zo={convert:Ea},Vo={V:180,v:180,M:-180,m:-180},Do=function(e){return Vo[e]||0},To=function(){return{file_spec:1.1,file_creator:"Rabbit Ear",file_classes:["singleModel"],frame_title:"",frame_classes:["creasePattern"],frame_attributes:["2D"],vertices_coords:[],vertices_vertices:[],vertices_faces:[],edges_vertices:[],edges_faces:[],edges_assignment:[],edges_foldAngle:[],edges_length:[],faces_vertices:[],faces_edges:[]}},qo=function(e,t){var i=To(),n=i.vertices_coords.length,r=Io(e);i.vertices_coords=r.map(function(e){return[[e[0],e[1]],[e[2],e[3]]]}).reduce(function(e,t){return e.concat(t)},i.vertices_coords),i.edges_vertices=r.map(function(e,t){return[n+2*t,n+2*t+1]}),i.edges_assignment=r.map(function(e){return e[4]}).map(function(e){return null==e?"U":Da(e.stroke)});var s=Qa(i,t.epsilon);return zo.convert.edges_vertices_to_vertices_vertices_sorted(s),zo.convert.vertices_vertices_to_faces_vertices(s),zo.convert.faces_vertices_to_faces_edges(s),s.edges_foldAngle=s.edges_assignment.map(function(e){return Do(e)}),s},Ro=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e){var i=new Ca.DOMParser().parseFromString(e,"text/xml").documentElement;return qo(i,t)}return qo(e,t)};Ro.core={segmentize:function(){},fragment:Qa};var Xo=function(e,t,i){switch(t){case"fold":switch(i){case"fold":return e;case"oripa":return Sa.fromFold(e);case"svg":return va.svg(e);default:}break;case"oripa":switch(i){case"fold":return Sa.toFold(e,!0);case"oripa":return e;case"svg":return va.svg(Sa.toFold(e,!0));default:}break;case"svg":switch(i){case"fold":return Ro(e);case"oripa":return Sa.fromFold(Ro(e));case"svg":return e;default:}break;default:}},Wo=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},Go=function(e){var t=e.toLowerCase(),i=e.toUpperCase(),n=Wo(t),r=[t,i,n];return["","to","into"].map(function(e){return r.map(function(t){return e+t})}).reduce(function(e,t){return e.concat(t)},[])},Yo=function(){var e=As.apply(void 0,arguments),t={};return["fold","svg","oripa"].forEach(function(i){return Go(i).forEach(function(n){return Object.defineProperty(t,n,{value:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return Xo.apply(void 0,[e.data,e.type,i].concat(n))}})})}),t},Uo=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return Fe.apply(Math,n(t.filter(function(e){return void 0!==e}).map(function(e){return e.length})))},Ko={vertices:function(e){var t=e.vertices_coords,i=e.vertices_faces,n=e.vertices_vertices;return Uo([],t,i,n)},edges:function(e){var t=e.edges_vertices,i=e.edges_faces;return Uo([],t,i)},faces:function(e){var t=e.faces_vertices,i=e.faces_edges;return Uo([],t,i)}},Ho=function(e,t,i){var n=Ko[t](e),r=Array(n).fill(!1);i.forEach(function(e){r[e]=!0});var a=0,o=r.map(function(e){return e?--a:a});if(0===i.length)return o;var d="".concat(t,"_"),c="_".concat(t),l=Object.keys(e),g=l.map(function(e){return e.substring(0,d.length)===d?e:void 0}).filter(function(e){return void 0!==e}),f=l.map(function(e){return e.substring(e.length-c.length,e.length)===c?e:void 0}).filter(function(e){return void 0!==e});return f.forEach(function(t){return e[t].forEach(function(n,r){return e[t][r].forEach(function(i,n){e[t][r][n]+=o[i]})})}),g.forEach(function(t){e[t]=e[t].filter(function(e,t){return!r[t]})}),o},Zo=/*#__PURE__*/Object.freeze({default:Ho}),Qo=function(e,t){for(var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:qi.core.EPSILON,r=0;r<e.length;r+=1)if(ze(e[r]-t[r])>n)return!1;return!0},Jo=function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:qi.core.EPSILON,r=[t[0]-i[0],t[1]-i[1]],s=[t[0]-e[0],t[1]-e[1]],a=[i[0]-e[0],i[1]-e[1]],o=qe(r[0]*r[0]+r[1]*r[1]),d=qe(s[0]*s[0]+s[1]*s[1]),c=qe(a[0]*a[0]+a[1]*a[1]);return ze(o-d-c)<n},$o=function(e,t){return e[0]===t[0]&&e[1]===t[1]||e[0]===t[1]&&e[1]===t[0]},ed=function(e){var t=e.vertices_coords,i=e.edges_vertices,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:qi.core.EPSILON,r=i.map(function(e){return e.map(function(e){return t[e]})});return r.map(function(i){return t.filter(function(e){return Jo(e,i[0],i[1],n)})})},td=function(e){var t=e.vertices_coords,i=e.edges_vertices,n=i.map(function(e){return e.map(function(e){return t[e]})}),r=n.map(function(t){return[t[1][0]-t[0][0],t[1][1]-t[0][1]]}),s=r.map(function(t){return qe(t[0]*t[0]+t[1]*t[1])}),a=r.map(function(t,e){return[t[0]/s[e],t[1]/s[e]]});return a.map(function(t){return .707<ze(t[0])})},id=function(e){for(var t=e.vertices_coords,n=e.edges_vertices,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:qi.core.EPSILON,s=n.length,a=n.map(function(e){return e.map(function(e){return t[e]})}),o=Array.from(Array(s-1)).map(function(){return[]}),d=0;d<a.length-1;d+=1)for(var c=d+1;c<a.length;c+=1)o[d][c]=qi.core.intersection.edge_edge_exclusive(a[d][0],a[d][1],a[c][0],a[c][1],r);for(var l=Array.from(Array(s)).map(function(){return[]}),g=0;g<a.length-1;g+=1)for(var f=g+1;f<a.length;f+=1)null!=o[g][f]&&(l[g].push(o[g][f]),l[f].push(o[g][f]));return l},nd=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:qi.core.EPSILON,n=function(e,t){return e[0]-t[0]},r=function(e,t){return e[1]-t[1]},s=td(e),a=e.edges_vertices.map(function(t){return t.map(function(t){return e.vertices_coords[t]})});a.forEach(function(t,e){return t.sort(s[e]?n:r)});var o=id(e,t),d=ed(e,t),c=o.map(function(e,t){return e.concat(d[t])});c.forEach(function(t,e){return t.sort(s[e]?n:r)});var l=c.map(function(e){return Array.from(Array(e.length-1)).map(function(t,n){return[e[n],e[n+1]]})});l=l.map(function(e){return e.filter(function(n){return!1===n.map(function(e,r){return ze(n[0][r]-n[1][r])<t}).reduce(function(e,t){return e&&t},!0)})});for(var g=l.map(function(e,t){return e.map(function(){return t})}).reduce(function(e,t){return e.concat(t)},[]),f=l.map(function(e){return e.reduce(function(e,t){return e.concat(t)},[])}).reduce(function(e,t){return e.concat(t)},[]),p=0,_=l.map(function(e){return e.map(function(){return[p++,p++]})}).reduce(function(e,t){return e.concat(t)},[]),h=Array.from(Array(f.length)).map(function(){return[]}),u=0;u<f.length-1;u+=1)for(var m=u+1;m<f.length;m+=1)h[u][m]=Qo(f[u],f[m],t);var y=f.map(function(){});h.forEach(function(e,t){return e.forEach(function(e,i){e&&(y[i]=void 0===y[t]?t:y[t])})});var x=y.map(function(e){return void 0!==e});y.forEach(function(e,t){void 0===e&&(y[t]=t)}),_.forEach(function(e,t){return e.forEach(function(e,i){_[t][i]=y[e]})});for(var k=Array.from(Array(_.length)).map(function(){return[]}),b=0;b<_.length-1;b+=1)for(var w=b+1;w<_.length;w+=1)k[b][w]=$o(_[b],_[w]);var E=_.map(function(){});k.forEach(function(e,t){return e.forEach(function(e,i){e&&(E[t]=void 0===E[i]?i:E[i])})});var P=E.map(function(e){return void 0===e});E.forEach(function(e,t){void 0===e&&(E[t]=t)});var A=_.filter(function(e,t){return P[t]}),S=g.filter(function(e,t){return P[t]}),N={vertices_coords:f,edges_vertices:A};!0=="edges_assignment"in e&&(N.edges_assignment=S.map(function(t){return e.edges_assignment[t]})),!0=="edges_foldAngle"in e&&(N.edges_foldAngle=S.map(function(t){return e.edges_foldAngle[t]}));var L=x.map(function(e,t){return e?t:void 0}).filter(function(e){return void 0!==e});return Ho(N,"vertices",L),N},rd=function(e){!1=="vertices_coords"in e||!1=="edges_vertices"in e||(!1=="vertices_vertices"in e&&Ea.edges_vertices_to_vertices_vertices_sorted(e),!1=="faces_vertices"in e&&Ea.vertices_vertices_to_faces_vertices(e),!1=="faces_edges"in e&&Ea.faces_vertices_to_faces_edges(e),!1=="edges_faces"in e&&(e.edges_faces=tr(e)),!1=="vertices_faces"in e&&(e.vertices_faces=rr(e)),!1=="edges_length"in e&&(e.edges_length=ir(e)),!1=="edges_foldAngle"in e&&!0=="edges_assignment"in e&&(e.edges_foldAngle=e.edges_assignment.map(function(e){return es(e)})),!1=="edges_assignment"in e&&!0=="edges_foldAngle"in e&&(e.edges_assignment=e.edges_foldAngle.map(function(e){return 0===e?"F":0>e?"M":0<e?"V":"U"})),!1=="faces_faces"in e&&(e.faces_faces=er(e)),!1=="vertices_edges"in e&&(e.vertices_edges=$n(e)))},sd=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:qi.core.EPSILON;["vertices_vertices","vertices_edges","vertices_faces","edges_faces","edges_edges","faces_vertices","faces_edges","faces_faces"].filter(function(t){return t in e}).forEach(function(t){return delete e[t]});var i=nd(e,t);Ho(i,"edges",Pr(i)),Ea.edges_vertices_to_vertices_vertices_sorted(i),Ea.vertices_vertices_to_faces_vertices(i),Ea.faces_vertices_to_faces_edges(i),i.edges_faces=tr(i),i.vertices_faces=rr(i),Object.assign(e,i),os(e)||(e.edges_assignment=Array(e.edges_vertices.length).fill("F")),!1=="file_spec"in e&&(e.file_spec=1.1),!1=="frame_attributes"in e&&(e.frame_attributes=["2D"]),!1=="frame_classes"in e&&(e.frame_classes=["creasePattern"])},ad=/*#__PURE__*/Object.freeze({complete:rd,rebuild:sd}),od=/*#__PURE__*/Object.freeze({copy_without_marks:function(e){var t=e.edges_vertices.filter(function(t,n){return"F"!==e.edges_assignment[n]&&"f"!==e.edges_assignment[n]}),i=e.edges_assignment.filter(function(e){return"F"!==e&&"f"!==e}),n=Gr(e);Object.keys(n).filter(function(e){return"vertices_"===e.substring(0,9)}).forEach(function(e){return delete n[e]}),Object.keys(n).filter(function(e){return"edges_"===e.substring(0,6)}).forEach(function(e){return delete n[e]}),Object.keys(n).filter(function(e){return"faces_"===e.substring(0,6)}).forEach(function(e){return delete n[e]});var r=Object.assign(n,{vertices_coords:e.vertices_coords,edges_vertices:t,edges_assignment:i});return Ea.edges_vertices_to_vertices_vertices_sorted(r),Ea.vertices_vertices_to_faces_vertices(r),Ea.faces_vertices_to_faces_edges(r),r.edges_faces=tr(r),r.vertices_faces=rr(r),r},silence:5}),dd=function(e,t,i){if(void 0!==e.vertices_coords){var n=e.vertices_coords.length;return e.vertices_coords[n]=[t,i],n}},cd=function(t,i,e,r){if(!(t.edges_vertices.length<r)){var s=dd(t,i,e),a=t.edges_vertices[r];null==t.vertices_vertices&&(t.vertices_vertices=[]),t.vertices_vertices[s]=Gr(a),a.forEach(function(e,n,i){var r=i[(n+1)%i.length],a=t.vertices_vertices[e].indexOf(r);t.vertices_vertices[e][a]=s}),null!=t.edges_faces&&null!=t.edges_faces[r]&&(t.vertices_faces[s]=Gr(t.edges_faces[r]));var o=[{edges_vertices:[a[0],s]},{edges_vertices:[s,a[1]]}];o.forEach(function(n,e){n.i=t.edges_vertices.length+e}),["edges_faces","edges_assignment","edges_foldAngle"].filter(function(e){return null!=t[e]&&null!=t[e][r]}).forEach(function(e){o[0][e]=Gr(t[e][r]),o[1][e]=Gr(t[e][r])}),o.forEach(function(e,r){var i=e.edges_vertices.map(function(e){return t.vertices_coords[e]}),s;o[r].edges_length=(s=qi.core).distance2.apply(s,n(i))}),o.forEach(function(e){return Object.keys(e).filter(function(e){return"i"!==e}).filter(function(e){return void 0!==t[e]}).forEach(function(i){t[i][e.i]=e[i]})});var d=t.edges_faces[r],c=d.map(function(e){return t.faces_vertices[e]}),l=d.map(function(e){return t.faces_edges[e]});c.forEach(function(e){return e.map(function(e,t,i){var n=(t+1)%i.length;return e===a[0]&&i[n]===a[1]||e===a[1]&&i[n]===a[0]?n:void 0}).filter(function(e){return void 0!==e}).sort(function(e,t){return t-e}).forEach(function(t){return e.splice(t,0,s)})}),l.forEach(function(e){var i=e.indexOf(r),a=e[(i+e.length-1)%e.length],d=e[(i+1)%e.length],c=[[a,r],[r,d]].map(function(e){var i=e.map(function(i){return t.edges_vertices[i]});return i[0][0]===i[1][0]||i[0][0]===i[1][1]?i[0][0]:i[0][1]}).reduce(function(e,t){return e.concat(t)},[]),l=[[c[0],s],[s,c[1]]].map(function(e){var t=e.map(function(e){return-1!==o[0].edges_vertices.indexOf(e)}).reduce(function(e,t){return e&&t},!0),i=e.map(function(e){return-1!==o[1].edges_vertices.indexOf(e)}).reduce(function(e,t){return e&&t},!0);if(t)return o[0].i;if(i)return o[1].i;throw new Error("something wrong with input graph's faces_edges construction")});return i===e.length-1?(e.splice(i,1,l[0]),e.unshift(l[1])):e.splice.apply(e,[i,1].concat(n(l))),l});var g=Ho(t,"edges",[r]);return{vertices:{new:[{index:s}]},edges:{map:g,replace:[{old:r,new:o.map(function(e){return e.i})}]}}}},ld=function(e,t){for(var n=[],r=1;r<e.length;r++)e[r]!==e[r-1]&&n.push(r);for(var s=1;s<t.length;s++)if(t[s]!==t[s-1]);var a=t.slice();return n.forEach(function(e){return a.splice(e,0,0===e?0:a[e-1])}),e.map(function(e,t){return e+a[t]})},gd=function(t,r,s,o){var d=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"F",c=t.faces_vertices[r].map(function(e){return t.vertices_coords[e]}).map(function(e){return qi.core.point_on_line(s,o,e)?e:void 0}).map(function(e,n){return{point:e,i_face:n,i_vertices:t.faces_vertices[r][n]}}).filter(function(e){return void 0!==e.point}),l=t.faces_edges[r].map(function(e){return t.edges_vertices[e]}).map(function(e){return e.map(function(i){return t.vertices_coords[i]})}).map(function(e){return qi.core.intersection.line_edge_exclusive(s,o,e[0],e[1])}).map(function(e,n){return{point:e,i_face:n,i_edges:t.faces_edges[r][n]}}).filter(function(e){return void 0!==e.point}),g=[],f=Array(t.edges_vertices.length).fill(0),p;if(2===l.length)g=l.map(function(e,n,i){var r=cd(t,e.point[0],e.point[1],e.i_edges);return i.slice(n+1).filter(function(e){return null!=r.edges.map[e.i_edges]}).forEach(function(e){e.i_edges+=r.edges.map[e.i_edges]}),f=ld(f,r.edges.map),r.vertices["new"][0].index});else if(1===l.length&&1===c.length){var _=c.map(function(e){return e.i_vertices}),e=l.map(function(e,n,i){var r=cd(t,e.point[0],e.point[1],e.i_edges);return i.slice(n+1).filter(function(e){return null!=r.edges.map[e.i_edges]}).forEach(function(e){e.i_edges+=r.edges.map[e.i_edges]}),f=r.edges.map,r.vertices["new"][0].index});g=_.concat(e)}else if(2===c.length){g=c.map(function(e){return e.i_vertices});var i=t.faces_vertices[r],a=c,h=i[(a[0].i_face+1)%i.length]===a[1].i_vertices,u=i[(a[1].i_face+1)%i.length]===a[0].i_vertices;if(h||u)return{}}else return{};var m=g.map(function(e){return t.faces_vertices[r].indexOf(e)}).sort(function(e,t){return e-t}),v=[{},{}];v[0].vertices=t.faces_vertices[r].slice(m[1]).concat(t.faces_vertices[r].slice(0,m[0]+1)),v[1].vertices=t.faces_vertices[r].slice(m[0],m[1]+1),v[0].edges=t.faces_edges[r].slice(m[1]).concat(t.faces_edges[r].slice(0,m[0])).concat([t.edges_vertices.length]),v[1].edges=t.faces_edges[r].slice(m[0],m[1]).concat([t.edges_vertices.length]),v[0].index=t.faces_vertices.length,v[1].index=t.faces_vertices.length+1;var y=[{index:t.edges_vertices.length,vertices:n(g),assignment:d,foldAngle:es(d),length:(p=qi.core).distance2.apply(p,n(g.map(function(e){return t.vertices_coords[e]}))),faces:[t.faces_vertices.length,t.faces_vertices.length+1]}],x=t.edges_vertices.length,k=t.faces_vertices.length;v.forEach(function(e,n){return Object.keys(e).filter(function(e){return"index"!==e}).forEach(function(i){t["faces_".concat(i)][k+n]=e[i]})}),y.forEach(function(e,n){return Object.keys(e).filter(function(e){return"index"!==e}).filter(function(e){return void 0!==t["edges_".concat(e)]}).forEach(function(i){t["edges_".concat(i)][x+n]=e[i]})}),y.forEach(function(e){var i=e.vertices[0],n=e.vertices[1];t.vertices_vertices[i].push(n),t.vertices_vertices[n].push(i)});var b={};t.faces_vertices.map(function(e,t){return{face:e,i:t}}).filter(function(e){return e.i===k||e.i===k+1}).forEach(function(e){return e.face.forEach(function(t){null==b[t]&&(b[t]=[]),b[t].push(e.i)})}),t.vertices_faces.forEach(function(e,s){for(var i=e.indexOf(r);-1!==i;){var a;(a=t.vertices_faces[s]).splice.apply(a,[i,1].concat(n(b[s]))),i=e.indexOf(r)}});var w={};t.faces_edges.map(function(e,t){return{face:e,i:t}}).filter(function(e){return e.i===k||e.i===k+1}).forEach(function(t){return t.face.forEach(function(i){null==w[i]&&(w[i]=[]),w[i].push(t.i)})}),t.edges_faces.forEach(function(e,s){for(var i=e.indexOf(r);-1!==i;){var a;(a=t.edges_faces[s]).splice.apply(a,[i,1].concat(n(w[s]))),i=e.indexOf(r)}});var E=Ho(t,"faces",[r]);return{faces:{map:E,replace:[{old:r,new:v}]},edges:{new:y,map:f}}},fd=function(e,t){var i=e.map(function(e,n){return t[n]?n:void 0}).filter(function(e){return void 0!==e}),n=e.map(function(e,n){return t[n]?void 0:n}).filter(function(e){return void 0!==e}),r=i.slice().sort(function(t,i){return e[t]-e[i]}),s=n.slice().sort(function(t,i){return e[t]-e[i]}),a=[];s.forEach(function(e,t){a[e]=t});var o=s.length;return r.reverse().forEach(function(e,t){a[e]=o+t}),a},pd=function(e){return{type:"flip",direction:e}},_d=function(e,t,i,n){var r=[i[0]-e[0],i[1]-e[1]],s=t[0]*r[1]-t[1]*r[0];return n?0<s:0>s},hd=function(e,t){return e.faces_vertices[t].map(function(t){return e.vertices_coords[t]}).reduce(function(e,t){return[e[0]+t[0],e[1]+t[1]]},[0,0]).map(function(i){return i/e.faces_vertices[t].length})},ud=function(e,t,i,n){var r=ur(e);e["faces_re:preindex"]=Array.from(Array(r)).map(function(e,t){return t}),!1=="faces_re:matrix"in e&&(e["faces_re:matrix"]=or(e,n)),e["faces_re:coloring"]=gr(e["faces_re:matrix"]),e["faces_re:creases"]=e["faces_re:matrix"].map(function(e){return qi.core.make_matrix2_inverse(e)}).map(function(e){return qi.core.multiply_line_matrix2(t,i,e)}),e["faces_re:center"]=Array.from(Array(r)).map(function(t,n){return hd(e,n)}),e["faces_re:sidedness"]=Array.from(Array(r)).map(function(t,n){return _d(e["faces_re:creases"][n][0],e["faces_re:creases"][n][1],e["faces_re:center"][n],e["faces_re:coloring"][n])})},md=function(e){var t=ur(e);null==e["faces_re:layer"]&&(e["faces_re:layer"]=Array(t).fill(0))},vd=function(e){var t=[0,-Infinity],i=[1/0,0],n=[-Infinity,0],r=[0,1/0];e.forEach(function(e){e[0]<i[0]&&(i=e),e[0]>n[0]&&(n=e),e[1]<r[1]&&(r=e),e[1]>t[1]&&(t=e)});var s=ze(t[1]-r[1]),a=ze(n[0]-i[0]);return s>a?[r,t]:[i,n]},yd=function(e,t,i,n){var r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"V",s=r;if("M"===r||"m"===r?s="V":("V"===r||"v"===r)&&(s="M"),null==n){var a=yr(e,t);n=void 0===a?0:a}md(e),ud(e,t,i,n);var o=Gr(e),d=Array.from(Array(ur(e))).map(function(e,t){return t}).reverse().map(function(t){var i=gd(o,t,o["faces_re:creases"][t][0],o["faces_re:creases"][t][1],o["faces_re:coloring"][t]?r:s);if(null!=i&&null!=i.faces)return i.faces.replace.forEach(function(t){return t["new"].map(function(e){return e.index}).map(function(e){return e+i.faces.map[e]}).forEach(function(n){o["faces_re:center"][n]=hd(o,n),o["faces_re:sidedness"][n]=_d(e["faces_re:creases"][t.old][0],e["faces_re:creases"][t.old][1],o["faces_re:center"][n],e["faces_re:coloring"][t.old]),o["faces_re:layer"][n]=e["faces_re:layer"][t.old],o["faces_re:preindex"][n]=e["faces_re:preindex"][t.old]})}),{index:t,length:i.edges["new"][0].length,edge:i.edges["new"][0].vertices.map(function(e){return o.vertices_coords[e]})}}).reverse();o["faces_re:layer"]=fd(o["faces_re:layer"],o["faces_re:sidedness"]);var c=void 0===d[0]?0:o["faces_re:preindex"].map(function(e,t){return{pre:e,new:t}}).filter(function(e){return 0===e.pre}).filter(function(e){return o["faces_re:sidedness"][e["new"]]}).shift()["new"],l=e["faces_re:matrix"][0];("M"===r||"m"===r||"V"===r||"v"===r)&&(l=void 0!==d[0]||e["faces_re:sidedness"][0]?qi.core.multiply_matrices2(e["faces_re:matrix"][0],qi.core.make_matrix2_reflection(e["faces_re:creases"][0][1],e["faces_re:creases"][0][0])):e["faces_re:matrix"][0]);var g=or(o,c).map(function(e){return qi.core.multiply_matrices2(l,e)});o["faces_re:coloring"]=gr(g);var f=qi.core.multiply_line_matrix2(e["faces_re:creases"][0][0],e["faces_re:creases"][0][1],l),p=qi.core.normalize([f[1][1],-f[1][0]]),_=d.map(function(t,n){return void 0===t?void 0:t.edge.map(function(t){return qi.core.multiply_vector2_matrix2(t,e["faces_re:matrix"][n])})}).filter(function(e){return void 0!==e}).reduce(function(e,t){return e.concat(t)},[]);return o["re:construction"]=0===_.length?pd(p):{type:"fold",assignment:r,direction:p,edge:vd(_)},o["vertices_re:foldedCoords"]=cr(o,c,g),o["faces_re:matrix"]=g.map(function(e){return e.map(function(e){return qi.core.clean_number(e,14)})}),delete e["faces_re:creases"],delete o["faces_re:creases"],delete e["faces_re:sidedness"],delete o["faces_re:sidedness"],delete e["faces_re:preindex"],delete o["faces_re:preindex"],delete e["faces_re:coloring"],delete o["faces_re:coloring"],delete e["faces_re:center"],delete o["faces_re:center"],o},xd=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return[0,1].map(function(e){return t.filter(function(t,n){return n%2===e}).reduce(function(e,t){return e+t},0)})},kd=function(){return xd.apply(void 0,arguments).map(function(e){return 0>e?e+2*Ie:e}).map(function(e){return Ie-e}).map(function(e){return qi.core.clean_number(e,14)})},bd=function(e,t){return e.vertices_vertices[t].map(function(i){return[e.vertices_coords[i][0]-e.vertices_coords[t][0],e.vertices_coords[i][1]-e.vertices_coords[t][1]]})},wd=function(e,t){return bd(e,t).map(function(e,t,i){return qi.core.counter_clockwise_angle2(i[t],i[(t+1)%i.length])})},Ed=function(e,t){return kd.apply(void 0,n(wd(e,t)))},Pd=function(e){var t=lr(e),i=Array.from(Array(e.vertices_coords.length)).map(function(n,r){return t[r]?[0,0]:Ed(e,r)});return i},Ad=function(e){var t=Array.from(Array(e.vertices_coords.length)),i=Pd(e),n=e.vertices_vertices,r=t.map(function(t,n){return bd(e,n)}),s=t.map(function(){return[]});return i.forEach(function(e,t){0===e[0]||n[t].forEach(function(i,n){s[t][i]=[-r[t][n][1]*e[n%2],r[t][n][0]*e[n%2]]})}),s},Sd=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.map(function(e,t,i){return qi.core.counter_clockwise_angle2_radians(e,i[(t+1)%i.length])}).map(function(e,t,i){return i.slice(t+1,i.length).concat(i.slice(0,t))}).map(function(e){return kd.apply(void 0,n(e))}).map(function(e,n){return t[n]+e[0]}).map(function(e,n){return qi.core.is_counter_clockwise_between(e,t[n],t[(n+1)%t.length])?e:void 0})},Nd=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=t.map(function(e){return Te(e[1],e[0])});return Sd.apply(void 0,n(r)).map(function(e){return void 0===e?void 0:[qi.core.clean_number(De(e),14),qi.core.clean_number(Ve(e),14)]})},Ld=/*#__PURE__*/Object.freeze({alternating_sum:xd,kawasaki_flatness:kd,vertex_adjacent_vectors:bd,vertex_sectorAngles:wd,vertex_kawasaki_flatness:Ed,make_vertices_sectorAngles:function(e){return Array.from(Array(e.vertices_coords.length)).map(function(t,n){return wd(e,n)})},make_vertices_kawasaki_flatness:function(e){return Array.from(Array(e.vertices_coords.length)).map(function(t,n){return Ed(e,n)})},make_vertices_kawasaki:Pd,make_vertices_nudge_matrix:Ad,make_vertices_nudge:function(e){var t=Ad(e),n=t.map(function(e){return e.reduce(function(e,t){var i=0===t.length?0:qi.core.magnitude(t);return e>i?e:i},0)}),r=t.map(function(e,t){return e.map(function(e){return qi.core.magnitude(e)/n[t]})}),s=r.map(function(e){return e.map(function(e){return 1/e})}),a=t.map(function(e,t){return e.map(function(e,i){return e.map(function(e){return e*s[t][i]})})}),o=a.map(function(e){return e.reduce(function(e,t){return[e[0]+t[0],e[1]+t[1]]},[0,0])});return o},kawasaki_solutions_radians:Sd,kawasaki_solutions:Nd,kawasaki_collapse:Le}),jd=JSON.parse("{\n  \"ar\": [null,\n    \"\u0627\u0635\u0646\u0639 \u062E\u0637\u0627\u064B \u064A\u0645\u0631 \u0628\u0646\u0642\u0637\u062A\u064A\u0646\",\n    \"\u0627\u0635\u0646\u0639 \u062E\u0637\u0627\u064B \u0639\u0646 \u0637\u0631\u064A\u0642 \u0637\u064A \u0646\u0642\u0637\u0629 \u0648\u0627\u062D\u062F\u0629 \u0625\u0644\u0649 \u0623\u062E\u0631\u0649\",\n    \"\u0627\u0635\u0646\u0639 \u062E\u0637\u0627\u064B \u0639\u0646 \u0637\u0631\u064A\u0642 \u0637\u064A \u062E\u0637 \u0648\u0627\u062D\u062F \u0639\u0644\u0649 \u0622\u062E\u0631\",\n    \"\u0627\u0635\u0646\u0639 \u062E\u0637\u0627\u064B \u064A\u0645\u0631 \u0639\u0628\u0631 \u0646\u0642\u0637\u0629 \u0648\u0627\u062D\u062F\u0629 \u0648\u064A\u062C\u0639\u0644 \u062E\u0637\u0627\u064B \u0648\u0627\u062D\u062F\u0627\u064B \u0641\u0648\u0642 \u0646\u0641\u0633\u0647\",\n    \"\u0627\u0635\u0646\u0639 \u062E\u0637\u0627\u064B \u064A\u0645\u0631 \u0628\u0627\u0644\u0646\u0642\u0637\u0629 \u0627\u0644\u0623\u0648\u0644\u0649 \u0648\u064A\u062C\u0639\u0644 \u0627\u0644\u0646\u0642\u0637\u0629 \u0627\u0644\u062B\u0627\u0646\u064A\u0629 \u0639\u0644\u0649 \u0627\u0644\u062E\u0637\",\n    \"\u0627\u0635\u0646\u0639 \u062E\u0637\u0627\u064B \u064A\u062C\u0644\u0628 \u0627\u0644\u0646\u0642\u0637\u0629 \u0627\u0644\u0623\u0648\u0644\u0649 \u0625\u0644\u0649 \u0627\u0644\u062E\u0637 \u0627\u0644\u0623\u0648\u0644 \u0648\u0627\u0644\u0646\u0642\u0637\u0629 \u0627\u0644\u062B\u0627\u0646\u064A\u0629 \u0625\u0644\u0649 \u0627\u0644\u062E\u0637 \u0627\u0644\u062B\u0627\u0646\u064A\",\n    \"\u0627\u0635\u0646\u0639 \u062E\u0637\u0627\u064B \u064A\u062C\u0644\u0628 \u0646\u0642\u0637\u0629 \u0625\u0644\u0649 \u062E\u0637 \u0648\u064A\u062C\u0639\u0644 \u062E\u0637 \u062B\u0627\u0646\u064A \u0641\u0648\u0642 \u0646\u0641\u0633\u0647\"\n  ],\n  \"de\": [null,\n    \"Falte eine Linie durch zwei Punkte\",\n    \"Falte zwei Punkte aufeinander\",\n    \"Falte zwei Linien aufeinander\",\n    \"Falte eine Linie auf sich selbst, falte dabei durch einen Punkt\",\n    \"Falte einen Punkt auf eine Linie, falte dabei durch einen anderen Punkt\",\n    \"Falte einen Punkt auf eine Linie und einen weiteren Punkt auf eine weitere Linie\",\n    \"Falte einen Punkt auf eine Linie und eine weitere Linie in sich selbst zusammen\"\n  ],\n  \"en\": [null,\n    \"fold a line through two points\",\n    \"fold two points together\",\n    \"fold two lines together\",\n    \"fold a line on top of itself, creasing through a point\",\n    \"fold a point to a line, creasing through another point\",\n    \"fold a point to a line and another point to another line\",\n    \"fold a point to a line and another line onto itself\"\n  ],\n  \"es\": [null,\n    \"dobla una l\xEDnea entre dos puntos\",\n    \"dobla dos puntos juntos\",\n    \"dobla y une dos l\xEDneas\",\n    \"dobla una l\xEDnea sobre s\xED misma, dobl\xE1ndola hacia un punto\",\n    \"dobla un punto hasta una l\xEDnea, dobl\xE1ndola a trav\xE9s de otro punto\",\n    \"dobla un punto hacia una l\xEDnea y otro punto hacia otra l\xEDnea\",\n    \"dobla un punto hacia una l\xEDnea y otra l\xEDnea sobre s\xED misma\"\n  ],\n  \"fr\":[null,\n    \"cr\xE9ez un pli passant par deux points\",\n    \"pliez pour superposer deux points\",\n    \"pliez pour superposer deux lignes\",\n    \"rabattez une ligne sur elle-m\xEAme \xE0 l'aide d'un pli qui passe par un point\",\n    \"rabattez un point sur une ligne \xE0 l'aide d'un pli qui passe par un autre point\",\n    \"rabattez un point sur une ligne et un autre point sur une autre ligne\",\n    \"rabattez un point sur une ligne et une autre ligne sur elle-m\xEAme\"\n  ],\n  \"hi\": [null,\n    \"\u090F\u0915 \u0915\u094D\u0930\u0940\u091C\u093C \u092C\u0928\u093E\u090F\u0901 \u091C\u094B \u0926\u094B \u0938\u094D\u0925\u093E\u0928\u094B\u0902 \u0938\u0947 \u0917\u0941\u091C\u0930\u0924\u093E \u0939\u0948\",\n    \"\u090F\u0915 \u0938\u094D\u0925\u093E\u0928 \u0915\u094B \u0926\u0942\u0938\u0930\u0947 \u0938\u094D\u0925\u093E\u0928 \u092A\u0930 \u092E\u094B\u0921\u093C\u0915\u0930 \u090F\u0915 \u0915\u094D\u0930\u0940\u091C\u093C \u092C\u0928\u093E\u090F\u0901\",\n    \"\u090F\u0915 \u0930\u0947\u0916\u093E \u092A\u0930 \u0926\u0942\u0938\u0930\u0940 \u0930\u0947\u0916\u093E \u0915\u094B \u092E\u094B\u0921\u093C\u0915\u0930 \u0915\u094D\u0930\u0940\u091C\u093C \u092C\u0928\u093E\u090F\u0901\",\n    \"\u090F\u0915 \u0915\u094D\u0930\u0940\u091C\u093C \u092C\u0928\u093E\u090F\u0901 \u091C\u094B \u090F\u0915 \u0938\u094D\u0925\u093E\u0928 \u0938\u0947 \u0917\u0941\u091C\u0930\u0924\u093E \u0939\u0948 \u0914\u0930 \u090F\u0915 \u0930\u0947\u0916\u093E \u0915\u094B \u0938\u094D\u0935\u092F\u0902 \u0915\u0947 \u090A\u092A\u0930 \u0932\u0947 \u0906\u0924\u093E \u0939\u0948\",\n    \"\u090F\u0915 \u0915\u094D\u0930\u0940\u091C\u093C \u092C\u0928\u093E\u090F\u0901 \u091C\u094B \u092A\u0939\u0932\u0947 \u0938\u094D\u0925\u093E\u0928 \u0938\u0947 \u0917\u0941\u091C\u0930\u0924\u093E \u0939\u0948 \u0914\u0930 \u0926\u0942\u0938\u0930\u0947 \u0938\u094D\u0925\u093E\u0928 \u0915\u094B \u0930\u0947\u0916\u093E \u092A\u0930 \u0932\u0947 \u0906\u0924\u093E \u0939\u0948\",\n    \"\u090F\u0915 \u0915\u094D\u0930\u0940\u091C\u093C \u092C\u0928\u093E\u090F\u0901 \u091C\u094B \u092A\u0939\u0932\u0947 \u0938\u094D\u0925\u093E\u0928 \u0915\u094B \u092A\u0939\u0932\u0940 \u0930\u0947\u0916\u093E \u092A\u0930 \u0914\u0930 \u0926\u0942\u0938\u0930\u0947 \u0938\u094D\u0925\u093E\u0928 \u0915\u094B \u0926\u0942\u0938\u0930\u0940 \u0930\u0947\u0916\u093E \u092A\u0930 \u0932\u0947 \u0906\u0924\u093E \u0939\u0948\",\n    \"\u090F\u0915 \u0915\u094D\u0930\u0940\u091C\u093C \u092C\u0928\u093E\u090F\u0901 \u091C\u094B \u090F\u0915 \u0938\u094D\u0925\u093E\u0928 \u0915\u094B \u090F\u0915 \u0930\u0947\u0916\u093E \u092A\u0930 \u0932\u0947 \u0906\u0924\u093E \u0939\u0948 \u0914\u0930 \u0926\u0942\u0938\u0930\u0940 \u0930\u0947\u0916\u093E \u0915\u094B \u0938\u094D\u0935\u092F\u0902 \u0915\u0947 \u090A\u092A\u0930 \u0932\u0947 \u0906\u0924\u093E \u0939\u0948\"\n  ],\n  \"jp\": [null,\n    \"2\u70B9\u306B\u6CBF\u3063\u3066\u6298\u308A\u76EE\u3092\u4ED8\u3051\u307E\u3059\",\n    \"2\u70B9\u3092\u5408\u308F\u305B\u3066\u6298\u308A\u307E\u3059\",\n    \"2\u3064\u306E\u7DDA\u3092\u5408\u308F\u305B\u3066\u6298\u308A\u307E\u3059\",\n    \"\u70B9\u3092\u901A\u904E\u3055\u305B\u3001\u65E2\u306B\u3042\u308B\u7DDA\u306B\u6CBF\u3063\u3066\u6298\u308A\u307E\u3059\",\n    \"\u70B9\u3092\u7DDA\u6CBF\u3044\u306B\u5408\u308F\u305B\u5225\u306E\u70B9\u3092\u901A\u904E\u3055\u305B\u6298\u308A\u307E\u3059\",\n    \"\u7DDA\u306B\u5411\u304B\u3063\u3066\u70B9\u3092\u6298\u308A\u3001\u540C\u6642\u306B\u3082\u3046\u4E00\u65B9\u306E\u7DDA\u306B\u5411\u304B\u3063\u3066\u3082\u3046\u4E00\u65B9\u306E\u70B9\u3092\u6298\u308A\u307E\u3059\",\n    \"\u7DDA\u306B\u5411\u304B\u3063\u3066\u70B9\u3092\u6298\u308A\u3001\u540C\u6642\u306B\u5225\u306E\u7DDA\u3092\u305D\u306E\u4E0A\u306B\u6298\u308A\u307E\u3059\"\n  ],\n  \"ko\": [null,\n    \"\uB450 \uC810\uC744 \uD1B5\uACFC\uD558\uB294 \uC120\uC73C\uB85C \uC811\uC73C\uC138\uC694\",\n    \"\uB450 \uC810\uC744 \uD568\uAED8 \uC811\uC73C\uC138\uC694\",\n    \"\uB450 \uC120\uC744 \uD568\uAED8 \uC811\uC73C\uC138\uC694\",\n    \"\uADF8 \uC704\uC5D0 \uC120\uC744 \uC811\uC73C\uBA74\uC11C \uC810\uC744 \uD1B5\uACFC\uD558\uAC8C \uC811\uC73C\uC138\uC694\",\n    \"\uC810\uC744 \uC120\uC73C\uB85C \uC811\uC73C\uBA74\uC11C, \uB2E4\uB978 \uC810\uC744 \uC9C0\uB098\uAC8C \uC811\uC73C\uC138\uC694\",\n    \"\uC810\uC744 \uC120\uC73C\uB85C \uC811\uACE0 \uB2E4\uB978 \uC810\uC744 \uB2E4\uB978 \uC120\uC73C\uB85C \uC811\uC73C\uC138\uC694\",\n    \"\uC810\uC744 \uC120\uC73C\uB85C \uC811\uACE0 \uB2E4\uB978 \uC120\uC744 \uADF8 \uC704\uC5D0 \uC811\uC73C\uC138\uC694\"\n  ],\n  \"ms\": [null,\n    \"lipat garisan melalui dua titik\",\n    \"lipat dua titik bersama\",\n    \"lipat dua garisan bersama\",\n    \"lipat satu garisan di atasnya sendiri, melipat melalui satu titik\",\n    \"lipat satu titik ke garisan, melipat melalui titik lain\",\n    \"lipat satu titik ke garisan dan satu lagi titik ke garisan lain\",\n    \"lipat satu titik ke garisan dan satu lagi garisan di atasnya sendiri\"\n  ],\n  \"pt\": [null,\n    \"dobre uma linha entre dois pontos\",\n    \"dobre os dois pontos para uni-los\",\n    \"dobre as duas linhas para uni-las\",\n    \"dobre uma linha sobre si mesma, criando uma dobra ao longo de um ponto\",\n    \"dobre um ponto at\xE9 uma linha, criando uma dobra ao longo de outro ponto\",\n    \"dobre um ponto at\xE9 uma linha e outro ponto at\xE9 outra linha\",\n    \"dobre um ponto at\xE9 uma linha e outra linha sobre si mesma\"\n  ],\n  \"ru\": [null,\n    \"\u0441\u043B\u043E\u0436\u0438\u0442\u0435 \u043B\u0438\u043D\u0438\u044E \u0447\u0435\u0440\u0435\u0437 \u0434\u0432\u0435 \u0442\u043E\u0447\u043A\u0438\",\n    \"\u0441\u043B\u043E\u0436\u0438\u0442\u0435 \u0434\u0432\u0435 \u0442\u043E\u0447\u043A\u0438 \u0432\u043C\u0435\u0441\u0442\u0435\",\n    \"\u0441\u043B\u043E\u0436\u0438\u0442\u0435 \u0434\u0432\u0435 \u043B\u0438\u043D\u0438\u0438 \u0432\u043C\u0435\u0441\u0442\u0435\",\n    \"\u0441\u0432\u0435\u0440\u043D\u0438\u0442\u0435 \u043B\u0438\u043D\u0438\u044E \u0441\u0432\u0435\u0440\u0445\u0443 \u0441\u0435\u0431\u044F, \u0441\u0433\u0438\u0431\u0430\u044F \u0447\u0435\u0440\u0435\u0437 \u0442\u043E\u0447\u043A\u0443\",\n    \"\u0441\u043B\u043E\u0436\u0438\u0442\u0435 \u0442\u043E\u0447\u043A\u0443 \u0432 \u043B\u0438\u043D\u0438\u044E, \u0441\u0433\u0438\u0431\u0430\u044F \u0447\u0435\u0440\u0435\u0437 \u0434\u0440\u0443\u0433\u0443\u044E \u0442\u043E\u0447\u043A\u0443\",\n    \"\u0441\u043B\u043E\u0436\u0438\u0442\u0435 \u0442\u043E\u0447\u043A\u0443 \u0432 \u043B\u0438\u043D\u0438\u044E \u0438 \u0434\u0440\u0443\u0433\u0443\u044E \u0442\u043E\u0447\u043A\u0443 \u0432 \u0434\u0440\u0443\u0433\u0443\u044E \u043B\u0438\u043D\u0438\u044E\",\n    \"\u0441\u043B\u043E\u0436\u0438\u0442\u0435 \u0442\u043E\u0447\u043A\u0443 \u0432 \u043B\u0438\u043D\u0438\u044E \u0438 \u0434\u0440\u0443\u0433\u0443\u044E \u043B\u0438\u043D\u0438\u044E \u043D\u0430 \u0441\u0435\u0431\u044F\"\n  ],\n  \"tr\": [null,\n    \"iki noktadan ge\xE7en bir \xE7izgi boyunca katla\",\n    \"iki noktay\u0131 birbirine katla\",\n    \"iki \xE7izgiyi birbirine katla\",\n    \"bir noktadan k\u0131v\u0131rarak kendi \xFCzerindeki bir \xE7izgi boyunca katla\",\n    \"ba\u015Fka bir noktadan k\u0131v\u0131rarak bir noktay\u0131 bir \xE7izgiye katla\",\n    \"bir noktay\u0131 bir \xE7izgiye ve ba\u015Fka bir noktay\u0131 ba\u015Fka bir \xE7izgiye katla\",\n    \"bir noktay\u0131 bir \xE7izgiye ve ba\u015Fka bir \xE7izgiyi kendi \xFCzerine katla\"\n  ],\n  \"vi\": [null,\n    \"t\u1EA1o m\u1ED9t n\u1EBFp g\u1EA5p \u0111i qua hai \u0111i\u1EC3m\",\n    \"t\u1EA1o n\u1EBFp g\u1EA5p b\u1EB1ng c\xE1ch g\u1EA5p m\u1ED9t \u0111i\u1EC3m n\xE0y sang \u0111i\u1EC3m kh\xE1c\",\n    \"t\u1EA1o n\u1EBFp g\u1EA5p b\u1EB1ng c\xE1ch g\u1EA5p m\u1ED9t \u0111\u01B0\u1EDDng l\xEAn m\u1ED9t \u0111\u01B0\u1EDDng kh\xE1c\",\n    \"t\u1EA1o m\u1ED9t n\u1EBFp g\u1EA5p \u0111i qua m\u1ED9t \u0111i\u1EC3m v\xE0 \u0111\u01B0a m\u1ED9t \u0111\u01B0\u1EDDng l\xEAn tr\xEAn ch\xEDnh n\xF3\",\n    \"t\u1EA1o m\u1ED9t n\u1EBFp g\u1EA5p \u0111i qua \u0111i\u1EC3m \u0111\u1EA7u ti\xEAn v\xE0 \u0111\u01B0a \u0111i\u1EC3m th\u1EE9 hai l\xEAn \u0111\u01B0\u1EDDng th\u1EB3ng\",\n    \"t\u1EA1o m\u1ED9t n\u1EBFp g\u1EA5p mang \u0111i\u1EC3m \u0111\u1EA7u ti\xEAn \u0111\u1EBFn \u0111\u01B0\u1EDDng \u0111\u1EA7u ti\xEAn v\xE0 \u0111i\u1EC3m th\u1EE9 hai cho \u0111\u01B0\u1EDDng th\u1EE9 hai\",\n    \"t\u1EA1o m\u1ED9t n\u1EBFp g\u1EA5p mang l\u1EA1i m\u1ED9t \u0111i\u1EC3m cho m\u1ED9t \u0111\u01B0\u1EDDng v\xE0 \u0111\u01B0a m\u1ED9t \u0111\u01B0\u1EDDng th\u1EE9 hai l\xEAn tr\xEAn ch\xEDnh n\xF3\"\n  ],\n  \"zh\": [null,\n    \"\u901A\u904E\u5169\u9EDE\u6298\u4E00\u689D\u7DDA\",\n    \"\u5C07\u5169\u9EDE\u6298\u758A\u8D77\u4F86\",\n    \"\u5C07\u5169\u689D\u7DDA\u6298\u758A\u5728\u4E00\u8D77\",\n    \"\u901A\u904E\u4E00\u500B\u9EDE\u6298\u758A\u4E00\u689D\u7DDA\u5728\u81EA\u8EAB\u4E0A\u9762\",\n    \"\u5C07\u4E00\u500B\u9EDE\uFF0C\u901A\u904E\u53E6\u4E00\u500B\u9EDE\u6298\u758A\u6210\u4E00\u689D\u7DDA\uFF0C\",\n    \"\u5C07\u4E00\u500B\u9EDE\u6298\u758A\u70BA\u4E00\u689D\u7DDA\uFF0C\u518D\u5C07\u53E6\u4E00\u500B\u9EDE\u6298\u758A\u5230\u53E6\u4E00\u689D\u7DDA\",\n    \"\u5C07\u4E00\u500B\u9EDE\u6298\u758A\u6210\u4E00\u689D\u7DDA\uFF0C\u53E6\u4E00\u689D\u7DDA\u6298\u758A\u5230\u5B83\u81EA\u8EAB\u4E0A\"\n  ]\n}\n"),Md=function(e){if(!(isNaN(e)||null==e||1>e||7<e)){var t={};return Object.keys(jd).forEach(function(i){t[i]=jd[i][e]}),t}},Cd=function(e){var t=e.axiom||0;return!isNaN(t)&&null!=t&&0<t&&8>t?Md(t):"assignment"in e?{en:"".concat(Qr.en[e.assignment]," fold")}:{en:""}},Od=function(e,t){var i=e.axiom||0,n=e.edge,r=e.direction,s=e;if(2===i)return[s.parameters.points[1],s.parameters.points[0]];if(7===i)return[s.parameters.points[0],s.test.points_reflected[0]];var a=[n[1][0]-n[0][0],n[1][1]-n[0][1]],o;o=4===i?qi.core.nearest_point_on_line(n[0],a,s.parameters.lines[0][0],function(e){return e}):7===i?qi.core.nearest_point_on_line(n[0],a,s.parameters.points[0],function(e){return e}):qi.core.average(n[0],n[1]);var d=wr(t).vertices.map(function(e){return t.vertices_coords[e]}),c=qi.core.intersection.convex_poly_line(d,o,r);if(void 0===c)return[];var l=[c[0],c[1]].map(function(e){return qi.core.distance2(e,o)}).sort(function(e,t){return e-t}).shift();7===i&&(l=qi.core.distance2(e.parameters.points[0],o));var g=r.map(function(e){return e*l});return[o.map(function(e,t){return e-g[t]}),o.map(function(e,t){return e+g[t]})]},Bd=function(e,t){var n={vertices:_r(e),edges:hr(e),faces:ur(e)};return t["new"]&&Object.keys(t["new"]).forEach(function(r){return t["new"][r].forEach(function(t,s){return Object.keys(t).forEach(function(i){e[i][n[r]+s]=t[i]})})}),t.update&&Object.keys(t.update).forEach(function(n){return Object.keys(t.update[n]).forEach(function(i){e[i][n]=t.update[n][i]})}),t.remove&&(t.remove.faces&&Ho(e,"faces",t.remove.faces),t.remove.edges&&Ho(e,"edges",t.remove.edges),t.remove.vertices&&Ho(e,"vertices",t.remove.vertices)),t},Fd=function(e,t,i){var n="".concat(t,"_"),r=Object.keys(e).map(function(e){return e.substring(0,n.length)===n?e:void 0}).filter(function(e){return void 0!==e}),s={};return r.forEach(function(t){s[t]=e[t][i]}),s},Id=function(e,t,i,n,r){var s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"U",a=qi.segment(t,i,n,r),o=_r(e),d=e.edges_vertices.map(function(t){return t.map(function(t){return e.vertices_coords[t]})}),c=[0,1].map(function(t){return e.vertices_coords.map(function(e){return qe(Re(a[t][0]-e[0],2)+Re(a[t][1]-e[1],2))}).map(function(e,t){return e<qi.core.EPSILON?t:void 0}).filter(function(e){return void 0!==e}).shift()}),l=[0,1].map(function(t){return d.map(function(i){return qi.core.point_on_edge(i[0],i[1],a[t])}).map(function(e,t){return e?t:void 0}).filter(function(t){return void 0!==t}).shift()}),g=[0,1].map(function(e){return void 0===c[e]?void 0===l[e]?"new":"edge":"vertex"}),f={new:{vertices:[],edges:[{edges_vertices:[]}]},remove:{edges:[]}};return[0,1].forEach(function(t){switch(g[t]){case"vertex":f["new"].edges[0].edges_vertices[t]=c[t];break;case"edge":f["new"].vertices.push({vertices_coords:[a[t][0],a[t][1]]}),o+=1,f["new"].edges[0].edges_vertices[t]=o-1;var i=Fd(e,"edges",l[t]),n=[{edges_vertices:[e.edges_vertices[l[t]][0],o-1]},{edges_vertices:[e.edges_vertices[l[t]][1],o-1]}];f["new"].edges.push(Object.assign(Object.assign({},i),n[0]),Object.assign(Object.assign({},i),n[1])),f.remove.edges.push(l[t]);break;default:f["new"].vertices.push({vertices_coords:[a[t][0],a[t][1]]}),o+=1,f["new"].edges[0].edges_vertices[t]=o-1;}}),f["new"].edges.filter(function(t){return void 0===t.edges_assignment}).forEach(function(t){t.edges_assignment=s}),f.apply=function(){return Bd(e,f)},f},zd=function(e,t){for(var i=arguments.length,n=Array(2<i?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];var s=Object.keys(e).map(function(e){return"edges_"===e.substring(0,6)?e:void 0}).filter(function(e){return void 0!==e}),a=Array.from(Array(n.length)).map(function(){return{}});return n.forEach(function(n,r){return s.filter(function(i){return void 0!==e[i][t]}).forEach(function(i){a[r][i]=e[i][t]})}),n.forEach(function(e,t){return Object.keys(e).forEach(function(e){a[t][e]=n[t][e]})}),a},Vd=function(e,t,r){var s=[];t.forEach(function(e){s[e]={}});var a=[1,0].map(function(e){return t[e]});t.forEach(function(t,r){s[t].vertices_vertices=void 0===e.vertices_vertices[t]?[a[r]]:n(e.vertices_vertices[t])});var o=t.map(function(e,t){return s[e].vertices_vertices.indexOf(a[t])});return t.forEach(function(e,t){s[e].vertices_vertices[o[t]]=r}),s},Dd=function(e,t,n){for(var r=e.length,s=e.map(function(e,n,i){return e===t[0]&&i[(n+1)%r]===t[1]||e===t[1]&&i[(n+1)%r]===t[0]?(n+1)%r:void 0}).filter(function(e){return void 0!==e}),a=[],o=0,d=0;d<r+s.length;d+=1)s.includes(d)?(o-=1,a[d]=n):a[d]=e[d+o];return a},Td=function(t){for(var i=arguments.length,n=Array(1<i?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];var s=n.map(function(i){return t.edges_vertices[i]});return s[0][0]===s[1][0]||s[0][0]===s[1][1]?s[0][0]:s[0][1]},qd=function(e,t,i,n,r,s,a){var o=t.length,d=t.indexOf(i),c=[t[(d+o-1)%o],i,t[(d+1)%o]],l=[0,1].map(function(t){return Td(e,c[t],c[t+1])}),g=a[0]===l[0]||a[1]===l[0]?[r,s]:[s,r],f=t.slice();return d===o-1?(f.splice(d,1,g[0]),f.unshift(g[1])):f.splice.apply(f,[d,1].concat(g)),f},Rd=1.1,Xd="Rabbit Ear",Wd=function(){var e=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0];return e?{file_spec:Rd,file_creator:Xd,file_author:"",file_title:"",file_description:"",file_classes:[],file_frames:[],frame_description:"",frame_attributes:[],frame_classes:[],frame_unit:""}:{file_spec:Rd,file_creator:Xd}},Gd=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return{"faces_re:layer":Array.from(Array(e)).map(function(e,t){return t}),"faces_re:matrix":Array.from(Array(e)).map(function(){return[1,0,0,1,0,0]})}},Yd=function(){return{file_classes:["singleModel"],frame_attributes:["2D"],frame_classes:["creasePattern"]}},Ud=function(){return{vertices_coords:[[0,0],[1,0],[1,1],[0,1]],vertices_vertices:[[1,3],[2,0],[3,1],[0,2]],vertices_faces:[[0],[0],[0],[0]],edges_vertices:[[0,1],[1,2],[2,3],[3,0]],edges_faces:[[0],[0],[0],[0]],edges_assignment:["B","B","B","B"],edges_foldAngle:[0,0,0,0],edges_length:[1,1,1,1],faces_vertices:[[0,1,2,3]],faces_edges:[[0,1,2,3]]}},Kd=function(){return Object.assign(Object.create(null),Wd())},Hd=function(){return Object.assign(Object.create(null),Wd(),Yd(),Ud(),Gd(1))},Zd=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=Ud();return i.vertices_coords=[[0,0],[e,0],[e,t],[0,t]],i.edges_length=[e,t,e,t],Object.assign(Object.create(null),Wd(),Yd(),i,Gd(1))},Qd=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=Array.from(Array(e)),r=2*Ie/e,s=qi.core.clean_number(qe(Re(t-t*De(r),2)+Re(t*Ve(r),2))),a={vertices_coords:n.map(function(e,t){return r*t}).map(function(e){return[qi.core.clean_number(t*De(e)),qi.core.clean_number(t*Ve(e))]}),vertices_vertices:n.map(function(e,t){return[(t+1)%n.length,(t+n.length-1)%n.length]}),vertices_faces:n.map(function(){return[0]}),edges_vertices:n.map(function(e,t){return[t,(t+1)%n.length]}),edges_faces:n.map(function(){return[0]}),edges_assignment:n.map(function(){return"B"}),edges_foldAngle:n.map(function(){return 0}),edges_length:n.map(function(){return s}),faces_vertices:[n.map(function(e,t){return t})],faces_edges:[n.map(function(e,t){return t})]};return Object.assign(Object.create(null),Wd(),Yd(),a,Gd(1))},Jd=function(e,t){return{axiom:1,parameters:{points:[e,t]},solutions:[[[.5,.625],[.6,-.8]],[[.25,.25],[.4,-1]],[[.15,.5],[.2,-.8]]]}},$d=function(){return{axiom1:Jd}},ec=function(e){var t=ur(e);if(0<t&&(null==e["faces_re:matrix"]?e["faces_re:matrix"]=or(e):e["faces_re:matrix"].length!==t&&(e["faces_re:matrix"]=or(e)),null==e["faces_re:layer:"]));},tc=function(e){var t=e.edges_assignment.map(function(e){return"b"!==e&&"B"!==e}).map(function(e,t){return e?t:void 0}).filter(function(e){return void 0!==e}),i=Ho(e,"edges",t),n=wr(e);e.faces_edges=[n.edges],e.faces_vertices=[n.vertices],Ho(e,"vertices",Er(e))},ic=function(e,t){is("coords").forEach(function(i){e[i]=e[i].map(function(e){return qi.core.multiply_vector2_matrix2(e,t)})}),is("matrix").forEach(function(i){e[i]=e[i].map(function(e){return qi.core.multiply_matrices2(e,t)})})},nc=function(e,t,i){var n=qi.core.make_matrix2_scale(t,i);ic(e,n)},rc=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.filter(function(e){return"string"==typeof e}).filter(function(e){return 1===e.length}).shift()},sc={rebuild:!0,change:!0},ac=function(t){if("object"!==e(t)||null===t)return!1;for(var n=Object.keys(t),r=Object.keys(sc),s=0;s<n.length;s+=1)if(r.includes(n[s]))return!0;return!1},oc=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=i.filter(function(t){return"object"===e(t)}).filter(function(e){return ac(e)}).shift();return void 0===r?Gr(sc):Object.assign(Gr(sc),r)},dc=function(e){var t=this,i=function(i){for(var r=arguments.length,s=Array(1<r?r-1:0),a=1,o,d,c,g;a<r;a++)s[a-1]=arguments[a];"edge"===i?c=(o=qi.core).get_vector_of_vectors.apply(o,s):(g=(d=qi.core).get_line.apply(d,s),c=[g.point,g.vector]);var f={line:qi.core.intersection.convex_poly_line,ray:qi.core.intersection.convex_poly_ray,edge:qi.core.intersection.convex_poly_edge};return e.map(function(e){return e.vertices.map(function(e){return t.vertices_coords[e]})}).map(function(e){return f[i].apply(f,[e].concat(n(c)))}).filter(function(e){return void 0!==e})};return e.clipLine=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.apply(void 0,["line"].concat(t))},e.clipRay=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.apply(void 0,["ray"].concat(t))},e.clipEdge=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return i.apply(void 0,["edge"].concat(t))},e},cc=function t(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};i.copy=function(){return Object.assign(Object.create(t()),Gr(this))};var n=function(){if(!1!="frame_classes"in this){var e=this.frame_classes.indexOf("creasePattern"),t=this.frame_classes.indexOf("foldedForm");return-1===e&&-1===t||-1!==e&&-1!==t?void 0:-1!==t}};i.rebuild=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:qi.core.EPSILON;sd(this,e)},i.complete=function(){rd(this)},i.fragment=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:qi.core.EPSILON;nd(this,e)};var r=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:qi.core.EPSILON,t="vertices_coords"in this&&"vertices_vertices"in this&&"edges_vertices"in this&&"edges_assignment"in this&&"faces_vertices"in this&&"faces_edges"in this;t||(console.log("load() crease pattern missing geometry arrays. rebuilding. geometry indices will change"),ec(this))};i.load=function(e,t){var i=this;(null==t||!0!==t)&&Zr.forEach(function(e){return delete i[e]}),Object.assign(this,Gr(e)),r.call(this),this.didChange.forEach(function(e){return e()})},i.clear=function(){tc(this),this.didChange.forEach(function(e){return e()})},i.nearestVertex=function(){var e=mr(this,(i=qi.core).get_vector.apply(i,arguments)),t=rs(this,"vertices",e),i;return t.index=e,t},i.nearestEdge=function(){var e=vr(this,(i=qi.core).get_vector.apply(i,arguments)),t=rs(this,"edges",e),i;return t.index=e,t},i.nearestFace=function(){var e=yr(this,(t=qi.core).get_vector.apply(t,arguments)),t;if(void 0!==e){var i=rs(this,"faces",e);return i.index=e,i}},i.nearest=function(){var e=(i=qi.core).get_vector.apply(i,arguments),t={vertex:this.nearestVertex(this,e),edge:this.nearestEdge(this,e),face:this.nearestFace(this,e)},i;return Object.keys(t).filter(function(e){return null==t[e]}).forEach(function(e){return delete t[e]}),t},i.scale=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];nc.apply(void 0,[this].concat(t))};var s=function(){this.didChange.forEach(function(e){return e()})};return i.mark=function(){var e=(n=qi.core).get_vector_of_vectors.apply(n,arguments),t=oc.apply(void 0,arguments),i=rc.apply(void 0,arguments)||"F",n;Id(this,e[0][0],e[0][1],e[1][0],e[1][1],i).apply(),t.rebuild&&sd(this),$d().axiom1(e[0],e[1]),t.change&&this.didChange.forEach(function(e){return e()})},i.crease=function(){for(var t=this,i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];var a=n.filter(function(t){return"object"===e(t)}),o=qi.core.get_line(n),d=rc.apply(void 0,n)||"V",c=n.filter(function(e){return null!==e&&!isNaN(e)}).shift();if(!qi.core.is_vector(o.point)||!qi.core.is_vector(o.vector))return void console.warn("fold was not supplied the correct parameters");var l=yd(this,o.point,o.vector,c,d);Object.keys(l).forEach(function(e){t[e]=l[e]}),!0=="re:construction"in this&&0<a.length&&!0=="axiom"in a[0]&&(this["re:construction"].axiom=a[0].axiom,this["re:construction"].parameters=a[0].parameters),s.call(this)},i.creaseRay=function(){for(var e=this,t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=qi.ray(i),s=this.faces_vertices.map(function(t){return t.map(function(t){return e.vertices_coords[t]})}),a=s.map(function(e,t){return void 0===qi.core.intersection.convex_poly_ray_exclusive(e,r.point,r.vector)?void 0:t}).filter(function(e){return void 0!==e}).sort(function(e,t){return t-e});a.forEach(function(t){return gd(e,t,r.point,r.vector,"F")})},i.kawasaki=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=Le.apply(void 0,[this].concat(t));return s.call(this),n},Object.defineProperty(i,"boundaries",{get:function(){return dc.call(this,[wr(this)])}}),Object.defineProperty(i,"vertices",{get:function(){return ns(this,"vertices")}}),Object.defineProperty(i,"edges",{get:function(){return ns(this,"edges")}}),Object.defineProperty(i,"faces",{get:function(){return ns(this,"faces")}}),Object.defineProperty(i,"isFolded",{value:n}),i.didChange=[],i};cc.empty=function(){return cc(Kd())},cc.square=function(){return cc(Zd(1,1))},cc.rectangle=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return cc(Zd(e,t))},cc.regularPolygon=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1;return null==e&&console.warn("regularPolygon requires number of sides parameter"),cc(Qd(e,t))};var lc=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"shadow",t=document.createElementNS("http://www.w3.org/2000/svg","filter");t.setAttribute("width","200%"),t.setAttribute("height","200%"),t.setAttribute("id",e);var i=document.createElementNS("http://www.w3.org/2000/svg","feGaussianBlur");i.setAttribute("in","SourceAlpha"),i.setAttribute("stdDeviation","0.01"),i.setAttribute("result","blur");var n=document.createElementNS("http://www.w3.org/2000/svg","feOffset");n.setAttribute("in","blur"),n.setAttribute("result","offsetBlur");var r=document.createElementNS("http://www.w3.org/2000/svg","feFlood");r.setAttribute("flood-color","#000"),r.setAttribute("flood-opacity","0.4"),r.setAttribute("result","offsetColor");var s=document.createElementNS("http://www.w3.org/2000/svg","feComposite");s.setAttribute("in","offsetColor"),s.setAttribute("in2","offsetBlur"),s.setAttribute("operator","in"),s.setAttribute("result","offsetBlur");var a=document.createElementNS("http://www.w3.org/2000/svg","feMerge"),o=document.createElementNS("http://www.w3.org/2000/svg","feMergeNode"),d=document.createElementNS("http://www.w3.org/2000/svg","feMergeNode");return d.setAttribute("in","SourceGraphic"),a.appendChild(o),a.appendChild(d),t.appendChild(i),t.appendChild(n),t.appendChild(r),t.appendChild(s),t.appendChild(a),t},gc=function(e,t){if(!1!="faces_vertices"in e&&!1!="edges_vertices"in e&&!1!="vertices_coords"in e){var i=br(e),n=i[2]>i[3]?i[3]:i[2],r=.04*n,s={vertices:"fill:#27b;font-family:sans-serif;font-size:".concat(r,"px;"),edges:"fill:#e53;font-family:sans-serif;font-size:".concat(r,"px;"),faces:"fill:black;font-family:sans-serif;font-size:".concat(r,"px;")},a=[.33*r,.4*r];e.vertices_coords.map(function(e,n){return t.text("".concat(n),e[0]-a[0],e[1]+a[1])}).forEach(function(e){return e.setAttribute("style",s.vertices)}),e.edges_vertices.map(function(t){return t.map(function(t){return e.vertices_coords[t]})}).map(function(e){return qi.core.average(e)}).map(function(e,n){return t.text("".concat(n),e[0]-a[0],e[1]+a[1])}).forEach(function(e){return e.setAttribute("style",s.edges)}),e.faces_vertices.map(function(t){return t.map(function(t){return e.vertices_coords[t]})}).map(function(e){return qi.core.average(e)}).map(function(e,n){return t.text("".concat(n),e[0]-a[0],e[1]+a[1])}).forEach(function(e){return e.setAttribute("style",s.faces)})}},fc=function(e,t){var i=br(e),n=i[2]>i[3]?i[3]:i[2],r=.005*n,s={faces_vertices:"fill:#555;stroke:none;stroke-width:".concat(r,";"),faces_edges:"fill:#aaa;stroke:none;stroke-width:".concat(r,";")};e.faces_vertices.map(function(t){return t.map(function(t){return e.vertices_coords[t]})}).map(function(e){return qi.convexPolygon(e).scale(.666).points}).map(function(e){return t.polygon(e)}).forEach(function(e){return e.setAttribute("style",s.faces_vertices)}),e.faces_edges.map(function(t){return t.map(function(t){return e.edges_vertices[t]}).map(function(e,t,i){var n=i[(t+1)%i.length];return e[1]===n[0]||e[1]===n[1]?e[0]:e[1]}).map(function(t){return e.vertices_coords[t]})}).map(function(e){return qi.convexPolygon(e).scale(.333).points}).map(function(e){return t.polygon(e)}).forEach(function(e){return e.setAttribute("style",s.faces_edges)})},pc=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},n=br(e),r=n[2]>n[3]?n[3]:n[2],s=e["re:diagrams"];null==s||s.map(function(e){return e["re:diagram_arrows"]}).filter(function(e){return null!=e}).forEach(function(e){return e.map(function(e){return e["re:diagram_arrow_coords"]}).filter(function(e){return 0<e.length}).map(function(e){var n=e[0][0]<e[1][0];.1>ze(e[0][0]-e[1][0])&&(n=e[0][1]<e[1][1]?.5>e[0][0]:.5<e[0][0]),.1>ze(e[0][1]-e[1][1])&&(n=e[0][0]<e[1][0]?.5<e[0][1]:.5>e[0][1]);var s={side:n,length:.09*r,width:.035*r,strokeWidth:.02*r};return i.arrowColor&&(s.color=i.arrowColor),t.arcArrow(e[0],e[1],s)})})},_c="http://www.w3.org/2000/svg",hc="\nline.mountain { stroke: red; }\nline.mark { stroke: lightgray; }\nline.valley { stroke: blue;\n  stroke-dasharray: calc(var(--crease-width) * 2) calc(var(--crease-width) * 2);\n}\npolygon { stroke: none; stroke-linejoin: bevel; }\n.foldedForm polygon { stroke: black; fill: #8881; }\n.foldedForm polygon.front { fill: white; }\n.foldedForm polygon.back { fill: lightgray; }\n.creasePattern polygon { fill: white; stroke: none; }\n.foldedForm .boundaries polygon { fill: none; stroke: none; }\n.foldedForm line { stroke: none; }\n",uc=Object.freeze({boundaries:!0,faces:!0,edges:!0,vertices:!1,diagram:!1,labels:!1,debug:!1,autofit:!0,padding:0,shadows:!1,strokeWidth:.01,style:void 0,arrowColor:void 0}),mc=function(){var t=Object.keys(uc),i={};return Array.apply(void 0,arguments).filter(function(t){return"object"===e(t)}).forEach(function(e){return Object.keys(e).filter(function(e){return t.includes(e)}).forEach(function(t){i[t]=e[t]})}),i},vc=function(e){for(var t=e,i=arguments.length,n=Array(1<i?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];var s=Zn.apply(Jn,n),a=ls.document.createElementNS(_c,"style"),o=ls.document.createElementNS(_c,"defs");s.appendChild(a),s.appendChild(o),o.appendChild(lc("faces_shadow")),a.innerHTML=hc;var d={};["boundaries","faces","edges","vertices","diagram","labels"].forEach(function(e){d[e]=s.group(),d[e].setAttribute("class",e)}),d.edges.setAttribute("stroke-width",1),d.faces.setAttribute("stroke-width",1),d.boundaries.setAttribute("stroke-width",1),d.edges.setAttribute("stroke","black"),d.faces.setAttribute("stroke","none"),d.faces.setAttribute("fill","none"),d.boundaries.setAttribute("fill","none"),Object.keys(d).forEach(function(e){d[e].setAttribute("pointer-events","none")});var c={};Object.assign(c,uc);var l=mc.apply(void 0,n);Object.keys(l).forEach(function(e){c[e]=l[e]});var g=function(){var e=br(t),i=e[2]>e[3]?e[3]:e[2];pn(s,e[0],e[1],e[2],e[3],c.padding*i)};return Object.defineProperty(s,"draw",{value:function(){var e=(null==t.file_classes?[]:t.file_classes).join(" "),i=null==t.frame_classes?"":t.frame_classes,n=[e,i].filter(function(e){return""!==e}).join(" ");s.setAttribute("class",n),Object.keys(d).forEach(function(e){return d[e].removeChildren()}),Object.keys(d).filter(function(e){return c[e]}).filter(function(e){return void 0!==va.components.svg[e]}).forEach(function(e){return va.components.svg[e](t).forEach(function(t){return d[e].appendChild(t)})}),c.autofit&&g(),c.diagram&&pc(t,d.diagram),c.labels&&gc(t,d.labels),c.debug&&fc(t,d.labels),c.shadows&&Array.from(d.faces.childNodes).forEach(function(e){return e.setAttribute("filter","url(#faces_shadow)")});var o=br(t),r=o[2]>o[3]?o[3]:o[2],l=o[2]>o[3]?o[2]:o[3],f=(r+l)/2*c.strokeWidth;["boundaries","faces","edges","vertices"].forEach(function(e){return d[e].setAttribute("stroke-width",f)}),c.style&&(a.innerHTML=hc+c.style)}}),Object.defineProperty(s,"fit",{value:g}),Object.defineProperty(s,"setViewBox",{value:function(e,t,i,n,r){return pn(s,e,t,i,n,r)}}),Object.defineProperty(s,"options",{get:function(){return c}}),Object.defineProperty(s,"groups",{get:function(){return d}}),s},yc={file_spec:1.1,file_creator:"",file_author:"",file_classes:["singleModel"],frame_title:"",frame_attributes:["2D"],frame_classes:["creasePattern"],vertices_coords:[[0,0],[1,0],[1,1],[0,1]],vertices_vertices:[[1,3],[2,0],[3,1],[0,2]],vertices_faces:[[0],[0],[0],[0]],edges_vertices:[[0,1],[1,2],[2,3],[3,0]],edges_faces:[[0],[0],[0],[0]],edges_assignment:["B","B","B","B"],edges_foldAngle:[0,0,0,0],edges_length:[1,1,1,1],faces_vertices:[[0,1,2,3]],faces_edges:[[0,1,2,3]]},xc=function(e){!1=="faces_re:matrix"in e&&(e["faces_re:matrix"]=or(e,0))},kc=function(e,t){xc(e);var i=0,n=Gr(e),r=!0=="vertices_re:unfoldedCoords"in e;t.events.addEventListener("onMouseDown",function(t){r=!0=="vertices_re:unfoldedCoords"in e,n=Gr(e);var s={faces_vertices:e.faces_vertices,"faces_re:layer":e["faces_re:layer"],vertices_coords:r?e["vertices_re:foldedCoords"]||e.vertices_coords:e["vertices_re:unfoldedCoords"]||e.vertices_coords},a=xr(s,t),o=kr(s,a);i=null==o?0:o,r&&(n.vertices_coords=e["vertices_re:unfoldedCoords"].slice())}),t.events.addEventListener("onMouseMove",function(t){if(t.isPressed){e.load(n);var s=Or(t.pressed,t.position);e.crease(s.solutions[0],i),r&&e.fold()}})},bc=Object.freeze({touchFold:!1}),wc=function(){var t=Object.keys(bc),i={};return Array.apply(void 0,arguments).filter(function(t){return"object"===e(t)}).forEach(function(e){return Object.keys(e).filter(function(e){return t.includes(e)}).forEach(function(t){i[t]=e[t]})}),i},Ec={gl:"webgl",GL:"webgl",webGL:"webgl",WebGL:"webgl",webgl:"webgl",Webgl:"webgl",svg:"svg",SVG:"svg","2d":"svg","2D":"svg","3d":"webgl","3D":"webgl"},Pc=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=i.filter(function(t){return"object"===e(t)}).filter(function(e){return!0=="view"in e}).shift();if(void 0===r){if(We)return;if(Xe)return"svg"}return Ec[r.view]},Ac=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=Object.assign(Object.create(cc()),t.filter(function(e){return as(e)}).shift()||Hd());ds(n),ec(n);var r=function(e){var t=n.isFolded(),i=e?"creasePattern":"foldedForm",r=e?"foldedForm":"creasePattern";for(null==n.frame_classes&&(n.frame_classes=[]);-1!==n.frame_classes.indexOf(i);)n.frame_classes.splice(n.frame_classes.indexOf(i),1);-1===n.frame_classes.indexOf(r)&&n.frame_classes.push(r);var s=e?"vertices_re:foldedCoords":"vertices_re:unfoldedCoords",a=e?"vertices_re:unfoldedCoords":"vertices_re:foldedCoords";!0==s in n&&(n[a]=n.vertices_coords,n.vertices_coords=n[s],delete n[s]),n.didChange.forEach(function(e){return e()})},s=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return!1=="faces_re:matrix"in n&&(n["faces_re:matrix"]=or(n,e.face)),!1=="vertices_re:foldedCoords"in n&&(n["vertices_re:foldedCoords"]=cr(n,null,n["faces_re:matrix"])),r(!0),n},a=function(e){var t=ns(n,e),i=n.svg||n.gl;return Object.defineProperty(t,"visible",{get:function(){return i.options[e]},set:function(t){i.options[e]=!!t,n.didChange.forEach(function(e){return e()})}}),null!=n.svg&&t.forEach(function(t,r){t.svg=n.svg.groups[e].childNodes[r]}),t},o={};Object.assign(o,bc);var d=wc.apply(void 0,t);Object.keys(d).forEach(function(e){o[e]=d[e]}),Object.defineProperty(n,"fold",{value:s}),Object.defineProperty(n,"unfold",{value:function(){return r(!1),n}}),Object.defineProperty(n,"load",{value:function(e,t){(null==t||!0!==t)&&Zr.forEach(function(e){return delete n[e]});var i=Yo(e).fold();Object.assign(n,i),ec(n),n.didChange.forEach(function(e){return e()})}}),Object.defineProperty(n,"nearest",{value:function(){var e={vertex:"vertices",edge:"edges",face:"faces"},t=(r=qi.core).get_vector.apply(r,arguments),i={vertex:n.nearestVertex(n,t),edge:n.nearestEdge(n,t),face:n.nearestFace(n,t)},r;return Object.keys(i).filter(function(e){return null==i[e]}).forEach(function(e){return delete i[e]}),null!=n.svg&&Object.keys(i).forEach(function(t){i[t].svg=n.svg.groups[e[t]].childNodes[i[t].index]}),i}}),Object.defineProperty(n,"vertices",{get:function(){return a.call(n,"vertices")}}),Object.defineProperty(n,"edges",{get:function(){return a.call(n,"edges")}}),Object.defineProperty(n,"faces",{get:function(){return a.call(n,"faces")}});var c=function(){return JSON.stringify(n)};return c.json=function(){return JSON.stringify(n)},c.fold=function(){return JSON.stringify(n)},c.svg=function(){return null==n.svg?va.svg(n):new ls.XMLSerializer().serializeToString(n.svg)},Object.defineProperty(n,"snapshot",{get:function(){return c}}),Object.defineProperty(n,"export",{get:function(){return c}}),Object.defineProperty(n,"options",{get:function(){return o}}),n};console.log("RabbitEar v0.2 [ ".concat(Xe?"browser ":"").concat(Ge?"webWorker ":"").concat(We?"node ":"","]"));var Sc=Object.create(null);Sc.svg=Jn,Sc.gl={};var Nc=Object.create(null);Object.assign(Nc,Kr,Yr,ss,cs,Zo,ad,fr,od,Ar,Ld,Wr),Nc.build_diagram_frame=function(e){var t=e["re:construction"];if(null==t)return console.warn("couldn't build diagram. construction info doesn't exist"),{};switch(t.type){case"flip":return{"re:diagram_arrows":[{"re:diagram_arrow_classes":["flip"],"re:diagram_arrow_coords":[]}],"re:diagram_instructions":{en:"flip over"}};case"fold":return{"re:diagram_lines":[{"re:diagram_line_classes":[Qr.en[t.assignment]],"re:diagram_line_coords":t.edge}],"re:diagram_arrows":[{"re:diagram_arrowClasses":[],"re:diagram_arrow_coords":Od(t,e)}],"re:diagram_instructions":Cd(t)};case"squash":case"sink":case"pleat":default:return{error:"construction type (".concat(t.type,") not yet defined")};}},Nc.add_edge=Id,Nc.split_edge_run=function(e,t,i,r){var s=e.vertices_coords.length,a=e.edges_vertices.length;if(!(a<r)){var o={remove:{edges:[r]},update:Vd(e,e.edges_vertices[r],s),new:{vertices:[{vertices_coords:[t,i],vertices_vertices:n(e.edges_vertices[r]),vertices_faces:e.edges_faces?e.edges_faces[r]:void 0}],edges:zd.apply(void 0,[e,r].concat(n(e.edges_vertices[r].map(function(e){return{edges_vertices:[e,s]}})))),faces:[]}};return e.edges_faces&&e.edges_faces[r].forEach(function(t){void 0===o.update[t]&&(o.update[t]={}),o.update[t].faces_vertices=Dd(e.faces_vertices[t],e.edges_vertices[r],s),o.update[t].faces_edges=qd(e,e.faces_edges[t],r,s,a,a+1,o["new"].edges[0].edges_vertices,o["new"].edges[1].edges_vertices)}),o}},Nc.apply_run=Bd,Nc.merge_run=function(e,t,r){var s=_r(e),a=hr(e),o=ur(e),d=0,c=0,l=0;void 0!==t["new"]&&(void 0!==t["new"].vertices&&(d=t["new"].vertices.length),void 0!==t["new"].edges&&(c=t["new"].edges.length),void 0!==t["new"].faces&&(l=t["new"].faces.length));var g={vertices:{length:s,change:d},edges:{length:a,change:c},faces:{length:o,change:l}},f=[];void 0!==r["new"]&&Object.keys(r["new"]).forEach(function(e){r["new"][e].forEach(function(t,s){["vertices","edges","faces"].forEach(function(i){var n="_".concat(i),a=Object.keys(t).map(function(e){return e.substring(e.length-n.length,e.length)===n?e:void 0}).filter(function(e){return void 0!==e});a.forEach(function(t){r["new"][e][s][t].forEach(function(i,n){r["new"][e][s][t][n]>=g[e].length&&(r["new"][e][s][t][n]+=g[e].change)})})})}),f=f.concat(r["new"].vertices)});var p={};void 0!==t["new"]&&(p["new"]=t["new"]),void 0!==t.update&&(p.update=t.update),void 0!==t.remove&&(p.remove=t.remove),void 0!==r["new"]&&(void 0!==r["new"].vertices&&(void 0===p["new"].vertices&&(p["new"].vertices=[]),p["new"].vertices=p["new"].vertices.concat(r["new"].vertices)),void 0!==r["new"].edges&&(void 0===p["new"].edges&&(p["new"].edges=[]),p["new"].edges=p["new"].edges.concat(r["new"].edges)),void 0!==r["new"].faces&&(void 0===p["new"].faces&&(p["new"].faces=[]),p["new"].faces=p["new"].faces.concat(r["new"].faces))),void 0!==r.update&&Object.keys(r.update).forEach(function(e){if(null==p.update[e])p.update[e]=r.update[e];else{var t=Object.keys(p.update[e]),i=Object.keys(r.update[e]),n=t.filter(function(e){return i.includes(e)});if(0<n.length){var s=n.join(", ");return void console.warn("cannot merge. two diffs contain overlap at ".concat(s))}Object.assign(p.update[e],r.update[e])}}),void 0!==r.remove&&(void 0!==r.remove.vertices&&(void 0===p.remove.vertices&&(p.remove.vertices=[]),p.remove.vertices=p.remove.vertices.concat(r.remove.vertices)),void 0!==r.remove.edges&&(void 0===p.remove.edges&&(p.remove.edges=[]),p.remove.edges=p.remove.edges.concat(r.remove.edges)),void 0!==r.remove.faces&&(void 0===p.remove.faces&&(p.remove.faces=[]),p.remove.faces=p.remove.faces.concat(r.remove.faces))),Object.assign(t,r)},Nc.apply_axiom=Mr,Nc.prototype=cc;var Lc={empty:JSON.parse("{\n\t\"file_spec\": 1.1,\n\t\"file_creator\": \"\",\n\t\"file_author\": \"\",\n\t\"file_title\": \"\",\n\t\"file_description\": \"\",\n\t\"file_classes\": [],\n\t\"file_frames\": [],\n\n\t\"frame_author\": \"\",\n\t\"frame_title\": \"\",\n\t\"frame_description\": \"\",\n\t\"frame_attributes\": [],\n\t\"frame_classes\": [],\n\t\"frame_unit\": \"\",\n\n\t\"vertices_coords\": [],\n\t\"vertices_vertices\": [],\n\t\"vertices_faces\": [],\n\n\t\"edges_vertices\": [],\n\t\"edges_faces\": [],\n\t\"edges_assignment\": [],\n\t\"edges_foldAngle\": [],\n\t\"edges_length\": [],\n\n\t\"faces_vertices\": [],\n\t\"faces_edges\": [],\n\n\t\"edgeOrders\": [],\n\t\"faceOrders\": []\n}\n"),square:JSON.parse("{\n\t\"file_spec\": 1.1,\n\t\"file_creator\": \"\",\n\t\"file_author\": \"\",\n\t\"file_classes\": [\"singleModel\"],\n\t\"frame_title\": \"\",\n\t\"frame_attributes\": [\"2D\"],\n\t\"frame_classes\": [\"creasePattern\"],\n\t\"vertices_coords\": [[0,0], [1,0], [1,1], [0,1]],\n\t\"vertices_vertices\": [[1,3], [2,0], [3,1], [0,2]],\n\t\"vertices_faces\": [[0], [0], [0], [0]],\n\t\"edges_vertices\": [[0,1], [1,2], [2,3], [3,0]],\n\t\"edges_faces\": [[0], [0], [0], [0]],\n\t\"edges_assignment\": [\"B\",\"B\",\"B\",\"B\"],\n\t\"edges_foldAngle\": [0, 0, 0, 0],\n\t\"edges_length\": [1, 1, 1, 1],\n\t\"faces_vertices\": [[0,1,2,3]],\n\t\"faces_edges\": [[0,1,2,3]]\n}"),book:JSON.parse("{\n\t\"file_spec\": 1.1,\n\t\"file_creator\": \"\",\n\t\"file_author\": \"\",\n\t\"file_classes\": [\"singleModel\"],\n\t\"frame_title\": \"\",\n\t\"frame_attributes\": [\"2D\"],\n\t\"frame_classes\": [\"creasePattern\"],\n\t\"vertices_coords\": [[0,0], [0.5,0], [1,0], [1,1], [0.5,1], [0,1]],\n\t\"vertices_vertices\": [[1,5], [2,4,0], [3,1], [4,2], [5,1,3], [0,4]],\n\t\"vertices_faces\": [[0], [0,1], [1], [1], [1,0], [0]],\n\t\"edges_vertices\": [[0,1], [1,2], [2,3], [3,4], [4,5], [5,0], [1,4]],\n\t\"edges_faces\": [[0], [1], [1], [1], [0], [0], [0,1]],\n\t\"edges_assignment\": [\"B\",\"B\",\"B\",\"B\",\"B\",\"B\",\"V\"],\n\t\"edges_foldAngle\": [0, 0, 0, 0, 0, 0, 180],\n\t\"edges_length\": [0.5, 0.5, 1, 0.5, 0.5, 1, 1],\n\t\"faces_vertices\": [[1,4,5,0], [4,1,2,3]],\n\t\"faces_edges\": [[6,4,5,0], [6,1,2,3]]\n}"),blintz:JSON.parse("{\n\t\"file_spec\": 1.1,\n\t\"file_creator\": \"\",\n\t\"file_author\": \"\",\n\t\"file_classes\": [\"singleModel\"],\n\t\"frame_title\": \"blintz base\",\n\t\"frame_attributes\": [\"2D\"],\n\t\"frame_classes\": [\"creasePattern\"],\n\t\"vertices_coords\": [[0,0], [0.5,0], [1,0], [1,0.5], [1,1], [0.5,1], [0,1], [0,0.5]],\n\t\"vertices_vertices\": [[1,7], [2,3,7,0], [3,1], [4,5,1,2], [5,3], [6,7,3,4], [7,5], [0,1,5,6]],\n\t\"vertices_faces\": [[0], [1,4,0], [1], [2,4,1], [2], [3,4,2], [3], [0,4,3]],\n\t\"edges_vertices\": [[0,1], [1,2], [2,3], [3,4], [4,5], [5,6], [6,7], [7,0], [1,3], [3,5], [5,7], [7,1]],\n\t\"edges_faces\": [[0], [1], [1], [2], [2], [3], [3], [0], [1,4], [2,4], [3,4], [0,4]],\n\t\"edges_assignment\": [\"B\",\"B\",\"B\",\"B\",\"B\",\"B\",\"B\",\"B\",\"V\",\"V\",\"V\",\"V\"],\n\t\"edges_foldAngle\": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t\"edges_length\": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.707106781186548, 0.707106781186548, 0.707106781186548, 0.707106781186548],\n\t\"faces_vertices\": [[0,1,7], [2,3,1], [4,5,3], [6,7,5], [1,3,5,7]],\n\t\"faces_edges\": [[0,11,7], [2,8,1], [4,9,3], [6,10,5], [8,9,10,11]],\n\t\"file_frames\": [{\n\t\t\"frame_classes\": [\"foldedForm\"],\n\t\t\"frame_parent\": 0,\n\t\t\"frame_inherit\": true,\n\t\t\"vertices_coords\": [[0.5,0.5], [0.5,0.0], [0.5,0.5], [1.0,0.5], [0.5,0.5], [0.5,1.0], [0.5,0.5], [0.0,0.5]],\n\t\t\"edges_foldAngle\": [0, 0, 0, 0, 0, 0, 0, 0, 180, 180, 180, 180],\n\t\t\"faceOrders\": [[0,4,1], [1,4,1], [2,4,1], [3,4,1]]\n\t}]\n}"),kite:JSON.parse("{\n\t\"file_spec\": 1.1,\n\t\"file_creator\": \"\",\n\t\"file_author\": \"\",\n\t\"file_classes\": [\"singleModel\"],\n\t\"frame_title\": \"kite base\",\n\t\"frame_classes\": [\"creasePattern\"],\n\t\"frame_attributes\": [\"2D\"],\n\t\"vertices_coords\": [\n\t\t[0,0],\n\t\t[0.414213562373095,0],\n\t\t[1,0],\n\t\t[1,0.585786437626905],\n\t\t[1,1],\n\t\t[0,1]\n\t],\n\t\"vertices_vertices\": [ [1,5], [2,5,0], [3,5,1], [4,5,2], [5,3], [0,1,2,3,4] ],\n\t\"vertices_faces\": [ [0], [1,0], [2,1], [3,2], [3], [0,1,2,3] ],\n\t\"edges_vertices\": [\n\t\t[0,1],\n\t\t[1,2],\n\t\t[2,3],\n\t\t[3,4],\n\t\t[4,5],\n\t\t[5,0],\n\t\t[5,1],\n\t\t[3,5],\n\t\t[5,2]\n\t],\n\t\"edges_faces\": [[0], [1], [2], [3], [3], [0], [0,1], [3,2], [1,2]],\n\t\"edges_assignment\": [\"B\", \"B\", \"B\", \"B\", \"B\", \"B\", \"V\", \"V\", \"F\"],\n\t\"edges_foldAngle\": [0, 0, 0, 0, 0, 0, 0, 0, 0],\n\t\"edges_length\": [0.414213562373095, 0.585786437626905, 0.585786437626905, 0.414213562373095, 1, 1, 1.082392200292394, 1.082392200292394, 1.414213562373095],\n\t\"faces_vertices\": [\n\t\t[0,1,5],\n\t\t[1,2,5],\n\t\t[2,3,5],\n\t\t[3,4,5]\n\t],\n\t\"faces_edges\": [\n\t\t[0,6,5],\n\t\t[1,8,6],\n\t\t[2,7,8],\n\t\t[3,4,7]\n\t],\n\t\"file_frames\": [{\n\t\t\"frame_classes\": [\"foldedForm\"],\n\t\t\"frame_parent\": 0,\n\t\t\"frame_inherit\": true,\n\t\t\"vertices_coords\": [\n\t\t\t[0.707106781186548,0.292893218813452],\n\t\t\t[1,0],\n\t\t\t[0.707106781186548,0.292893218813452],\n\t\t\t[0,1],\n\t\t\t[0.414213562373095,0],\n\t\t\t[1,0.585786437626905]\n\t\t],\n\t\t\"edges_foldAngle\": [0, 0, 0, 0, 0, 0, 180, 180, 0],\n\t\t\"faceOrders\": [[0,1,1], [3,2,1]]\n\t}]\n}"),fish:JSON.parse("{\n  \"file_spec\": 1.1,\n  \"file_creator\": \"\",\n  \"file_author\": \"\",\n  \"file_classes\": [\"singleModel\"],\n  \"frame_title\": \"\",\n  \"frame_classes\": [\"creasePattern\"],\n  \"frame_attributes\": [\"2D\"],\n  \"vertices_coords\": [\n    [0,0],\n    [1,0],\n    [1,1],\n    [0,1],\n    [0.292893218813452,0.292893218813452],\n    [0.707106781186548,0.707106781186548],\n    [0.292893218813452,0],\n    [1,0.707106781186548]\n  ],\n  \"edges_vertices\": [\n  \t[2,3], [3,0], [3,1], [0,4], [1,4], [3,4], [1,5], [2,5], [3,5], [4,6], [0,6], [6,1], [5,7], [1,7], [7,2]\n  ],\n  \"edges_assignment\": [\n  \t\"B\", \"B\", \"F\", \"M\", \"M\", \"M\", \"M\", \"M\", \"M\", \"V\", \"B\", \"B\", \"V\", \"B\", \"B\"\n  ],\n  \"file_frames\": [{\n    \"frame_classes\": [\"foldedForm\"],\n    \"frame_parent\": 0,\n    \"frame_inherit\": true,\n    \"vertices_coords\":[[0.707106781186548,0.292893218813452],[1,0],[0.707106781186548,0.292893218813452],[0,1],[0.292893218813452,0.292893218813452],[0.707106781186548,0.707106781186548],[0.5,0.5],[0.5,0.5]]\n  }],\n  \"vertices_vertices\": [\n    [6,4,3],\n    [7,5,3,4,6],\n    [5,7,3],\n    [0,4,1,5,2],\n    [0,6,1,3],\n    [1,7,2,3],\n    [1,4,0],\n    [1,2,5]\n  ],\n  \"faces_vertices\": [\n    [4,0,6],\n    [3,0,4],\n    [5,1,7],\n    [3,1,5],\n    [4,1,3],\n    [6,1,4],\n    [5,2,3],\n    [7,2,5]\n  ],\n  \"faces_edges\": [\n    [3,10,9],\n    [1,3,5],\n    [6,13,12],\n    [2,6,8],\n    [4,2,5],\n    [11,4,9],\n    [7,0,8],\n    [14,7,12]\n  ],\n  \"edges_faces\": [[6], [1], [3,4], [0,1], [4,5], [1,4], [2,3], [6,7], [3,6], [0,5], [0], [5], [2,7], [2], [7]],\n  \"vertices_faces\": [[0,1], [2,3,4,5], [6,7], [1,3,4,6], [0,1,4,5], [2,3,6,7], [0,5], [2,7]],\n  \"edges_length\": [1, 1, 1.4142135623730951, 0.41421356237309437, 0.7653668647301798, 0.7653668647301798, 0.7653668647301798, 0.41421356237309437, 0.7653668647301798, 0.292893218813452, 0.292893218813452, 0.707106781186548, 0.292893218813452, 0.707106781186548, 0.292893218813452],\n  \"edges_foldAngle\": [0, 0, 0, -180, -180, -180, -180, -180, -180, 180, 0, 0, 180, 0, 0],\n  \"faces_faces\": [\n  \t[1,5], [0,4], [3,7], [2,4,6], [3,1,5], [4,0], [3,7], [6,2]\n  ],\n  \"vertices_edges\": [\n    [1,3,10],\n    [2,4,6,11,13],\n    [0,7,14],\n    [0,1,2,5,8],\n    [3,4,5,9],\n    [6,7,8,12],\n    [9,10,11],\n    [12,13,14]\n  ]\n}\n"),bird:JSON.parse("{\n\t\"file_spec\": 1.1,\n\t\"frame_title\": \"\",\n\t\"file_classes\": [\"singleModel\"],\n\t\"frame_classes\": [\"creasePattern\"],\n\t\"frame_attributes\": [\"2D\"],\n\t\"vertices_coords\": [[0,0],[1,0],[1,1],[0,1],[0.5,0.5],[0.207106781186548,0.5],[0.5,0.207106781186548],[0.792893218813452,0.5],[0.5,0.792893218813452],[0.353553390593274,0.646446609406726],[0.646446609406726,0.646446609406726],[0.646446609406726,0.353553390593274],[0.353553390593274,0.353553390593274],[0,0.5],[0.5,0],[1,0.5],[0.5,1]],\n\t\"edges_vertices\": [[3,5],[5,9],[3,9],[3,13],[5,13],[0,5],[0,13],[0,12],[5,12],[4,5],[4,12],[4,9],[0,6],[6,12],[0,14],[6,14],[1,6],[1,14],[1,11],[6,11],[4,6],[4,11],[1,7],[7,11],[1,15],[7,15],[2,7],[2,15],[2,10],[7,10],[4,7],[4,10],[2,8],[8,10],[2,16],[8,16],[3,8],[3,16],[8,9],[4,8]],\n\t\"edges_faces\": [[0,1],[0,5],[21,0],[1],[2,1],[2,3],[2],[3,6],[4,3],[4,5],[11,4],[5,22],[6,7],[6,11],[7],[8,7],[8,9],[8],[9,12],[10,9],[10,11],[17,10],[12,13],[12,17],[13],[14,13],[14,15],[14],[15,18],[16,15],[16,17],[23,16],[18,19],[18,23],[19],[20,19],[20,21],[20],[22,21],[22,23]],\n\t\"edges_assignment\": [\"M\",\"F\",\"V\",\"B\",\"V\",\"M\",\"B\",\"F\",\"F\",\"M\",\"F\",\"V\",\"M\",\"F\",\"B\",\"V\",\"M\",\"B\",\"V\",\"F\",\"M\",\"V\",\"M\",\"F\",\"B\",\"V\",\"M\",\"B\",\"F\",\"F\",\"M\",\"F\",\"M\",\"F\",\"B\",\"V\",\"M\",\"B\",\"F\",\"M\"],\n\t\"faces_vertices\": [[3,5,9],[5,3,13],[0,5,13],[5,0,12],[4,5,12],[5,4,9],[0,6,12],[6,0,14],[1,6,14],[6,1,11],[4,6,11],[6,4,12],[1,7,11],[7,1,15],[2,7,15],[7,2,10],[4,7,10],[7,4,11],[2,8,10],[8,2,16],[3,8,16],[8,3,9],[4,8,9],[8,4,10]],\n\t\"faces_edges\": [[0,1,2],[0,3,4],[5,4,6],[5,7,8],[9,8,10],[9,11,1],[12,13,7],[12,14,15],[16,15,17],[16,18,19],[20,19,21],[20,10,13],[22,23,18],[22,24,25],[26,25,27],[26,28,29],[30,29,31],[30,21,23],[32,33,28],[32,34,35],[36,35,37],[36,2,38],[39,38,11],[39,31,33]]\n}"),frog:JSON.parse("{\n\t\"file_spec\": 1.1,\n\t\"frame_title\": \"\",\n\t\"file_classes\": [\"singleModel\"],\n\t\"frame_classes\": [\"creasePattern\"],\n\t\"frame_attributes\": [\"2D\"],\n\t\"vertices_coords\": [[0,0],[1,0],[1,1],[0,1],[0.5,0.5],[0,0.5],[0.5,0],[1,0.5],[0.5,1],[0.146446609406726,0.353553390593274],[0.353553390593274,0.146446609406726],[0.646446609406726,0.146446609406726],[0.853553390593274,0.353553390593274],[0.853553390593274,0.646446609406726],[0.646446609406726,0.853553390593274],[0.353553390593274,0.853553390593274],[0.146446609406726,0.646446609406726],[0,0.353553390593274],[0,0.646446609406726],[0.353553390593274,0],[0.646446609406726,0],[1,0.353553390593274],[1,0.646446609406726],[0.646446609406726,1],[0.353553390593274,1]],\n\t\"edges_vertices\": [[0,4],[4,9],[0,9],[0,10],[4,10],[2,4],[2,14],[4,14],[4,13],[2,13],[3,4],[4,15],[3,15],[3,16],[4,16],[1,4],[1,12],[4,12],[4,11],[1,11],[4,5],[5,9],[5,16],[4,6],[6,11],[6,10],[4,7],[7,13],[7,12],[4,8],[8,15],[8,14],[9,17],[0,17],[5,17],[0,19],[10,19],[6,19],[11,20],[1,20],[6,20],[1,21],[12,21],[7,21],[13,22],[2,22],[7,22],[2,23],[14,23],[8,23],[15,24],[3,24],[8,24],[3,18],[16,18],[5,18]],\n\t\"edges_faces\": [[0,1],[0,8],[16,0],[1,18],[11,1],[3,2],[2,26],[15,2],[3,12],[24,3],[4,5],[4,14],[28,4],[5,30],[9,5],[7,6],[6,22],[13,6],[7,10],[20,7],[8,9],[8,17],[31,9],[10,11],[10,21],[19,11],[12,13],[12,25],[23,13],[14,15],[14,29],[27,15],[16,17],[16],[17],[18],[19,18],[19],[20,21],[20],[21],[22],[23,22],[23],[24,25],[24],[25],[26],[27,26],[27],[28,29],[28],[29],[30],[31,30],[31]],\n\t\"edges_assignment\": [\"F\",\"M\",\"M\",\"M\",\"M\",\"F\",\"M\",\"M\",\"M\",\"M\",\"V\",\"M\",\"M\",\"M\",\"M\",\"V\",\"M\",\"M\",\"M\",\"M\",\"V\",\"M\",\"M\",\"V\",\"M\",\"M\",\"V\",\"M\",\"M\",\"V\",\"M\",\"M\",\"V\",\"B\",\"B\",\"B\",\"V\",\"B\",\"V\",\"B\",\"B\",\"B\",\"V\",\"B\",\"V\",\"B\",\"B\",\"B\",\"V\",\"B\",\"V\",\"B\",\"B\",\"B\",\"V\",\"B\"],\n\t\"faces_vertices\": [[0,4,9],[4,0,10],[4,2,14],[2,4,13],[3,4,15],[4,3,16],[4,1,12],[1,4,11],[4,5,9],[5,4,16],[4,6,11],[6,4,10],[4,7,13],[7,4,12],[4,8,15],[8,4,14],[0,9,17],[9,5,17],[10,0,19],[6,10,19],[1,11,20],[11,6,20],[12,1,21],[7,12,21],[2,13,22],[13,7,22],[14,2,23],[8,14,23],[3,15,24],[15,8,24],[16,3,18],[5,16,18]],\n\t\"faces_edges\": [[0,1,2],[0,3,4],[5,6,7],[5,8,9],[10,11,12],[10,13,14],[15,16,17],[15,18,19],[20,21,1],[20,14,22],[23,24,18],[23,4,25],[26,27,8],[26,17,28],[29,30,11],[29,7,31],[2,32,33],[21,34,32],[3,35,36],[25,36,37],[19,38,39],[24,40,38],[16,41,42],[28,42,43],[9,44,45],[27,46,44],[6,47,48],[31,48,49],[12,50,51],[30,52,50],[13,53,54],[22,54,55]]\n}")},b=Object.create(null);Object.defineProperty(b,"empty",{get:function(){return Nc.clone(Lc.empty)}}),Object.defineProperty(b,"square",{get:function(){return Nc.clone(Lc.square)}}),Object.defineProperty(b,"book",{get:function(){return Nc.clone(Lc.book)}}),Object.defineProperty(b,"blintz",{get:function(){return Nc.clone(Lc.blintz)}}),Object.defineProperty(b,"kite",{get:function(){return Nc.clone(Lc.kite)}}),Object.defineProperty(b,"fish",{get:function(){return Nc.clone(Lc.fish)}}),Object.defineProperty(b,"bird",{get:function(){return Nc.clone(Lc.bird)}}),Object.defineProperty(b,"frog",{get:function(){return Nc.clone(Lc.frog)}});var jc={Origami:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=Ac.apply(void 0,t),r;switch(Pc.apply(void 0,t)){case"svg":r=vc.apply(void 0,[n].concat(t)),n.didChange.push(r.draw),Object.defineProperty(n,"svg",{get:function(){return r}}),!0===n.options.touchFold&&kc(n,n.svg),n.svg.fit(),n.svg.draw();break;case"webgl":r=je.apply(void 0,[n].concat(t)),Object.defineProperty(n,"canvas",{get:function(){return r}});break;default:}return n},graph:function e(){var t=Object.create(null);t.nodes=[],t.edges=[],t.types={node:Wi,edge:Gi};var i=function(){var e=t.edges.length;return t.edges=t.edges.filter(function(e){return e.nodes[0]!==e.nodes[1]}),Xi().circularEdges(e-t.edges.length)},n=function(){for(var e=0,n=0;n<t.edges.length-1;n+=1)for(var r=t.edges.length-1;r>n;r-=1)t.edges[n].isSimilarToEdge(t.edges[r])&&(t.edges.splice(r,1),e+=1);return Xi().duplicateEdges(e)},r=function(){return n().join(i())},s=function(){t.nodes.forEach(function(e,t){e._memo=t});for(var r=e(),s=0,a;s<t.nodes.length;s+=1)a=r.newNode(),Object.assign(a,t.nodes[s]),a.graph=r;for(var o=0;o<t.edges.length;o+=1){var d=t.edges[o].nodes.map(function(e){return e._memo}),c=r.newEdge(r.nodes[d[0]],r.nodes[d[1]]);Object.assign(c,t.edges[o]),c.graph=r,c.nodes=[r.nodes[d[0]],r.nodes[d[1]]]}return t.nodes.forEach(function(e){return delete e._memo}),r.nodes.forEach(function(e){return delete e._memo}),r};return Object.defineProperty(t,"newNode",{value:function(){for(var e=t.types.node(t),i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];return Object.assign.apply(Object,[e].concat(n)),e.graph=t,t.nodes.push(e),e}}),Object.defineProperty(t,"newEdge",{value:function(e,i){var n=t.types.edge(t,e,i);return n.graph=t,t.edges.push(n),n}}),Object.defineProperty(t,"copyNode",{value:function(e){return Object.assign(t.newNode(),e)}}),Object.defineProperty(t,"copyEdge",{value:function(e){return Object.assign(t.newEdge(e.nodes[0],e.nodes[1]),e)}}),Object.defineProperty(t,"clear",{value:function(){return t.nodes=[],t.edges=[],t}}),Object.defineProperty(t,"removeEdge",{value:function(e){var i=t.edges.length;return t.edges=t.edges.filter(function(t){return t!==e}),Xi(void 0,i-t.edges.length)}}),Object.defineProperty(t,"removeEdgeBetween",{value:function(e,i){var n=t.edges.length;return t.edges=t.edges.filter(function(t){return(t.nodes[0]!==e||t.nodes[1]!==i)&&(t.nodes[0]!==i||t.nodes[1]!==e)}),Xi(void 0,n-t.edges.length)}}),Object.defineProperty(t,"removeNode",{value:function(i){var n=t.nodes.length,r=t.edges.length;return t.nodes=t.nodes.filter(function(e){return e!==i}),t.edges=t.edges.filter(function(t){return t.nodes[0]!==i&&t.nodes[1]!==i}),Xi(n-t.nodes.length,r-t.edges.length)}}),Object.defineProperty(t,"mergeNodes",{value:function(e,i){if(e!==i){t.edges.forEach(function(t){t.nodes[0]===i&&(t.nodes[0]=e),t.nodes[1]===i&&(t.nodes[1]=e)});var n=t.nodes.length;return t.nodes=t.nodes.filter(function(e){return e!==i}),Xi(n-t.nodes.length).join(r())}}}),Object.defineProperty(t,"removeIsolatedNodes",{value:function(){var n=Array(t.nodes.length).fill(!1);t.nodes.forEach(function(e,t){e._memo=t}),t.edges.forEach(function(t){n[t.nodes[0]._memo]=!0,n[t.nodes[1]._memo]=!0}),t.nodes.forEach(function(e){return delete e._memo});var r=t.nodes.length;return t.nodes=t.nodes.filter(function(e,t){return n[t]}),Xi().isolatedNodes(r-t.nodes.length)}}),Object.defineProperty(t,"removeCircularEdges",{value:i}),Object.defineProperty(t,"removeDuplicateEdges",{value:n}),Object.defineProperty(t,"clean",{value:r}),Object.defineProperty(t,"getEdgeConnectingNodes",{value:function(e,n){for(var r=t.edges,s=0;s<r.length;s+=1)if(r[s].nodes[0]===e&&r[s].nodes[1]===n||r[s].nodes[0]===n&&r[s].nodes[1]===e)return r[s]}}),Object.defineProperty(t,"getEdgesConnectingNodes",{value:function(i,n){return t.edges.filter(function(t){return t.nodes[0]===i&&t.nodes[1]===n||t.nodes[0]===n&&t.nodes[1]===i})}}),Object.defineProperty(t,"copy",{value:s}),Object.defineProperty(t,"eulerianPaths",{value:function(){var t=s();t.clean(),t.removeIsolatedNodes(),t.nodes.forEach(function(e,t){e._memo={index:t,adj:e.adjacent.edges.length}});for(var i=[],n=function(){var r=e();r.nodes=t.nodes.map(function(e){return Object.assign(r.types.node(r),e)}),r.nodes.forEach(function(e){e.graph=r});for(var s=t.nodes.slice().sort(function(e,t){return t._memo.adj-e._memo.adj})[0],a=s.adjacent.edges,o=function(){var e=a.filter(function(e){return 0==e.otherNode(s)._memo.adj%2});0===e.length&&(e=a);var i=e.sort(function(e,t){return t.otherNode(s)._memo.adj-e.otherNode(s)._memo.adj})[0],n=i.otherNode(s),o=Object.assign(r.types.edge(r,void 0,void 0),i);o.nodes=[r.nodes[s._memo.index],r.nodes[n._memo.index]],r.edges.push(o),s._memo.adj-=1,n._memo.adj-=1,t.edges=t.edges.filter(function(e){return e!==i}),s=n,a=s.adjacent.edges};0<a.length;)o();r.removeIsolatedNodes(),i.push(r)};0<t.edges.length;)n();return i}}),t},draw:Sc,fold:yd,convert:Yo,core:Nc,bases:b,math:qi.core,axiom:Xr,equivalent:qi.core.equivalent};return Object.keys(qi).filter(function(e){return"core"!==e}).forEach(function(e){jc[e]=qi[e]}),jc});
