/* Rabbit Ear v0.1.91 (c) Robby Kraft, MIT License */(function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self,e.RabbitEar=t())})(this,function(){'use strict';var $=Math.tan,Q=Math.floor,J=Math.acos,ee=Math.min,te=Math.max,ie=Math.PI,ne=Math.abs,re=Math.sin,se=Math.cos,ae=Math.atan2,ce=Math.sqrt,oe=Math.pow;function e(t){"@babel/helpers - typeof";return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function i(e,t){return s(e)||c(e,t)||l()}function n(e){return r(e)||a(e)||o()}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function s(e){if(Array.isArray(e))return e}function a(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function c(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var i=[],n=!0,r=!1,s=void 0;try{for(var a=e[Symbol.iterator](),c;!(n=(c=a.next()).done)&&(i.push(c.value),!(t&&i.length===t));n=!0);}catch(e){r=!0,s=e}finally{try{n||null==a["return"]||a["return"]()}finally{if(r)throw s}}return i}}function o(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function g(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return He(t)}function f(){var e=Array.from(arguments),t=e.filter(function(e){return!isNaN(e)}),i=e.filter(function(e){return e.constructor===Array});if(0===e.length)return{vector:[],origin:[]};if(!isNaN(e[0])&&4<=t.length)return{origin:[e[0],e[1]],vector:[e[2],e[3]]};if(0<i.length){if(1===i.length)return f.apply(void 0,n(i[0]));if(2===i.length)return{origin:[i[0][0],i[0][1]],vector:[i[1][0],i[1][1]]};if(4===i.length)return{origin:[i[0],i[1]],vector:[i[2],i[3]]}}if(e[0].constructor===Object){var r=[],s=[];return null==e[0].vector?null!=e[0].direction&&(r=We(e[0].direction)):r=We(e[0].vector),null==e[0].origin?null!=e[0].point&&(s=We(e[0].point)):s=We(e[0].origin),{origin:s,vector:r}}return{origin:[],vector:[]}}function p(){return f.apply(void 0,arguments)}function _(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];if(0!==i.length){if(1===i.length&&void 0!==i[0])return _.apply(void 0,n(i[0]));var s=Array.from(i),a=s.filter(function(e){return!isNaN(e)}),c=s.filter(function(t){return"object"===e(t)}).filter(function(e){return e.constructor===Array});return 4<=a.length?[[a[0],a[1]],[a[2],a[3]]]:2<=c.length&&!isNaN(c[0][0])?c:1!==c.length||isNaN(c[0][0][0])?void 0:c[0]}}function u(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return 0===t.length?void 0:1===t.length&&void 0!==t[0]?u.apply(void 0,n(t[0])):Array.from(t)}function h(e,t){var i=null==t?{}:t,n=function(e){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:tt;return this.compare_function(e,t)&&!0},r=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:tt;return this.compare_function(e,i)&&t>=-i},s=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:tt;return this.compare_function(e,i)&&t>=-i&&t<=1+i};return Object.defineProperty(i,"isParallel",{value:function(e){if(null==e.vector)throw new Error("isParallel() argument is missing a vector");var t=this.vector.length<e.vector.length,i=t?this.vector:e.vector,n=t?e.vector:this.vector;return lt(i,n)}}),Object.defineProperty(i,"isDegenerate",{value:function(){return dt(this.vector)}}),Object.defineProperty(i,"nearestPoint",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=We(t);return oi(ii(this.origin,this.vector,n,this.clip_function))}}),Object.defineProperty(i,"reflection",{value:function(){return di.makeReflection(this.vector,this.origin)}}),Object.defineProperty(i,"intersect",{value:function(e){var t=this;return jt(this.origin,this.vector,e.origin,e.vector,function(i,n){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:tt;return t.compare_function(i,r)&&e.compare_function(n,r)})}}),Object.defineProperty(i,"intersectLine",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=f(t);return jt(this.origin,this.vector,r.origin,r.vector,n.bind(this))}}),Object.defineProperty(i,"intersectRay",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=p(t);return jt(this.origin,this.vector,n.origin,n.vector,r.bind(this))}}),Object.defineProperty(i,"intersectSegment",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=g(t),r=[n[1][0]-n[0][0],n[1][1]-n[0][1]];return jt(this.origin,this.vector,n[0],r,s.bind(this))}}),Object.defineProperty(i,"bisectLine",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=f(t);return Kt(this.origin,this.vector,n.origin,n.vector)}}),Object.defineProperty(i,"bisectRay",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=p(t);return Kt(this.origin,this.vector,n.origin,n.vector)}}),Object.defineProperty(i,"bisectSegment",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=g(t),r=[n[1][0]-n[0][0],n[1][1]-n[0][1]];return Kt(this.origin,this.vector,n[0],r)}}),Object.freeze(i)}function m(e){var t={},i=e,n=function(){return $t(this.points)},r=function(){return this.points.map(function(e,t,i){var n=(t+i.length-1)%i.length,r=(t+1)%i.length,s=e,c=i[n].map(function(e,t){return e-s[t]}),a=i[r].map(function(e,t){return e-s[t]});return _i(a,c,s)})};return Object.defineProperty(t,"area",{value:n}),Object.defineProperty(t,"centroid",{value:function(){return Qt(this.points)}}),Object.defineProperty(t,"midpoint",{value:function(){return ue(this.points)}}),Object.defineProperty(t,"enclosingRectangle",{value:function(){return Jt(this.points)}}),Object.defineProperty(t,"contains",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return ft(We(t),this.points)}}),Object.defineProperty(t,"nearest",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=We(t),r=this.sides.map(function(e){return e.nearestPoint(n)}),s=1/0,a;return r.map(function(e){return me(n,e)}).forEach(function(e,t){e<s&&(s=e,a=t)}),{point:r[a],edge:this.sides[a]}}}),Object.defineProperty(t,"clipSegment",{value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=g(i),s=Xt(this.points,r[0],r[1]);return void 0===s?void 0:pi(s)}}),Object.defineProperty(t,"clipLine",{value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=f(i),s=Rt(this.points,r.origin,r.vector);return void 0===s?void 0:pi(s)}}),Object.defineProperty(t,"clipRay",{value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=f(i),s=qt(this.points,r.origin,r.vector);return void 0===s?void 0:pi(s)}}),Object.defineProperty(t,"split",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=f(t);return ni(this.points,r.origin,r.vector).map(function(e){return i(e)})}}),Object.defineProperty(t,"scale",{value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Qt(this.points),n=this.points.map(function(e){return[0,1].map(function(n,r){return e[r]-t[r]})}).map(function(n){return n.map(function(r,s){return t[s]+n[s]*e})});return i(n)}}),Object.defineProperty(t,"rotate",{value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Qt(this.points),n=this.points.map(function(i){var n=[i[0]-t[0],i[1]-t[1]],r=ce(oe(n[0],2)+oe(n[1],2)),s=ae(n[1],n[0]);return[t[0]+se(s+e)*r,t[1]+re(s+e)*r]});return i(n)}}),Object.defineProperty(t,"translate",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=We(t),s=this.points.map(function(e){return e.map(function(e,t){return e+r[t]})});return i(s)}}),Object.defineProperty(t,"transform",{value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Je(t),s=this.points.map(function(e){return oi(xe(r,e))});return i(s)}}),Object.defineProperty(t,"edges",{get:function(){return this.sides}}),Object.defineProperty(t,"sectors",{get:function(){return r.call(this)}}),Object.defineProperty(t,"signedArea",{value:n}),Object.freeze(t)}function v(e,t){for(var i=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").split("~::~"),n=i.length,r=!1,s=0,a="",c=null!=t&&"string"==typeof t?t:"\t",o=["\n"],d=0;100>d;d+=1)o.push(o[d]+c);for(var l=0;l<n;l+=1)-1<i[l].search(/<!/)?(a+=o[s]+i[l],r=!0,(-1<i[l].search(/-->/)||-1<i[l].search(/\]>/)||-1<i[l].search(/!DOCTYPE/))&&(r=!1)):-1<i[l].search(/-->/)||-1<i[l].search(/\]>/)?(a+=i[l],r=!1):/^<\w/.exec(i[l-1])&&/^<\/\w/.exec(i[l])&&/^<[\w:\-\.\,]+/.exec(i[l-1])==/^<\/[\w:\-\.\,]+/.exec(i[l])[0].replace("/","")?(a+=i[l],r||(s-=1)):-1<i[l].search(/<\w/)&&-1===i[l].search(/<\//)&&-1===i[l].search(/\/>/)?a=r?a+=i[l]:a+=o[s++]+i[l]:-1<i[l].search(/<\w/)&&-1<i[l].search(/<\//)?a=r?a+=i[l]:a+=o[s]+i[l]:-1<i[l].search(/<\//)?a=r?a+=i[l]:a+=o[--s]+i[l]:-1<i[l].search(/\/>/)?a=r?a+=i[l]:a+=o[s]+i[l]:a+=-1<i[l].search(/<\?/)?o[s]+i[l]:-1<i[l].search(/xmlns\:/)||-1<i[l].search(/xmlns\=/)?o[s]+i[l]:i[l];return"\n"===a[0]?a.slice(1):a}function k(e,t){for(var i=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").split("~::~"),n=i.length,r=!1,s=0,a="",c=null!=t&&"string"==typeof t?t:"\t",o=["\n"],d=0;100>d;d+=1)o.push(o[d]+c);for(var l=0;l<n;l+=1)-1<i[l].search(/<!/)?(a+=o[s]+i[l],r=!0,(-1<i[l].search(/-->/)||-1<i[l].search(/\]>/)||-1<i[l].search(/!DOCTYPE/))&&(r=!1)):-1<i[l].search(/-->/)||-1<i[l].search(/\]>/)?(a+=i[l],r=!1):/^<\w/.exec(i[l-1])&&/^<\/\w/.exec(i[l])&&/^<[\w:\-\.\,]+/.exec(i[l-1])==/^<\/[\w:\-\.\,]+/.exec(i[l])[0].replace("/","")?(a+=i[l],r||(s-=1)):-1<i[l].search(/<\w/)&&-1===i[l].search(/<\//)&&-1===i[l].search(/\/>/)?a=r?a+=i[l]:a+=o[s++]+i[l]:-1<i[l].search(/<\w/)&&-1<i[l].search(/<\//)?a=r?a+=i[l]:a+=o[s]+i[l]:-1<i[l].search(/<\//)?a=r?a+=i[l]:a+=o[--s]+i[l]:-1<i[l].search(/\/>/)?a=r?a+=i[l]:a+=o[s]+i[l]:a+=-1<i[l].search(/<\?/)?o[s]+i[l]:-1<i[l].search(/xmlns\:/)||-1<i[l].search(/xmlns\=/)?o[s]+i[l]:i[l];return"\n"===a[0]?a.slice(1):a}function E(e){var t=[];return e.replace(Es,function(e,i,n){var r=i.toLowerCase();for(n=P(n),"m"===r&&2<n.length&&(t.push([i].concat(n.splice(0,2))),r="l",i="m"===i?"l":"L");0<=n.length;){if(n.length===bs[r])return n.unshift(i),t.push(n);if(n.length<bs[r])throw new Error("malformed path data");t.push([i].concat(n.splice(0,bs[r])))}}),t}function P(e){var t=e.match(Ps);return t?t.map(Number):[]}function A(e,t,i,n,r,s,a,c){return new w(e,t,i,n,r,s,a,c)}function w(e,i,n,r,s,a,c,o){this.a={x:e,y:i},this.b={x:n,y:r},this.c={x:s,y:a},this.d={x:c,y:o},null!==c&&void 0!==c&&null!==o&&void 0!==o?(this.getArcLength=t,this.getPoint=C,this.getDerivative=L):(this.getArcLength=M,this.getPoint=j,this.getDerivative=N),this.init()}function N(e,i,n){return{x:2*(1-n)*(e[1]-e[0])+2*n*(e[2]-e[1]),y:2*(1-n)*(i[1]-i[0])+2*n*(i[2]-i[1])}}function L(e,i,n){var t=j([3*(e[1]-e[0]),3*(e[2]-e[1]),3*(e[3]-e[2])],[3*(i[1]-i[0]),3*(i[2]-i[1]),3*(i[3]-i[2])],n);return t}function O(e,i,n,r,s){for(var a=1,c=e/i,o=(e-n(r,s,c))/i,d=0;.001<a;){var l=n(r,s,c+o),g=n(r,s,c-o),f=ne(e-l)/i,p=ne(e-g)/i;if(f<a?(a=f,c+=o):p<a?(a=p,c-=o):o/=2,d++,500<d)break}return c}function j(e,i,n){var t=(1-n)*(1-n)*e[0]+2*(1-n)*n*e[1]+n*n*e[2],r=(1-n)*(1-n)*i[0]+2*(1-n)*n*i[1]+n*n*i[2];return{x:t,y:r}}function C(e,i,n){var t=(1-n)*(1-n)*(1-n)*e[0]+3*(1-n)*(1-n)*n*e[1]+3*(1-n)*n*n*e[2]+n*n*n*e[3],r=(1-n)*(1-n)*(1-n)*i[0]+3*(1-n)*(1-n)*n*i[1]+3*(1-n)*n*n*i[2]+n*n*n*i[3];return{x:t,y:r}}function M(e,i,n){var r=Math.log;void 0===n&&(n=1);var s=e[0]-2*e[1]+e[2],a=i[0]-2*i[1]+i[2],c=2*e[1]-2*e[0],o=2*i[1]-2*i[0],d=4*(s*s+a*a);if(0===d)return n*ce(oe(e[2]-e[0],2)+oe(i[2]-i[0],2));var l=4*(s*c+a*o)/(2*d),g=n+l,f=(c*c+o*o)/d-l*l,p=0<g*g+f?ce(g*g+f):0,_=0<l*l+f?ce(l*l+f):0,u=0===l+ce(l*l+f)?0:f*r(ne((g+p)/(l+_)));return ce(d)/2*(g*p-l*_+u)}function T(e,t){return ws[e][t]}function I(e,i,t){var r=t.length-1,n,s,a;if(0==r)return 0;if(0===e){for(s=0,a=0;a<=r;a++)s+=T(r,a)*oe(1-i,r-a)*oe(i,a)*t[a];return s}for(n=Array(r),a=0;a<r;a++)n[a]=r*(t[a+1]-t[a]);return I(e-1,i,n)}function F(e,i,n){var t=I(1,n,e),r=I(1,n,i);return ce(t*t+r*r)}function t(e,n,r){var s,a,c,o;void 0===r&&(r=1);for(s=r/2,a=0,c=0;20>c;c++)o=s*Ss[20][c]+s,a+=As[20][c]*F(e,n,o);return s*a}function z(e,t,i,n,r,s,a,c,o){return new B(e,t,i,n,r,s,a,c,o)}function B(e,i,n,r,s,a,c,o,d){this.x0=e,this.y0=i,this.rx=n,this.ry=r,this.xAxisRotate=s,this.LargeArcFlag=a,this.SweepFlag=c,this.x1=o,this.y1=d;var t=D(300,function(l){return V({x:e,y:i},n,r,s,a,c,{x:o,y:d},l)});this.length=t.arcLength}function V(e,i,n,r,s,a,c,o){i=ne(i),n=ne(n),r=R(r,360);var t=q(r);if(e.x===c.x&&e.y===c.y)return e;if(0===i||0===n)return this.pointOnLine(e,c,o);var d=(e.x-c.x)/2,l=(e.y-c.y)/2,g={x:se(t)*d+re(t)*l,y:-re(t)*d+se(t)*l},f=oe(g.x,2)/oe(i,2)+oe(g.y,2)/oe(n,2);1<f&&(i=ce(f)*i,n=ce(f)*n);var p=oe(i,2)*oe(n,2)-oe(i,2)*oe(g.y,2)-oe(n,2)*oe(g.x,2),_=oe(i,2)*oe(g.y,2)+oe(n,2)*oe(g.x,2),u=p/_;u=0>u?0:u;var h=(s===a?-1:1)*ce(u),m={x:h*(i*g.y/n),y:h*(-(n*g.x)/i)},v={x:se(t)*m.x-re(t)*m.y+(e.x+c.x)/2,y:re(t)*m.x+se(t)*m.y+(e.y+c.y)/2},y={x:(g.x-m.x)/i,y:(g.y-m.y)/n},k=G({x:1,y:0},y),x={x:(-g.x-m.x)/i,y:(-g.y-m.y)/n},b=G(y,x);!a&&0<b?b-=2*ie:a&&0>b&&(b+=2*ie),b%=2*ie;var E=k+b*o,P=i*se(E),S=n*re(E),A={x:se(t)*P-re(t)*S+v.x,y:re(t)*P+se(t)*S+v.y};return A.ellipticalArcStartAngle=k,A.ellipticalArcEndAngle=k+b,A.ellipticalArcAngle=E,A.ellipticalArcCenter=v,A.resultantRx=i,A.resultantRy=n,A}function D(e,n){e=e?e:500;for(var r=0,s=[],a=[],c=n(0),o=0,d,l;o<e;o++)l=Y(o*(1/e),0,1),d=n(l),r+=X(c,d),a.push([c,d]),s.push({t:l,arcLength:r}),c=d;return d=n(1),a.push([c,d]),r+=X(c,d),s.push({t:1,arcLength:r}),{arcLength:r,arcLengthMap:s,approximationLines:a}}function R(e,t){return(e%t+t)%t}function q(e){return e*(ie/180)}function X(e,t){return ce(oe(t.x-e.x,2)+oe(t.y-e.y,2))}function Y(e,t,i){return ee(te(e,t),i)}function G(e,t){var i=e.x*t.x+e.y*t.y,r=ce((oe(e.x,2)+oe(e.y,2))*(oe(t.x,2)+oe(t.y,2))),n=0>e.x*t.y-e.y*t.x?-1:1,s=n*J(i/r);return s}function Z(e,t,i,n){return new K(e,t,i,n)}function K(e,t,i,n){this.x0=e,this.x1=t,this.y0=i,this.y1=n}function W(e){function t(e){if(!e)return null;for(var a=E(e),c=[0,0],o=[0,0],d=0,l,g;d<a.length;d++)"M"===a[d][0]?(c=[a[d][1],a[d][2]],g=[c[0],c[1]],s.push(null)):"m"===a[d][0]?(c=[a[d][1]+c[0],a[d][2]+c[1]],g=[c[0],c[1]],s.push(null)):"L"===a[d][0]?(n+=ce(oe(c[0]-a[d][1],2)+oe(c[1]-a[d][2],2)),s.push(new Z(c[0],a[d][1],c[1],a[d][2])),c=[a[d][1],a[d][2]]):"l"===a[d][0]?(n+=ce(oe(a[d][1],2)+oe(a[d][2],2)),s.push(new Z(c[0],a[d][1]+c[0],c[1],a[d][2]+c[1])),c=[a[d][1]+c[0],a[d][2]+c[1]]):"H"===a[d][0]?(n+=ne(c[0]-a[d][1]),s.push(new Z(c[0],a[d][1],c[1],c[1])),c[0]=a[d][1]):"h"===a[d][0]?(n+=ne(a[d][1]),s.push(new Z(c[0],c[0]+a[d][1],c[1],c[1])),c[0]=a[d][1]+c[0]):"V"===a[d][0]?(n+=ne(c[1]-a[d][1]),s.push(new Z(c[0],c[0],c[1],a[d][1])),c[1]=a[d][1]):"v"===a[d][0]?(n+=ne(a[d][1]),s.push(new Z(c[0],c[0],c[1],c[1]+a[d][1])),c[1]=a[d][1]+c[1]):"z"===a[d][0]||"Z"===a[d][0]?(n+=ce(oe(g[0]-c[0],2)+oe(g[1]-c[1],2)),s.push(new Z(c[0],g[0],c[1],g[1])),c=[g[0],g[1]]):"C"===a[d][0]?(l=new A(c[0],c[1],a[d][1],a[d][2],a[d][3],a[d][4],a[d][5],a[d][6]),n+=l.getTotalLength(),c=[a[d][5],a[d][6]],s.push(l)):"c"===a[d][0]?(l=new A(c[0],c[1],c[0]+a[d][1],c[1]+a[d][2],c[0]+a[d][3],c[1]+a[d][4],c[0]+a[d][5],c[1]+a[d][6]),0<l.getTotalLength()?(n+=l.getTotalLength(),s.push(l),c=[a[d][5]+c[0],a[d][6]+c[1]]):s.push(new Z(c[0],c[0],c[1],c[1]))):"S"===a[d][0]?(l=0<d&&-1<["C","c","S","s"].indexOf(a[d-1][0])?new A(c[0],c[1],2*c[0]-a[d-1][a[d-1].length-4],2*c[1]-a[d-1][a[d-1].length-3],a[d][1],a[d][2],a[d][3],a[d][4]):new A(c[0],c[1],c[0],c[1],a[d][1],a[d][2],a[d][3],a[d][4]),n+=l.getTotalLength(),c=[a[d][3],a[d][4]],s.push(l)):"s"===a[d][0]?(l=0<d&&-1<["C","c","S","s"].indexOf(a[d-1][0])?new A(c[0],c[1],c[0]+l.d.x-l.c.x,c[1]+l.d.y-l.c.y,c[0]+a[d][1],c[1]+a[d][2],c[0]+a[d][3],c[1]+a[d][4]):new A(c[0],c[1],c[0],c[1],c[0]+a[d][1],c[1]+a[d][2],c[0]+a[d][3],c[1]+a[d][4]),n+=l.getTotalLength(),c=[a[d][3]+c[0],a[d][4]+c[1]],s.push(l)):"Q"===a[d][0]?(l=c[0]==a[d][1]&&c[1]==a[d][2]?new Z(a[d][1],a[d][3],a[d][2],a[d][4]):new A(c[0],c[1],a[d][1],a[d][2],a[d][3],a[d][4]),n+=l.getTotalLength(),s.push(l),c=[a[d][3],a[d][4]],o=[a[d][1],a[d][2]]):"q"===a[d][0]?(l=0==a[d][1]&&0==a[d][2]?new Z(c[0]+a[d][1],c[0]+a[d][3],c[1]+a[d][2],c[1]+a[d][4]):new A(c[0],c[1],c[0]+a[d][1],c[1]+a[d][2],c[0]+a[d][3],c[1]+a[d][4]),n+=l.getTotalLength(),o=[c[0]+a[d][1],c[1]+a[d][2]],c=[a[d][3]+c[0],a[d][4]+c[1]],s.push(l)):"T"===a[d][0]?(l=0<d&&-1<["Q","q","T","t"].indexOf(a[d-1][0])?new A(c[0],c[1],2*c[0]-o[0],2*c[1]-o[1],a[d][1],a[d][2]):new Z(c[0],a[d][1],c[1],a[d][2]),s.push(l),n+=l.getTotalLength(),o=[2*c[0]-o[0],2*c[1]-o[1]],c=[a[d][1],a[d][2]]):"t"===a[d][0]?(l=0<d&&-1<["Q","q","T","t"].indexOf(a[d-1][0])?new A(c[0],c[1],2*c[0]-o[0],2*c[1]-o[1],c[0]+a[d][1],c[1]+a[d][2]):new Z(c[0],c[0]+a[d][1],c[1],c[1]+a[d][2]),n+=l.getTotalLength(),o=[2*c[0]-o[0],2*c[1]-o[1]],c=[a[d][1]+c[0],a[d][2]+c[0]],s.push(l)):"A"===a[d][0]?(l=new z(c[0],c[1],a[d][1],a[d][2],a[d][3],a[d][4],a[d][5],a[d][6],a[d][7]),n+=l.getTotalLength(),c=[a[d][6],a[d][7]],s.push(l)):"a"===a[d][0]&&(l=new z(c[0],c[1],a[d][1],a[d][2],a[d][3],a[d][4],a[d][5],c[0]+a[d][6],c[1]+a[d][7]),n+=l.getTotalLength(),c=[c[0]+a[d][6],c[1]+a[d][7]],s.push(l)),r.push(n);return t}var n=0,r=[],s=[];t.getTotalLength=function(){return n},t.getPointAtLength=function(e){var t=a(e);return s[t.i].getPointAtLength(t.fraction)},t.getTangentAtLength=function(e){var t=a(e);return s[t.i].getTangentAtLength(t.fraction)},t.getPropertiesAtLength=function(e){var t=a(e);return s[t.i].getPropertiesAtLength(t.fraction)},t.getParts=function(){for(var e=[],t=0;t<s.length;t++)if(null!=s[t]){var n={};n.start=s[t].getPointAtLength(0),n.end=s[t].getPointAtLength(r[t]-r[t-1]),n.length=r[t]-r[t-1],function(e){n.getPointAtLength=function(t){return e.getPointAtLength(t)},n.getTangentAtLength=function(t){return e.getTangentAtLength(t)},n.getPropertiesAtLength=function(t){return e.getPropertiesAtLength(t)}}(s[t]),e.push(n)}return e};var a=function(e){0>e?e=0:e>n&&(e=n);for(var t=r.length-1;r[t]>=e&&0<r[t];)t--;return t++,{fraction:e-r[t-1],i:t}};return t(e)}function H(e,t){for(var i=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").split("~::~"),n=i.length,r=!1,s=0,a="",c=null!=t&&"string"==typeof t?t:"\t",o=["\n"],d=0;100>d;d+=1)o.push(o[d]+c);for(var l=0;l<n;l+=1)-1<i[l].search(/<!/)?(a+=o[s]+i[l],r=!0,(-1<i[l].search(/-->/)||-1<i[l].search(/\]>/)||-1<i[l].search(/!DOCTYPE/))&&(r=!1)):-1<i[l].search(/-->/)||-1<i[l].search(/\]>/)?(a+=i[l],r=!1):/^<\w/.exec(i[l-1])&&/^<\/\w/.exec(i[l])&&/^<[\w:\-\.\,]+/.exec(i[l-1])==/^<\/[\w:\-\.\,]+/.exec(i[l])[0].replace("/","")?(a+=i[l],r||(s-=1)):-1<i[l].search(/<\w/)&&-1===i[l].search(/<\//)&&-1===i[l].search(/\/>/)?a=r?a+=i[l]:a+=o[s++]+i[l]:-1<i[l].search(/<\w/)&&-1<i[l].search(/<\//)?a=r?a+=i[l]:a+=o[s]+i[l]:-1<i[l].search(/<\//)?a=r?a+=i[l]:a+=o[--s]+i[l]:-1<i[l].search(/\/>/)?a=r?a+=i[l]:a+=o[s]+i[l]:a+=-1<i[l].search(/<\?/)?o[s]+i[l]:-1<i[l].search(/xmlns\:/)||-1<i[l].search(/xmlns\=/)?o[s]+i[l]:i[l];return"\n"===a[0]?a.slice(1):a}var de="undefined"!=typeof window&&"undefined"!=typeof window.document,le="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,ge="object"===("undefined"==typeof self?"undefined":e(self))&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,fe=function(e){var t=e.map(function(e){return e*e}).reduce(function(e,t){return e+t},0);return ce(t)},pe=function(e){var t=fe(e);return 0===t?e:e.map(function(e){return e/t})},_e=function(e,t){return e.map(function(n,r){return e[r]*t[r]}).reduce(function(e,t){return e+t},0)},ue=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=0<t.length?t[0].length:0,r=Array(n).fill(0);return t.forEach(function(e){return r.forEach(function(t,n){r[n]+=e[n]||0})}),r.map(function(e){return e/t.length})},he=function(e,t){return[e[1]*t[2]-e[2]*t[1],e[0]*t[2]-e[2]*t[0],e[0]*t[1]-e[1]*t[0]]},me=function(e,t){var i=e[0]-t[0],n=e[1]-t[1];return ce(i*i+n*n)},ve=function(e,t){for(var n=e.length,r=0,s=0;s<n;s+=1)r+=oe(e[s]-t[s],2);return ce(r)},ye=function(e,t){return e.map(function(n,r){return(e[r]+t[r])/2})},ke=Object.freeze({__proto__:null,magnitude:fe,normalize:pe,dot:_e,average:ue,cross2:function(e,t){return[e[0]*t[1],e[1]*t[0]]},cross3:he,distance2:me,distance3:function(t,i){var n=t[0]-i[0],r=t[1]-i[1],s=t[2]-i[2];return ce(n*n+r*r+s*s)},distance:ve,midpoint2:ye}),xe=function(e,t){return[e[0]*t[0]+e[2]*t[1]+e[4],e[1]*t[0]+e[3]*t[1]+e[5]]},be=function(e,t,i){return{origin:[e[0]*t[0]+e[2]*t[1]+e[4],e[1]*t[0]+e[3]*t[1]+e[5]],vector:[e[0]*i[0]+e[2]*i[1],e[1]*i[0]+e[3]*i[1]]}},Ee=function(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]},Pe=function(e){return e[0]*e[3]-e[1]*e[2]},Se=function(e){var t=Pe(e);return 1e-6>ne(t)||isNaN(t)||!isFinite(e[4])||!isFinite(e[5])?void 0:[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[3]*e[4])/t,(e[1]*e[4]-e[0]*e[5])/t]},Ae=function(e,t){return[1,0,0,1,e,t]},we=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[0,0];return[e,0,0,t,e*-i[0]+i[0],t*-i[1]+i[1]]},Ne=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0],i=se(e),n=re(e);return[i,n,-n,i,t[0],t[1]]},Le=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0],i=ae(e[1],e[0]),n=se(i),r=re(i),s=se(-i),o=re(-i),l=n*s+r*o,a=n*-o+r*s,g=r*s+-n*o,c=r*-o+-n*s,d=t[0]+l*-t[0]+-t[1]*g,f=t[1]+a*-t[0]+-t[1]*c;return[l,a,g,c,d,f]},Oe=Object.freeze({__proto__:null,multiply_matrix2_vector2:xe,multiply_matrix2_line2:be,multiply_matrices2:Ee,matrix2_determinant:Pe,invert_matrix2:Se,make_matrix2_translate:Ae,make_matrix2_scale:we,make_matrix2_rotate:Ne,make_matrix2_reflection:Le}),je=function(e,t){return[e[0]*t[0]+e[3]*t[1]+e[6]*t[2]+e[9],e[1]*t[0]+e[4]*t[1]+e[7]*t[2]+e[10],e[2]*t[0]+e[5]*t[1]+e[8]*t[2]+e[11]]},Ce=function(e,t,i){return{origin:[e[0]*t[0]+e[3]*t[1]+e[6]*t[2]+e[9],e[1]*t[0]+e[4]*t[1]+e[7]*t[2]+e[10],e[2]*t[0]+e[5]*t[1]+e[8]*t[2]+e[11]],vector:[e[0]*i[0]+e[3]*i[1]+e[6]*i[2],e[1]*i[0]+e[4]*i[1]+e[7]*i[2],e[2]*i[0]+e[5]*i[1]+e[8]*i[2]]}},Me=function(e,t){return[e[0]*t[0]+e[3]*t[1]+e[6]*t[2],e[1]*t[0]+e[4]*t[1]+e[7]*t[2],e[2]*t[0]+e[5]*t[1]+e[8]*t[2],e[0]*t[3]+e[3]*t[4]+e[6]*t[5],e[1]*t[3]+e[4]*t[4]+e[7]*t[5],e[2]*t[3]+e[5]*t[4]+e[8]*t[5],e[0]*t[6]+e[3]*t[7]+e[6]*t[8],e[1]*t[6]+e[4]*t[7]+e[7]*t[8],e[2]*t[6]+e[5]*t[7]+e[8]*t[8],e[0]*t[9]+e[3]*t[10]+e[6]*t[11]+e[9],e[1]*t[9]+e[4]*t[10]+e[7]*t[11]+e[10],e[2]*t[9]+e[5]*t[10]+e[8]*t[11]+e[11]]},Te=function(e){return e[0]*e[4]*e[8]-e[0]*e[7]*e[5]-e[3]*e[1]*e[8]+e[3]*e[7]*e[2]+e[6]*e[1]*e[5]-e[6]*e[4]*e[2]},Ie=function(e){var t=Te(e);if(!(1e-6>ne(t))&&!isNaN(t)&&isFinite(e[9])&&isFinite(e[10])&&isFinite(e[11])){var i=[e[4]*e[8]-e[7]*e[5],-e[1]*e[8]+e[7]*e[2],e[1]*e[5]-e[4]*e[2],-e[3]*e[8]+e[6]*e[5],e[0]*e[8]-e[6]*e[2],-e[0]*e[5]+e[3]*e[2],e[3]*e[7]-e[6]*e[4],-e[0]*e[7]+e[6]*e[1],e[0]*e[4]-e[3]*e[1],-e[3]*e[7]*e[11]+e[3]*e[8]*e[10]+e[6]*e[4]*e[11]-e[6]*e[5]*e[10]-e[9]*e[4]*e[8]+e[9]*e[5]*e[7],e[0]*e[7]*e[11]-e[0]*e[8]*e[10]-e[6]*e[1]*e[11]+e[6]*e[2]*e[10]+e[9]*e[1]*e[8]-e[9]*e[2]*e[7],-e[0]*e[4]*e[11]+e[0]*e[5]*e[10]+e[3]*e[1]*e[11]-e[3]*e[2]*e[10]-e[9]*e[1]*e[5]+e[9]*e[2]*e[4]];return i.map(function(e){return e*(1/t)})}},ze=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return[1,0,0,0,1,0,0,0,1,e,t,i]},Fe=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0,0],i=se(e),n=re(e);return[1,0,0,0,i,n,0,-n,i,t[0]||0,t[1]||0,t[2]||0]},Be=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0,0],i=se(e),n=re(e);return[i,0,-n,0,1,0,n,0,i,t[0]||0,t[1]||0,t[2]||0]},Ve=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0,0],i=se(e),n=re(e);return[i,n,0,-n,i,0,0,0,1,t[0]||0,t[1]||0,t[2]||0]},De=function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0,1],r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[0,0,0],s=pe(n),o=Array.from([,,,]).map(function(e,t){return r[t]||0}),l=i(s,3),g=l[0],a=l[1],f=l[2],c=se(e),p=re(e),_=ce(s[1]*s[1]+s[2]*s[2]),d=1e-6>ne(_)?0:a/_,u=1e-6>ne(_)?1:f/_,h=[1,0,0,0,1,0,0,0,1,o[0],o[1],o[2]],t=[1,0,0,0,1,0,0,0,1,-o[0],-o[1],-o[2]];return Me(t,Me([1,0,0,0,u,-d,0,d,u,0,0,0],Me([_,0,-g,0,1,0,g,0,_,0,0,0],Me([c,p,0,-p,c,0,0,0,1,0,0,0],Me([_,0,g,0,1,0,-g,0,_,0,0,0],Me([1,0,0,0,u,d,0,-d,u,0,0,0],h))))))},Re=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0,0];return[e,0,0,0,e,0,0,0,e,e*-t[0]+t[0],e*-t[1]+t[1],e*-t[2]+t[2]]},qe=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0],i=ae(e[1],e[0]),n=se(i),r=re(i),s=se(-i),o=re(-i),l=n*s+r*o,a=n*-o+r*s,g=r*s+-n*o,c=r*-o+-n*s,d=t[0]+l*-t[0]+-t[1]*g,f=t[1]+a*-t[0]+-t[1]*c;return[l,a,0,g,c,0,0,0,0,d,f,0]},Xe=Object.freeze({__proto__:null,multiply_matrix3_vector3:je,multiply_matrix3_line3:Ce,multiply_matrices3:Me,matrix3_determinant:Te,invert_matrix3:Ie,make_matrix3_translate:ze,make_matrix3_rotateX:Fe,make_matrix3_rotateY:Be,make_matrix3_rotateZ:Ve,make_matrix3_rotate:De,make_matrix3_scale:Re,make_matrix3_reflectionZ:qe}),Ue=function(e){var t="".concat(e).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return t?te(0,(t[1]?t[1].length:0)-(t[2]?+t[2]:0)):0},Ye=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:15,i=parseFloat(e.toFixed(t));return Ue(i)===ee(t,Ue(e))?e:i},Ge=function(e){return null!=e&&"function"==typeof e[Symbol.iterator]},Ze=function e(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];switch(i.length){case void 0:case 0:return i;case 1:return Ge(i[0])&&"string"!=typeof i[0]?e.apply(void 0,n(i[0])):[i[0]];default:return Array.from(i).map(function(t){return Ge(t)?n(e(t)):t}).reduce(function(e,t){return e.concat(t)},[]);}},Ke=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=t;1===r.length&&r[0].length;){var s=r,a=i(s,1);r=a[0]}return r},We=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=Ze(t).filter(function(e){return void 0!==e});if(void 0!==n)return 0===n.length?void 0:(isNaN(n[0].x)||(n=["x","y","z"].map(function(e){return n[0][e]}).filter(function(e){return void 0!==e})),n.filter(function(e){return"number"==typeof e}))},He=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return Ke(t).map(function(e){return We(e)})},$e=[1,0,0,1,0,0],Qe=[1,0,0,0,1,0,0,0,1,0,0,0],Je=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=We(t);return void 0===r?void 0:6===r.length?r:6<r.length?[r[0],r[1],r[2],r[3],r[4],r[5]]:6>r.length?$e.map(function(e,t){return r[t]||e}):void 0},et=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=We(t);if(void 0!==r){switch(r.length){case 4:return[r[0],r[1],0,0,r[2],r[3],0,0,0,0,1,0,0,0,0,1];case 6:return[r[0],r[1],0,r[2],r[3],0,0,0,1,r[4],r[5],0];case 9:return[r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],0,0,0];case 12:return r;case 16:return[r[0],r[1],r[2],r[4],r[5],r[6],r[8],r[9],r[10],r[12],r[13],r[14]];}return 12<r.length?[r[0],r[1],r[2],r[4],r[5],r[6],r[8],r[9],r[10],r[12],r[13],r[14]]:12>r.length?Qe.map(function(e,t){return r[t]||e}):void 0}},tt=1e-6,it=function(e,t){return Array.from(Array(e.length-1)).map(function(n,r){return t(e[0],e[r+1])}).reduce(function(e,t){return e&&t},!0)},nt=function e(){var t=He.apply(void 0,arguments);if(0===t.length)return!1;if(1===t.length&&void 0!==t[0])return e.apply(void 0,n(t[0]));var i=t[0].length,r=Array.from(Array(i));return Array.from(Array(t.length-1)).map(function(e,n){return r.map(function(e,i){return ne(t[n][i]-t[n+1][i])<tt}).reduce(function(e,t){return e&&t},!0)}).reduce(function(e,t){return e&&t},!0)&&Array.from(Array(t.length-1)).map(function(e,n){return t[0].length===t[n+1].length}).reduce(function(e,t){return e&&t},!0)},rt=function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];var s=Ke(i);if(1>s.length)return!1;var a=e(s[0]);if("undefined"===a)return!1;switch(s[0].constructor===Array&&(s=s.map(function(e){return Ke(e)})),a){case"number":return it(s,function(e,t){return ne(e-t)<tt});case"boolean":return it(s,function(e,t){return e===t});case"string":return it(s,function(e,t){return e===t});case"object":return s[0].constructor===Array?nt.apply(void 0,n(s)):(console.warn("comparing array of objects for equivalency by slow JSON.stringify with no epsilon check"),it(s,function(e,t){return JSON.stringify(e)===JSON.stringify(t)}));default:console.warn("incapable of determining comparison method");}return!1},st=Object.freeze({__proto__:null,EPSILON:tt,equivalent_numbers:function e(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return 0!==i.length&&(1===i.length&&void 0!==i[0]?e.apply(void 0,n(i[0])):it(i,function(e,t){return ne(e-t)<tt}))},equivalent_vectors:nt,equivalent:rt}),at=function(e,t,i,n,r){var s=function(e,t){return e[0]*t[1]-t[0]*e[1]},a=s(t,n),c=s([i[0]-e[0],i[1]-e[1]],n),o=s([e[0]-i[0],e[1]-i[1]],t);if(ne(a)<tt)return!1;return r(c/a,o/-a)},ct=function(e,t){return e>=-tt&&e<=1+tt&&t>=-tt&&t<=1+tt},ot=function(e,t,i,n){var r=[t[0]-e[0],t[1]-e[1]],s=[n[0]-i[0],n[1]-i[1]];return at(e,r,i,s,ct)},dt=function(e){return ne(e.reduce(function(e,t){return e+t},0))<tt},lt=function(e,t){return 1-ne(_e(pe(e),pe(t)))<tt},gt=function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:tt,r=[i[0]-e[0],i[1]-e[1]],s=r[0]*t[1]-r[1]*t[0];return ne(s)<n},ft=function(e,t){for(var n=!1,r=0,s=t.length-1;r<t.length;s=r++)t[r][1]>e[1]!=t[s][1]>e[1]&&e[0]<(t[s][0]-t[r][0])*(e[1]-t[r][1])/(t[s][1]-t[r][1])+t[r][0]&&(n=!n);return n},pt=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:tt;return!!(null!=t&&0<t.length)&&t.map(function(t,r,i){var s=i[(r+1)%i.length],c=[s[0]-t[0],s[1]-t[1]],a=[e[0]-t[0],e[1]-t[1]];return c[0]*a[1]-c[1]*a[0]>-n}).map(function(e,t,i){return e===i[0]}).reduce(function(e,t){return e&&t},!0)},_t=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:tt;return!!(null!=t&&0<t.length)&&t.map(function(t,r,i){var s=i[(r+1)%i.length],c=[s[0]-t[0],s[1]-t[1]],a=[e[0]-t[0],e[1]-t[1]];return c[0]*a[1]-c[1]*a[0]>n}).map(function(e,t,i){return e===i[0]}).reduce(function(e,t){return e&&t},!0)},ut=function(e,t){for(var n=e.map(function(e,t,i){return[e,i[(t+1)%i.length]]}),r=t.map(function(e,t,i){return[e,i[(t+1)%i.length]]}),s=0;s<n.length;s+=1)for(var a=0;a<r.length;a+=1)if(ot(n[s][0],n[s][1],r[a][0],r[a][1]))return!0;return!!ft(t[0],e)||!!ft(e[0],t)},ht=Object.freeze({__proto__:null,overlap_function:at,segment_segment_overlap:ot,degenerate:dt,parallel:lt,point_on_line:gt,point_on_segment:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:tt,r=[e[0]-t[0],e[1]-t[1]],s=[e[0]-i[0],e[1]-i[1]],a=[t[0]-i[0],t[1]-i[1]],c=ce(r[0]*r[0]+r[1]*r[1]),o=ce(s[0]*s[0]+s[1]*s[1]),d=ce(a[0]*a[0]+a[1]*a[1]);return ne(c-o-d)<n},point_in_poly:ft,point_in_convex_poly:pt,point_in_convex_poly_exclusive:_t,convex_polygons_overlap:ut,convex_polygon_is_enclosed:function(e,t){var i=t.map(function(t){return pt(t,e)}).reduce(function(e,t){return e||t},!1);return!i&&void 0},convex_polygons_enclose:function(e,t){var i=t.map(function(t){return pt(t,e)}).reduce(function(e,t){return e||t},!1),n=e.map(function(t){return pt(t,e)}).reduce(function(e,t){return e&&t},!0);return!i&&n},is_counter_clockwise_between:function(e,t,i){for(;i<t;)i+=2*ie;for(;e<t;)e+=2*ie;return e<i}}),mt=function(){return!0},vt=function(e,t){return t>=-tt},yt=function(e,t){return t>=-tt&&t<=1+tt},kt=function(e,t){return e>=-tt&&t>=-tt},xt=function(e,t){return e>=-tt&&t>=-tt&&t<=1+tt},bt=function(e,t){return e>=-tt&&e<=1+tt&&t>=-tt&&t<=1+tt},Et=function(e,t){return t>tt},Pt=function(e,t){return t>tt&&t<1-tt},St=function(e,t){return e>tt&&t>tt},At=function(e,t){return e>tt&&t>tt&&t<1-tt},wt=function(e,t){return e>tt&&e<1-tt&&t>tt&&t<1-tt},Nt=function(e){return e},Lt=function(e){return e<-tt?0:e},Ot=function(e){return e<-tt?0:e>1+tt?1:e},jt=function(e,t,i,n,r){function s(e,t){return e[0]*t[1]-t[0]*e[1]}var a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:tt,c=s(t,n);if(!(ne(c)<a)){var o=s([i[0]-e[0],i[1]-e[1]],n),d=s([e[0]-i[0],e[1]-i[1]],t),l=o/c;return r(l,d/-c,a)?[e[0]+t[0]*l,e[1]+t[1]*l]:void 0}},Ct=function(e,t,i,n,r){var s=[n[0]-i[0],n[1]-i[1]];return jt(e,t,i,s,yt,r)},Mt=function(e,t,i,n,r){var s=[n[0]-i[0],n[1]-i[1]];return jt(e,t,i,s,xt,r)},Tt=function(e,t,i,n,r){var s=[n[0]-i[0],n[1]-i[1]];return jt(e,t,i,s,Pt,r)},It=function(e,t,i,n,r){var s=[n[0]-i[0],n[1]-i[1]];return jt(e,t,i,s,At,r)},zt=function(e,t,i,n,r){var s=[t[0]-e[0],t[1]-e[1]],a=[n[0]-i[0],n[1]-i[1]];return jt(e,s,i,a,wt,r)},Ft=function(e,t,i,n){function r(e){return e<-s?-1:1}var s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:tt,a=i[0]-e[0],c=i[1]-e[1],o=n[0]-e[0],d=n[1]-e[1],l=o-a,g=d-c,f=a*d-o*c,p=f*f,_=t*t,u=ne(l*l+g*g),h=_*u-p;if(!(h<-s)){var m=ce(_*u-p),v=[e[0]+(f*g+r(g)*l*m)/u,e[1]+(-f*l+ne(g)*m)/u];if(h>s){var y=[e[0]+(f*g-r(g)*l*m)/u,e[1]+(-f*l-ne(g)*m)/u];return[v,y]}return[v]}},Bt=function(){throw"circle_ray has not been written yet"},Vt=function(e,t,i,n){function r(e){return 0>e?-1:1}var s=oe(t,2),a=i[0]-e[0],c=i[1]-e[1],o=n[0]-e[0],d=n[1]-e[1],l=o-a,g=d-c,f=l*l+g*g,p=a*d-o*c,_=(p*g+r(g)*l*ce(s*f-p*p))/f,u=(p*g-r(g)*l*ce(s*f-p*p))/f,h=(-p*l+ne(g)*ce(s*f-p*p))/f,m=(-p*l-ne(g)*ce(s*f-p*p))/f,v=isNaN(_),y=isNaN(u);return v||y?v&&y?void 0:v?y?void 0:[[u+e[0],m+e[1]]]:[[_+e[0],h+e[1]]]:[[_+e[0],h+e[1]],[u+e[0],m+e[1]]]},Dt=function(e,t){return ne(e[0]-t[0])<tt&&ne(e[1]-t[1])<tt},Rt=function(e,t,n){var r=e.map(function(e,t,i){return[e,i[(t+1)%i.length]]}).map(function(e){return Ct(t,n,e[0],e[1])}).filter(function(e){return null!=e});switch(r.length){case 0:return;case 1:return[r[0],r[0]];case 2:return r;default:for(var s=1;s<r.length;s+=1)if(!Dt(r[0],r[s]))return[r[0],r[s]];}},qt=function(e,t,n){var r=e.map(function(e,t,i){return[e,i[(t+1)%i.length]]}).map(function(e){return Mt(t,n,e[0],e[1])}).filter(function(e){return null!=e});switch(r.length){case 0:return;case 1:return[t,r[0]];case 2:return r;default:for(var s=1;s<r.length;s+=1)if(!Dt(r[0],r[s]))return[r[0],r[s]];}},Xt=function(e,t,i){var r=e.map(function(e,t,i){return[e,i[(t+1)%i.length]]}).map(function(e){return zt(t,i,e[0],e[1])}).filter(function(e){return null!=e}),s=_t(t,e),a=_t(i,e),c=pt(t,e),o=pt(i,e);if(0===r.length&&(s||a))return[t,i];if(0===r.length&&c&&o)return[t,i];switch(r.length){case 0:return s?[n(t),n(i)]:void 0;case 1:return c?[n(t),r[0]]:[n(i),r[0]];case 2:return r;default:throw new Error("clipping segment in a convex polygon resulting in 3 or more points");}},Ut=Object.freeze({__proto__:null,limit_line:Nt,limit_ray:Lt,limit_segment:Ot,intersection_function:jt,line_line:function(e,t,i,n,r){return jt(e,t,i,n,mt,r)},line_ray:function(e,t,i,n,r){return jt(e,t,i,n,vt,r)},line_segment:Ct,ray_ray:function(e,t,i,n,r){return jt(e,t,i,n,kt,r)},ray_segment:Mt,segment_segment:function(e,t,i,n,r){var s=[t[0]-e[0],t[1]-e[1]],a=[n[0]-i[0],n[1]-i[1]];return jt(e,s,i,a,bt,r)},line_ray_exclusive:function(e,t,i,n,r){return jt(e,t,i,n,Et,r)},line_segment_exclusive:Tt,ray_ray_exclusive:function(e,t,i,n,r){return jt(e,t,i,n,St,r)},ray_segment_exclusive:It,segment_segment_exclusive:zt,circle_line:Ft,circle_ray:Bt,circle_segment:Vt,convex_poly_line:Rt,convex_poly_ray:qt,convex_poly_segment:Xt,convex_poly_ray_exclusive:function(e,t,n){var r=e.map(function(e,t,i){return[e,i[(t+1)%i.length]]}).map(function(e){return It(t,n,e[0],e[1])}).filter(function(e){return null!=e});switch(r.length){case 0:return;case 1:return[t,r[0]];case 2:return r;default:for(var s=1;s<r.length;s+=1)if(!Dt(r[0],r[s]))return[r[0],r[s]];}}}),Yt=function(e,t){var i=e[0]*t[0]+e[1]*t[1],n=e[0]*t[1]-e[1]*t[0],r=ae(n,i);return 0>r&&(r+=2*ie),r},Gt=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=t.map(function(e){return ae(e[1],e[0])}),r=Array.from(Array(n.length)).map(function(e,t){return t}).sort(function(e,t){return n[e]-n[t]});return r.slice(r.indexOf(0),r.length).concat(r.slice(0,r.indexOf(0)))},Zt=function(e,t){var n=pe(e),r=pe(t),i=n.map(function(e,t){return n[t]+r[t]}),s=pe(i),a=n.map(function(e,t){return-n[t]+-r[t]});return[s,pe(a)]},Kt=function(e,i,n,r){var s=i[0]*r[1]-r[0]*i[1];if(ne(s)<tt){var a=[ye(e,n),[i[0],i[1]]],c=[a,a],o=i[0]*r[0]+i[1]*r[1];return delete c[0<o?1:0],c}var d=(n[0]-e[0])*r[1]-r[0]*(n[1]-e[1]),l=d/s,t=e[0]+i[0]*l,g=e[1]+i[1]*l,f=Zt(i,r);return f[1]=[f[1][1],-f[1][0]],f.map(function(e){return[[t,g],e]})},Wt=function(e,t,i){var n=Yt(t,i)/e;return Array.from(Array(e-1)).map(function(e,r){return t+n*r})},Ht=function(e,t,i){var n=ae(t[1],t[0]),r=ae(i[1],i[0]);return Wt(e,n,r).map(function(e){return[se(e),re(e)]})},$t=function(e){return .5*e.map(function(e,t,i){var n=i[(t+1)%i.length];return e[0]*n[1]-n[0]*e[1]}).reduce(function(e,t){return e+t},0)},Qt=function(e){var t=1/(6*$t(e));return e.map(function(e,t,i){var n=i[(t+1)%i.length],r=e[0]*n[1]-n[0]*e[1];return[(e[0]+n[0])*r,(e[1]+n[1])*r]}).reduce(function(e,t){return[e[0]+t[0],e[1]+t[1]]},[0,0]).map(function(e){return e*t})},Jt=function(e){var t=e[0].length,n=Array.from(Array(t)).map(function(){return 1/0}),r=Array.from(Array(t)).map(function(){return-Infinity});e.forEach(function(e){return e.forEach(function(e,t){e<n[t]&&(n[t]=e),e>r[t]&&(r[t]=e)})});var s=r.map(function(e,t){return e-n[t]});return[n,s]},ei=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,s=.5*(2*ie/e),c=i/se(s);return Array.from(Array(Q(e))).map(function(r,o){var i=-2*ie*o/e+s,a=Ye(t+c*re(i),14),d=Ye(n+c*se(i),14);return[a,d]})},ti=function(e,t,n){for(var r=t.map(function(t,r){return{o:t,i:r,d:n(e,t)}}),s=1/0,a=0,c;a<r.length;a+=1)r[a].d<s&&(c=a,s=r[a].d);return c},ii=function(e,t,n,r){var s=4<arguments.length&&void 0!==arguments[4]?arguments[4]:tt,a=oe(t[0],2)+oe(t[1],2),c=[0,1].map(function(t,r){return n[r]-e[r]}),o=[0,1].map(function(e,n){return t[n]*c[n]}).reduce(function(e,t){return e+t},0),l=r(o/a,s);return[0,1].map(function(n,r){return e[r]+t[r]*l})},ni=function(e,t,n){var r=e.map(function(e,r){var i=gt(t,n,e);return{type:"v",point:i?e:null,at_index:r}}).filter(function(e){return null!=e.point}),s=e.map(function(e,r,i){var s=Tt(t,n,e,i[(r+1)%i.length]);return{type:"e",point:s,at_index:r}}).filter(function(e){return null!=e.point}),a=r.concat(s).sort(function(e,t){return ne(e.point[0]-t.point[0])<tt?e.point[1]-t.point[1]:e.point[0]-t.point[0]});return console.log(a),e},ri=function(e,t,n){var r=e.map(function(e,r){var i=gt(t,n,e);return{point:i?e:null,at_index:r}}).filter(function(e){return null!=e.point}),s=e.map(function(e,r,i){var s=Tt(t,n,e,i[(r+1)%i.length]);return{point:s,at_index:r}}).filter(function(e){return null!=e.point});if(2==s.length){var a=s.slice().sort(function(e,t){return e.at_index-t.at_index}),c=e.slice(a[1].at_index+1).concat(e.slice(0,a[0].at_index+1));c.push(a[0].point),c.push(a[1].point);var o=e.slice(a[0].at_index+1,a[1].at_index+1);return o.push(a[1].point),o.push(a[0].point),[c,o]}if(1==s.length&&1==r.length){r[0].type="v",s[0].type="e";var d=r.concat(s).sort(function(e,t){return e.at_index-t.at_index}),l=e.slice(d[1].at_index+1).concat(e.slice(0,d[0].at_index+1));"e"===d[0].type&&l.push(d[0].point),l.push(d[1].point);var g=e.slice(d[0].at_index+1,d[1].at_index+1);return"e"===d[1].type&&g.push(d[1].point),g.push(d[0].point),[l,g]}if(2==r.length){var f=r.slice().sort(function(e,t){return e.at_index-t.at_index}),p=e.slice(f[1].at_index).concat(e.slice(0,f[0].at_index+1)),_=e.slice(f[0].at_index,f[1].at_index+1);return[p,_]}return[e.slice()]},si=function(t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:tt,n=t.slice().sort(function(e,t){return ne(e[1]-t[1])<i?e[0]-t[0]:e[1]-t[1]}),r=[];r.push(n[0]);var s=0,a=0,c=function(){a+=1;var e=r.length-1,t=n.filter(function(t){return!(ne(t[0]-r[e][0])<i&&ne(t[1]-r[e][1])<i)}).map(function(t){for(var i=ae(r[e][1]-t[1],r[e][0]-t[0]);i<s;)i+=2*ie;return{node:t,angle:i,distance:void 0}}).sort(function(e,t){return e.angle<t.angle?-1:e.angle>t.angle?1:0});if(0===t.length)return{v:void 0};var c=t[0];return t=t.filter(function(e){return ne(c.angle-e.angle)<i}).map(function(t){var i=ce(oe(r[e][0]-t.node[0],2)+oe(r[e][1]-t.node[1],2));return t.distance=i,t}).sort(function(e,t){return e.distance<t.distance?1:e.distance>t.distance?-1:0}),0<r.filter(function(e){return e===t[0].node}).length?{v:r}:void(r.push(t[0].node),s=ae(r[e][1]-t[0].node[1],r[e][0]-t[0].node[0]))};do{var o=c();if("object"===e(o))return o.v}while(a<1e4)},ai=Object.freeze({__proto__:null,clockwise_angle2_radians:function(e,t){for(;0>e;)e+=2*ie;for(;0>t;)t+=2*ie;var i=e-t;return 0<=i?i:2*ie-(t-e)},counter_clockwise_angle2_radians:function(e,t){for(;0>e;)e+=2*ie;for(;0>t;)t+=2*ie;var i=t-e;return 0<=i?i:2*ie-(e-t)},clockwise_angle2:function(e,t){var i=t[0]*e[0]+t[1]*e[1],n=t[0]*e[1]-t[1]*e[0],r=ae(n,i);return 0>r&&(r+=2*ie),r},counter_clockwise_angle2:Yt,counter_clockwise_vector_order:Gt,interior_angles2:function(e,t){var i=Yt(e,t);return[i,2*ie-i]},interior_angles:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.map(function(e,t,i){return Yt(e,i[(t+1)%i.length])})},bisect_vectors:Zt,bisect_lines2:Kt,subsect_radians:Wt,subsect:Ht,signed_area:$t,centroid:Qt,enclosing_rectangle:Jt,make_regular_polygon:ei,nearest_point2:function(e,t){var i=ti(e,t,me);return void 0===i?void 0:t[i]},nearest_point:function(e,t){var i=ti(e,t,ve);return void 0===i?void 0:t[i]},nearest_point_on_line:ii,split_polygon:ni,split_convex_polygon:ri,convex_hull:si}),ci=function(e){var t=[],r=e,s=function(){return r(pe(S))},a=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=We(t);return this.length>n.length?_e(n,S):_e(S,n)},c=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=We(t),s=S.slice();return null==s[2]&&(s[2]=0),null==n[2]&&(n[2]=0),r(he(s,n))},o=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=We(t),r=S.length<n.length?S.length:n.length,s=Array.from(Array(r)).map(function(e,t){return oe(S[t]-n[t],2)}).reduce(function(e,t){return e+t},0);return ce(s)},d=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=Je(t);return r(xe(n,S))},l=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=We(t);return r(S.map(function(e,t){return e+n[t]}))},g=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=We(t);return r(S.map(function(e,t){return e-n[t]}))},p=function(e,t){var i=Ne(e,t);return r(xe(i,S))},_=function(){return r(-S[1],S[0])},u=function(){return r(-S[0],-S[1])},h=function(){return r(S[1],-S[0])},m=function(){return r.apply(void 0,n(S.map(function(e){return-e})))},v=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=f(t),s=Le(n.vector,n.origin);return r(xe(s,S))},y=function(e,t){var n=We(e),s=S.length<n.length?S.length:n.length,a=Array.from(Array(s)).map(function(e,r){return S[r]*t+n[r]*(1-t)});return r(a)},k=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=We(t),r=S.length<n.length?S:n,s=S.length<n.length?n:S;return rt(r,s)},x=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=We(t),r=S.length<n.length?S:n,s=S.length<n.length?n:S;return lt(r,s)},b=function(e){return r(S.map(function(t){return t*e}))},E=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var s=We(t),a=S.length<s.length?S.slice():s,c=S.length<s.length?s:S.slice(),o=a.length;o<c.length;o+=1)a[o]=0;return r(c.map(function(e,t){return .5*(a[t]+c[t])}))},P=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=We(t);return Zt(S,n).map(function(e){return r(e)})},S;return Object.defineProperty(t,"normalize",{value:s}),Object.defineProperty(t,"dot",{value:a}),Object.defineProperty(t,"cross",{value:c}),Object.defineProperty(t,"distanceTo",{value:o}),Object.defineProperty(t,"transform",{value:d}),Object.defineProperty(t,"add",{value:l}),Object.defineProperty(t,"subtract",{value:g}),Object.defineProperty(t,"rotateZ",{value:p}),Object.defineProperty(t,"rotateZ90",{value:_}),Object.defineProperty(t,"rotateZ180",{value:u}),Object.defineProperty(t,"rotateZ270",{value:h}),Object.defineProperty(t,"flip",{value:m}),Object.defineProperty(t,"reflect",{value:v}),Object.defineProperty(t,"lerp",{value:y}),Object.defineProperty(t,"isEquivalent",{value:k}),Object.defineProperty(t,"isParallel",{value:x}),Object.defineProperty(t,"scale",{value:b}),Object.defineProperty(t,"midpoint",{value:E}),Object.defineProperty(t,"bisect",{value:P}),Object.defineProperty(t,"copy",{value:function(){return r.apply(void 0,n(S))}}),Object.defineProperty(t,"magnitude",{get:function(){return fe(S)}}),Object.defineProperty(t,"bind",{value:function(e){S=e}}),t},oi=function e(){var t=ci(e),i=Object.create(t);t.bind(i);for(var n=arguments.length,r=Array(n),s=0;s<n;s++)r[s]=arguments[s];return We(r).forEach(function(e){return i.push(e)}),Object.defineProperty(i,"x",{get:function(){return i[0]}}),Object.defineProperty(i,"y",{get:function(){return i[1]}}),Object.defineProperty(i,"z",{get:function(){return i[2]}}),i};oi.withAngle=function(e){return oi(se(e),re(e))};var di=function e(){for(var t=[1,0,0,1,0,0],i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];var s=Je(n);void 0!==s&&s.forEach(function(e,n){t[n]=e});return Object.defineProperty(t,"multiply",{value:function(){for(var i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];return e(Ee(t,Je(n)).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"determinant",{value:function(){return Ye(Pe(t))}}),Object.defineProperty(t,"inverse",{value:function(){return e(Se(t).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"translate",{value:function(i,n){var r=Ae(i,n);return e(Ee(t,r).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"scale",{value:function(){var i=we.apply(void 0,arguments);return e(Ee(t,i).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"rotate",{value:function(){var i=Ne.apply(void 0,arguments);return e(Ee(t,i).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"reflect",{value:function(){var i=Le.apply(void 0,arguments);return e(Ee(t,i).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"transform",{value:function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];var r=We(i);return oi(xe(t,r).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"transformVector",{value:function(i){return e(xe(t,i).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"transformLine",{value:function(i,n){return e(be(t,i,n).map(function(e){return Ye(e,13)}))}}),Object.freeze(t)};di.makeIdentity=function(){return di(1,0,0,1,0,0)},di.makeTranslation=function(e,t){return di(Ae(e,t))},di.makeRotation=function(e,t){return di(Ne(e,t).map(function(e){return Ye(e,13)}))},di.makeScale=function(e,t,i){return di(we(e,t,i).map(function(e){return Ye(e,13)}))},di.makeReflection=function(e,t){return di(Le(e,t).map(function(e){return Ye(e,13)}))};var li=function e(){for(var t=[1,0,0,0,1,0,0,0,1,0,0,0],i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];var s=et(n);void 0!==s&&s.forEach(function(e,n){t[n]=e});return Object.defineProperty(t,"multiply",{value:function(){for(var i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];return e(Me(t,et(n)).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"determinant",{value:function(){return Ye(Te(t),13)}}),Object.defineProperty(t,"inverse",{value:function(){return e(Ie(t).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"translate",{value:function(i,n,r){var s=ze(i,n,r);return e(Me(t,s).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"rotateX",{value:function(i){var n=Fe(i);return e(Me(t,n).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"rotateY",{value:function(i){var n=Be(i);return e(Me(t,n).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"rotateZ",{value:function(i){var n=Ve(i);return e(Me(t,n).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"rotate",{value:function(i,n,r){var s=De(i,n,r);return e(Me(t,s).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"scale",{value:function(i){var n=Re(i);return e(Me(t,n).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"reflectZ",{value:function(i,n){var r=qe(i,n);return e(Me(t,r).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"transform",{value:function(){for(var e=arguments.length,i=Array(e),n=0;n<e;n++)i[n]=arguments[n];var r=We(i);return oi(je(r,t).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"transformVector",{value:function(i){return e(je(t,i).map(function(e){return Ye(e,13)}))}}),Object.defineProperty(t,"transformLine",{value:function(i,n){return e(Ce(t,i,n).map(function(e){return Ye(e,13)}))}}),Object.freeze(t)};li.makeIdentity=function(){return li(1,0,0,0,1,0,0,0,1,0,0,0)},li.makeTranslation=function(e,t,i){return li(ze(e,t,i))},li.makeRotationX=function(e){return li(Fe(e).map(function(e){return Ye(e,13)}))},li.makeRotationY=function(e){return li(Be(e).map(function(e){return Ye(e,13)}))},li.makeRotationZ=function(e){return li(Ve(e).map(function(e){return Ye(e,13)}))},li.makeRotation=function(e,t,i){return li(De(e,t,i).map(function(e){return Ye(e,13)}))},li.makeScale=function(e,t){return li(Re(e,t).map(function(e){return Ye(e,13)}))},li.makeReflectionZ=function(e,t){return li(qe(e,t).map(function(e){return Ye(e,13)}))};var gi=function e(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=f(i),s=r.origin,a=r.vector,c=h.bind(this),o=Object.create(c(e));return Object.defineProperty(o,"compare_function",{value:function(){return!0}}),Object.defineProperty(o,"clip_function",{value:Nt}),o.origin=oi(s),o.vector=oi(a),Object.defineProperty(o,"length",{get:function(){return 1/0}}),Object.defineProperty(o,"transform",{value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=Je(i),c=be(r,s,a);return e(c[0],c[1])}}),o};gi.fromPoints=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=_(t);return gi({origin:n[0],vector:pe([n[1][0]-n[0][0],n[1][1]-n[0][1]])})},gi.perpendicularBisector=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=_(t),r=pe([n[1][0]-n[0][0],n[1][1]-n[0][1]]);return gi({origin:ue(n[0],n[1]),vector:[r[1],-r[0]]})};var fi=function e(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=f(i),s=r.origin,a=r.vector,c=h.bind(this),o=Object.create(c(e));return Object.defineProperty(o,"origin",{get:function(){return oi(s)}}),Object.defineProperty(o,"vector",{get:function(){return oi(a)}}),Object.defineProperty(o,"length",{get:function(){return 1/0}}),Object.defineProperty(o,"transform",{value:function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=Je(i),c=a.map(function(e,t){return e+s[t]}),o=xe(r,s),d=xe(r,c).map(function(e,t){return e-o[t]});return e(o,d)}}),Object.defineProperty(o,"rotate180",{value:function(){return e(s[0],s[1],-a[0],-a[1])}}),Object.defineProperty(o,"compare_function",{value:function(e,t){return e>=-t}}),Object.defineProperty(o,"clip_function",{value:Lt}),o};fi.fromPoints=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=_(t);return fi({origin:n[0],vector:pe([n[1][0]-n[0][0],n[1][1]-n[0][1]])})};var pi=function e(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=_(i),s=h.bind(this),a=0<r.length?r.map(function(e){return oi(e)}):void 0;if(void 0!==a){var c=Object.create(s(e,a)),o=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=Je(i),s=c.map(function(e){return xe(r,e)});return e(s)},d=function(t){var i=ue(c[0],c[1]),n=c.map(function(e){return e.lerp(i,t)});return e(n)},l=function(){return oi(c[1][0]-c[0][0],c[1][1]-c[0][1])},g=function(){return oi(ue(c[0],c[1]))},f=function(){return ce(oe(c[1][0]-c[0][0],2)+oe(c[1][1]-c[0][1],2))},p=function(e,t){return e>=-t&&e<=1+t};return Object.defineProperty(c,"origin",{get:function(){return c[0]}}),Object.defineProperty(c,"vector",{get:function(){return l()}}),Object.defineProperty(c,"midpoint",{value:g}),Object.defineProperty(c,"magnitude",{get:function(){return f()}}),Object.defineProperty(c,"transform",{value:o}),Object.defineProperty(c,"scale",{value:d}),Object.defineProperty(c,"compare_function",{value:p}),Object.defineProperty(c,"clip_function",{value:Ot}),c}},_i=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[0,0],s=[We(e),We(t)];return{contains:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=We(t).map(function(e,t){return e+r[t]}),a=(n[1]-s[0][1])*-s[0][0]-(n[0]-s[0][0])*-s[0][1],c=n[1]*s[1][0]-n[0]*s[1][1];return 0>a&&0>c},bisect:function(){var e=Yt(s[0],s[1]),t=s.map(function(e){return ae(e[1],e[0])}),i=t[0]+.5*e;return oi(se(i),re(i))},subsect:function(e){return Ht(e,s[0],s[1]).map(function(e){return oi(e[0],e[1])})},get center(){return r},get vectors(){return s},get angle(){return Yt(s[0],s[1])}}};_i.fromVectors=function(e,t){return _i(e,t)},_i.fromPoints=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[0,0],r=[e,t].map(function(e){return e.map(function(t,r){return e[r]-n[r]})});return _i(r[0],r[1],n)};var ui=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=He(t).map(function(e){return oi(e)});if(void 0!==n){var r=n.map(function(e,t,i){return[e,i[(t+1)%i.length]]}).map(function(e){return pi(e[0][0],e[0][1],e[1][0],e[1][1])}),s=m.bind(this),a=Object.create(s());return Object.defineProperty(a,"points",{get:function(){return n}}),Object.defineProperty(a,"sides",{get:function(){return r}}),a}};ui.regularPolygon=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,r=ei(e,t,i,n);return ui(r)},ui.convexHull=function(e){var t=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],i=si(e,t);return ui(i)};var hi=function e(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=u(i).map(function(e){return oi(e)});if(void 0!==r){var s=r.map(function(e,t,i){return[e,i[(t+1)%i.length]]}).map(function(e){return pi(e[0][0],e[0][1],e[1][0],e[1][1])}),a=m.bind(this),c=Object.create(a(e)),o=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var s=f(i);return ri(r,s.origin,s.vector).map(function(t){return e(t)})},d=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=u(t);return ut(r,n)},l=function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Qt(c.points),r=c.points.map(function(e){return[0,1].map(function(t,r){return e[r]-n[r]})}).map(function(e){return e.map(function(r,s){return n[s]+e[s]*t})});return e(r)},g=function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Qt(c.points),n=c.points.map(function(e){var n=[e[0]-i[0],e[1]-i[1]],r=ce(oe(n[0],2)+oe(n[1],2)),s=ae(n[1],n[0]);return[i[0]+se(s+t)*r,i[1]+re(s+t)*r]});return e(n)};return Object.defineProperty(c,"points",{get:function(){return r}}),Object.defineProperty(c,"sides",{get:function(){return s}}),Object.defineProperty(c,"split",{value:o}),Object.defineProperty(c,"overlaps",{value:d}),Object.defineProperty(c,"scale",{value:l}),Object.defineProperty(c,"rotate",{value:g}),c}};hi.regularPolygon=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,r=ei(e,t,i,n);return hi(r)},hi.convexHull=function(e){var t=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1],i=si(e,t);return hi(i)};var mi=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=He(t);if(void 0!==r){var s=Gt.apply(void 0,n(r)),a=function(){return s.map(function(e){return r[e]}).map(function(e,t,i){return[e,i[(t+1)%i.length]]}).map(function(e){return _i.fromVectors(e[0],e[1])})},c=function(){return s.map(function(e){return r[e]}).map(function(e,t,i){return[e,i[(t+1)%i.length]]}).map(function(e){return Yt(e[0],e[1])})};return{sectors:a,angles:c,get vectors(){return r},get vectorOrder(){return n(s)}}}};mi.fromVectors=function(){return mi.apply(void 0,arguments)},mi.fromPoints=function(e,t){var i=t.map(function(t){return t.map(function(n,r){return t[r]-e[r]})});return mi.fromVectors(i)};var vi=Object.create(null);Object.assign(vi,ke,Oe,Xe,ai,ht,st),vi.clean_number=Ye,vi.is_number=function(e){return null!=e&&!isNaN(e)},vi.is_vector=function(e){return null!=e&&null!=e[0]&&!isNaN(e[0])},vi.is_iterable=Ge,vi.flatten_input=Ze,vi.semi_flatten_input=Ke,vi.get_vector=We,vi.get_vector_of_vectors=He,vi.get_matrix2=Je,vi.get_segment=g,vi.get_line=f,vi.get_ray=p,vi.get_two_vec2=_,vi.get_array_of_vec=u,vi.get_array_of_vec2=function(){var e=Array.from(arguments),t=e.filter(function(e){return e.constructor===Array});return 2<=t.length&&!isNaN(t[0][0])?t:1===t.length&&1<=t[0].length?t[0]:e},vi.intersection=Ut,Object.freeze(vi);var yi={vector:oi,matrix2:di,matrix:li,line:gi,ray:fi,segment:pi,circle:function(){for(var e=arguments.length,t=Array(e),r=0,s,a;r<e;r++)t[r]=arguments[r];var c=t.filter(function(e){return!isNaN(e)}),o=_(t);if(3===c.length){s=oi(c[0],c[1]);var d=i(c,3);a=d[2]}else 2===o.length&&(a=me.apply(void 0,n(o)),s=oi.apply(void 0,n(o[0])));var l=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=f(t),r=[n.origin[0]+n.vector[0],n.origin[1]+n.vector[1]],c=Ft(s,a,n.origin,r);return void 0===c?void 0:c.map(function(e){return oi(e)})},g=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=p(t),r=Bt(s,a,n[0],n[1]);return void 0===r?void 0:r.map(function(e){return oi(e)})},u=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=_(t),r=Vt(s,a,n[0],n[1]);return void 0===r?void 0:r.map(function(e){return oi(e)})};return{intersectionLine:l,intersectionRay:g,intersectionSegment:u,get origin(){return s},get x(){return s[0]},get y(){return s[1]},get radius(){return a},set origin(e){s=oi(e)},set radius(e){a=e}}},polygon:ui,convexPolygon:hi,rectangle:function e(){for(var t=arguments.length,n=Array(t),r=0,s,a,c;r<t;r++)n[r]=arguments[r];var o=Array.from(n),d=o.filter(function(e){return!isNaN(e)}),l=o.filter(function(e){return e.constructor===Array});if(4===d.length){s=oi(d.slice(0,2));var g=i(d,4);a=g[2],c=g[3]}1===l.length&&(l=l[0]),2===l.length&&"number"==typeof l[0][0]&&(s=oi(l[0].slice()),a=l[1][0],c=l[1][1]);var f=[[s[0],s[1]],[s[0]+a,s[1]],[s[0]+a,s[1]+c],[s[0],s[1]+c]],p=m.bind(this),_=Object.create(p(e)),u=function(t,i){var n=null==i?[s[0]+a,s[1]+c]:i,r=s[0]+(n[0]-s[0])*(1-t),o=s[1]+(n[1]-s[1])*(1-t);return e(r,o,a*t,c*t)};return Object.defineProperty(_,"points",{get:function(){return f}}),Object.defineProperty(_,"origin",{get:function(){return s}}),Object.defineProperty(_,"width",{get:function(){return a}}),Object.defineProperty(_,"height",{get:function(){return c}}),Object.defineProperty(_,"area",{get:function(){return a*c}}),Object.defineProperty(_,"scale",{value:u}),Object.defineProperty(_,"rotate",{value:function(){var e;return(e=hi(f)).rotate.apply(e,arguments)}}),Object.defineProperty(_,"transform",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return hi(f).transform(t)}}),_},junction:mi,sector:_i,core:vi},ki=1.1,xi="Rabbit Ear",bi={file:["file_spec","file_creator","file_author","file_title","file_description","file_classes","file_frames"],frame:["frame_author","frame_title","frame_description","frame_attributes","frame_classes","frame_unit","frame_parent","frame_inherit"],graph:["vertices_coords","vertices_vertices","vertices_faces","edges_vertices","edges_faces","edges_assignment","edges_foldAngle","edges_length","faces_vertices","faces_edges","vertices_edges","edges_edges","faces_faces"],orders:["edgeOrders","faceOrders"]},Ei=Object.freeze([].concat(bi.file).concat(bi.frame).concat(bi.graph).concat(bi.orders)),Pi=["B","b","M","m","V","v","F","f","U","u"],Ai={B:"boundary",b:"boundary",M:"mountain",m:"mountain",V:"valley",v:"valley",F:"mark",f:"mark",U:"unassigned",u:"unassigned"},wi={M:-180,m:-180,V:180,v:180},Ni="foldedForm",Li="creasePattern",Oi=function(e){return wi[e]||0},ji=function(e,t){var i="".concat(t,"_");return Object.keys(e).map(function(e){return e.substring(0,i.length)===i?e:void 0}).filter(function(e){return void 0!==e})},Ci=function(e,t){return Object.keys(e).map(function(e){return e.substring(e.length-t.length,e.length)===t?e:void 0}).filter(function(e){return void 0!==e})},Mi=function(e,t){var i=ji(e,t);if(0===i.length)return[];var r=te.apply(Math,n(i.map(function(t){return e[t].length}))),s=Array.from(Array(r)).map(function(){return{}});return i.map(function(e){return{long:e,short:e.substring(t.length+1)}}).forEach(function(t){return s.forEach(function(n,r){s[r][t.short]=e[t.long][r]})}),s},Ti=function(e,t,i){var n=ji(e,t);if(0===n.length)return[];var r={};return n.map(function(e){return{long:e,short:e.substring(t.length+1)}}).forEach(function(t){r[t.short]=e[t.long][i]}),r},Ii=/*#__PURE__*/Object.freeze({__proto__:null,file_spec:ki,file_creator:xi,future_spec:{FACES_MATRIX:"faces_re:matrix",FACES_LAYER:"faces_re:layer",SECTORS_VERTICES:"re:sectors_vertices",SECTORS_EDGES:"re:sectors_edges",SECTORS_ANGLES:"re:sectors_angles",VERTICES_SECTORS_VERTICES:"vertices_re:sectors_vertices"},fold_keys:bi,file_classes:["singleModel","multiModel","animation","diagrams"],frame_classes:["creasePattern","foldedForm","graph","linkage"],frame_attributes:["2D","3D","abstract","manifold","nonManifold","orientable","nonOrientable","selfTouching","nonSelfTouching","selfIntersecting","nonSelfIntersecting"],keys:Ei,edges_assignment_values:Pi,edges_assignment_names:Ai,FOLDED_FORM:Ni,CREASE_PATTERN:Li,edge_assignment_to_foldAngle:Oi,get_graph_keys_with_prefix:ji,get_graph_keys_with_suffix:function(e,t){var i="_".concat(t);return Object.keys(e).map(function(e){return e.substring(e.length-i.length,e.length)===i?e:void 0}).filter(function(e){return void 0!==e})},get_keys_with_ending:Ci,transpose_geometry_arrays:Mi,transpose_geometry_array_at_index:Ti}),zi=function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"number",n=!0;return t.forEach(function(t){t.forEach(function(t){if(e(t)!==i)return void(n=!1)})}),n},Fi=function(e){return e.map(function(e){return e.map(function(e){return!isNaN(e)}).reduce(function(e,t){return e&&t},!0)}).reduce(function(e,t){return e&&t},!0)},Bi=function(e,t){return e.map(function(e){return e.map(function(e){return t(e)}).reduce(function(e,t){return e&&t},!0)}).reduce(function(e,t){return e&&t},!0)},Vi={};Vi.vertices_coords=function(e){var t=e.vertices_coords;return null!=t&&zi(t,"number")&&Fi(t)},Vi.vertices_vertices=function(e){var t=e.vertices_coords,i=e.vertices_vertices,n=e.edges_vertices;if(null==i)return!1;var r=i.map(function(e){return e.length}).reduce(function(e,t){return e+t},0);if(1<ne(1*r-2*n.length)&&console.warn("Validate.vertices_vertices, expected array length deviated by more than 1"),null!=i){if(i.length!==t.length)return!1;var s=i.map(function(e,t){return e.map(function(e){return[t,e]})}).reduce(function(e,t){return e.concat(t)},[]);return 0===s.map(function(t){return 0<n.filter(function(i){return t[0]===i[0]&&t[1]===i[1]||t[0]===i[1]&&t[1]===i[0]}).length}).map(function(e,t){return{test:e,i:t}}).filter(function(e){return!e.test}).length}return!1},Vi.vertices_faces=function(e){var t=e.vertices_faces,n=e.faces_vertices;return null!=n&&null!=t&&0===t.map(function(e,t){return e.map(function(e){return{test:-1!==n[e].indexOf(t),face:e,i:t}}).filter(function(e){return!e.test})}).reduce(function(e,t){return e.concat(t)},[]).length},Vi.edges_vertices=function(e){var t=e.vertices_coords,i=e.edges_vertices;if(null==t)return!0;var r=t.length;return null!=i&&zi(i,"number")&&Fi(i)&&Bi(i,function(e){return e<r})},Vi.edges_faces=function(e){var t=e.edges_faces,i=e.faces_edges;return!1},Vi.faces_faces=function(){return!1},Vi.vertices_edges=function(){return!1},Vi.edges_assignment=function(e){var t=e.edges_vertices,i=e.edges_assignment;return null!=t&&null!=i&&i.length===t.length&&i.filter(function(e){return Pi.includes(e)}).reduce(function(e,t){return e&&t},!0)},Vi.edges_foldAngle=function(){return!1},Vi.edges_length=function(){return!1},Vi.faces_vertices=function(e){var t=e.vertices_faces,i=e.faces_vertices;return null!=t&&0===i.map(function(e,n){return e.map(function(e){return{test:-1!==t[e].indexOf(n),face:e,i:n}}).filter(function(e){return!e.test})}).reduce(function(e,t){return e.concat(t)},[]).length},Vi.faces_edges=function(){return!1};var Di=function(t){if("object"!==e(t)||null===t)return 0;var i=Object.keys(t);return 0===i.length?0:i.map(function(e){return Ei.includes(e)}).reduce(function(e,t){return e+(t?1:0)},0)/i.length},Ri=function(e){var t={vertices:["coords","vertices","faces"],edges:["vertices","faces","assignment","foldAngle","length"],faces:["vertices","edges"]};["vertices_coords","vertices_vertices","vertices_faces","edges_vertices","edges_faces","faces_vertices","faces_edges"].filter(function(t){return t in e}).forEach(function(t){if(e[t].map(function(e){return 0<e.filter(function(e){return null==e}).length}).reduce(function(e,t){return e||t},!1))throw new Error("".concat(t," contains a null"))}),["edges_assignment","edges_foldAngle","edges_length"].filter(function(t){return t in e}).forEach(function(t){if(0<e[t].filter(function(e){return null==e}).length)throw new Error("".concat(t," contains a null"))});var i=Object.keys(t).map(function(e){return{prefix:e,suffixes:t[e]}}).map(function(t){return t.suffixes.map(function(e){return"".concat(t.prefix,"_").concat(e)}).filter(function(t){return null!=e[t]}).map(function(t,i,n){return e[t].length===e[n[0]].length}).reduce(function(e,t){return e&&t},!0)}).reduce(function(e,t){return e&&t},!0);if(!i)throw new Error("validate failed: arrays with common keys have mismatching lengths");var n={vertices:e.vertices_coords.length,edges:e.edges_vertices.length,faces:e.faces_vertices.length||e.faces_edges.length},r=Object.keys(t).map(function(e){return{prefix:e,suffixes:t[e]}}).map(function(t){return t.suffixes.map(function(e){return{key:"".concat(t.prefix,"_").concat(e),suffix:e}}).filter(function(t){return null!=e[t.key]&&null!=n[t.suffix]}).map(function(t){return{key:t.key,test:e[t.key].reduce(function(e,i){return i.reduce(function(e,i){return e&&i<n[t.suffix]},!0)},!0)}})}).reduce(function(e,t){return e.concat(t)},[]);if(r.filter(function(e){return!e.test}).forEach(function(t){throw console.log(e),new Error("".concat(t.key," contains a index too large, larger than the reference array to which it points"))}),"vertices_vertices"in e){var s=e.vertices_vertices.map(function(e,t){return e.map(function(e){return[t,e]})}).reduce(function(e,t){return e.concat(t)},[]),a=s.map(function(t){return 0<e.edges_vertices.filter(function(i){return t[0]===i[0]&&t[1]===i[1]||t[0]===i[1]&&t[1]===i[0]}).length}).map(function(e,t){return{test:e,i:t}}).filter(function(e){return!e.test});if(0<a.length)throw new Error("vertices_vertices at index ".concat(a[0].i," declares an edge that doesn't exist in edges_vertices"))}if("vertices_faces"in e){var c=e.vertices_faces.map(function(t,n){return t.map(function(t){return{test:-1!==e.faces_vertices[t].indexOf(n),face:t,i:n}}).filter(function(e){return!e.test})}).reduce(function(e,t){return e.concat(t)},[]);if(0<c.length)throw new Error("vertex ".concat(c[0].i," in vertices_faces connects to face ").concat(c[0].face,", whereas in faces_vertices this same connection in reverse doesn't exist."))}if("edges_faces"in e){var o=e.edges_faces.map(function(t,n){return t.map(function(t){return{test:-1!==e.faces_edges[t].indexOf(n),face:t,i:n}}).filter(function(e){return!e.test})}).reduce(function(e,t){return e.concat(t)},[]);if(0<o.length)throw new Error("edges_faces ".concat(o[0].i," connects to face ").concat(o[0].face,", whereas in faces_edges this same connection in reverse doesn't exist."))}if("faces_vertices"in e&&"vertices_faces"in e)e.faces_vertices.map(function(t,n){return t.map(function(t){return{test:-1!==e.vertices_faces[t].indexOf(n),face:t,i:n}}).filter(function(e){return!e.test})}).reduce(function(e,t){return e.concat(t)},[]);return!0},qi=/*#__PURE__*/Object.freeze({__proto__:null,arrayOfType:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"number",n=!0;return t.forEach(function(t){if(e(t)!==i)return void(n=!1)}),n},arrayOfArrayOfType:zi,possibleFoldObject:Di,default:Vi,validate_first:Ri}),Xi=function(){var e={};if(le){var t=require("xmldom"),i=t.DOMParser,n=t.XMLSerializer;e.DOMParser=i,e.XMLSerializer=n,e.document=new i().parseFromString("<!DOCTYPE html><title> </title>","text/html")}else de&&(e=window);return e}(),Ui=function(e){return 128>e.length&&-1!==e.indexOf(".")},Yi=function(e){return"svg"===e.tagName||0<e.getElementsByTagName("svg").length},Gi=function(e){var t=e.getElementsByTagName("object");return!!(0<t.length)&&0<Array.from(t).filter(function(e){return"oripa.DataSet"===e.className}).length},Zi={SVG:"svg",Svg:"svg",svg:"svg",FOLD:"fold",Fold:"fold",fold:"fold",ORIPA:"oripa",Oripa:"oripa",oripa:"oripa",".SVG":"svg",".Svg":"svg",".svg":"svg",".FOLD":"fold",".Fold":"fold",".fold":"fold",".ORIPA":"oripa",".Oripa":"oripa",".oripa":"oripa"},Ki=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];if(0>=i.length)throw new Error("convert(), load(), missing a file as a parameter");var r=i[0],s;if(2<=i.length&&"string"==typeof i[1]&&(s=Zi[i[1]],void 0===s))throw new Error("expected a file type (like 'svg'), ".concat(i[1]," is unsupported"));if(void 0!==s)return"string"==typeof r?"fold"===s?{data:JSON.parse(r),type:s}:"svg"===s||"oripa"===s?{data:new Xi.DOMParser().parseFromString(r,"text/xml").documentElement,type:s}:{data:r,type:s}:{data:r,type:s};var a=e(r);if("string"===a){try{var c=JSON.parse(r);if(0<Di(c))return{data:c,type:"fold"}}catch(e){var o=new Xi.DOMParser().parseFromString(r,"text/xml").documentElement;if(!(0<o.getElementsByTagName("parsererror").length))return Yi(o)?{data:o,type:"svg"}:Gi(o)?{data:o,type:"oripa"}:void 0;if(Ui(r))throw new Error("did you provide a file name? please load the file first and pass in the data.");else throw new Error("unable to load file. tried XML, JSON")}return}if("object"===a)try{var d=JSON.parse(JSON.stringify(r));return{data:d,type:"fold"}}catch(e){return"function"==typeof r.getElementsByTagName?Yi(r)?{data:r,type:"svg"}:Gi(r)?{data:r,type:"oripa"}:void 0:void 0}},Wi="vertices",Hi="edges",$i="faces",Qi="frame",Ji="file",en="".concat(Wi,"_").concat("coords"),tn="".concat(Hi,"_").concat(Wi),nn="".concat($i,"_").concat(Wi),rn="".concat($i,"_").concat(Hi),sn="".concat(Hi,"_assignment"),an="".concat($i,"_re:coloring"),cn="".concat($i,"_re:matrix"),on="".concat($i,"_re:layer"),dn="".concat(Qi,"_parent"),ln="".concat(Qi,"_inherit"),gn="".concat(Qi,"_classes"),fn="".concat(Ji,"_frames"),pn="".concat(Ji,"_classes"),_n="boundary",un="mountain",hn="valley",mn="mark",vn="unassigned",yn="front",kn="back",xn="class",bn="index",En="object",Pn="string",Sn="undefined",An="black",wn="white",Nn="lightgray",Ln="stroke-width",On="createElementNS",jn="setAttributeNS",Cn="appendChild",Mn=("undefined"==typeof window?"undefined":e(window))!==Sn&&e(window.document)!==Sn,Tn=("undefined"==typeof process?"undefined":e(process))!==Sn&&null!=process.versions&&null!=process.versions.node,In=function(){var e={};if(Tn){var t=require("xmldom"),i=t.DOMParser,n=t.XMLSerializer;e.DOMParser=i,e.XMLSerializer=n,e.document=new i().parseFromString("<!DOCTYPE html><title>.</title>","text/html")}else Mn&&(e=window);return e}(),zn="http://www.w3.org/2000/svg",Fn=function(){var e=In.document[On](zn,"svg");return e.setAttribute("version","1.1"),e.setAttribute("xmlns",zn),e},Bn=function(e){var t=In.document[On](zn,"g");return e&&e[Cn](t),t},Vn=function e(t){var e=In.document[On](zn,"defs");return t&&t[Cn](e),e},Dn=function(e){var t=In.document[On](zn,"style");return t[jn](null,"type","text/css"),e&&e[Cn](t),t},Rn=function(e,t,i,n,r){var s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,a=n/1-n,c=[t-a-s,i-a-s,n+2*a+2*s,r+2*a+2*s].join(" ");e[jn](null,"viewBox",c)},qn=function(e,t,i,n){var r=In.document[On](zn,"line");return r[jn](null,"x1",e),r[jn](null,"y1",t),r[jn](null,"x2",i),r[jn](null,"y2",n),r},Xn=function(e,t,i){var n=In.document[On](zn,"circle");return n[jn](null,"cx",e),n[jn](null,"cy",t),n[jn](null,"r",i),n},Un=function(e){var t=In.document[On](zn,"polygon"),i=e.map(function(e){return"".concat(e[0],",").concat(e[1])}).join(" ");return t[jn](null,"points",i),t},Yn=function(e){var t=In.document[On](zn,"path");return t[jn](null,"d",e),t},Gn=function(e,t){if(!1==en in e)return[];var i=t&&t.radius?t.radius:.01,n=e[en].map(function(e){return Xn(e[0],e[1],i)});return n.forEach(function(e,t){return e[jn](null,bn,t)}),n},Zn={B:_n,b:_n,M:un,m:un,V:hn,v:hn,F:mn,f:mn,U:vn,u:vn},Kn={B:"b",b:"b",M:"m",m:"m",V:"v",v:"v",F:"f",f:"f",U:"u",u:"u"},Wn=function(e){var t=e.vertices_coords,i=e.edges_vertices;return null==i||null==t?[]:i.map(function(e){return e.map(function(e){return t[e]})})},Hn=function(e){var t={u:[],f:[],v:[],m:[],b:[]};return e[sn].map(function(e){return Kn[e]}).forEach(function(e,n){return t[e].push(n)}),t},$n=function(e){return null==e[tn]||null==e[sn]||e[tn].length!==e[sn].length?[]:e[sn].map(function(e){return Zn[e]})},Qn=function(e){return"M".concat(e[0][0]," ").concat(e[0][1],"L").concat(e[1][0]," ").concat(e[1][1])},Jn=function(e){var t=Wn(e).map(function(e){return Qn(e)}).join("");return""===t?void 0:t},er=function(e){if(null==e[tn]||null==e[en]||null==e[sn])return[];var t=Wn(e),i=Hn(e),n=Object.keys(i).map(function(e){return i[e].map(function(e){return t[e]})}).map(function(e){return e.map(function(e){return Qn(e)}).join("")}),r={};return Object.keys(i).map(function(e,t){""!==n[t]&&(r[e]=n[t])}),r},tr=function(e){if(null==e[sn]){var t=Jn(e);return void 0===t?[]:[Yn(t)]}var i=er(e);return Object.keys(i).map(function(e){var t=Yn(i[e]);return t[jn](null,xn,Zn[e]),t})},ir=function(e){var t=e.edges_vertices;if(t){var n=[];return t.forEach(function(e,t){return e.forEach(function(e){void 0===n[e]&&(n[e]=[]),n[e].push(t)})}),n}},nr=function(e){var t=e.faces_vertices;if(t){var i=t.length,n=Array.from(Array(i)).map(function(){return[]}),r={};return t.forEach(function(e,t){if(void 0!==e){var s=e.length;e.forEach(function(e,a,i){var c=i[(a+1)%s];if(c<e){var o=[c,e];e=o[0],c=o[1]}var d="".concat(e," ").concat(c);if(d in r){var l=r[d];n[t].push(l),n[l].push(t)}else r[d]=t})}}),n}},rr=function(e){var t=e.edges_vertices;if(!t)return{};var n={};return t.map(function(e){return e.sort(function(e,t){return e-t}).join(" ")}).forEach(function(e,t){n[e]=t}),n},sr=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=rr(e),n=nr(e);if(0>=n.length)return[];var r=[t],s=[[{face:t,parent:void 0,edge:void 0,level:0}]];do s[s.length]=s[s.length-1].map(function(t){var s=n[t.face].filter(function(e){return-1===r.indexOf(e)});return r=r.concat(s),s.map(function(n){var r=e.faces_vertices[n].filter(function(i){return-1!==e.faces_vertices[t.face].indexOf(i)}).sort(function(e,t){return e-t}),s=i[r.join(" ")];return{face:n,parent:t.face,edge:s,edge_vertices:r}})}).reduce(function(e,t){return e.concat(t)},[]);while(0<s[s.length-1].length);return 0<s.length&&0===s[s.length-1].length&&s.pop(),s},ar=function(e){return e.map(function(e){return e[0]*e[3]-e[1]*e[2]}).map(function(e){return 0<=e})},cr=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=[];return n[t]=!0,sr(e,t).forEach(function(e,t){return e.forEach(function(e){n[e.face]=0==t%2})}),n},or=function(e){return e.map(function(e,t){return{layer:e,i:t}}).sort(function(e,t){return e.layer-t.layer}).map(function(e){return e.i})},dr=function(e){var t=e[an];return null==t&&(t=cn in e?ar(e[cn]):cr(e,0)),t.map(function(e){return e?yn:kn})},lr=function(t,n){var r=e(t.frame_classes)===En&&null!==t.frame_classes&&!t.frame_classes.includes("creasePattern"),s=null!=t[on]&&t[on].length===t[nn].length;return s&&r&&dr(t).forEach(function(e,t){return n[t][jn](null,xn,e)}),s?or(t[on]).map(function(e){return n[e]}):n},gr=function(e){if(!1==nn in e||!1==en in e)return[];var t=e[nn].map(function(t){return t.map(function(t){return e[en][t]})}).map(function(e){return Un(e)});return t.forEach(function(e,t){return e[jn](null,bn,t)}),lr(e,t)},fr=function(e){if(!1==rn in e||!1==tn in e||!1==en in e)return[];var t=e[rn].map(function(t){return t.map(function(t){return e[tn][t]}).map(function(e,t,i){var n=i[(t+1)%i.length];return e[1]===n[0]||e[1]===n[1]?e[0]:e[1]}).map(function(t){return e[en][t]})}).map(function(e){return Un(e)});return t.forEach(function(e,t){return e[jn](null,bn,t)}),lr(e,t)},pr=function(e){if(null==e[en]||0>=e[en].length)return[0,0,0,0];var t=e[en][0].length,r=Array(t).fill(1/0),s=Array(t).fill(-Infinity);return e[en].forEach(function(e){return e.forEach(function(e,t){e<r[t]&&(r[t]=e),e>s[t]&&(s[t]=e)})}),isNaN(r[0])||isNaN(r[1])||isNaN(s[0])||isNaN(s[1])?[0,0,0,0]:[r[0],r[1],s[0]-r[0],s[1]-r[1]]},_r=function(e){if(null==e[sn])return{vertices:[],edges:[]};for(var t=e[sn].map(function(e){return"B"===e||"b"===e}),n=ir(e),r=[],s=[],a=-1,c=0;c<t.length;c+=1)if(t[c]){a=c;break}if(-1===a)return{vertices:[],edges:[]};t[a]=!1,r.push(a),s.push(e[tn][a][0]);for(var o=e[tn][a][1];s[0]!==o;){if(s.push(o),a=n[o].filter(function(e){return t[e]}).shift(),void 0===a)return{vertices:[],edges:[]};if(e[tn][a][0]===o){var d=i(e[tn][a],2);o=d[1]}else{var l=i(e[tn][a],1);o=l[0]}t[a]=!1,r.push(a)}return{vertices:s,edges:r}},ur=function t(n){var r,s;if(e(n)!==En)return n;if(!n)return n;if("[object Array]"===Object.prototype.toString.apply(n)){for(r=[],s=0;s<n.length;s+=1)r[s]=t(n[s]);return r}for(s in r={},n)n.hasOwnProperty(s)&&(r[s]=t(n[s]));return r},hr=function t(i){return(Object.freeze(i),void 0===i)?i:(Object.getOwnPropertyNames(i).filter(function(t){return null!==i[t]&&(e(i[t])===En||e(i[t])==="function")&&!Object.isFrozen(i[t])}).forEach(function(e){return t(i[e])}),i)},mr=function(e,t){if(!1==fn in e||e[fn].length<t)return e;var i=[dn,ln],n={visited_frames:[]};return function e(t,i,r){if(-1!==n.visited_frames.indexOf(i))throw new Error("flatten error:cycle");return n.visited_frames.push(i),r=[i].concat(r),0===i?r:t[fn][i-1].frame_inherit&&null!=t[fn][i-1].frame_parent?e(t,t[fn][i-1].frame_parent,r):r}(e,t,[]).map(function(t){if(0===t){var n=e[fn];e[fn]=null;var r=ur(e);return e[fn]=n,delete r[fn],i.forEach(function(e){return delete r[e]}),r}var s=ur(e[fn][t-1]);return i.forEach(function(e){return delete s[e]}),s}).reduce(function(e,t){return Object.assign(e,t)},{})},vr=function(e){var t=(null==e[pn]?[]:e[pn]).join(" "),i=(null==e[gn]?[]:e[gn]).join(" ");return[t,i].filter(function(e){return""!==e}).join(" ")},yr=In.document,kr=Object.freeze({blur:.005,opacity:.3,color:An}),xr="result",br="in",Er="blur",Pr="offsetColor",Ar="offsetBlur",wr="feMergeNode",Nr="200%",Lr=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:kr;(e(t)!==En||null===t)&&(t={}),Object.keys(kr).filter(function(e){return!(e in t)}).forEach(function(e){t[e]=kr[e]});var i=yr[On](zn,"filter");i[jn](null,"width",Nr),i[jn](null,"height",Nr),i[jn](null,"id","shadow");var n=yr[On](zn,"feGaussianBlur");n[jn](null,br,"SourceAlpha"),n[jn](null,"stdDeviation",t.blur),n[jn](null,xr,Er);var r=yr[On](zn,"feOffset");r[jn](null,br,Er),r[jn](null,xr,Ar);var s=yr[On](zn,"feFlood");s[jn](null,"flood-color",t.color),s[jn](null,"flood-opacity",t.opacity),s[jn](null,xr,Pr);var a=yr[On](zn,"feComposite");a[jn](null,br,Pr),a[jn](null,"in2",Ar),a[jn](null,"operator",br),a[jn](null,xr,Ar);var c=yr[On](zn,"feMerge"),o=yr[On](zn,wr),d=yr[On](zn,wr);return d[jn](null,br,"SourceGraphic"),c[Cn](o),c[Cn](d),i[Cn](n),i[Cn](r),i[Cn](s),i[Cn](a),i[Cn](c),i},Or="none",jr="500px",Cr=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return hr({input:Pn,output:Pn,padding:null,file_frame:null,stylesheet:null,shadows:null,boundaries:!0,faces:!0,edges:!0,vertices:!1,attributes:{svg:{width:jr,height:jr,stroke:An,fill:Or,"stroke-linejoin":"bevel","stroke-width":e/200},boundaries:{fill:wn},faces:{stroke:Or,front:{stroke:An,fill:Nn},back:{stroke:An,fill:wn}},edges:{boundary:{},mountain:{stroke:"red"},valley:{stroke:"blue"},mark:{stroke:Nn},unassigned:{stroke:Nn}},vertices:{stroke:Or,fill:An,r:e/200}}})},Mr=function t(i,n){Object.keys(n).forEach(function(r){e(n[r])===En&&null!==n[r]?(!(r in i)&&(i[r]={}),t(i[r],n[r])):e(i)===En&&!(r in i)&&(i[r]=n[r])})},Tr=function(e){if(!1==en in e||!1==tn in e||!1==sn in e)return[];var t=_r(e).vertices.map(function(t){return e[en][t]});if(0===t.length)return[];var i=Un(t);return i[jn](null,xn,_n),[i]},Ir={vertices:Gn,edges:tr,faces:function(e){return null==e[nn]?fr(e):gr(e)},boundaries:Tr},zr=function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r="number"==typeof i.file_frame?mr(t,i.file_frame):t,s=pr(r),a=ee(s[2],s[3]);Mr(i,Cr(a));var c=Fn();Rn.apply(void 0,[c].concat(n(s),[i.padding]));var o=vr(r);""!==o&&c[jn](null,xn,o),Object.keys(i.attributes.svg).forEach(function(e){return c[jn](null,e,i.attributes.svg[e])});var d=null!=i.stylesheet||null!=i.shadows?Vn(c):void 0;if(null!=i.stylesheet){var l=Dn(d),g=i.attributes.svg[Ln]?i.attributes.svg[Ln]:a/200,f=new In.DOMParser().parseFromString("<xml></xml>","application/xml").createCDATASection("\n* { --".concat(Ln,": ").concat(g,"; }\n").concat(i.stylesheet));l[Cn](f)}if(null!=i.shadows){var p=e(i.shadows)===En&&null!==i.shadows?i.shadows:{blur:a/200};d[Cn](Lr(p))}var _={};if(["boundaries",Hi,$i,Wi].filter(function(e){return!0===i[e]}).forEach(function(e){_[e]=Bn(),_[e][jn](null,xn,e)}),Object.keys(_).filter(function(e){return void 0!==Ir[e]}).forEach(function(e){return Ir[e](r,i).forEach(function(t){return _[e][Cn](t)})}),Object.keys(_).filter(function(e){return 0<_[e].childNodes.length}).forEach(function(e){return c[Cn](_[e])}),_.edges){var u=[vn,mn,hn,un,_n];Object.keys(i.attributes.edges).filter(function(e){return!u.includes(e)}).forEach(function(e){return _.edges[jn](null,e,i.attributes.edges[e])}),Array.from(_.edges.childNodes).forEach(function(e){return Object.keys(i.attributes.edges[e.getAttribute(xn)]||{}).forEach(function(t){return e[jn](null,t,i.attributes.edges[e.getAttribute(xn)][t])})})}if(_.faces){var h=[yn,kn];Object.keys(i.attributes.faces).filter(function(e){return!h.includes(e)}).forEach(function(e){return _.faces[jn](null,e,i.attributes.faces[e])}),Array.from(_.faces.childNodes).forEach(function(e){return Object.keys(i.attributes.faces[e.getAttribute(xn)]||{}).forEach(function(t){return e[jn](null,t,i.attributes.faces[e.getAttribute(xn)][t])})}),null!=i.shadows&&Array.from(_.faces.childNodes).forEach(function(e){return e[jn](null,"filter","url(#shadow)")})}if(_.vertices&&(Object.keys(i.attributes.vertices).filter(function(e){return"r"!==e}).forEach(function(e){return _.vertices[jn](null,e,i.attributes.vertices[e])}),Array.from(_.vertices.childNodes).forEach(function(e){return e[jn](null,"r",i.attributes.vertices.r)})),_.boundaries&&Object.keys(i.attributes.boundaries).forEach(function(e){return _.boundaries[jn](null,e,i.attributes.boundaries[e])}),"svg"===i.output)return c;var m=new In.XMLSerializer().serializeToString(c),y=v(m);return y},Fr=function(t){if(null==t)return{};if(e(t)===En&&null!==t)return t;if(e(t)===Pn||t instanceof String)try{var i=JSON.parse(t);return i}catch(e){throw e}throw new TypeError("input requires ".concat(Pn," or ").concat(En))},Br=function(e,t){try{var i=Fr(e);return zr(i,t)}catch(e){throw e}};Br.vertices_circle=Gn,Br.edges_path_data=Jn,Br.edges_by_assignment_paths_data=er,Br.edges_path=tr,Br.edges_line=function(e){var t=Wn(e).map(function(t){return qn(t[0][0],t[0][1],t[1][0],t[1][1])});return t.forEach(function(e,t){return e[jn](null,bn,t)}),$n(e).forEach(function(e,n){return t[n][jn](null,xn,e)}),t},Br.faces_vertices_polygon=gr,Br.faces_edges_polygon=fr;var Vr={},Dr=function(e,t){return(+e%(t=+t)+t)%t};Vr.EPS=1e-6,Vr.sum=function(e,t){return e+t},Vr.min=function(e,t){return e<t?e:t},Vr.max=function(e,t){return e>t?e:t},Vr.all=function(e,t){return e&&t},Vr.next=function(e,t,n){return null==n&&(n=1),Dr(e+n,t)},Vr.rangesDisjoint=function(e,t){var i,n,r,s,a,c;return i=e[0],n=e[1],r=t[0],s=t[1],r<(a=ee(i,n))&&a>s||r>(c=te(i,n))&&c<s},Vr.topologicalSort=function(e){var t,i,n,r,s,a,c;for(t=0,n=e.length;t<n;t++)c=e[t],a=[!1,null],c.visited=a[0],c.parent=a[1];for(s=[],i=0,r=e.length;i<r;i++)c=e[i],c.visited||(s=Vr.visit(c,s));return s},Vr.visit=function(e,t){var i,n,r,s;for(e.visited=!0,r=e.children,(i=0,n=r.length);i<n;i++)(s=r[i],!!!s.visited)&&(s.parent=e,t=Vr.visit(s,t));return t.concat([e])},Vr.magsq=function(e){return Vr.dot(e,e)},Vr.mag=function(e){return ce(Vr.magsq(e))},Vr.unit=function(e,t){var i;return null==t&&(t=Vr.EPS),i=Vr.magsq(e),i<t?null:Vr.mul(e,1/Vr.mag(e))},Vr.ang2D=function(e,t){return null==t&&(t=Vr.EPS),Vr.magsq(e)<t?null:ae(e[1],e[0])},Vr.mul=function(e,t){var n,r,s,a;for(a=[],r=0,s=e.length;r<s;r++)n=e[r],a.push(n*t);return a},Vr.linearInterpolate=function(e,t,i){return Vr.plus(Vr.mul(t,1-e),Vr.mul(i,e))},Vr.plus=function(e,t){var n,r,s,a,c;for(c=[],r=s=0,a=e.length;s<a;r=++s)n=e[r],c.push(n+t[r]);return c},Vr.sub=function(e,t){return Vr.plus(e,Vr.mul(t,-1))},Vr.dot=function(e,t){var n,r;return function(){var i,s,a;for(a=[],r=i=0,s=e.length;i<s;r=++i)n=e[r],a.push(n*t[r]);return a}().reduce(Vr.sum)},Vr.distsq=function(e,t){return Vr.magsq(Vr.sub(e,t))},Vr.dist=function(e,t){return ce(Vr.distsq(e,t))},Vr.closestIndex=function(e,t){var n,r,s,a,c,o,d;for(o=2e308,s=a=0,c=t.length;a<c;s=++a)n=t[s],o>(r=Vr.dist(e,n))&&(o=r,d=s);return d},Vr.dir=function(e,t){return Vr.unit(Vr.sub(t,e))},Vr.ang=function(e,t){var i,n,r,s;return i=function(){var i,n,r,a;for(r=[e,t],a=[],(i=0,n=r.length);i<n;i++)s=r[i],a.push(Vr.unit(s));return a}(),n=i[0],r=i[1],null==n||null==r?null:J(Vr.dot(n,r))},Vr.cross=function(e,t){var n,r,s,a;return e.length===(s=t.length)&&2===s?e[0]*t[1]-e[1]*t[0]:e.length===(a=t.length)&&3===a?function(){var i,s,a,c,o;for(a=[[1,2],[2,0],[0,1]],o=[],(i=0,s=a.length);i<s;i++)c=a[i],n=c[0],r=c[1],o.push(e[n]*t[r]-e[r]*t[n]);return o}():null},Vr.parallel=function(e,t,i){var n,r,s,a;return null==i&&(i=Vr.EPS),n=function(){var i,n,r,s;for(r=[e,t],s=[],(i=0,n=r.length);i<n;i++)a=r[i],s.push(Vr.unit(a));return s}(),r=n[0],s=n[1],null==r||null==s?null:1-ne(Vr.dot(r,s))<i},Vr.rotate=function(e,n,r){var t,s,a,c,o,d,l,g,f,_;if(n=Vr.unit(n),null==n)return null;for(l=[se(r),re(r)],t=l[0],_=l[1],g=[[0,1,2],[1,2,0],[2,0,1]],f=[],(a=0,c=g.length);a<c;a++)o=g[a],f.push(function(){var i,r,a,c;for(a=[t,-_*n[o[2]],_*n[o[1]]],c=[],(s=i=0,r=a.length);i<r;s=++i)d=a[s],c.push(e[o[s]]*(n[o[0]]*n[o[s]]*(1-t)+d));return c}().reduce(Vr.sum));return f},Vr.interiorAngle=function(e,t,i){var n;return n=Vr.ang2D(Vr.sub(e,t))-Vr.ang2D(Vr.sub(i,t)),n+(0>n?2*ie:0)},Vr.turnAngle=function(e,t,i){return ie-Vr.interiorAngle(e,t,i)},Vr.triangleNormal=function(e,t,i){return Vr.unit(Vr.cross(Vr.sub(t,e),Vr.sub(i,t)))},Vr.polygonNormal=function(e,t){var n,r;return null==t&&(t=Vr.EPS),Vr.unit(function(){var t,i,s;for(s=[],n=t=0,i=e.length;t<i;n=++t)r=e[n],s.push(Vr.cross(r,e[Vr.next(n,e.length)]));return s}().reduce(Vr.plus),t)},Vr.twiceSignedArea=function(e){var t,n,r;return function(){var i,s,a;for(a=[],t=i=0,s=e.length;i<s;t=++i)n=e[t],r=e[Vr.next(t,e.length)],a.push(n[0]*r[1]-r[0]*n[1]);return a}().reduce(Vr.sum)},Vr.polygonOrientation=function(e){var t=Math.sign;return t(Vr.twiceSignedArea(e))},Vr.sortByAngle=function(e,t,i){return null==t&&(t=[0,0]),null==i&&(i=function(e){return e}),t=i(t),e.sort(function(e,n){var r,s;return r=Vr.ang2D(Vr.sub(i(e),t)),s=Vr.ang2D(Vr.sub(i(n),t)),r-s})},Vr.segmentsCross=function(e,t){var i,n,r,s;return i=e[0],r=e[1],n=t[0],s=t[1],!(Vr.rangesDisjoint([i[0],r[0]],[n[0],s[0]])||Vr.rangesDisjoint([i[1],r[1]],[n[1],s[1]]))&&Vr.polygonOrientation([i,r,n])!==Vr.polygonOrientation([i,r,s])&&Vr.polygonOrientation([n,s,i])!==Vr.polygonOrientation([n,s,r])},Vr.parametricLineIntersect=function(e,t){var i,n,r,s,a;return n=e[0],r=e[1],s=t[0],a=t[1],i=(a[1]-s[1])*(r[0]-n[0])+(s[0]-a[0])*(r[1]-n[1]),0===i?[null,null]:[(a[0]*(n[1]-s[1])+a[1]*(s[0]-n[0])+s[1]*n[0]-n[1]*s[0])/i,(s[0]*(r[1]-n[1])+s[1]*(n[0]-r[0])+n[1]*r[0]-r[1]*n[0])/i]},Vr.segmentIntersectSegment=function(e,i){var n,r,a;return n=Vr.parametricLineIntersect(e,i),r=n[0],a=n[1],null!=r&&0<=r&&1>=r&&0<=a&&1>=a?Vr.linearInterpolate(r,e[0],e[1]):null},Vr.lineIntersectLine=function(e,i){var n,r,a;return n=Vr.parametricLineIntersect(e,i),r=n[0],a=n[1],null==r?null:Vr.linearInterpolate(r,e[0],e[1])},Vr.pointStrictlyInSegment=function(e,t,i){var n,r;return null==i&&(i=Vr.EPS),n=Vr.sub(e,t[0]),r=Vr.sub(e,t[1]),Vr.parallel(n,r,i)&&0>Vr.dot(n,r)},Vr.centroid=function(e){return Vr.mul(e.reduce(Vr.plus),1/e.length)},Vr.basis=function(e,t){var i,r,s,a,c,o,l,g;return(null==t&&(t=Vr.EPS),function(){var t,i,n;for(n=[],t=0,i=e.length;t<i;t++)c=e[t],n.push(3!==c.length);return n}().reduce(Vr.all))?null:(r=function(){var i,n,r;for(r=[],i=0,n=e.length;i<n;i++)c=e[i],Vr.distsq(c,e[0])>t&&r.push(Vr.dir(c,e[0]));return r}(),0===r.length)?[]:(o=r[0],function(){var e,n,s;for(s=[],e=0,n=r.length;e<n;e++)i=r[e],s.push(Vr.parallel(i,o,t));return s}().reduce(Vr.all))?[o]:(a=function(){var e,t,n;for(n=[],e=0,t=r.length;e<t;e++)i=r[e],n.push(Vr.unit(Vr.cross(i,o)));return n}(),a=function(){var e,t,i;for(i=[],e=0,t=a.length;e<t;e++)s=a[e],null!=s&&i.push(s);return i}(),g=a[0],l=Vr.cross(g,o),function(){var e,i,n;for(n=[],e=0,i=a.length;e<i;e++)s=a[e],n.push(Vr.parallel(s,g,t));return n}().reduce(Vr.all)?[o,l]:[o,l,g])},Vr.above=function(e,t,i,n){var r,s,a,c,o;return null==n&&(n=Vr.EPS),a=function(){var n,r,s,a;for(s=[e,t],a=[],(n=0,r=s.length);n<r;n++)o=s[n],a.push(function(){var e,t,n;for(n=[],e=0,t=o.length;e<t;e++)c=o[e],n.push(Vr.dot(c,i));return n}());return a}(),r=a[0],s=a[1],s.reduce(Vr.max)-r.reduce(Vr.min)<n?1:r.reduce(Vr.max)-s.reduce(Vr.min)<n?-1:0},Vr.separatingDirection2D=function(e,r,s,n){var a,c,d,g,f,_,u,h,v,y,x,b,E,P;for(null==n&&(n=Vr.EPS),b=[e,r],(d=0,f=b.length);d<f;d++)for(P=b[d],a=g=0,_=P.length;g<_;a=++g)for(y=P[a],c=v=0,u=P.length;v<u;c=++v)if((x=P[c],!!(a<c))&&(h=Vr.unit(Vr.cross(Vr.sub(y,x),s)),null!=h&&(E=Vr.above(e,r,h,n),0!==E)))return Vr.mul(h,E);return null},Vr.separatingDirection3D=function(e,t,n){var s,a,c,d,g,f,_,u,h,v,y,x,b,E,P,S,A,w,N;for(null==n&&(n=Vr.EPS),P=[[e,t],[t,e]],(c=0,g=P.length);c<g;c++)for(S=P[c],w=S[0],N=S[1],(d=0,f=w.length);d<f;d++)for(y=w[d],s=v=0,_=N.length;v<_;s=++v)for(x=N[s],a=E=0,u=N.length;E<u;a=++E)if((b=N[a],!!(s<a))&&(h=Vr.unit(Vr.cross(Vr.sub(y,x),Vr.sub(y,b))),null!=h&&(A=Vr.above(e,t,h,n),0!==A)))return Vr.mul(h,A);return null},Vr.circleCross=function(e,t,i){var n,r;return n=(e*e-i*i+t*t)/e/2,r=ce(t*t-n*n),[n,r]},Vr.creaseDir=function(e,t,i,n,r){var s,a,c,o,d,l;return null==r&&(r=Vr.EPS),s=se(i)+se(n),a=se(i)-se(n),c=Vr.plus(e,t),o=Vr.sub(e,t),d=Vr.unit(Vr.cross(o,c)),c=Vr.mul(c,s/Vr.magsq(c)),o=Vr.mul(o,Vr.magsq(o)<r?0:a/Vr.magsq(o)),l=ce(1-Vr.magsq(c)-Vr.magsq(o)),d=Vr.mul(d,l),[c,o,d].reduce(Vr.plus)},Vr.quadSplit=function(e,i,n,r){if(Vr.magsq(i)>n*n)throw new Error("STOP! Trying to split expansive quad.");return Vr.mul(e,(n*n-Vr.magsq(i))/2/(n*se(r)-Vr.dot(e,i)))};var Rr={},qr=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};Rr.edgesAssigned=function(e,t){var n,r,s,a,c,o;for(c=e.edges_assignment,o=[],(r=s=0,a=c.length);s<a;r=++s)n=c[r],n===t&&o.push(r);return o},Rr.mountainEdges=function(e){return Rr.edgesAssigned(e,"M")},Rr.valleyEdges=function(e){return Rr.edgesAssigned(e,"V")},Rr.flatEdges=function(e){return Rr.edgesAssigned(e,"F")},Rr.boundaryEdges=function(e){return Rr.edgesAssigned(e,"B")},Rr.unassignedEdges=function(e){return Rr.edgesAssigned(e,"U")},Rr.keysStartingWith=function(e,t){var i,n;for(i in n=[],e)i.slice(0,t.length)===t&&n.push(i);return n},Rr.keysEndingWith=function(e,t){var i,n;for(i in n=[],e)i.slice(-t.length)===t&&n.push(i);return n},Rr.remapField=function(e,t,n){var r,s,a,c,o,d,g,f,p,_,u,h,v,y;for(u=[],s=c=0,g=n.length;c<g;s=++c)a=n[s],null!=a&&(u[a]=s);for(v=Rr.keysStartingWith(e,t+"_"),d=0,f=v.length;d<f;d++)o=v[d],e[o]=function(){var t,i,n;for(n=[],i=0,t=u.length;i<t;i++)h=u[i],n.push(e[o][h]);return n}();for(y=Rr.keysEndingWith(e,"_"+t),_=0,p=y.length;_<p;_++)o=y[_],e[o]=function(){var t,i,s,a;for(s=e[o],a=[],(i=0,t=s.length);i<t;i++)r=s[i],a.push(function(){var e,t,i;for(i=[],t=0,e=r.length;t<e;t++)h=r[t],i.push(n[h]);return i}());return a}();return e},Rr.remapFieldSubset=function(e,t,i){var n,r,s;return n=0,r=function(){var e,t,r;for(r=[],e=0,t=i.length;e<t;e++)s=i[e],s?r.push(n++):r.push(null);return r}(),Rr.remapField(e,t,r),r},Rr.numType=function(e,t){var i,n,r;return i=function(){var i,s,a,c;for(a=Rr.keysStartingWith(e,t+"_"),c=[],(i=0,s=a.length);i<s;i++)(n=a[i],r=e[n],null!=r.length)&&c.push(r.length);return c}(),i.length||(i=function(){var i,r,s,a;for(s=Rr.keysEndingWith(e,"_"+t),a=[],(i=0,r=s.length);i<r;i++)n=s[i],a.push(1+te.apply(Math,e[n]));return a}()),i.length?te.apply(Math,i):0},Rr.numVertices=function(e){return Rr.numType(e,"vertices")},Rr.numEdges=function(e){return Rr.numType(e,"edges")},Rr.numFaces=function(e){return Rr.numType(e,"faces")},Rr.removeDuplicateEdges_vertices=function(e){var t,i,n,r,s,a,c;return s={},i=0,r=function(){var r,o,d,l;for(d=e.edges_vertices,l=[],(r=0,o=d.length);r<o;r++)t=d[r],a=t[0],c=t[1],n=a<c?a+","+c:c+","+a,n in s||(s[n]=i,i+=1),l.push(s[n]);return l}(),Rr.remapField(e,"edges",r),r},Rr.edges_verticesIncident=function(e,t){var i,n,r;for(i=0,n=e.length;i<n;i++)if(r=e[i],0<=qr.call(t,r))return r;return null};var Xr=function(){var t=Math.round;function e(e,t){var i,n,r,s,a,c,o;for(this.vertices_coords=e,this.epsilon=t,this.hash={},c=this.vertices_coords,(o=r=0,s=c.length);r<s;o=++r)n=c[o],(null==(i=this.hash)[a=this.key(n)]?i[a]=[]:i[a]).push(o)}return e.prototype.lookup=function(e){var i,n,r,s,a,c,o,d,g,f,p,_,u,h,b,E,P,S;for(u=e[0],E=e[1],h=t(u/this.epsilon),P=t(E/this.epsilon),d=[h,h-1,h+1],(i=0,s=d.length);i<s;i++)for(b=d[i],g=[P,P-1,P+1],(r=0,a=g.length);r<a;r++)for(S=g[r],n=b+","+S,p=null==(f=this.hash[n])?[]:f,(o=0,c=p.length);o<c;o++)if(_=p[o],this.epsilon>Vr.dist(this.vertices_coords[_],e))return _;return null},e.prototype.key=function(e){var i,n,r,s,a;return n=e[0],s=e[1],r=t(n/this.epsilon),a=t(s/this.epsilon),i=r+","+a},e.prototype.insert=function(e){var t,i,n;return(n=this.lookup(e),null!=n)?n:((null==(t=this.hash)[i=this.key(e)]?t[i]=[]:t[i]).push(n=this.vertices_coords.length),this.vertices_coords.push(e),n)},e}();Rr.collapseNearbyVertices=function(e,t){var i,n,r;return r=new Xr([],t),n=function(){var t,n,s,a;for(s=e.vertices_coords,a=[],(t=0,n=s.length);t<n;t++)i=s[t],a.push(r.insert(i));return a}(),Rr.remapField(e,"vertices",n)},Rr.maybeAddVertex=function(e,t,n){var r;return r=Vr.closestIndex(t,e.vertices_coords),null!=r&&n>=Vr.dist(t,e.vertices_coords[r])?r:e.vertices_coords.push(t)-1},Rr.addVertexLike=function(e,t){var i,n,r,s,a;for(a=Rr.numVertices(e),s=Rr.keysStartingWith(e,"vertices_"),(i=0,r=s.length);i<r;i++)switch(n=s[i],n.slice(6)){case"vertices":break;default:e[n][a]=e[n][t];}return a},Rr.addEdgeLike=function(e,t,i,n){var r,s,a,c,o;for(r=e.edges_vertices.length,o=Rr.keysStartingWith(e,"edges_"),(s=0,c=o.length);s<c;s++)switch(a=o[s],a.slice(6)){case"vertices":e.edges_vertices.push([null==i?e.edges_vertices[t][0]:i,null==n?e.edges_vertices[t][1]:n]);break;case"edges":break;default:e[a][r]=e[a][t];}return r},Rr.addVertexAndSubdivide=function(t,n,r){var a,c,o,d,l,g,f,p,_,h;if(h=Rr.maybeAddVertex(t,n,r),a=[],h===t.vertices_coords.length-1)for(f=t.edges_vertices,o=l=0,g=f.length;l<g;o=++l)(c=f[o],!(0<=qr.call(c,h)))&&(p=function(){var e,i,n;for(n=[],e=0,i=c.length;e<i;e++)_=c[e],n.push(t.vertices_coords[_]);return n}(),Vr.pointStrictlyInSegment(n,p)&&(d=Rr.addEdgeLike(t,o,h,c[1]),a.push(o,d),c[1]=h));return[h,a]},Rr.removeLoopEdges=function(e){var t;return Rr.remapFieldSubset(e,"edges",function(){var i,n,r,s;for(r=e.edges_vertices,s=[],(i=0,n=r.length);i<n;i++)t=r[i],s.push(t[0]!==t[1]);return s}())},Rr.subdivideCrossingEdges_vertices=function(t,r,a){var c,d,g,f,_,o,h,y,x,b,E,P,S,A,w,N,L,O,j,C,M,T,I,z,F,B,V,D,R,q;for(d=[[],[]],c=function(e,i,n,r){var s;return s=Rr.addEdgeLike(t,n,e,i),d[r].push(n,s)},y=null==a?0:a;y<t.edges_vertices.length;){for(_=t.edges_vertices[y],F=function(){var e,i,n;for(n=[],e=0,i=_.length;e<i;e++)D=_[e],n.push(t.vertices_coords[D]);return n}(),M=t.vertices_coords,(R=E=0,S=M.length);E<S;R=++E)(C=M[R],!(0<=qr.call(_,R)))&&Vr.pointStrictlyInSegment(C,F)&&(c(R,_[1],y,0),_[1]=R);y++}for(q=new Xr(t.vertices_coords,r),x=null==a?0:a;x<t.edges_vertices.length;){for(o=t.edges_vertices[x],B=function(){var e,i,n;for(n=[],e=0,i=o.length;e<i;e++)R=o[e],n.push(t.vertices_coords[R]);return n}(),T=t.edges_vertices.slice(0,x),(b=P=0,A=T.length);P<A;b=++P)if(h=T[b],V=function(){var e,i,n;for(n=[],i=0,e=h.length;i<e;i++)R=h[i],n.push(t.vertices_coords[R]);return n}(),!Rr.edges_verticesIncident(o,h)&&Vr.segmentsCross(B,V)){if(g=Vr.lineIntersectLine(B,V),null==g)continue;f=q.insert(g),0<=qr.call(o,f)&&0<=qr.call(h,f)||(0>qr.call(o,f)&&(c(f,o[1],x,0),o[1]=f,B[1]=t.vertices_coords[f]),0>qr.call(h,f)&&(c(f,h[1],b,1),h[1]=f))}x++}for(j=Rr.removeDuplicateEdges_vertices(t),I=[0,1],(L=0,w=I.length);L<w;L++)y=I[L],d[y]=function(){var e,t,i,r;for(i=d[y],r=[],(t=0,e=i.length);t<e;t++)_=i[t],r.push(j[_]);return r}();for(j=Rr.removeLoopEdges(t),z=[0,1],(O=0,N=z.length);O<N;O++)y=z[O],d[y]=function(){var e,t,i,n;for(i=d[y],n=[],(t=0,e=i.length);t<e;t++)_=i[t],n.push(j[_]);return n}();return null==a?d[0].concat(d[1]):d},Rr.addEdgeAndSubdivide=function(t,n,r,s){var a,c,o,d,l,g,f,p,_,u,h,m,v;if(null!=n.length&&(_=Rr.addVertexAndSubdivide(t,n,s),n=_[0],c=_[1]),null!=r.length&&(u=Rr.addVertexAndSubdivide(t,r,s),r=u[0],o=u[1]),n===r)return[[],[]];for(h=t.edges_vertices,l=f=0,p=h.length;f<p;l=++f)if(d=h[l],d[0]===n&&d[1]===r||d[0]===r&&d[1]===n)return[[l],[]];return g=t.edges_vertices.push([n,r])-1,g?(a=Rr.subdivideCrossingEdges_vertices(t,s,g),0>qr.call(a[0],g)&&a[0].push(g)):a=[[g],[]],null!=c&&(m=a[1]).push.apply(m,c),null!=o&&(v=a[1]).push.apply(v,o),a},Rr.cutEdges=function(s,a){var c,d,g,f,p,_,u,h,y,x,b,E,P,S,A,w,N,L,O,j,C,M,T,I,z,F,B,V,D,R,X,U,Y,G,Z,K,W,H,$,Q,J,te,ne,re,se,ae,ce,oe,de;for(de=[],X=Rr.boundaryEdges(s),(S=0,w=X.length);S<w;S++)for(f=X[S],U=s.edges_vertices[f],(A=0,N=U.length);A<N;A++)se=U[A],(null==de[se]?de[se]=[]:de[se]).push(f);for(I=0,L=a.length;I<L;I++){for(p=a[I],_=Rr.addEdgeLike(s,p),G=s.edges_vertices[p],(h=z=0,O=G.length);z<O;h=++z)se=G[h],oe=s.vertices_edges[se],oe.splice(oe.indexOf(p)+h,0,_);for(Z=s.edges_vertices[p],h=V=0,j=Z.length;V<j;h=++V)if(ae=Z[h],ne=s.edges_vertices[p][1-h],re=s.edges_vertices[_][1-h],g=null==(K=de[ae])?void 0:K.length,2<=g){if(2<g)throw new Error(de[ae].length+" boundary edges at vertex "+ae);if(W=de[ae],c=W[0],d=W[1],B=s.vertices_edges[ae],y=B.indexOf(c),x=B.indexOf(d),x===(y+1)%B.length)0!==x&&(B=B.slice(x).concat(B.slice(0,+y+1||9e9)));else if(y===(x+1)%B.length)0!==y&&(B=B.slice(y).concat(B.slice(0,+x+1||9e9)));else throw new Error("Nonadjacent boundary edges at vertex "+ae);for(E=B.indexOf(p),P=B.indexOf(_),b=ee(E,P),s.vertices_edges[ae]=B.slice(0,+b+1||9e9),ce=Rr.addVertexLike(s,ae),s.vertices_edges[ce]=B.slice(1+b),H=s.vertices_edges[ce],(D=0,C=H.length);D<C;D++)F=H[D],u=s.edges_vertices[F],u[u.indexOf(ae)]=ce}for(null!=($=s.edges_assignment)&&($[p]="B"),null!=(Q=s.edges_assignment)&&(Q[_]="B"),J=s.edges_vertices[p],(h=R=0,M=J.length);R<M;h=++R)se=J[h],(null==de[se]?de[se]=[]:de[se]).push(p);for(Y=s.edges_vertices[_],h=te=0,T=Y.length;te<T;h=++te)se=Y[h],(null==de[se]?de[se]=[]:de[se]).push(_)}return delete s.vertices_vertices,s},Rr.edges_vertices_to_vertices_vertices=function(e){var t,i,n,r,s,a,c,o;for(r=Rr.numVertices(e),c=function(){var e,t,i;for(i=[],a=e=0,t=r;0<=t?e<t:e>t;a=0<=t?++e:--e)i.push([]);return i}(),s=e.edges_vertices,(i=0,n=s.length);i<n;i++){for(t=s[i],a=t[0],o=t[1];a>=c.length;)c.push([]);for(;o>=c.length;)c.push([]);c[a].push(o),c[o].push(a)}return c};var Ur={},Yr=function(e,t){return(+e%(t=+t)+t)%t},Gr={}.hasOwnProperty;Ur.edges_vertices_to_vertices_vertices_unsorted=function(e){return e.vertices_vertices=Rr.edges_vertices_to_vertices_vertices(e),e},Ur.edges_vertices_to_vertices_vertices_sorted=function(e){return Ur.edges_vertices_to_vertices_vertices_unsorted(e),Ur.sort_vertices_vertices(e)},Ur.edges_vertices_to_vertices_edges_sorted=function(e){return Ur.edges_vertices_to_vertices_vertices_sorted(e),Ur.vertices_vertices_to_vertices_edges(e)},Ur.sort_vertices_vertices=function(e){var t,i,n,r,s;if(2!==(null==(i=e.vertices_coords)||null==(n=i[0])?void 0:n.length))throw console.log("fold.vertices_coords",e.vertices_coords),new Error("sort_vertices_vertices: Vertex coordinates missing or not two dimensional");for(s in null==e.vertices_vertices&&Ur.edges_vertices_to_vertices_vertices(e),r=e.vertices_vertices,r)t=r[s],Vr.sortByAngle(t,s,function(t){return e.vertices_coords[t]});return e},Ur.vertices_vertices_to_faces_vertices=function(e){var t,n,r,s,a,c,o,d,g,f,p,_,h,m,y,b,E,P,S,A;for(p={},_=e.vertices_vertices,(P=r=0,o=_.length);r<o;P=++r)for(f=_[P],n=s=0,d=f.length;s<d;n=++s)b=f[n],p[b+","+P]=f[Yr(n-1,f.length)];for(e.faces_vertices=[],h=function(){var e;for(a in e=[],p)e.push(a);return e}(),(c=0,g=h.length);c<g;c++)if(E=h[c],S=p[E],null!=S){for(p[E]=null,m=E.split(","),b=m[0],P=m[1],b=parseInt(b),P=parseInt(P),t=[b,P];S!==t[0];){if(null==S){console.warn("Confusion with face "+t);break}t.push(S),y=[P,S],b=y[0],P=y[1],S=p[b+","+P],p[b+","+P]=null}p[t[t.length-1]+","+t[0]]=null,null!=S&&0<Vr.polygonOrientation(function(){var i,n,r;for(r=[],n=0,i=t.length;n<i;n++)A=t[n],r.push(e.vertices_coords[A]);return r}())&&e.faces_vertices.push(t)}return e},Ur.vertices_edges_to_faces_vertices_edges=function(t){var n,r,s,a,c,o,d,g,f,p,_,u,h,y,b,E,P,S,A,w,N,L;for(b=[],P=t.vertices_edges,(A=o=0,f=P.length);o<f;A=++o)for(y=P[A],b[A]={},(c=d=0,p=y.length);d<p;c=++d)n=y[c],b[A][n]=y[Yr(c-1,y.length)];for(t.faces_vertices=[],t.faces_edges=[],(w=g=0,_=b.length);g<_;w=++g)for(r in E=b[w],E)if(s=E[r],null!=s){if(r=parseInt(r),E[r]=null,a=[r],N=[Rr.edges_verticesIncident(t.edges_vertices[r],t.edges_vertices[s])],null==N[0])throw new Error("Confusion at edges "+r+" and "+s);for(;s!==a[0];){if(null==s){console.warn("Confusion with face containing edges "+a);break}for(a.push(s),S=t.edges_vertices[s],(h=0,u=S.length);h<u;h++)if(A=S[h],A!==N[N.length-1]){N.push(A);break}r=s,s=b[A][r],b[A][r]=null}null!=s&&0<Vr.polygonOrientation(function(){var e,i,r;for(r=[],i=0,e=N.length;i<e;i++)L=N[i],r.push(t.vertices_coords[L]);return r}())&&(t.faces_vertices.push(N),t.faces_edges.push(a))}return t},Ur.edges_vertices_to_faces_vertices=function(e){return Ur.edges_vertices_to_vertices_vertices_sorted(e),Ur.vertices_vertices_to_faces_vertices(e)},Ur.edges_vertices_to_faces_vertices_edges=function(e){return Ur.edges_vertices_to_vertices_edges_sorted(e),Ur.vertices_edges_to_faces_vertices_edges(e)},Ur.vertices_vertices_to_vertices_edges=function(e){var t,n,r,s,a,c,o,d,l,g,f;for(n={},c=e.edges_vertices,(t=s=0,a=c.length);s<a;t=++s)o=c[t],d=o[0],l=o[1],n[d+","+l]=t,n[l+","+d]=t;return e.vertices_edges=function(){var t,i,s,a;for(s=e.vertices_vertices,a=[],(g=t=0,i=s.length);t<i;g=++t)f=s[g],a.push(function(){var e,t,i;for(i=[],r=e=0,t=f.length;0<=t?e<t:e>t;r=0<=t?++e:--e)i.push(n[g+","+f[r]]);return i}());return a}()},Ur.faces_vertices_to_faces_edges=function(e){var t,n,r,s,a,c,o,d,l,g,f;for(n={},o=e.edges_vertices,(t=a=0,c=o.length);a<c;t=++a)d=o[t],l=d[0],g=d[1],n[l+","+g]=t,n[g+","+l]=t;return e.faces_edges=function(){var t,i,a,c;for(a=e.faces_vertices,c=[],(r=t=0,i=a.length);t<i;r=++t)f=a[r],c.push(function(){var e,t,i;for(i=[],s=e=0,t=f.length;0<=t?e<t:e>t;s=0<=t?++e:--e)i.push(n[f[s]+","+f[(s+1)%f.length]]);return i}());return c}()},Ur.faces_vertices_to_edges=function(e){var t,n,r,s,a,c,o,d,l;for(r in e.edges_vertices=[],e.edges_faces=[],e.faces_edges=[],e.edges_assignment=[],n={},c=e.faces_vertices,c)l=c[r],r=parseInt(r),e.faces_edges.push(function(){var i,c,g;for(g=[],s=i=0,c=l.length;i<c;s=++i)o=l[s],o=parseInt(o),d=l[(s+1)%l.length],a=o<=d?o+","+d:d+","+o,a in n?t=n[a]:(t=n[a]=e.edges_vertices.length,o<=d?e.edges_vertices.push([o,d]):e.edges_vertices.push([d,o]),e.edges_faces.push([null,null]),e.edges_assignment.push("B")),o<=d?e.edges_faces[t][0]=r:e.edges_faces[t][1]=r,g.push(t);return g}());return e},Ur.deepCopy=function(t){var i,n,r,s,a,c,o,d;if("number"===(c=e(t))||"string"===c||"boolean"===c)return t;if(Array.isArray(t)){for(o=[],r=0,a=t.length;r<a;r++)n=t[r],o.push(Ur.deepCopy(n));return o}for(s in i={},t)Gr.call(t,s)&&(d=t[s],i[s]=Ur.deepCopy(d));return i},Ur.toJSON=function(e){var t,i,n;return"{\n"+function(){var r=[];for(var s=Object.keys(e),a=0;a<s.length;a++)t=s[a],n=e[t],r.push("  "+JSON.stringify(t)+": "+(Array.isArray(n)?"[\n"+function(){var e,t,r;for(r=[],e=0,t=n.length;e<t;e++)i=n[e],r.push("    "+JSON.stringify(i));return r}().join(",\n")+"\n  ]":JSON.stringify(n)));return r}().join(",\n")+"\n}\n"},Ur.extensions={},Ur.converters={},Ur.getConverter=function(e,t){return e===t?function(e){return e}:Ur.converters[""+e+t]},Ur.setConverter=function(e,t,i){return Ur.extensions[e]=!0,Ur.extensions[t]=!0,Ur.converters[""+e+t]=i},Ur.convertFromTo=function(e,t,i){var n;if("."!==t[0]&&(t="."+t),"."!==i[0]&&(i="."+i),n=Ur.getConverter(t,i),null==n){if(t===i)return e;throw new Error("No converter from "+t+" to "+i)}return n(e)},Ur.convertFrom=function(e,t){return Ur.convertFromTo(e,t,".fold")},Ur.convertTo=function(e,t){return Ur.convertFromTo(e,".fold",t)};var Zr={type2fold:{0:"F",1:"B",2:"M",3:"V"},fold2type:{}},Kr=Zr.type2fold;for(var Wr in Kr){var x=Kr[Wr];Zr.fold2type[x]=Wr}Zr.fold2type_default=0,Zr.prop_xml2fold={editorName:"frame_author",originalAuthorName:"frame_designer",reference:"frame_reference",title:"frame_title",memo:"frame_description",paperSize:null,mainVersion:null,subVersion:null},Zr.POINT_EPS=1,Zr.toFold=function(e,t){var i,r,s,a,c,o,d,g,f,p,_,u,h,v,y,x,b,E,P,S,A,w,N,L,O,C,M,T,I,z,F,B,V,D;for(r={vertices_coords:[],edges_vertices:[],edges_assignment:[],file_creator:"oripa2fold"},I=function(e,t){var i;return i=r.vertices_coords.length,r.vertices_coords.push([parseFloat(e),parseFloat(t)]),i},y=function(e,t,i,n){return null!=t&&e.tagName!==t?(console.warn("ORIPA file has "+e.tagName+" where "+t+" was expected"),null):null==i||e.hasAttribute(i)&&(null==n||e.getAttribute(i)===n)?e:(console.warn("ORIPA file has "+e.tagName+" with "+i+" = "+e.getAttribute(i)+" where "+n+" was expected"),null)},i=function(e){var t,i,n,r,s;if(e){for(r=e.childNodes,s=[],(i=0,n=r.length);i<n;i++)t=r[i],1===t.nodeType&&s.push(t);return s}return[]},b=function(e,t,n,r){var s;return s=i(e),1===s.length?y(s[0],t,n,r):(console.warn("ORIPA file has "+e.tagName+" with "+e.childNodes.length+" children, not 1"),null)},E=function(e){var t;return 1<e.childNodes.length?(console.warn("ORIPA file has "+e.tagName+" with "+e.childNodes.length+" children, not 0 or 1"),null):0===e.childNodes.length?"":(t=e.childNodes[0],3===t.nodeType?t.data:console.warn("ORIPA file has nodeType "+t.nodeType+" where 3 (text) was expected"))},B=!0===t?e:new DOMParser().parseFromString(e,"text/xml").documentElement,A=i(B),(s=0,o=A.length);s<o;s++)if(M=A[s],y(M,"object","class","oripa.DataSet"))for(w=i(M),a=0,d=w.length;a<d;a++)if(S=w[a],"lines"===S.getAttribute("property")){for(u=b(S,"array","class","oripa.OriLineProxy"),N=i(u),(c=0,g=N.length);c<g;c++)if(_=N[c],y(_,"void","index"))for(L=i(_),h=0,f=L.length;h<f;h++)if(x=L[h],y(x,"object","class","oripa.OriLineProxy")){for(z=F=V=D=T=0,O=i(x),(v=0,p=O.length);v<p;v++)if(C=O[v],y(C,"void","property"))switch(C.getAttribute("property")){case"x0":z=E(b(C,"double"));break;case"x1":F=E(b(C,"double"));break;case"y0":V=E(b(C,"double"));break;case"y1":D=E(b(C,"double"));break;case"type":T=E(b(C,"int"));}null!=z&&null!=F&&null!=V&&null!=D?(r.edges_vertices.push([I(z,V),I(F,D)]),null!=T&&(T=parseInt(T)),r.edges_assignment.push(Zr.type2fold[T])):console.warn("ORIPA line has missing data: "+z+" "+F+" "+V+" "+D+" "+T)}}else S.getAttribute("property")in Zr.prop_xml2fold?(P=Zr.prop_xml2fold[S.getAttribute("property")],null!=P&&(r[P]=E(b(S,"string")))):console.warn("Ignoring "+S.tagName+" "+M.getAttribute("property")+" in ORIPA file");return Rr.collapseNearbyVertices(r,Zr.POINT_EPS),Rr.subdivideCrossingEdges_vertices(r,Zr.POINT_EPS),Ur.edges_vertices_to_faces_vertices(r),r},Zr.fromFold=function(e){var t,n,r,a,c,o,d,l,g,f,p,_,u;for(u in"string"==typeof e&&(e=JSON.parse(e)),f="<?xml version=\"1.0\" encoding=\"UTF-8\"?> \n<java version=\"1.5.0_05\" class=\"java.beans.XMLDecoder\"> \n <object class=\"oripa.DataSet\"> \n  <void property=\"mainVersion\"> \n   <int>1</int> \n  </void> \n  <void property=\"subVersion\"> \n   <int>1</int> \n  </void> \n  <void property=\"paperSize\"> \n   <double>400.0</double> \n  </void> \n",g=Zr.prop_xml2fold,g)r=g[u],f+=(".\n  <void property=\""+u+"\"> \n   <string>"+(e[r]||"")+"</string> \n  </void> \n").slice(2);for(l=function(){var i,r,s,a;for(s=e.edges_vertices,a=[],(n=i=0,r=s.length);i<r;n=++i)t=s[n],_=function(){var i,n,r,s,a,c;for(c=[],i=0,r=t.length;i<r;i++){for(p=t[i],a=e.vertices_coords[p].slice(2),(n=0,s=a.length);n<s;n++)a[n];c.push(e.vertices_coords[p])}return c}(),a.push({x0:_[0][0],y0:_[0][1],x1:_[1][0],y1:_[1][1],type:Zr.fold2type[e.edges_assignment[n]]||Zr.fold2type_default});return a}(),f+=(".\n  <void property=\"lines\"> \n   <array class=\"oripa.OriLineProxy\" length=\""+l.length+"\"> \n").slice(2),(a=c=0,o=l.length);c<o;a=++c)d=l[a],f+=(".\n    <void index=\""+a+"\"> \n     <object class=\"oripa.OriLineProxy\"> \n      <void property=\"type\"> \n       <int>"+d.type+"</int> \n      </void> \n      <void property=\"x0\"> \n       <double>"+d.x0+"</double> \n      </void> \n      <void property=\"x1\"> \n       <double>"+d.x1+"</double> \n      </void> \n      <void property=\"y0\"> \n       <double>"+d.y0+"</double> \n      </void> \n      <void property=\"y1\"> \n       <double>"+d.y1+"</double> \n      </void> \n     </object> \n    </void> \n").slice(2);return f+=".\n   </array> \n  </void> \n </object> \n</java> \n".slice(2),f};var y="undefined"!=typeof window&&"undefined"!=typeof window.document,Hr="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,$r="object"===("undefined"==typeof self?"undefined":e(self))&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,Qr=function(){var e={};if(Hr){var t=require("xmldom"),i=t.DOMParser,n=t.XMLSerializer;e.DOMParser=i,e.XMLSerializer=n,e.document=new i().parseFromString("<!DOCTYPE html><title> </title>","text/html")}else y&&(e=window);return e}(),Jr={black:"#000000",silver:"#c0c0c0",gray:"#808080",white:"#ffffff",maroon:"#800000",red:"#ff0000",purple:"#800080",fuchsia:"#ff00ff",green:"#008000",lime:"#00ff00",olive:"#808000",yellow:"#ffff00",navy:"#000080",blue:"#0000ff",teal:"#008080",aqua:"#00ffff",orange:"#ffa500",aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",blanchedalmond:"#ffebcd",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",oldlace:"#fdf5e6",olivedrab:"#6b8e23",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",whitesmoke:"#f5f5f5",yellowgreen:"#9acd32"},es=Object.keys(Jr),ts=function(e){var t=0,i=0,n=0,s=255;return 4===e.length?(t="0x".concat(e[1]).concat(e[1]),i="0x".concat(e[2]).concat(e[2]),n="0x".concat(e[3]).concat(e[3])):7===e.length?(t="0x".concat(e[1]).concat(e[2]),i="0x".concat(e[3]).concat(e[4]),n="0x".concat(e[5]).concat(e[6])):5===e.length?(t="0x".concat(e[1]).concat(e[1]),i="0x".concat(e[2]).concat(e[2]),n="0x".concat(e[3]).concat(e[3]),s="0x".concat(e[4]).concat(e[4])):9===e.length&&(t="0x".concat(e[1]).concat(e[2]),i="0x".concat(e[3]).concat(e[4]),n="0x".concat(e[5]).concat(e[6]),s="0x".concat(e[7]).concat(e[8])),[+(t/255),+(i/255),+(n/255),+(s/255)]},is=function(e){if(null==e||"string"!=typeof e)return"U";var t=[0,0,0,1];"#"===e[0]?t=ts(e):-1!==es.indexOf(e)&&(t=ts(Jr[e]));var i=.05;return t[0]<i&&t[1]<i&&t[2]<i?"U":t[0]>t[1]&&t[0]-t[2]>i?"M":t[2]>t[1]&&t[2]-t[0]>i?"V":"U"},ns=1e-6,rs=function(e){var t=e.map(function(e){return e*e}).reduce(function(e,t){return e+t},0);return ce(t)},ss=function(e,t){return e>ns&&e<1-ns&&t>ns&&t<1-ns},as=function(e,t,i,n,r){function s(e,t){return e[0]*t[1]-t[0]*e[1]}var a=5<arguments.length&&void 0!==arguments[5]?arguments[5]:ns,c=s(t,n);if(!(ne(c)<a)){var o=s([i[0]-e[0],i[1]-e[1]],n),d=s([e[0]-i[0],e[1]-i[1]],t),l=o/c;return r(l,d/-c,a)?[e[0]+t[0]*l,e[1]+t[1]*l]:void 0}},cs={core:{EPSILON:ns,magnitude:rs,normalize:function(e){var t=rs(e);return 0===t?e:e.map(function(e){return e/t})},equivalent:function(e,t){for(var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:ns,r=0;r<e.length;r+=1)if(ne(e[r]-t[r])>n)return!1;return!0},point_on_edge_exclusive:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:ns,r=[t[0]-i[0],t[1]-i[1]],s=[t[0]-e[0],t[1]-e[1]],a=[i[0]-e[0],i[1]-e[1]],c=ce(r[0]*r[0]+r[1]*r[1]),o=ce(s[0]*s[0]+s[1]*s[1]),d=ce(a[0]*a[0]+a[1]*a[1]);return ne(c-o-d)<n},intersection:{segment_segment_exclusive:function(e,t,i,n,r){var s=[t[0]-e[0],t[1]-e[1]],a=[n[0]-i[0],n[1]-i[1]];return as(e,s,i,a,ss,r)}}}},os=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return te.apply(Math,n(t.filter(function(e){return void 0!==e}).map(function(e){return e.length})))},ds={vertices:function(e){var t=e.vertices_coords,i=e.vertices_faces,n=e.vertices_vertices;return os([],t,i,n)},edges:function(e){var t=e.edges_vertices,i=e.edges_faces;return os([],t,i)},faces:function(e){var t=e.faces_vertices,i=e.faces_edges;return os([],t,i)}},ls=function(e,t,i){var n=ds[t](e),r=Array(n).fill(!1);i.forEach(function(e){r[e]=!0});var a=0,c=r.map(function(e){return e?--a:a});if(0===i.length)return c;var o="".concat(t,"_"),d="_".concat(t),l=Object.keys(e),g=l.map(function(e){return e.substring(0,o.length)===o?e:void 0}).filter(function(e){return void 0!==e}),f=l.map(function(e){return e.substring(e.length-d.length,e.length)===d?e:void 0}).filter(function(e){return void 0!==e});return f.forEach(function(t){return e[t].forEach(function(n,r){return e[t][r].forEach(function(i,n){e[t][r][n]+=c[i]})})}),g.forEach(function(t){e[t]=e[t].filter(function(e,t){return!r[t]})}),c},gs=function(e,t){return e[0]===t[0]&&e[1]===t[1]||e[0]===t[1]&&e[1]===t[0]},fs=function(e){var t=e.vertices_coords,i=e.edges_vertices,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:cs.core.EPSILON,r=i.map(function(e){return e.map(function(e){return t[e]})});return r.map(function(i){return t.filter(function(e){return cs.core.point_on_edge_exclusive(e,i[0],i[1],n)})})},ps=function(e){var t=e.vertices_coords,i=e.edges_vertices,n=i.map(function(e){return e.map(function(e){return t[e]})}),r=n.map(function(t){return[t[1][0]-t[0][0],t[1][1]-t[0][1]]}),s=r.map(function(t){return ce(t[0]*t[0]+t[1]*t[1])}),a=r.map(function(t,e){return[t[0]/s[e],t[1]/s[e]]});return a.map(function(t){return .707<ne(t[0])})},_s=function(e){for(var t=e.vertices_coords,n=e.edges_vertices,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:cs.core.EPSILON,s=n.length,a=n.map(function(e){return e.map(function(e){return t[e]})}),c=Array.from(Array(s-1)).map(function(){return[]}),o=0;o<a.length-1;o+=1)for(var d=o+1;d<a.length;d+=1)c[o][d]=cs.core.intersection.segment_segment_exclusive(a[o][0],a[o][1],a[d][0],a[d][1],r);for(var l=Array.from(Array(s)).map(function(){return[]}),g=0;g<a.length-1;g+=1)for(var f=g+1;f<a.length;f+=1)null!=c[g][f]&&(l[g].push(c[g][f]),l[f].push(c[g][f]));return l},us=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:cs.core.EPSILON,n=function(e,t){return e[0]-t[0]},r=function(e,t){return e[1]-t[1]},s=ps(e),a=e.edges_vertices.map(function(t){return t.map(function(t){return e.vertices_coords[t]})});a.forEach(function(t,e){return t.sort(s[e]?n:r)});var c=_s(e,t),o=fs(e,t),d=c.map(function(e,t){return e.concat(o[t])});d.forEach(function(t,e){return t.sort(s[e]?n:r)});var l=d.map(function(e){return Array.from(Array(e.length-1)).map(function(t,n){return[e[n],e[n+1]]})});l=l.map(function(e){return e.filter(function(n){return!1===n.map(function(e,r){return ne(n[0][r]-n[1][r])<t}).reduce(function(e,t){return e&&t},!0)})});for(var g=l.map(function(e,t){return e.map(function(){return t})}).reduce(function(e,t){return e.concat(t)},[]),f=l.map(function(e){return e.reduce(function(e,t){return e.concat(t)},[])}).reduce(function(e,t){return e.concat(t)},[]),p=0,_=l.map(function(e){return e.map(function(){return[p++,p++]})}).reduce(function(e,t){return e.concat(t)},[]),u=Array.from(Array(f.length)).map(function(){return[]}),h=0;h<f.length-1;h+=1)for(var m=h+1;m<f.length;m+=1)u[h][m]=cs.core.equivalent(f[h],f[m],t);var y=f.map(function(){});u.forEach(function(e,t){return e.forEach(function(e,i){e&&(y[i]=void 0===y[t]?t:y[t])})});var k=y.map(function(e){return void 0!==e});y.forEach(function(e,t){void 0===e&&(y[t]=t)}),_.forEach(function(e,t){return e.forEach(function(e,i){_[t][i]=y[e]})});for(var x=Array.from(Array(_.length)).map(function(){return[]}),b=0;b<_.length-1;b+=1)for(var E=b+1;E<_.length;E+=1)x[b][E]=gs(_[b],_[E]);var P=_.map(function(){});x.forEach(function(e,t){return e.forEach(function(e,i){e&&(P[t]=void 0===P[i]?i:P[i])})});var S=P.map(function(e){return void 0===e});P.forEach(function(e,t){void 0===e&&(P[t]=t)});var A=_.filter(function(e,t){return S[t]}),w=g.filter(function(e,t){return S[t]}),N={vertices_coords:f,edges_vertices:A};!0=="edges_assignment"in e&&(N.edges_assignment=w.map(function(t){return e.edges_assignment[t]})),!0=="edges_foldAngle"in e&&(N.edges_foldAngle=w.map(function(t){return e.edges_foldAngle[t]}));var L=k.map(function(e,t){return e?t:void 0}).filter(function(e){return void 0!==e});return ls(N,"vertices",L),N},hs=function(e){var t=e.edges_vertices,n={};return t.map(function(e){return e.sort(function(e,t){return e-t}).join(" ")}).forEach(function(e,t){n[e]=t}),n},ms=function(e,t,i){for(var n=e.vertices_vertices,r=[t,i];r[0]!==r[r.length-1]&&r[r.length-1]!==r[r.length-2];){var s=n[r[r.length-1]],a=s.indexOf(r[r.length-2]),c=s[(a+1)%s.length];r.push(c)}return r.pop(),r},vs=function(e){if(null==e.vertices_coords||1>e.vertices_coords.length)return[];for(var t=0,n=1;n<e.vertices_coords.length;n+=1)e.vertices_coords[n][1]<e.vertices_coords[t][1]&&(t=n);if(-1===t)return[];for(var r=e.vertices_vertices[t],s=r.map(function(i){return[e.vertices_coords[i][0]-e.vertices_coords[t][0],e.vertices_coords[i][1]-e.vertices_coords[t][1]]}),a=s.map(function(e){return cs.core.normalize(e)}).map(function(e){return e[0]}),c=-1,o=-Infinity,d=0;d<a.length;d+=1)a[d]>o&&(c=d,o=a[d]);var l=ms(e,t,r[c]),g=hs(e),f=l.map(function(e,t,i){return[i[t],i[(t+1)%i.length]].sort(function(e,t){return e-t}).join(" ")}),p=f.map(function(e){return g[e]});return p},ys="undefined"!=typeof window&&"undefined"!=typeof window.document,ks="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,xs=function(){var e={};if(ks){var t=require("xmldom"),i=t.DOMParser,n=t.XMLSerializer;e.DOMParser=i,e.XMLSerializer=n,e.document=new i().parseFromString("<!DOCTYPE html><title> </title>","text/html")}else ys&&(e=window);return e}(),bs={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},Es=/([astvzqmhlc])([^astvzqmhlc]*)/ig,Ps=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;w.prototype={constructor:w,init:function(){this.length=this.getArcLength([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y])},getTotalLength:function(){return this.length},getPointAtLength:function(e){var i=O(e,this.length,this.getArcLength,[this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y]);return this.getPoint([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],i)},getTangentAtLength:function(e){var i=O(e,this.length,this.getArcLength,[this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y]),t=this.getDerivative([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],i),n=ce(t.x*t.x+t.y*t.y),r;return r=0<n?{x:t.x/n,y:t.y/n}:{x:0,y:0},r},getPropertiesAtLength:function(e){var i=O(e,this.length,this.getArcLength,[this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y]),t=this.getDerivative([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],i),n=ce(t.x*t.x+t.y*t.y),r;r=0<n?{x:t.x/n,y:t.y/n}:{x:0,y:0};var s=this.getPoint([this.a.x,this.b.x,this.c.x,this.d.x],[this.a.y,this.b.y,this.c.y,this.d.y],i);return{x:s.x,y:s.y,tangentX:r.x,tangentY:r.y}}};var Ss=[[],[],[-.5773502691896257,.5773502691896257],[0,-.7745966692414834,.7745966692414834],[-.33998104358485626,.33998104358485626,-.8611363115940526,.8611363115940526],[0,-.5384693101056831,.5384693101056831,-.906179845938664,.906179845938664],[.6612093864662645,-.6612093864662645,-.2386191860831969,.2386191860831969,-.932469514203152,.932469514203152],[0,.4058451513773972,-.4058451513773972,-.7415311855993945,.7415311855993945,-.9491079123427585,.9491079123427585],[-.1834346424956498,.1834346424956498,-.525532409916329,.525532409916329,-.7966664774136267,.7966664774136267,-.9602898564975363,.9602898564975363],[0,-.8360311073266358,.8360311073266358,-.9681602395076261,.9681602395076261,-.3242534234038089,.3242534234038089,-.6133714327005904,.6133714327005904],[-.14887433898163122,.14887433898163122,-.4333953941292472,.4333953941292472,-.6794095682990244,.6794095682990244,-.8650633666889845,.8650633666889845,-.9739065285171717,.9739065285171717],[0,-.26954315595234496,.26954315595234496,-.5190961292068118,.5190961292068118,-.7301520055740494,.7301520055740494,-.8870625997680953,.8870625997680953,-.978228658146057,.978228658146057],[-.1252334085114689,.1252334085114689,-.3678314989981802,.3678314989981802,-.5873179542866175,.5873179542866175,-.7699026741943047,.7699026741943047,-.9041172563704749,.9041172563704749,-.9815606342467192,.9815606342467192],[0,-.2304583159551348,.2304583159551348,-.44849275103644687,.44849275103644687,-.6423493394403402,.6423493394403402,-.8015780907333099,.8015780907333099,-.9175983992229779,.9175983992229779,-.9841830547185881,.9841830547185881],[-.10805494870734367,.10805494870734367,-.31911236892788974,.31911236892788974,-.5152486363581541,.5152486363581541,-.6872929048116855,.6872929048116855,-.827201315069765,.827201315069765,-.9284348836635735,.9284348836635735,-.9862838086968123,.9862838086968123],[0,-.20119409399743451,.20119409399743451,-.3941513470775634,.3941513470775634,-.5709721726085388,.5709721726085388,-.7244177313601701,.7244177313601701,-.8482065834104272,.8482065834104272,-.937273392400706,.937273392400706,-.9879925180204854,.9879925180204854],[-.09501250983763744,.09501250983763744,-.2816035507792589,.2816035507792589,-.45801677765722737,.45801677765722737,-.6178762444026438,.6178762444026438,-.755404408355003,.755404408355003,-.8656312023878318,.8656312023878318,-.9445750230732326,.9445750230732326,-.9894009349916499,.9894009349916499],[0,-.17848418149584785,.17848418149584785,-.3512317634538763,.3512317634538763,-.5126905370864769,.5126905370864769,-.6576711592166907,.6576711592166907,-.7815140038968014,.7815140038968014,-.8802391537269859,.8802391537269859,-.9506755217687678,.9506755217687678,-.9905754753144174,.9905754753144174],[-.0847750130417353,.0847750130417353,-.2518862256915055,.2518862256915055,-.41175116146284263,.41175116146284263,-.5597708310739475,.5597708310739475,-.6916870430603532,.6916870430603532,-.8037049589725231,.8037049589725231,-.8926024664975557,.8926024664975557,-.9558239495713977,.9558239495713977,-.9915651684209309,.9915651684209309],[0,-.16035864564022537,.16035864564022537,-.31656409996362983,.31656409996362983,-.46457074137596094,.46457074137596094,-.600545304661681,.600545304661681,-.7209661773352294,.7209661773352294,-.8227146565371428,.8227146565371428,-.9031559036148179,.9031559036148179,-.96020815213483,.96020815213483,-.9924068438435844,.9924068438435844],[-.07652652113349734,.07652652113349734,-.22778585114164507,.22778585114164507,-.37370608871541955,.37370608871541955,-.5108670019508271,.5108670019508271,-.636053680726515,.636053680726515,-.7463319064601508,.7463319064601508,-.8391169718222188,.8391169718222188,-.912234428251326,.912234428251326,-.9639719272779138,.9639719272779138,-.9931285991850949,.9931285991850949],[0,-.1455618541608951,.1455618541608951,-.2880213168024011,.2880213168024011,-.4243421202074388,.4243421202074388,-.5516188358872198,.5516188358872198,-.6671388041974123,.6671388041974123,-.7684399634756779,.7684399634756779,-.8533633645833173,.8533633645833173,-.9200993341504008,.9200993341504008,-.9672268385663063,.9672268385663063,-.9937521706203895,.9937521706203895],[-.06973927331972223,.06973927331972223,-.20786042668822127,.20786042668822127,-.34193582089208424,.34193582089208424,-.469355837986757,.469355837986757,-.5876404035069116,.5876404035069116,-.6944872631866827,.6944872631866827,-.7878168059792081,.7878168059792081,-.8658125777203002,.8658125777203002,-.926956772187174,.926956772187174,-.9700604978354287,.9700604978354287,-.9942945854823992,.9942945854823992],[0,-.1332568242984661,.1332568242984661,-.26413568097034495,.26413568097034495,-.3903010380302908,.3903010380302908,-.5095014778460075,.5095014778460075,-.6196098757636461,.6196098757636461,-.7186613631319502,.7186613631319502,-.8048884016188399,.8048884016188399,-.8767523582704416,.8767523582704416,-.9329710868260161,.9329710868260161,-.9725424712181152,.9725424712181152,-.9947693349975522,.9947693349975522],[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213]],As=[[],[],[1,1],[.8888888888888888,.5555555555555556,.5555555555555556],[.6521451548625461,.6521451548625461,.34785484513745385,.34785484513745385],[.5688888888888889,.47862867049936647,.47862867049936647,.23692688505618908,.23692688505618908],[.3607615730481386,.3607615730481386,.46791393457269104,.46791393457269104,.17132449237917036,.17132449237917036],[.4179591836734694,.3818300505051189,.3818300505051189,.27970539148927664,.27970539148927664,.1294849661688697,.1294849661688697],[.362683783378362,.362683783378362,.31370664587788727,.31370664587788727,.22238103445337448,.22238103445337448,.10122853629037626,.10122853629037626],[.3302393550012598,.1806481606948574,.1806481606948574,.08127438836157441,.08127438836157441,.31234707704000286,.31234707704000286,.26061069640293544,.26061069640293544],[.29552422471475287,.29552422471475287,.26926671930999635,.26926671930999635,.21908636251598204,.21908636251598204,.1494513491505806,.1494513491505806,.06667134430868814,.06667134430868814],[.2729250867779006,.26280454451024665,.26280454451024665,.23319376459199048,.23319376459199048,.18629021092773426,.18629021092773426,.1255803694649046,.1255803694649046,.05566856711617366,.05566856711617366],[.24914704581340277,.24914704581340277,.2334925365383548,.2334925365383548,.20316742672306592,.20316742672306592,.16007832854334622,.16007832854334622,.10693932599531843,.10693932599531843,.04717533638651183,.04717533638651183],[.2325515532308739,.22628318026289723,.22628318026289723,.2078160475368885,.2078160475368885,.17814598076194574,.17814598076194574,.13887351021978725,.13887351021978725,.09212149983772845,.09212149983772845,.04048400476531588,.04048400476531588],[.2152638534631578,.2152638534631578,.2051984637212956,.2051984637212956,.18553839747793782,.18553839747793782,.15720316715819355,.15720316715819355,.12151857068790319,.12151857068790319,.08015808715976021,.08015808715976021,.03511946033175186,.03511946033175186],[.2025782419255613,.19843148532711158,.19843148532711158,.1861610000155622,.1861610000155622,.16626920581699392,.16626920581699392,.13957067792615432,.13957067792615432,.10715922046717194,.10715922046717194,.07036604748810812,.07036604748810812,.03075324199611727,.03075324199611727],[.1894506104550685,.1894506104550685,.18260341504492358,.18260341504492358,.16915651939500254,.16915651939500254,.14959598881657674,.14959598881657674,.12462897125553388,.12462897125553388,.09515851168249279,.09515851168249279,.062253523938647894,.062253523938647894,.027152459411754096,.027152459411754096],[.17944647035620653,.17656270536699264,.17656270536699264,.16800410215645004,.16800410215645004,.15404576107681028,.15404576107681028,.13513636846852548,.13513636846852548,.11188384719340397,.11188384719340397,.08503614831717918,.08503614831717918,.0554595293739872,.0554595293739872,.02414830286854793,.02414830286854793],[.1691423829631436,.1691423829631436,.16427648374583273,.16427648374583273,.15468467512626524,.15468467512626524,.14064291467065065,.14064291467065065,.12255520671147846,.12255520671147846,.10094204410628717,.10094204410628717,.07642573025488905,.07642573025488905,.0497145488949698,.0497145488949698,.02161601352648331,.02161601352648331],[.1610544498487837,.15896884339395434,.15896884339395434,.15276604206585967,.15276604206585967,.1426067021736066,.1426067021736066,.12875396253933621,.12875396253933621,.11156664554733399,.11156664554733399,.09149002162245,.09149002162245,.06904454273764123,.06904454273764123,.0448142267656996,.0448142267656996,.019461788229726478,.019461788229726478],[.15275338713072584,.15275338713072584,.14917298647260374,.14917298647260374,.14209610931838204,.14209610931838204,.13168863844917664,.13168863844917664,.11819453196151841,.11819453196151841,.10193011981724044,.10193011981724044,.08327674157670475,.08327674157670475,.06267204833410907,.06267204833410907,.04060142980038694,.04060142980038694,.017614007139152118,.017614007139152118],[.14608113364969041,.14452440398997005,.14452440398997005,.13988739479107315,.13988739479107315,.13226893863333747,.13226893863333747,.12183141605372853,.12183141605372853,.10879729916714838,.10879729916714838,.09344442345603386,.09344442345603386,.0761001136283793,.0761001136283793,.057134425426857205,.057134425426857205,.036953789770852494,.036953789770852494,.016017228257774335,.016017228257774335],[.13925187285563198,.13925187285563198,.13654149834601517,.13654149834601517,.13117350478706238,.13117350478706238,.12325237681051242,.12325237681051242,.11293229608053922,.11293229608053922,.10041414444288096,.10041414444288096,.08594160621706773,.08594160621706773,.06979646842452049,.06979646842452049,.052293335152683286,.052293335152683286,.03377490158481415,.03377490158481415,.0146279952982722,.0146279952982722],[.13365457218610619,.1324620394046966,.1324620394046966,.12890572218808216,.12890572218808216,.12304908430672953,.12304908430672953,.11499664022241136,.11499664022241136,.10489209146454141,.10489209146454141,.09291576606003515,.09291576606003515,.07928141177671895,.07928141177671895,.06423242140852585,.06423242140852585,.04803767173108467,.04803767173108467,.030988005856979445,.030988005856979445,.013411859487141771,.013411859487141771],[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872]],ws=[[1],[1,1],[1,2,1],[1,3,3,1]];B.prototype={constructor:B,init:function(){},getTotalLength:function(){return this.length},getPointAtLength:function(e){0>e?e=0:e>this.length&&(e=this.length);var t=V({x:this.x0,y:this.y0},this.rx,this.ry,this.xAxisRotate,this.LargeArcFlag,this.SweepFlag,{x:this.x1,y:this.y1},e/this.length);return{x:t.x,y:t.y}},getTangentAtLength:function(e){0>e?e=0:e>this.length&&(e=this.length);var t=V({x:this.x0,y:this.y0},this.rx,this.ry,this.xAxisRotate,this.LargeArcFlag,this.SweepFlag,{x:this.x1,y:this.y1},e/this.length);return{x:t.x,y:t.y}},getPropertiesAtLength:function(e){var t=this.getTangentAtLength(e),i=this.getPointAtLength(e);return{x:i.x,y:i.y,tangentX:t.x,tangentY:t.y}}},K.prototype.getTotalLength=function(){return ce(oe(this.x0-this.x1,2)+oe(this.y0-this.y1,2))},K.prototype.getPointAtLength=function(e){var t=e/ce(oe(this.x0-this.x1,2)+oe(this.y0-this.y1,2)),i=(this.x1-this.x0)*t,n=(this.y1-this.y0)*t;return{x:this.x0+i,y:this.y0+n}},K.prototype.getTangentAtLength=function(){var e=ce((this.x1-this.x0)*(this.x1-this.x0)+(this.y1-this.y0)*(this.y1-this.y0));return{x:(this.x1-this.x0)/e,y:(this.y1-this.y0)/e}},K.prototype.getPropertiesAtLength=function(e){var t=this.getPointAtLength(e),i=this.getTangentAtLength();return{x:t.x,y:t.y,tangentX:i.x,tangentY:i.y}};var Ns={value:0},Ls=function(e){return e.split(" ").filter(function(e){return""!==e}).map(function(e){return e.split(",").map(function(e){return parseFloat(e)})})},Os=function(e,t){var i=t.map(function(t){for(var n=0;n<e.attributes.length;n+=1)if(e.attributes[n].nodeName===t)return n});return i.map(function(t){return void 0===t?Ns:e.attributes[t]}).map(function(e){return void 0===e.value?e.baseVal.value:e.value})},js=function(e){for(var t="",n=0;n<e.attributes.length;n+=1)if("points"===e.attributes[n].nodeName){t=e.attributes[n].value;break}return Ls(t).map(function(e,t,i){return[i[t][0],i[t][1],i[(t+1)%i.length][0],i[(t+1)%i.length][1]]})},Cs={line:function(e){return[Os(e,["x1","y1","x2","y2"])]},rect:function(e){var t=Os(e,["x","y","width","height"]),i=parseFloat(t[0]),n=parseFloat(t[1]),r=parseFloat(t[2]),s=parseFloat(t[3]);return[[i,n,i+r,n],[i+r,n,i+r,n+s],[i+r,n+s,i,n+s],[i,n+s,i,n]]},circle:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:64,i=Os(e,["cx","cy","r"]),n=parseFloat(i[0]),s=parseFloat(i[1]),a=parseFloat(i[2]);return Array.from(Array(t)).map(function(e,r){return[n+a*se(2*(r/t*ie)),s+a*re(2*(r/t*ie))]}).map(function(e,t,i){return[i[t][0],i[t][1],i[(t+1)%i.length][0],i[(t+1)%i.length][1]]})},ellipse:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:64,i=Os(e,["cx","cy","rx","ry"]),n=parseFloat(i[0]),r=parseFloat(i[1]),s=parseFloat(i[2]),a=parseFloat(i[3]);return Array.from(Array(t)).map(function(e,c){return[n+s*se(2*(c/t*ie)),r+a*re(2*(c/t*ie))]}).map(function(e,t,i){return[i[t][0],i[t][1],i[(t+1)%i.length][0],i[(t+1)%i.length][1]]})},polygon:js,polyline:function(e){var t=js(e);return t.pop(),t},path:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:128,i=e.getAttribute("d"),n=W(i),r=n.getTotalLength(),s="Z"===i[i.length-1]||"z"===i[i.length-1],a=s?r/t:r/(t-1),c=Array.from(Array(t)).map(function(e,t){return n.getPointAtLength(t*a)}).map(function(e){return[e.x,e.y]}),o=c.map(function(e,t,i){return[i[t][0],i[t][1],i[(t+1)%i.length][0],i[(t+1)%i.length][1]]});return s||o.pop(),o}},Ms={line:["x1","y1","x2","y2"],rect:["x","y","width","height"],circle:["cx","cy","r"],ellipse:["cx","cy","rx","ry"],polygon:["points"],polyline:["points"],path:["d"]},Ts=function e(t){return"g"===t.tagName||"svg"===t.tagName?null==t.childNodes?[]:Array.from(t.childNodes).map(function(t){return e(t)}).reduce(function(e,t){return e.concat(t)},[]):[t]},Is=function(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5],e[2]*t[0]+e[3]*t[2]+t[4],e[2]*t[1]+e[3]*t[3]+t[5]]},zs=function(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]},Fs=function(e){var t=e.match(/(\w+\((\-?\d+\.?\d*e?\-?\d*,?\s*)+\))+/g),i=t.map(function(e){return e.match(/[\w\.\-]+/g)});return i.map(function(e){return{transform:e.shift(),parameters:e.map(function(e){return parseFloat(e)})}})},Bs=function(e){switch(e.length){case 1:return[1,0,0,1,e[0],0];case 2:return[1,0,0,1,e[0],e[1]];default:console.warn("improper translate, ".concat(e));}},Vs=function(e){var t=se(e[0]/180*ie),i=re(e[0]/180*ie);switch(e.length){case 1:return[t,i,-i,t,0,0];case 3:return[t,i,-i,t,-e[1]*t+e[2]*i+e[1],-e[1]*i-e[2]*t+e[2]];default:console.warn("improper rotate, ".concat(e));}},Ds=function(e){switch(e.length){case 1:return[e[0],0,0,e[0],0,0];case 2:return[e[0],0,0,e[1],0,0];default:console.warn("improper scale, ".concat(e));}},Rs=function(e){return[1,0,$(e[0]/180*ie),1,0,0]},qs=function(e){return[1,$(e[0]/180*ie),0,1,0,0]},Xs=function(e,t){switch(e){case"translate":return Bs(t);case"rotate":return Vs(t);case"scale":return Ds(t);case"skewX":return Rs(t);case"skewY":return qs(t);case"matrix":return t;default:console.warn("unknown transform type ".concat(e));}},Us=function(e){return Fs(e).map(function(e){return Xs(e.transform,e.parameters)}).filter(function(e){return void 0!==e}).reduce(function(e,t){return zs(e,t)},[1,0,0,1,0,0])},Ys=function(e){if("function"!=typeof e.getAttribute)return[1,0,0,1,0,0];var t=e.getAttribute("transform");return null!=t&&""!==t?Us(t):[1,0,0,1,0,0]},Gs=function e(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[1,0,0,1,0,0],n=zs(i,Ys(t));if(t.matrix=n,"g"===t.tagName||"svg"===t.tagName){if(null==t.childNodes)return;Array.from(t.childNodes).forEach(function(t){return e(t,n)})}},Zs=Object.keys(Cs),Ks=function(e){return Array.from(e.attributes).filter(function(t){return-1===Ms[e.tagName].indexOf(t.name)})},Ws=function(e){var t={};return e.forEach(function(e){t[e.nodeName]=e.value}),t},Hs=function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r="object"===e(i.resolution)?i.resolution:{};"number"==typeof i.resolution&&["circle","ellipse","path"].forEach(function(e){r[e]=i.resolution}),Gs(t);var s=Ts(t),a=s.filter(function(e){return-1!==Zs.indexOf(e.tagName)}).map(function(e){return Cs[e.tagName](e,r[e.tagName]).map(function(t){return Is(t,e.matrix)}).map(function(t){return[].concat(n(t),[Ks(e)])})}).reduce(function(e,t){return e.concat(t)},[]);return a.filter(function(e){return void 0!==e[4]}).forEach(function(e){var t=e[4].filter(function(e){return"transform"!==e.nodeName});e[4]=Ws(t)}),a},$s="http://www.w3.org/2000/svg",Qs=["version","xmlns","contentScriptType","contentStyleType","baseProfile","class","externalResourcesRequired","x","y","width","height","viewBox","preserveAspectRatio","zoomAndPan","style"],Js={defs:!0,metadata:!0,title:!0,desc:!0,style:!0},ea=function(e,t){var i=xs.document.createElementNS($s,"svg");return void 0!==t&&Qs.map(function(e){return{attribute:e,value:t.getAttribute(e)}}).filter(function(e){return null!=e.value&&""!==e.value}).forEach(function(e){return i.setAttribute(e.attribute,e.value)}),null===i.getAttribute("xmlns")&&i.setAttribute("xmlns",$s),Array.from(t.childNodes).filter(function(e){return Js[e.tagName]}).map(function(e){return e.cloneNode(!0)}).forEach(function(e){return i.appendChild(e)}),e.forEach(function(e){var t=xs.document.createElementNS($s,"line");Ms.line.forEach(function(n,r){return t.setAttributeNS(null,n,e[r])}),null!=e[4]&&Object.keys(e[4]).forEach(function(i){return t.setAttribute(i,e[4][i])}),i.appendChild(t)}),i},ta=Object.freeze({input:"string",output:"string",resolution:Object.freeze({circle:64,ellipse:64,path:128})}),ia=function(e){return"string"==typeof e||e instanceof String?new xs.DOMParser().parseFromString(e,"text/xml").documentElement:e},na=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:ta,i="svg"===t.input?e:ia(e),n=Hs(i,t);if("data"===t.output)return n;var r=ea(n,i);if("svg"===t.output)return r;var s=new xs.XMLSerializer().serializeToString(r);return k(s)},ra={convert:Ur},sa={V:180,v:180,M:-180,m:-180},aa=function(e){return sa[e]||0},ca=function(){return{file_spec:1.1,file_creator:"Rabbit Ear",file_classes:["singleModel"],frame_title:"",frame_classes:["creasePattern"],frame_attributes:["2D"],vertices_coords:[],vertices_vertices:[],vertices_faces:[],edges_vertices:[],edges_faces:[],edges_assignment:[],edges_foldAngle:[],edges_length:[],faces_vertices:[],faces_edges:[]}},oa=function(e,t){var i=ca(),n=i.vertices_coords.length,r=na(e,{output:"data"});i.vertices_coords=r.map(function(e){return[[e[0],e[1]],[e[2],e[3]]]}).reduce(function(e,t){return e.concat(t)},i.vertices_coords),i.edges_vertices=r.map(function(e,t){return[n+2*t,n+2*t+1]}),i.edges_assignment=r.map(function(e){return e[4]}).map(function(e){return null==e?"U":is(e.stroke)});var s=us(i,t.epsilon);return ra.convert.edges_vertices_to_vertices_vertices_sorted(s),ra.convert.vertices_vertices_to_faces_vertices(s),ra.convert.faces_vertices_to_faces_edges(s),s.edges_foldAngle=s.edges_assignment.map(function(e){return aa(e)}),!1!==t.boundary&&vs(s).forEach(function(e){s.edges_assignment[e]="B"}),s},da=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if("string"==typeof e){var i=new Qr.DOMParser().parseFromString(e,"text/xml").documentElement;return oa(i,t)}return oa(e,t)};da.core={segmentize:function(){},fragment:us};var la=function(e,t,i){for(var n=arguments.length,r=Array(3<n?n-3:0),s=3;s<n;s++)r[s-3]=arguments[s];switch(t){case"fold":switch(i){case"fold":return e;case"oripa":return Zr.fromFold(e);case"svg":return Br.apply(void 0,[e].concat(r));}break;case"oripa":switch(i){case"fold":return Zr.toFold(e,!0);case"oripa":return e;case"svg":return Br.apply(void 0,[Zr.toFold(e,!0)].concat(r));}break;case"svg":switch(i){case"fold":return da.apply(void 0,[e].concat(r));case"oripa":return Zr.fromFold(da.apply(void 0,[e].concat(r)));case"svg":return e;}}},ga=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},fa=function(e){var t=e.toLowerCase(),i=e.toUpperCase(),n=ga(t),r=[t,i,n];return["","to","into"].map(function(e){return r.map(function(t){return e+t})}).reduce(function(e,t){return e.concat(t)},[])},pa=function(){var e=Ki.apply(void 0,arguments),t={};return["fold","svg","oripa"].forEach(function(i){return fa(i).forEach(function(n){return Object.defineProperty(t,n,{value:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];return la.apply(void 0,[e.data,e.type,i].concat(n))}})})}),t},_a=function(){var e=!!(0<arguments.length&&void 0!==arguments[0])&&arguments[0];return e?{file_spec:ki,file_creator:xi,file_author:"",file_title:"",file_description:"",file_classes:[],file_frames:[],frame_description:"",frame_attributes:[],frame_classes:[],frame_unit:""}:{file_spec:ki,file_creator:xi}},ua=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;return{"faces_re:layer":Array.from(Array(e)).map(function(e,t){return t}),"faces_re:matrix":Array.from(Array(e)).map(function(){return[1,0,0,1,0,0]})}},ha=function(){return{file_classes:["singleModel"],frame_attributes:["2D"],frame_classes:["creasePattern"]}},ma=function(){return{vertices_coords:[[0,0],[1,0],[1,1],[0,1]],vertices_vertices:[[1,3],[2,0],[3,1],[0,2]],vertices_faces:[[0],[0],[0],[0]],edges_vertices:[[0,1],[1,2],[2,3],[3,0]],edges_faces:[[0],[0],[0],[0]],edges_assignment:["B","B","B","B"],edges_foldAngle:[0,0,0,0],edges_length:[1,1,1,1],faces_vertices:[[0,1,2,3]],faces_edges:[[0,1,2,3]]}},va=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return Object.assign(Object.create(e),_a())},ya=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null;return Object.assign(Object.create(e),_a(),ha(),ma(),ua(1))},ka=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=ma();return i.vertices_coords=[[0,0],[e,0],[e,t],[0,t]],i.edges_length=[e,t,e,t],Object.assign(Object.create(null),_a(),ha(),i,ua(1))},xa=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n=Array.from(Array(e)),r=2*ie/e,s=yi.core.clean_number(ce(oe(t-t*se(r),2)+oe(t*re(r),2))),a={vertices_coords:n.map(function(e,t){return r*t}).map(function(e){return[yi.core.clean_number(t*se(e)),yi.core.clean_number(t*re(e))]}),vertices_vertices:n.map(function(e,t){return[(t+1)%n.length,(t+n.length-1)%n.length]}),vertices_faces:n.map(function(){return[0]}),edges_vertices:n.map(function(e,t){return[t,(t+1)%n.length]}),edges_faces:n.map(function(){return[0]}),edges_assignment:n.map(function(){return"B"}),edges_foldAngle:n.map(function(){return 0}),edges_length:n.map(function(){return s}),faces_vertices:[n.map(function(e,t){return t})],faces_edges:[n.map(function(e,t){return t})]};return Object.assign(Object.create(null),_a(),ha(),a,ua(1))},ba=function t(n){var r,s;if("object"!==e(n))return n;if(!n)return n;if("[object Array]"===Object.prototype.toString.apply(n)){for(r=[],s=0;s<n.length;s+=1)r[s]=t(n[s]);return r}for(s in r={},n)n.hasOwnProperty(s)&&(r[s]=t(n[s]));return r},Ea=/*#__PURE__*/Object.freeze({__proto__:null,clone:ba,recursive_freeze:function t(i){return(Object.freeze(i),void 0===i)?i:(Object.getOwnPropertyNames(i).filter(function(t){return null!==i[t]&&("object"===e(i[t])||"function"==typeof i[t])&&!Object.isFrozen(i[t])}).forEach(function(e){return t(i[e])}),i)}}),Pa=function(e){var t=e.edges_vertices;if(t){var n=[];return t.forEach(function(e,t){return e.forEach(function(e){void 0===n[e]&&(n[e]=[]),n[e].push(t)})}),n}},Sa=function(e){var t=e.faces_vertices;if(t){var i=t.length,n=Array.from(Array(i)).map(function(){return[]}),r={};return t.forEach(function(e,t){if(void 0!==e){var s=e.length;e.forEach(function(e,a,i){var c=i[(a+1)%s];if(c<e){var o=[c,e];e=o[0],c=o[1]}var d="".concat(e," ").concat(c);if(d in r){var l=r[d];n[t].push(l),n[l].push(t)}else r[d]=t})}}),n}},Aa=function(e){var t=e.edges_vertices,n=e.vertices_edges;return t&&n?t.map(function(e,t){var i=e[0],r=e[1],s=n[i].filter(function(i){return i!==t}),a=n[r].filter(function(i){return i!==t});return s.concat(a)}):void 0},wa=function(e){var t=e.edges_vertices,i=e.faces_edges;if(t&&i){var n=Array.from(Array(t.length)).map(function(){return[]});return i.forEach(function(e,t){var i=[];e.forEach(function(e){i[e]=t}),i.forEach(function(t,i){return n[i].push(t)})}),n}},Na=function(e){var t=e.vertices_coords,i=e.edges_vertices;return t&&i?i.map(function(e){return e.map(function(e){return t[e]})}).map(function(e){var t;return(t=yi.core).distance.apply(t,n(e))}):void 0},La={M:-180,m:-180,V:180,v:180},Oa=function(e){var t=e.edges_vertices;if(!t)return{};var n={};return t.map(function(e){return e.sort(function(e,t){return e-t}).join(" ")}).forEach(function(e,t){n[e]=t}),n},ja=function(e){var t=e.vertices_coords,i=e.faces_vertices;if(t&&i){var n=Array.from(Array(t.length)).map(function(){return[]});return i.forEach(function(e,t){var i=[];e.forEach(function(e){i[e]=t}),i.forEach(function(e,t){return n[t].push(e)})}),n}},Ca=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=Oa(e),n=Sa(e);if(0>=n.length)return[];var r=[t],s=[[{face:t,parent:void 0,edge:void 0,level:0}]];do s[s.length]=s[s.length-1].map(function(t){var s=n[t.face].filter(function(e){return-1===r.indexOf(e)});return r=r.concat(s),s.map(function(n){var r=e.faces_vertices[n].filter(function(i){return-1!==e.faces_vertices[t.face].indexOf(i)}).sort(function(e,t){return e-t}),s=i[r.join(" ")];return{face:n,parent:t.face,edge:s,edge_vertices:r}})}).reduce(function(e,t){return e.concat(t)},[]);while(0<s[s.length-1].length);return 0<s.length&&0===s[s.length-1].length&&s.pop(),s},Ma=function(e){return"f"===e||"F"===e||"u"===e||"U"===e},Ta=function(e,t){if(null!=e.faces_vertices&&null!=e.edges_vertices){var i=!0=="edges_assignment"in e,n=i?e.edges_assignment.map(function(e){return!Ma(e)}):e.edges_vertices.map(function(){return!0}),r=e.faces_vertices.map(function(){return[1,0,0,1,0,0]});return Ca(e,t).forEach(function(t){t.filter(function(e){return null!=e.parent}).forEach(function(t){var i=t.edge_vertices.map(function(t){return e.vertices_coords[t]}),s=[i[1][0]-i[0][0],i[1][1]-i[0][1]],a=n[t.edge]?yi.core.make_matrix2_reflection(s,i[0]):[1,0,0,1,0,0];r[t.face]=yi.core.multiply_matrices2(r[t.parent],a)})}),r}},Ia=function(e,t){var i=!0=="edges_assignment"in e?e.edges_assignment.map(function(e){return!Ma(e)}):e.edges_vertices.map(function(){return!0}),n=e.faces_vertices.map(function(){return[1,0,0,1,0,0]});return Ca(e,t).forEach(function(t){t.filter(function(e){return null!=e.parent}).forEach(function(t){var r=t.edge_vertices.map(function(t){return e.vertices_coords[t]}),s=[r[1][0]-r[0][0],r[1][1]-r[0][1]],a=i[t.edge]?yi.core.make_matrix2_reflection(s,r[0]):[1,0,0,1,0,0];n[t.face]=yi.core.multiply_matrices2(a,n[t.parent])})}),n},za=function(e,t,n){if(null!=e.vertices_coords&&null!=e.faces_vertices){if(null==t&&(t=0),null==n)n=Ta(e,t);else{var r=null==e.faces_vertices?e.faces_edges:e.faces_vertices,s=null==r?0:r.length;n.length!==s&&(n=Ta(e,t))}var a=e.vertices_coords.map(function(n,r){for(var i=0;i<e.faces_vertices.length;i+=1)if(e.faces_vertices[i].includes(r))return i;return t});return e.vertices_coords.map(function(e,t){return yi.core.multiply_matrix2_vector2(n[a[t]],e).map(function(e){return yi.core.clean_number(e)})})}},Fa=function(e){var t=Pa(e),i=e.edges_assignment.map(function(e){return"b"===e||"B"===e});return t.map(function(e){return e.map(function(t){return i[t]}).reduce(function(e,t){return e||t},!1)})},Ba=function(e){return e.map(function(e){return e[0]*e[3]-e[1]*e[2]}).map(function(e){return 0<=e})},Va=/*#__PURE__*/Object.freeze({__proto__:null,make_vertices_edges:Pa,make_edges_vertices:function(e){var t=e.edges_vertices,i=e.faces_edges;if(t&&i){var n=Array.from(Array(t.length)).map(function(){return[]});return i.forEach(function(e,t){var i=[];e.forEach(function(e){i[e]=t}),i.forEach(function(t,i){return n[i].push(t)})}),n}},make_faces_faces:Sa,make_edges_edges:Aa,make_edges_faces:wa,make_edges_length:Na,make_edges_foldAngle:function(e){var t=e.edges_assignment;return t?t.map(function(e){return La[e]||0}):void 0},make_vertex_pair_to_edge_map:Oa,make_vertices_faces:ja,make_face_walk_tree:Ca,make_faces_matrix:Ta,make_faces_matrix_inv:Ia,make_vertices_coords_folded:za,make_vertices_isBoundary:Fa,make_faces_coloring_from_faces_matrix:Ba,make_faces_coloring:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=[];return n[t]=!0,Ca(e,t).forEach(function(e,t){return e.forEach(function(e){n[e.face]=0==t%2})}),n}}),Da=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return te.apply(Math,n(t.filter(function(e){return void 0!==e}).map(function(e){return e.length})))},Ra=function(e){var t=e.vertices_coords,i=e.vertices_faces,n=e.vertices_vertices;return Da([],t,i,n)},qa=function(e){var t=e.edges_vertices,i=e.edges_faces;return Da([],t,i)},Xa=function(e){var t=e.faces_vertices,i=e.faces_edges;return Da([],t,i)},Ua=function(e){var t=e.faces_vertices,i=e.edges_vertices,n=-1;return[t,i].filter(function(e){return void 0!==e}).forEach(function(e){return e.forEach(function(e){return e.forEach(function(t){t>n&&(n=t)})})}),n+1},Ya=function(e,t){var i=e.vertices_coords;if(void 0!==i&&0!==i.length){var r=n(t);return null==r[2]&&(r[2]=0),i.map(function(e){return e.map(function(e,t){return oe(e-r[t],2)}).reduce(function(e,t){return e+t},0)}).map(function(e,t){return{d:ce(e),i:t}}).sort(function(e,t){return e.d-t.d}).shift().i}},Ga=function(e,t){var n=e.vertices_coords,r=e.edges_vertices;if(null!=n&&0!==n.length&&null!=r&&0!==r.length){for(var s=function(e){return e<-yi.core.EPSILON?0:e>1+yi.core.EPSILON?1:e},a=r.map(function(t){return t.map(function(e){return n[e]})}).map(function(t){return[t[0],[t[1][0]-t[0][0],t[1][1]-t[0][1]]]}).map(function(e){return yi.core.nearest_point_on_line(e[0],e[1],t,s)}).map(function(e,n){return{p:e,i:n,d:yi.core.distance2(t,e)}}),c=1/0,o=0,d;o<a.length;o+=1)a[o].d<c&&(d=o,c=a[o].d);return d}},Za=function(e,t){var i=e.vertices_coords,n=e.faces_vertices;if(null!=i&&0!==i.length&&null!=n&&0!==n.length){var r=n.map(function(e,t){return{face:e.map(function(e){return i[e]}),i:t}}).filter(function(e){return yi.core.point_in_poly(t,e.face)}).shift();return null==r?void 0:r.i}},Ka=function(e,t){var i=e.vertices_coords,n=e.faces_vertices;return n.map(function(e,t){return{face:e.map(function(e){return i[e]}),i:t}}).filter(function(e){return yi.core.point_in_poly(t,e.face)}).map(function(e){return e.i})},Wa=function(e,t){if(null==t&&(t=Array.from(Array(Xa(e))).map(function(e,t){return t})),0!==t.length){if(1===t.length)return t[0];for(var n=e["faces_re:layer"].map(function(e,t){return{layer:e,i:t}}).sort(function(e,t){return t.layer-e.layer}).map(function(e){return e.i}),r=0;r<n.length;r+=1)if(t.includes(n[r]))return n[r]}},Ha=/*#__PURE__*/Object.freeze({__proto__:null,vertices_count:Ra,edges_count:qa,faces_count:Xa,implied_vertices_count:Ua,implied_edges_count:function(e){var t=e.faces_edges,i=e.vertices_edges,n=e.edgeOrders,r=-1;return[t,i].filter(function(e){return void 0!==e}).forEach(function(e){return e.forEach(function(e){return e.forEach(function(t){t>r&&(r=t)})})}),void 0!==n&&n.forEach(function(e){return e.forEach(function(t,e){2!==e&&t>r&&(r=t)})}),r+1},implied_faces_count:function(e){var t=e.vertices_faces,i=e.edges_faces,n=e.facesOrders,r=-1;return[t,i].filter(function(e){return void 0!==e}).forEach(function(e){return e.forEach(function(e){return e.forEach(function(e){e>r&&(r=e)})})}),void 0!==n&&n.forEach(function(e){return e.forEach(function(e,t){2!==t&&e>r&&(r=e)})}),r+1},nearest_vertex:Ya,nearest_edge:Ga,face_containing_point:Za,folded_faces_containing_point:function(e,t,i){var n=e.vertices_coords,r=e.faces_vertices,s=i.map(function(e){return yi.core.multiply_matrix2_vector2(e,t)});return r.map(function(e,t){return{face:e.map(function(e){return n[e]}),i:t}}).filter(function(e,t){return yi.core.intersection.point_in_poly(s[t],e.face)}).map(function(e){return e.i})},faces_containing_point:Ka,topmost_face:Wa,get_collinear_vertices:function(e){var t=e.edges_vertices,i=e.vertices_coords,n=Pa({edges_vertices:t});return Array.from(Array(i.length)).map(function(e,t){return t}).filter(function(){return 2===n.length}).map(function(e){var t=n[e],r=t[0][0]===e?t[0][1]:t[0][0],s=t[1][0]===e?t[1][1]:t[1][0],a=yi.core.distance2(i[r],i[e]),c=yi.core.distance2(i[s],i[e]),o=yi.core.distance2(i[r],i[s]);return ne(o-a-c)<yi.core.EPSILON?e:void 0}).filter(function(e){return void 0!==e})},get_isolated_vertices:function(t){for(var n=t.edges_vertices,r=t.vertices_coords,s=r.length,a=Array(s).fill(!0),c=s,o=0;o<n.length&&0<c;o+=1)for(var d=0,l;d<n[o].length;d+=1)l=n[o][d],a[l]&&(c-=1,a[l]=!1);return 0===c?[]:a.map(function(e,t){return e?t:void 0}).filter(function(e){return void 0!==e})},get_duplicate_vertices:function(e){for(var t=e.vertices_coords,n=Array.from(Array(t.length)).map(function(){return[]}),r=0;r<t.length-1;r+=1)for(var s=r+1;s<t.length;s+=1)n[r][s]=yi.core.equivalent_vectors(t[r],t[s]);var a=t.map(function(){});n.forEach(function(e,t){return e.forEach(function(e,i){e&&(a[i]=void 0===a[t]?t:a[t])})});var c=a.map(function(e){return void 0!==e});return a.forEach(function(e,t){void 0===e&&(a[t]=t)}),c.map(function(e,t){return e?t:void 0}).filter(function(e){return void 0!==e})},get_duplicate_edges:function(e){for(var t=e.edges_vertices,n=function(e,t){return e[0]===t[0]&&e[1]===t[1]||e[0]===t[1]&&e[1]===t[0]},r=Array.from(Array(t.length)).map(function(){return[]}),s=0;s<t.length-1;s+=1)for(var a=s+1;a<t.length;a+=1)r[s][a]=n(t[s],t[a]);var c=[];return r.forEach(function(e,t){return e.forEach(function(e,i){e&&(c[i]=void 0===c[t]?t:c[t])})}),c},get_duplicate_edges_old:function(e){for(var t=function(e,t){return e[0]===t[0]&&e[1]===t[1]||e[0]===t[1]&&e[1]===t[0]},n=Array.from(Array(e.edges_vertices.length)).map(function(){return[]}),r=0;r<e.edges_vertices.length-1;r+=1)for(var s=r+1;s<e.edges_vertices.length;s+=1)n[r][s]=t(e.edges_vertices[r],e.edges_vertices[s]);var a=e.edges_vertices.map(function(){});n.forEach(function(e,t){return e.forEach(function(e,i){e&&(a[i]=void 0===a[t]?t:a[t])})});var c=a.map(function(e){return void 0!==e});return a.forEach(function(e,t){void 0===e&&(a[t]=t)}),c.map(function(e,t){return e?t:void 0}).filter(function(e){return void 0!==e})},find_collinear_face_edges:function(e,t,i){var n=t.map(function(e){return i[e]}).map(function(e,t,i){return[e,i[(t+1)%i.length]]});return e.map(function(r){var s=n.map(function(e,t){return{index:t,edge:e}}).filter(function(t){return yi.core.intersection.point_on_edge(t.edge[0],t.edge[1],r)}).shift().index;return[t[s],t[(s+1)%t.length]].sort(function(e,t){return e-t})})}}),$a=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return te.apply(Math,n(t.filter(function(e){return void 0!==e}).map(function(e){return e.length})))},Qa={vertices:function(e){var t=e.vertices_coords,i=e.vertices_faces,n=e.vertices_vertices;return $a([],t,i,n)},edges:function(e){var t=e.edges_vertices,i=e.edges_faces;return $a([],t,i)},faces:function(e){var t=e.faces_vertices,i=e.faces_edges;return $a([],t,i)}},Ja=function(e,t,i){var n=Qa[t](e),r=Array(n).fill(!1);i.forEach(function(e){r[e]=!0});var a=0,c=r.map(function(e){return e?--a:a});if(0===i.length)return c;var o="".concat(t,"_"),d="_".concat(t),l=Object.keys(e),g=l.map(function(e){return e.substring(0,o.length)===o?e:void 0}).filter(function(e){return void 0!==e}),f=l.map(function(e){return e.substring(e.length-d.length,e.length)===d?e:void 0}).filter(function(e){return void 0!==e});return f.forEach(function(t){return e[t].forEach(function(n,r){return e[t][r].forEach(function(i,n){e[t][r][n]+=c[i]})})}),g.forEach(function(t){e[t]=e[t].filter(function(e,t){return!r[t]})}),c},ec=function(e){var t=e.vertices_coords;if(null==t||0>=t.length)return[0,0,0,0];var i=t[0].length,r=Array(i).fill(1/0),s=Array(i).fill(-Infinity);return t.forEach(function(e){return e.forEach(function(e,t){e<r[t]&&(r[t]=e),e>s[t]&&(s[t]=e)})}),isNaN(r[0])||isNaN(r[1])||isNaN(s[0])||isNaN(s[1])?[0,0,0,0]:[r[0],r[1],s[0]-r[0],s[1]-r[1]]},tc=function(e){if(null==e.edges_assignment)return{vertices:[],edges:[]};for(var t=e.edges_assignment.map(function(e){return"B"===e||"b"===e}),n=Pa(e),r=[],s=[],a=-1,c=0;c<t.length;c+=1)if(t[c]){a=c;break}if(-1===a)return{vertices:[],edges:[]};t[a]=!1,r.push(a),s.push(e.edges_vertices[a][0]);for(var o=e.edges_vertices[a][1];s[0]!==o;){if(s.push(o),a=n[o].filter(function(e){return t[e]}).shift(),void 0===a)return{vertices:[],edges:[]};if(e.edges_vertices[a][0]===o){var d=i(e.edges_vertices[a],2);o=d[1]}else{var l=i(e.edges_vertices[a],1);o=l[0]}t[a]=!1,r.push(a)}return{vertices:s,edges:r}},ic=function(e,t){for(var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:yi.core.EPSILON,r=2>e.length?e.length:2,s=0;s<r;s+=1)if(ne(e[s]-t[s])>n)return!1;return!0},nc=function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:yi.core.EPSILON,r=[t[0]-i[0],t[1]-i[1]],s=[t[0]-e[0],t[1]-e[1]],a=[i[0]-e[0],i[1]-e[1]],c=ce(r[0]*r[0]+r[1]*r[1]),o=ce(s[0]*s[0]+s[1]*s[1]),d=ce(a[0]*a[0]+a[1]*a[1]);return ne(c-o-d)<n},rc=function(e,t){return e[0]===t[0]&&e[1]===t[1]||e[0]===t[1]&&e[1]===t[0]},sc=function(e){var t=e.vertices_coords,i=e.edges_vertices,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:yi.core.EPSILON,r=i.map(function(e){return e.map(function(e){return t[e]})});return r.map(function(i){return t.filter(function(e){return nc(e,i[0],i[1],n)})})},ac=function(e){var t=e.vertices_coords,i=e.edges_vertices,n=i.map(function(e){return e.map(function(e){return t[e]})}),r=n.map(function(t){return[t[1][0]-t[0][0],t[1][1]-t[0][1]]}),s=r.map(function(t){return ce(t[0]*t[0]+t[1]*t[1])}),a=r.map(function(t,e){return[t[0]/s[e],t[1]/s[e]]});return a.map(function(t){return .707<ne(t[0])})},cc=function(e){for(var t=e.vertices_coords,n=e.edges_vertices,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:yi.core.EPSILON,s=n.length,a=n.map(function(e){return e.map(function(e){return t[e]})}),c=Array.from(Array(s-1)).map(function(){return[]}),o=0;o<a.length-1;o+=1)for(var d=o+1;d<a.length;d+=1)c[o][d]=yi.core.intersection.segment_segment_exclusive(a[o][0],a[o][1],a[d][0],a[d][1],r);for(var l=Array.from(Array(s)).map(function(){return[]}),g=0;g<a.length-1;g+=1)for(var f=g+1;f<a.length;f+=1)null!=c[g][f]&&(l[g].push(c[g][f]),l[f].push(c[g][f]));return l},oc=function(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:yi.core.EPSILON,r=function(e,t){return e[0]-t[0]},s=function(e,t){return e[1]-t[1]},a=ac(t),c=t.edges_vertices.map(function(e){return e.map(function(e){return t.vertices_coords[e]})});c.forEach(function(t,e){return t.sort(a[e]?r:s)});var o=cc(t,n),d=sc(t,n),l=o.map(function(e,t){return e.concat(d[t])});l.forEach(function(t,e){return t.sort(a[e]?r:s)});var g=l.map(function(e){return e.filter(function(t,e,i){return!ic(t,i[(e+1)%i.length])})}).filter(function(e){return e.length}),f=g.map(function(e){return Array.from(Array(e.length-1)).map(function(t,n){return[e[n],e[n+1]]})}),p=f.length;f=f.map(function(e){return e.filter(function(t){return!1===t.map(function(e,r){return ne(t[0][r]-t[1][r])<n}).reduce(function(e,t){return e&&t},!0)})});var _=f.length;p!==_&&console.log("fragment() remove degenerate edges is needed!");for(var u=f.map(function(e,t){return e.map(function(){return t})}).reduce(function(e,t){return e.concat(t)},[]),h=f.map(function(e){return e.reduce(function(e,t){return e.concat(t)},[])}).reduce(function(e,t){return e.concat(t)},[]),m=0,y=f.map(function(e){return e.map(function(){return[m++,m++]})}).reduce(function(e,t){return e.concat(t)},[]),k=Array.from(Array(h.length)).map(function(){return[]}),x=0;x<h.length-1;x+=1)for(var e=x+1;e<h.length;e+=1)k[x][e]=ic(h[x],h[e],n);var b=h.map(function(){});k.forEach(function(e,t){return e.forEach(function(e,i){e&&(b[i]=void 0===b[t]?t:b[t])})});var E=b.map(function(e){return void 0!==e});b.forEach(function(e,t){void 0===e&&(b[t]=t)}),y.forEach(function(e,t){return e.forEach(function(e,i){y[t][i]=b[e]})});for(var P=Array.from(Array(y.length)).map(function(){return[]}),S=0;S<y.length-1;S+=1)for(var A=S+1;A<y.length;A+=1)P[S][A]=rc(y[S],y[A]);var w=y.map(function(){});P.forEach(function(e,t){return e.forEach(function(e,i){e&&(w[t]=void 0===w[i]?i:w[i])})}),w.forEach(function(n,e){void 0!==n&&["B","b"].includes(t.edges_assignment[e])&&(t.edges_assignment[n]="B")});var N=w.map(function(e){return void 0===e});w.forEach(function(e,t){void 0===e&&(w[t]=t)});var L=y.filter(function(e,t){return N[t]}),O=u.filter(function(e,t){return N[t]}),C={vertices_coords:h,edges_vertices:L};null!=t.edges_assignment&&(C.edges_assignment=O.map(function(e){return t.edges_assignment[e]||"U"})),null!=t.edges_foldAngle&&(C.edges_foldAngle=O.map(function(e,i){return t.edges_foldAngle[e]||Oi(C.edges_assignment[i])}));var M=E.map(function(e,t){return e?t:void 0}).filter(function(e){return void 0!==e});Ja(C,"vertices",M),bi.graph.forEach(function(e){return delete t[e]}),Object.assign(t,C)},dc=function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return i.map(function(t){return"vertices_coords"===t||"edges_vertices"===t?null!=e[t]:"vertices_vertices"===t?(Ur.edges_vertices_to_vertices_vertices_sorted(e),!0):"vertices_edges"==t&&(e.vertices_edges=Pa(e),!0)}).reduce(function(e,t){return e&&t},!0)},lc=function(e,t,i){return e.vertices_coords.map(function(e){return e.map(function(e,n){return e-t[n]})}).map(function(e){return e[0]*i[1]-e[1]*i[0]}).map(function(e,t){return ne(e)<yi.core.EPSILON?t:void 0}).filter(function(e){return void 0!==e})},gc=function(e,t){if(3>t.length)return!1;var n=t.map(function(t){return e.vertices_coords[t]}),r=Array.from(Array(n[0].length)),s=r.map(function(e,t){return n[1][t]-n[0][t]}),i=r.map(function(e,t){return n[2][t]-n[0][t]});return ne(s[0]*i[1]-s[1]*i[0])<yi.core.EPSILON},fc=function(e,t){var i=[];t.forEach(function(t){var n=t.vertices,r=t.edges,s=t.assignments[0];Ja(e,"edges",r),i.push({vertices:n,assignment:s})}),i.forEach(function(t){var i=e.edges_vertices.length;e.edges_vertices[i]=t.vertices,e.edges_assignment[i]=t.assignment}),Ja(e,"vertices",t.map(function(e){return e.vertex}))},pc=function(t){dc(t,"vertices_vertices","vertices_edges");var i=t.vertices_vertices.map(function(e,t){return 2===e.length?t:void 0}).filter(function(e){return void 0!==e}),n=i.map(function(e){return[e].concat(t.vertices_vertices[e])}).map(function(e){return gc(t,e)?{vertex:e[0],vertices:[e[1],e[2]],edges:t.vertices_edges[e[0]]}:void 0}).filter(function(e){return void 0!==e});n.forEach(function(e){e.assignments=e.edges.map(function(i){return t.edges_assignment[i].toUpperCase()})}),n.forEach(function(e){e.valid=e.assignments.map(function(t){return t===e.assignments[0]}).reduce(function(e,t){return e&&t},!0)});var r=n.filter(function(e){return e.valid});return fc(t,r),0<r.length},_c=/*#__PURE__*/Object.freeze({__proto__:null,collinear_vertices:lc,collinear_edges:function(e,t,i){var n={};return lc(e,t,i).forEach(function(e){n[e]=!0}),Ur.edges_vertices_to_vertices_vertices_sorted(e),e.edges_vertices.map(function(t){return n[t[0]]&&n[t[1]]&&e.vertices_vertices[t[0]].includes(t[1])}).map(function(e,t){return e?t:void 0}).filter(function(e){return void 0!==e})},remove_all_collinear_vertices:pc}),uc=function(e){if(null==e.vertices_coords)return[];var t=e.vertices_coords.length,i=Array(t).fill(!1);return e.edges_vertices&&e.edges_vertices.forEach(function(e){e.filter(function(e){return!i[e]}).forEach(function(e){i[e]=!0,t-=1})}),e.faces_vertices&&e.faces_vertices.forEach(function(e){e.filter(function(e){return!i[e]}).forEach(function(e){i[e]=!0,t-=1})}),i.map(function(e,t){return e?void 0:t}).filter(function(e){return void 0!==e})},hc=/*#__PURE__*/Object.freeze({__proto__:null,find_edge_isolated_vertices:function(e){if(null==e.vertices_coords)return[];var t=e.vertices_coords.length,i=Array(t).fill(!1);return e.edges_vertices&&e.edges_vertices.forEach(function(e){e.filter(function(e){return!i[e]}).forEach(function(e){i[e]=!0,t-=1})}),i.map(function(e,t){return e?void 0:t}).filter(function(e){return void 0!==e})},find_face_isolated_vertices:function(e){if(null==e.vertices_coords)return[];var t=e.vertices_coords.length,i=Array(t).fill(!1);return e.faces_vertices&&e.faces_vertices.forEach(function(e){e.filter(function(e){return!i[e]}).forEach(function(e){i[e]=!0,t-=1})}),i.map(function(e,t){return e?void 0:t}).filter(function(e){return void 0!==e})},find_isolated_vertices:uc}),mc=Object.freeze({circular:!0,duplicate:!0}),vc=function(e){var t=e.edges_vertices.map(function(e,t){return e[0]===e[1]?t:void 0}).filter(function(e){return void 0!==e});Ja(e,"edges",t)},yc=function(e,t,i){return e.edges_vertices[t][0]===e.edges_vertices[i][0]&&e.edges_vertices[t][1]===e.edges_vertices[i][1]||e.edges_vertices[t][0]===e.edges_vertices[i][1]&&e.edges_vertices[t][1]===e.edges_vertices[i][0]},kc=function(e){var t=e.edges_vertices.map(function(t,n){for(var i=n+1;i<e.edges_vertices-1-n;i+=1)if(yc(e,n,i))return i});Ja(e,"edges",t)},xc=function(t,i){"object"!==e(i)&&(i={}),Object.keys(mc).filter(function(e){return!(e in i)}).forEach(function(e){i[e]=mc[e]}),!0===i.circular&&vc(t),!0===i.duplicate&&kc(t),!0===i.collinear&&(pc(t),!0===i.circular&&vc(t),!0===i.duplicate&&kc(t)),!0===i.isolated&&Ja(t,"vertices",uc(t))},bc=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:yi.core.EPSILON;if(e.length!==t.length)return!1;for(var r=0;r<e.length;r+=1)if(ne(e[r]-t[r])>n)return!1;return!0},Ec=function(e,t,n){for(var r=t.vertices_coords.map(function(){}),s=0;s<e.vertices_coords.length;s+=1)for(var a=0;a<t.vertices_coords.length;a+=1)bc(e.vertices_coords[s],t.vertices_coords[a],n)&&(r[a]=s,a=t.vertices_coords.length);return r},Pc=/*#__PURE__*/Object.freeze({__proto__:null,similar_vertices_coords:Ec}),Sc=function(t){if("object"===e(t)){if(null==t.vertices_vertices&&(t.vertices_coords&&t.edges_vertices?Ur.edges_vertices_to_vertices_vertices_sorted(t):t.edges_vertices&&Ur.edges_vertices_to_vertices_vertices_unsorted(t)),null==t.faces_vertices&&t.vertices_coords&&t.vertices_vertices&&Ur.vertices_vertices_to_faces_vertices(t),null==t.faces_edges&&t.faces_vertices&&Ur.faces_vertices_to_faces_edges(t),null==t.edges_faces){var i=wa(t);void 0!==i&&(t.edges_faces=i)}if(null==t.vertices_faces){var n=ja(t);void 0!==n&&(t.vertices_faces=n)}if(null==t.edges_length){var r=Na(t);void 0!==r&&(t.edges_length=r)}if(null==t.edges_foldAngle&&null!=t.edges_assignment&&(t.edges_foldAngle=t.edges_assignment.map(function(e){return Oi(e)})),null==t.edges_assignment&&null!=t.edges_foldAngle&&(t.edges_assignment=t.edges_foldAngle.map(function(e){return 0===e?"F":0>e?"M":0<e?"V":"U"})),null==t.faces_faces){var s=Sa(t);void 0!==s&&(t.faces_faces=s)}if(null==t.vertices_edges){var a=Pa(t);void 0!==a&&(t.vertices_edges=a)}if(null==t.edges_edges){var c=Aa(t);void 0!==c&&(t.edges_edges=c)}}},Ac=function(e,t){for(var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:yi.core.EPSILON,r=Ec(e,t,n),s=t.vertices_coords.filter(function(e,t){return void 0===r[t]}),a=e.vertices_coords.length,c=0;c<r.length;c+=1)void 0===r[c]&&(r[c]=a,a+=1);var o=t.edges_vertices.map(function(e){return e.map(function(e){return r[e]})});return e.vertices_coords=e.vertices_coords.concat(s),e.edges_vertices=e.edges_vertices.concat(o),delete e.vertices_vertices,delete e.vertices_edges,delete e.vertices_faces,delete e.edges_edges,delete e.edges_faces,delete e.faces_vertices,delete e.faces_edges,delete e.faces_faces,xc(e),oc(e),Sc(e),e},wc=function(e){1<arguments.length&&void 0!==arguments[1]?arguments[1]:yi.core.EPSILON;bi.orders.forEach(function(t){return delete e[t]}),bi.graph.filter(function(e){return"vertices_coords"!==e}).filter(function(e){return"edges_vertices"!==e}).filter(function(e){return"edges_assignment"!==e}).filter(function(e){return"edges_foldAngle"!==e}).forEach(function(t){return delete e[t]}),Object.keys(e).filter(function(e){return e.includes("re:")}).forEach(function(t){return delete e[t]}),null!=e.edges_assignment&&null!=e.edges_foldAngle&&delete e.edges_foldAngle,Sc(e)},Nc=function(e,t){Ci(e,"coords").forEach(function(i){e[i]=e[i].map(function(e){return yi.core.multiply_matrix2_vector2(t,e)})}),Ci(e,"matrix").forEach(function(i){e[i]=e[i].map(function(e){return yi.core.multiply_matrices2(e,t)})})},Lc=function(e,t,i){"number"==typeof t&&void 0===i&&(i=t);var n=yi.core.make_matrix2_scale(t,i);Nc(e,n)},Oc=function(e,t,i){var n=yi.core.make_matrix2_translate(t,i);Nc(e,n)},jc=/*#__PURE__*/Object.freeze({__proto__:null,transform_scale:Lc,transform_translate:Oc,transform_matrix:function(e,t){Nc(e,t)}}),Cc=function(){var e=!1,t={};return t.update=function(){for(var i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];e||t.handlers.forEach(function(e){return e.apply(void 0,n)})},t.handlers=[],Object.defineProperty(t,"pause",{get:function(){return e},set:function(i){e=i,e||t.update()}}),Object.freeze(t)},Mc=function(e,t){var i=this;Object.defineProperty(e,"degree",{get:function(){return i.vertices_vertices&&i.vertices_vertices[t]?i.vertices_vertices[t].length:null}})},Tc=function(t,e){var i=this;Object.defineProperty(t,"coords",{get:function(){return i.edges_vertices&&i.edges_vertices[e]&&i.vertices_coords?i.edges_vertices[e].map(function(e){return i.vertices_coords[e]}):void 0}})},Ic=function(e,t){var i=this;Object.defineProperty(e,"simple",{get:function(){if(!i.faces_vertices||!i.faces_vertices[t])return null;for(var n=0;n<e.length-1;n+=1)for(var r=n+1;r<e.length;r+=1)if(i.faces_vertices[t][n]===i.faces_vertices[t][r])return!1;return!0}})},zc=function(e,t){var i=this;Object.defineProperty(e,"coords",{get:function(){return i.faces_vertices&&i.faces_vertices[t]&&i.vertices_coords?i.faces_vertices[t].map(function(e){return i.vertices_coords[e]}):void 0}})},Fc=function(e,t){Mc.call(this,e,t)},Bc=function(t,e){Tc.call(this,t,e)},Vc=function(e,t){Ic.call(this,e,t),zc.call(this,e,t)},Dc=function t(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};i.changed=Cc(),i.load=function(t){var i=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};"object"!==e(t)||(!0!==n.append&&Ei.forEach(function(e){return delete i[e]}),Object.assign(this,{file_spec:ki,file_creator:xi},ba(t)),this.changed.update(this.load))},i.join=function(e,t){Ac(this,e,t),this.changed.update(this.join)},i.clear=function(){var e=this;bi.graph.forEach(function(t){return delete e[t]}),bi.orders.forEach(function(t){return delete e[t]}),this.changed.update(this.clear)},i.copy=function(){return Object.assign(Object.create(t()),ba(this))},i.clean=function(e){xc(this,e),this.changed.update(this.clean)},i.populate=function(){Sc(this),this.changed.update(this.populate)},i.fragment=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1e-6;oc(this,e),this.changed.update(this.fragment)},i.rebuild=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1e-6;wc(this,e),this.changed.update(this.rebuild)},i.translate=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];Oc.apply(jc,[this].concat(t)),this.changed.update(this.translate)},i.scale=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];Lc.apply(jc,[this].concat(t)),this.changed.update(this.scale)};return i.nearestVertex=function(){var e=Ya(this,(i=yi.core).get_vector.apply(i,arguments)),t=Ti(this,"vertices",e),i;return Fc.call(this,t,e),t.index=e,t},i.nearestEdge=function(){var e=Ga(this,(i=yi.core).get_vector.apply(i,arguments)),t=Ti(this,"edges",e),i;return Bc.call(this,t,e),t.index=e,t},i.nearestFace=function(){var e=Za(this,(t=yi.core).get_vector.apply(t,arguments)),t;if(void 0!==e){var i=Ti(this,"faces",e);return Vc.call(this,i,e),i.index=e,i}},i.nearest=function(){var e=(i=yi.core).get_vector.apply(i,arguments),t={vertex:this.nearestVertex(this,e),edge:this.nearestEdge(this,e),face:this.nearestFace(this,e)},i;return Object.keys(t).filter(function(e){return null==t[e]}).forEach(function(e){return delete t[e]}),t},Object.defineProperty(i,"vertices",{get:function(){var e=Mi(this,"vertices"),t=0===e.length?Array.from(Array(Ua(this))).map(function(){return{}}):e;return t.forEach(Fc.bind(this)),t}}),Object.defineProperty(i,"edges",{get:function(){var e=Mi(this,"edges");return e.forEach(Bc.bind(this)),e}}),Object.defineProperty(i,"faces",{get:function(){var e=Mi(this,"faces");return e.forEach(Vc.bind(this)),e}}),Object.defineProperty(i,"bounds",{get:function(){return yi.rectangle.apply(yi,n(ec(this)))}}),Object.freeze(i)},Rc=function(e,t,i){if(void 0!==e.vertices_coords){var n=e.vertices_coords.length;return e.vertices_coords[n]=[t,i],n}},qc=function(t,i,e,r){if(!(t.edges_vertices.length<r)){var s=Rc(t,i,e),a=t.edges_vertices[r];null==t.vertices_vertices&&(t.vertices_vertices=[]),t.vertices_vertices[s]=ba(a),a.forEach(function(e,n,i){var r=i[(n+1)%i.length],a=t.vertices_vertices[e].indexOf(r);t.vertices_vertices[e][a]=s}),null!=t.edges_faces&&null!=t.edges_faces[r]&&(t.vertices_faces[s]=ba(t.edges_faces[r]));var c=[{edges_vertices:[a[0],s]},{edges_vertices:[s,a[1]]}];c.forEach(function(n,e){n.i=t.edges_vertices.length+e}),["edges_faces","edges_assignment","edges_foldAngle"].filter(function(e){return null!=t[e]&&null!=t[e][r]}).forEach(function(e){c[0][e]=ba(t[e][r]),c[1][e]=ba(t[e][r])}),c.forEach(function(e,r){var i=e.edges_vertices.map(function(e){return t.vertices_coords[e]}),s;c[r].edges_length=(s=yi.core).distance2.apply(s,n(i))}),c.forEach(function(e){return Object.keys(e).filter(function(e){return"i"!==e}).filter(function(e){return void 0!==t[e]}).forEach(function(i){t[i][e.i]=e[i]})});var o=t.edges_faces[r],d=o.map(function(e){return t.faces_vertices[e]}),l=o.map(function(e){return t.faces_edges[e]});d.forEach(function(e){return e.map(function(e,t,i){var n=(t+1)%i.length;return e===a[0]&&i[n]===a[1]||e===a[1]&&i[n]===a[0]?n:void 0}).filter(function(e){return void 0!==e}).sort(function(e,t){return t-e}).forEach(function(t){return e.splice(t,0,s)})}),l.forEach(function(e){var i=e.indexOf(r),a=e[(i+e.length-1)%e.length],o=e[(i+1)%e.length],d=[[a,r],[r,o]].map(function(e){var i=e.map(function(i){return t.edges_vertices[i]});return i[0][0]===i[1][0]||i[0][0]===i[1][1]?i[0][0]:i[0][1]}).reduce(function(e,t){return e.concat(t)},[]),l=[[d[0],s],[s,d[1]]].map(function(e){var t=e.map(function(e){return-1!==c[0].edges_vertices.indexOf(e)}).reduce(function(e,t){return e&&t},!0),i=e.map(function(e){return-1!==c[1].edges_vertices.indexOf(e)}).reduce(function(e,t){return e&&t},!0);if(t)return c[0].i;if(i)return c[1].i;throw new Error("something wrong with input graph's faces_edges construction")});return i===e.length-1?(e.splice(i,1,l[0]),e.unshift(l[1])):e.splice.apply(e,[i,1].concat(n(l))),l});var g=Ja(t,"edges",[r]);return{vertices:{new:[{index:s}]},edges:{map:g,replace:[{old:r,new:c.map(function(e){return e.i})}]}}}},Xc=function(e,t){for(var n=[],r=1;r<e.length;r++)e[r]!==e[r-1]&&n.push(r);for(var s=1;s<t.length;s++)if(t[s]!==t[s-1]);var a=t.slice();return n.forEach(function(e){return a.splice(e,0,0===e?0:a[e-1])}),e.map(function(e,t){return e+a[t]})},Uc=function(t,r,s,c){var o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"F",d=t.faces_vertices[r].map(function(e){return t.vertices_coords[e]}).map(function(e){return yi.core.point_on_line(s,c,e)?e:void 0}).map(function(e,n){return{point:e,i_face:n,i_vertices:t.faces_vertices[r][n]}}).filter(function(e){return void 0!==e.point}),l=t.faces_edges[r].map(function(e){return t.edges_vertices[e]}).map(function(e){return e.map(function(i){return t.vertices_coords[i]})}).map(function(e){return yi.core.intersection.line_segment_exclusive(s,c,e[0],e[1])}).map(function(e,n){return{point:e,i_face:n,i_edges:t.faces_edges[r][n]}}).filter(function(e){return void 0!==e.point}),g=[],f=Array(t.edges_vertices.length).fill(0),p;if(2===l.length)g=l.map(function(e,n,i){var r=qc(t,e.point[0],e.point[1],e.i_edges);return i.slice(n+1).filter(function(e){return null!=r.edges.map[e.i_edges]}).forEach(function(e){e.i_edges+=r.edges.map[e.i_edges]}),f=Xc(f,r.edges.map),r.vertices["new"][0].index});else if(1===l.length&&1===d.length){var _=d.map(function(e){return e.i_vertices}),e=l.map(function(e,n,i){var r=qc(t,e.point[0],e.point[1],e.i_edges);return i.slice(n+1).filter(function(e){return null!=r.edges.map[e.i_edges]}).forEach(function(e){e.i_edges+=r.edges.map[e.i_edges]}),f=r.edges.map,r.vertices["new"][0].index});g=_.concat(e)}else if(2===d.length){g=d.map(function(e){return e.i_vertices});var i=t.faces_vertices[r],a=d,u=i[(a[0].i_face+1)%i.length]===a[1].i_vertices,h=i[(a[1].i_face+1)%i.length]===a[0].i_vertices;if(u||h)return{}}else return{};var m=g.map(function(e){return t.faces_vertices[r].indexOf(e)}).sort(function(e,t){return e-t}),v=[{},{}];v[0].vertices=t.faces_vertices[r].slice(m[1]).concat(t.faces_vertices[r].slice(0,m[0]+1)),v[1].vertices=t.faces_vertices[r].slice(m[0],m[1]+1),v[0].edges=t.faces_edges[r].slice(m[1]).concat(t.faces_edges[r].slice(0,m[0])).concat([t.edges_vertices.length]),v[1].edges=t.faces_edges[r].slice(m[0],m[1]).concat([t.edges_vertices.length]),v[0].index=t.faces_vertices.length,v[1].index=t.faces_vertices.length+1;var y=[{index:t.edges_vertices.length,vertices:n(g),assignment:o,foldAngle:Oi(o),length:(p=yi.core).distance2.apply(p,n(g.map(function(e){return t.vertices_coords[e]}))),faces:[t.faces_vertices.length,t.faces_vertices.length+1]}],k=t.edges_vertices.length,x=t.faces_vertices.length;v.forEach(function(e,n){return Object.keys(e).filter(function(e){return"index"!==e}).forEach(function(i){t["faces_".concat(i)][x+n]=e[i]})}),y.forEach(function(e,n){return Object.keys(e).filter(function(e){return"index"!==e}).filter(function(e){return void 0!==t["edges_".concat(e)]}).forEach(function(i){t["edges_".concat(i)][k+n]=e[i]})}),y.forEach(function(e){var i=e.vertices[0],n=e.vertices[1];t.vertices_vertices[i].push(n),t.vertices_vertices[n].push(i)});var b={};t.faces_vertices.map(function(e,t){return{face:e,i:t}}).filter(function(e){return e.i===x||e.i===x+1}).forEach(function(e){return e.face.forEach(function(t){null==b[t]&&(b[t]=[]),b[t].push(e.i)})}),t.vertices_faces.forEach(function(e,s){for(var i=e.indexOf(r);-1!==i;){var a;(a=t.vertices_faces[s]).splice.apply(a,[i,1].concat(n(b[s]))),i=e.indexOf(r)}});var E={};t.faces_edges.map(function(e,t){return{face:e,i:t}}).filter(function(e){return e.i===x||e.i===x+1}).forEach(function(t){return t.face.forEach(function(i){null==E[i]&&(E[i]=[]),E[i].push(t.i)})}),t.edges_faces.forEach(function(e,s){for(var i=e.indexOf(r);-1!==i;){var a;(a=t.edges_faces[s]).splice.apply(a,[i,1].concat(n(E[s]))),i=e.indexOf(r)}});var P=Ja(t,"faces",[r]);return{faces:{map:P,replace:[{old:r,new:v}]},edges:{new:y,map:f}}},Yc=function(e,t){var i=e.map(function(e,n){return t[n]?n:void 0}).filter(function(e){return void 0!==e}),n=e.map(function(e,n){return t[n]?void 0:n}).filter(function(e){return void 0!==e}),r=i.slice().sort(function(t,i){return e[t]-e[i]}),s=n.slice().sort(function(t,i){return e[t]-e[i]}),a=[];s.forEach(function(e,t){a[e]=t});var c=s.length;return r.reverse().forEach(function(e,t){a[e]=c+t}),a},Gc=function(e){return{type:"flip",direction:e}},Zc=function(e,t,i,n){var r=[i[0]-e[0],i[1]-e[1]],s=t[0]*r[1]-t[1]*r[0];return n?0<s:0>s},Kc=function(e,t){return e.faces_vertices[t].map(function(t){return e.vertices_coords[t]}).reduce(function(e,t){return[e[0]+t[0],e[1]+t[1]]},[0,0]).map(function(i){return i/e.faces_vertices[t].length})},Wc=function(e,t,i,n){var r=Xa(e);e["faces_re:preindex"]=Array.from(Array(r)).map(function(e,t){return t}),!1=="faces_re:matrix"in e&&(e["faces_re:matrix"]=Ta(e,n)),e["faces_re:coloring"]=Ba(e["faces_re:matrix"]),e["faces_re:creases"]=e["faces_re:matrix"].map(function(e){return yi.core.invert_matrix2(e)}).map(function(e){return yi.core.multiply_matrix2_line2(e,t,i)}),e["faces_re:center"]=Array.from(Array(r)).map(function(t,n){return Kc(e,n)}),e["faces_re:sidedness"]=Array.from(Array(r)).map(function(t,n){return Zc(e["faces_re:creases"][n].origin,e["faces_re:creases"][n].vector,e["faces_re:center"][n],e["faces_re:coloring"][n])})},Hc=function(e){var t=Xa(e);null==e["faces_re:layer"]&&(e["faces_re:layer"]=Array(t).fill(0))},$c=function(e){var t=[0,-Infinity],i=[1/0,0],n=[-Infinity,0],r=[0,1/0];e.forEach(function(e){e[0]<i[0]&&(i=e),e[0]>n[0]&&(n=e),e[1]<r[1]&&(r=e),e[1]>t[1]&&(t=e)});var s=ne(t[1]-r[1]),a=ne(n[0]-i[0]);return s>a?[r,t]:[i,n]},Qc={M:"V",m:"V",V:"M",v:"M"},Jc=function(e){return Qc[e]||e},eo=function(e,t,i,n){var r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:"V",s=Jc(r);if(null==n){var a=Za(e,t);n=void 0===a?0:a}Hc(e),Wc(e,t,i,n);var c=ba(e),o=Array.from(Array(Xa(e))).map(function(e,t){return t}).reverse().map(function(t){var i=Uc(c,t,c["faces_re:creases"][t].origin,c["faces_re:creases"][t].vector,c["faces_re:coloring"][t]?r:s);if(null!=i&&null!=i.faces)return i.faces.replace.forEach(function(t){return t["new"].map(function(e){return e.index}).map(function(e){return e+i.faces.map[e]}).forEach(function(n){c["faces_re:center"][n]=Kc(c,n),c["faces_re:sidedness"][n]=Zc(e["faces_re:creases"][t.old].origin,e["faces_re:creases"][t.old].vector,c["faces_re:center"][n],e["faces_re:coloring"][t.old]),c["faces_re:layer"][n]=e["faces_re:layer"][t.old],c["faces_re:preindex"][n]=e["faces_re:preindex"][t.old]})}),{index:t,length:i.edges["new"][0].length,edge:i.edges["new"][0].vertices.map(function(e){return c.vertices_coords[e]})}}).reverse();c["faces_re:layer"]=Yc(c["faces_re:layer"],c["faces_re:sidedness"]);var d=void 0===o[0]?0:c["faces_re:preindex"].map(function(e,t){return{pre:e,new:t}}).filter(function(e){return 0===e.pre}).filter(function(e){return c["faces_re:sidedness"][e["new"]]}).shift()["new"],l=e["faces_re:matrix"][0];("M"===r||"m"===r||"V"===r||"v"===r)&&(l=void 0!==o[0]||e["faces_re:sidedness"][0]?yi.core.multiply_matrices2(e["faces_re:matrix"][0],yi.core.make_matrix2_reflection(e["faces_re:creases"][0].vector,e["faces_re:creases"][0].origin)):e["faces_re:matrix"][0]);var g=Ta(c,d).map(function(e){return yi.core.multiply_matrices2(l,e)});c["faces_re:coloring"]=Ba(g);var f=yi.core.multiply_matrix2_line2(l,e["faces_re:creases"][0].origin,e["faces_re:creases"][0].vector),p=yi.core.normalize([f.vector[1],-f.vector[0]]),_=o.map(function(t,n){return void 0===t?void 0:t.edge.map(function(t){return yi.core.multiply_matrix2_vector2(e["faces_re:matrix"][n],t)})}).filter(function(e){return void 0!==e}).reduce(function(e,t){return e.concat(t)},[]);return c["re:construction"]=0===_.length?Gc(p):{type:"fold",assignment:r,direction:p,edge:$c(_)},c["vertices_re:foldedCoords"]=za(c,d,g),c["faces_re:matrix"]=g,delete e["faces_re:creases"],delete c["faces_re:creases"],delete e["faces_re:sidedness"],delete c["faces_re:sidedness"],delete e["faces_re:preindex"],delete c["faces_re:preindex"],delete e["faces_re:coloring"],delete c["faces_re:coloring"],delete e["faces_re:center"],delete c["faces_re:center"],c},to="{\n  \"ar\": [null,\n    \"\u0627\u0635\u0646\u0639 \u062E\u0637\u0627\u064B \u064A\u0645\u0631 \u0628\u0646\u0642\u0637\u062A\u064A\u0646\",\n    \"\u0627\u0635\u0646\u0639 \u062E\u0637\u0627\u064B \u0639\u0646 \u0637\u0631\u064A\u0642 \u0637\u064A \u0646\u0642\u0637\u0629 \u0648\u0627\u062D\u062F\u0629 \u0625\u0644\u0649 \u0623\u062E\u0631\u0649\",\n    \"\u0627\u0635\u0646\u0639 \u062E\u0637\u0627\u064B \u0639\u0646 \u0637\u0631\u064A\u0642 \u0637\u064A \u062E\u0637 \u0648\u0627\u062D\u062F \u0639\u0644\u0649 \u0622\u062E\u0631\",\n    \"\u0627\u0635\u0646\u0639 \u062E\u0637\u0627\u064B \u064A\u0645\u0631 \u0639\u0628\u0631 \u0646\u0642\u0637\u0629 \u0648\u0627\u062D\u062F\u0629 \u0648\u064A\u062C\u0639\u0644 \u062E\u0637\u0627\u064B \u0648\u0627\u062D\u062F\u0627\u064B \u0641\u0648\u0642 \u0646\u0641\u0633\u0647\",\n    \"\u0627\u0635\u0646\u0639 \u062E\u0637\u0627\u064B \u064A\u0645\u0631 \u0628\u0627\u0644\u0646\u0642\u0637\u0629 \u0627\u0644\u0623\u0648\u0644\u0649 \u0648\u064A\u062C\u0639\u0644 \u0627\u0644\u0646\u0642\u0637\u0629 \u0627\u0644\u062B\u0627\u0646\u064A\u0629 \u0639\u0644\u0649 \u0627\u0644\u062E\u0637\",\n    \"\u0627\u0635\u0646\u0639 \u062E\u0637\u0627\u064B \u064A\u062C\u0644\u0628 \u0627\u0644\u0646\u0642\u0637\u0629 \u0627\u0644\u0623\u0648\u0644\u0649 \u0625\u0644\u0649 \u0627\u0644\u062E\u0637 \u0627\u0644\u0623\u0648\u0644 \u0648\u0627\u0644\u0646\u0642\u0637\u0629 \u0627\u0644\u062B\u0627\u0646\u064A\u0629 \u0625\u0644\u0649 \u0627\u0644\u062E\u0637 \u0627\u0644\u062B\u0627\u0646\u064A\",\n    \"\u0627\u0635\u0646\u0639 \u062E\u0637\u0627\u064B \u064A\u062C\u0644\u0628 \u0646\u0642\u0637\u0629 \u0625\u0644\u0649 \u062E\u0637 \u0648\u064A\u062C\u0639\u0644 \u062E\u0637 \u062B\u0627\u0646\u064A \u0641\u0648\u0642 \u0646\u0641\u0633\u0647\"\n  ],\n  \"de\": [null,\n    \"Falte eine Linie durch zwei Punkte\",\n    \"Falte zwei Punkte aufeinander\",\n    \"Falte zwei Linien aufeinander\",\n    \"Falte eine Linie auf sich selbst, falte dabei durch einen Punkt\",\n    \"Falte einen Punkt auf eine Linie, falte dabei durch einen anderen Punkt\",\n    \"Falte einen Punkt auf eine Linie und einen weiteren Punkt auf eine weitere Linie\",\n    \"Falte einen Punkt auf eine Linie und eine weitere Linie in sich selbst zusammen\"\n  ],\n  \"en\": [null,\n    \"fold a line through two points\",\n    \"fold two points together\",\n    \"fold two lines together\",\n    \"fold a line on top of itself, creasing through a point\",\n    \"fold a point to a line, creasing through another point\",\n    \"fold a point to a line and another point to another line\",\n    \"fold a point to a line and another line onto itself\"\n  ],\n  \"es\": [null,\n    \"dobla una l\xEDnea entre dos puntos\",\n    \"dobla dos puntos juntos\",\n    \"dobla y une dos l\xEDneas\",\n    \"dobla una l\xEDnea sobre s\xED misma, dobl\xE1ndola hacia un punto\",\n    \"dobla un punto hasta una l\xEDnea, dobl\xE1ndola a trav\xE9s de otro punto\",\n    \"dobla un punto hacia una l\xEDnea y otro punto hacia otra l\xEDnea\",\n    \"dobla un punto hacia una l\xEDnea y otra l\xEDnea sobre s\xED misma\"\n  ],\n  \"fr\":[null,\n    \"cr\xE9ez un pli passant par deux points\",\n    \"pliez pour superposer deux points\",\n    \"pliez pour superposer deux lignes\",\n    \"rabattez une ligne sur elle-m\xEAme \xE0 l'aide d'un pli qui passe par un point\",\n    \"rabattez un point sur une ligne \xE0 l'aide d'un pli qui passe par un autre point\",\n    \"rabattez un point sur une ligne et un autre point sur une autre ligne\",\n    \"rabattez un point sur une ligne et une autre ligne sur elle-m\xEAme\"\n  ],\n  \"hi\": [null,\n    \"\u090F\u0915 \u0915\u094D\u0930\u0940\u091C\u093C \u092C\u0928\u093E\u090F\u0901 \u091C\u094B \u0926\u094B \u0938\u094D\u0925\u093E\u0928\u094B\u0902 \u0938\u0947 \u0917\u0941\u091C\u0930\u0924\u093E \u0939\u0948\",\n    \"\u090F\u0915 \u0938\u094D\u0925\u093E\u0928 \u0915\u094B \u0926\u0942\u0938\u0930\u0947 \u0938\u094D\u0925\u093E\u0928 \u092A\u0930 \u092E\u094B\u0921\u093C\u0915\u0930 \u090F\u0915 \u0915\u094D\u0930\u0940\u091C\u093C \u092C\u0928\u093E\u090F\u0901\",\n    \"\u090F\u0915 \u0930\u0947\u0916\u093E \u092A\u0930 \u0926\u0942\u0938\u0930\u0940 \u0930\u0947\u0916\u093E \u0915\u094B \u092E\u094B\u0921\u093C\u0915\u0930 \u0915\u094D\u0930\u0940\u091C\u093C \u092C\u0928\u093E\u090F\u0901\",\n    \"\u090F\u0915 \u0915\u094D\u0930\u0940\u091C\u093C \u092C\u0928\u093E\u090F\u0901 \u091C\u094B \u090F\u0915 \u0938\u094D\u0925\u093E\u0928 \u0938\u0947 \u0917\u0941\u091C\u0930\u0924\u093E \u0939\u0948 \u0914\u0930 \u090F\u0915 \u0930\u0947\u0916\u093E \u0915\u094B \u0938\u094D\u0935\u092F\u0902 \u0915\u0947 \u090A\u092A\u0930 \u0932\u0947 \u0906\u0924\u093E \u0939\u0948\",\n    \"\u090F\u0915 \u0915\u094D\u0930\u0940\u091C\u093C \u092C\u0928\u093E\u090F\u0901 \u091C\u094B \u092A\u0939\u0932\u0947 \u0938\u094D\u0925\u093E\u0928 \u0938\u0947 \u0917\u0941\u091C\u0930\u0924\u093E \u0939\u0948 \u0914\u0930 \u0926\u0942\u0938\u0930\u0947 \u0938\u094D\u0925\u093E\u0928 \u0915\u094B \u0930\u0947\u0916\u093E \u092A\u0930 \u0932\u0947 \u0906\u0924\u093E \u0939\u0948\",\n    \"\u090F\u0915 \u0915\u094D\u0930\u0940\u091C\u093C \u092C\u0928\u093E\u090F\u0901 \u091C\u094B \u092A\u0939\u0932\u0947 \u0938\u094D\u0925\u093E\u0928 \u0915\u094B \u092A\u0939\u0932\u0940 \u0930\u0947\u0916\u093E \u092A\u0930 \u0914\u0930 \u0926\u0942\u0938\u0930\u0947 \u0938\u094D\u0925\u093E\u0928 \u0915\u094B \u0926\u0942\u0938\u0930\u0940 \u0930\u0947\u0916\u093E \u092A\u0930 \u0932\u0947 \u0906\u0924\u093E \u0939\u0948\",\n    \"\u090F\u0915 \u0915\u094D\u0930\u0940\u091C\u093C \u092C\u0928\u093E\u090F\u0901 \u091C\u094B \u090F\u0915 \u0938\u094D\u0925\u093E\u0928 \u0915\u094B \u090F\u0915 \u0930\u0947\u0916\u093E \u092A\u0930 \u0932\u0947 \u0906\u0924\u093E \u0939\u0948 \u0914\u0930 \u0926\u0942\u0938\u0930\u0940 \u0930\u0947\u0916\u093E \u0915\u094B \u0938\u094D\u0935\u092F\u0902 \u0915\u0947 \u090A\u092A\u0930 \u0932\u0947 \u0906\u0924\u093E \u0939\u0948\"\n  ],\n  \"jp\": [null,\n    \"2\u70B9\u306B\u6CBF\u3063\u3066\u6298\u308A\u76EE\u3092\u4ED8\u3051\u307E\u3059\",\n    \"2\u70B9\u3092\u5408\u308F\u305B\u3066\u6298\u308A\u307E\u3059\",\n    \"2\u3064\u306E\u7DDA\u3092\u5408\u308F\u305B\u3066\u6298\u308A\u307E\u3059\",\n    \"\u70B9\u3092\u901A\u904E\u3055\u305B\u3001\u65E2\u306B\u3042\u308B\u7DDA\u306B\u6CBF\u3063\u3066\u6298\u308A\u307E\u3059\",\n    \"\u70B9\u3092\u7DDA\u6CBF\u3044\u306B\u5408\u308F\u305B\u5225\u306E\u70B9\u3092\u901A\u904E\u3055\u305B\u6298\u308A\u307E\u3059\",\n    \"\u7DDA\u306B\u5411\u304B\u3063\u3066\u70B9\u3092\u6298\u308A\u3001\u540C\u6642\u306B\u3082\u3046\u4E00\u65B9\u306E\u7DDA\u306B\u5411\u304B\u3063\u3066\u3082\u3046\u4E00\u65B9\u306E\u70B9\u3092\u6298\u308A\u307E\u3059\",\n    \"\u7DDA\u306B\u5411\u304B\u3063\u3066\u70B9\u3092\u6298\u308A\u3001\u540C\u6642\u306B\u5225\u306E\u7DDA\u3092\u305D\u306E\u4E0A\u306B\u6298\u308A\u307E\u3059\"\n  ],\n  \"ko\": [null,\n    \"\uB450 \uC810\uC744 \uD1B5\uACFC\uD558\uB294 \uC120\uC73C\uB85C \uC811\uC73C\uC138\uC694\",\n    \"\uB450 \uC810\uC744 \uD568\uAED8 \uC811\uC73C\uC138\uC694\",\n    \"\uB450 \uC120\uC744 \uD568\uAED8 \uC811\uC73C\uC138\uC694\",\n    \"\uADF8 \uC704\uC5D0 \uC120\uC744 \uC811\uC73C\uBA74\uC11C \uC810\uC744 \uD1B5\uACFC\uD558\uAC8C \uC811\uC73C\uC138\uC694\",\n    \"\uC810\uC744 \uC120\uC73C\uB85C \uC811\uC73C\uBA74\uC11C, \uB2E4\uB978 \uC810\uC744 \uC9C0\uB098\uAC8C \uC811\uC73C\uC138\uC694\",\n    \"\uC810\uC744 \uC120\uC73C\uB85C \uC811\uACE0 \uB2E4\uB978 \uC810\uC744 \uB2E4\uB978 \uC120\uC73C\uB85C \uC811\uC73C\uC138\uC694\",\n    \"\uC810\uC744 \uC120\uC73C\uB85C \uC811\uACE0 \uB2E4\uB978 \uC120\uC744 \uADF8 \uC704\uC5D0 \uC811\uC73C\uC138\uC694\"\n  ],\n  \"ms\": [null,\n    \"lipat garisan melalui dua titik\",\n    \"lipat dua titik bersama\",\n    \"lipat dua garisan bersama\",\n    \"lipat satu garisan di atasnya sendiri, melipat melalui satu titik\",\n    \"lipat satu titik ke garisan, melipat melalui titik lain\",\n    \"lipat satu titik ke garisan dan satu lagi titik ke garisan lain\",\n    \"lipat satu titik ke garisan dan satu lagi garisan di atasnya sendiri\"\n  ],\n  \"pt\": [null,\n    \"dobre uma linha entre dois pontos\",\n    \"dobre os dois pontos para uni-los\",\n    \"dobre as duas linhas para uni-las\",\n    \"dobre uma linha sobre si mesma, criando uma dobra ao longo de um ponto\",\n    \"dobre um ponto at\xE9 uma linha, criando uma dobra ao longo de outro ponto\",\n    \"dobre um ponto at\xE9 uma linha e outro ponto at\xE9 outra linha\",\n    \"dobre um ponto at\xE9 uma linha e outra linha sobre si mesma\"\n  ],\n  \"ru\": [null,\n    \"\u0441\u043B\u043E\u0436\u0438\u0442\u0435 \u043B\u0438\u043D\u0438\u044E \u0447\u0435\u0440\u0435\u0437 \u0434\u0432\u0435 \u0442\u043E\u0447\u043A\u0438\",\n    \"\u0441\u043B\u043E\u0436\u0438\u0442\u0435 \u0434\u0432\u0435 \u0442\u043E\u0447\u043A\u0438 \u0432\u043C\u0435\u0441\u0442\u0435\",\n    \"\u0441\u043B\u043E\u0436\u0438\u0442\u0435 \u0434\u0432\u0435 \u043B\u0438\u043D\u0438\u0438 \u0432\u043C\u0435\u0441\u0442\u0435\",\n    \"\u0441\u0432\u0435\u0440\u043D\u0438\u0442\u0435 \u043B\u0438\u043D\u0438\u044E \u0441\u0432\u0435\u0440\u0445\u0443 \u0441\u0435\u0431\u044F, \u0441\u0433\u0438\u0431\u0430\u044F \u0447\u0435\u0440\u0435\u0437 \u0442\u043E\u0447\u043A\u0443\",\n    \"\u0441\u043B\u043E\u0436\u0438\u0442\u0435 \u0442\u043E\u0447\u043A\u0443 \u0432 \u043B\u0438\u043D\u0438\u044E, \u0441\u0433\u0438\u0431\u0430\u044F \u0447\u0435\u0440\u0435\u0437 \u0434\u0440\u0443\u0433\u0443\u044E \u0442\u043E\u0447\u043A\u0443\",\n    \"\u0441\u043B\u043E\u0436\u0438\u0442\u0435 \u0442\u043E\u0447\u043A\u0443 \u0432 \u043B\u0438\u043D\u0438\u044E \u0438 \u0434\u0440\u0443\u0433\u0443\u044E \u0442\u043E\u0447\u043A\u0443 \u0432 \u0434\u0440\u0443\u0433\u0443\u044E \u043B\u0438\u043D\u0438\u044E\",\n    \"\u0441\u043B\u043E\u0436\u0438\u0442\u0435 \u0442\u043E\u0447\u043A\u0443 \u0432 \u043B\u0438\u043D\u0438\u044E \u0438 \u0434\u0440\u0443\u0433\u0443\u044E \u043B\u0438\u043D\u0438\u044E \u043D\u0430 \u0441\u0435\u0431\u044F\"\n  ],\n  \"tr\": [null,\n    \"iki noktadan ge\xE7en bir \xE7izgi boyunca katla\",\n    \"iki noktay\u0131 birbirine katla\",\n    \"iki \xE7izgiyi birbirine katla\",\n    \"bir noktadan k\u0131v\u0131rarak kendi \xFCzerindeki bir \xE7izgi boyunca katla\",\n    \"ba\u015Fka bir noktadan k\u0131v\u0131rarak bir noktay\u0131 bir \xE7izgiye katla\",\n    \"bir noktay\u0131 bir \xE7izgiye ve ba\u015Fka bir noktay\u0131 ba\u015Fka bir \xE7izgiye katla\",\n    \"bir noktay\u0131 bir \xE7izgiye ve ba\u015Fka bir \xE7izgiyi kendi \xFCzerine katla\"\n  ],\n  \"vi\": [null,\n    \"t\u1EA1o m\u1ED9t n\u1EBFp g\u1EA5p \u0111i qua hai \u0111i\u1EC3m\",\n    \"t\u1EA1o n\u1EBFp g\u1EA5p b\u1EB1ng c\xE1ch g\u1EA5p m\u1ED9t \u0111i\u1EC3m n\xE0y sang \u0111i\u1EC3m kh\xE1c\",\n    \"t\u1EA1o n\u1EBFp g\u1EA5p b\u1EB1ng c\xE1ch g\u1EA5p m\u1ED9t \u0111\u01B0\u1EDDng l\xEAn m\u1ED9t \u0111\u01B0\u1EDDng kh\xE1c\",\n    \"t\u1EA1o m\u1ED9t n\u1EBFp g\u1EA5p \u0111i qua m\u1ED9t \u0111i\u1EC3m v\xE0 \u0111\u01B0a m\u1ED9t \u0111\u01B0\u1EDDng l\xEAn tr\xEAn ch\xEDnh n\xF3\",\n    \"t\u1EA1o m\u1ED9t n\u1EBFp g\u1EA5p \u0111i qua \u0111i\u1EC3m \u0111\u1EA7u ti\xEAn v\xE0 \u0111\u01B0a \u0111i\u1EC3m th\u1EE9 hai l\xEAn \u0111\u01B0\u1EDDng th\u1EB3ng\",\n    \"t\u1EA1o m\u1ED9t n\u1EBFp g\u1EA5p mang \u0111i\u1EC3m \u0111\u1EA7u ti\xEAn \u0111\u1EBFn \u0111\u01B0\u1EDDng \u0111\u1EA7u ti\xEAn v\xE0 \u0111i\u1EC3m th\u1EE9 hai cho \u0111\u01B0\u1EDDng th\u1EE9 hai\",\n    \"t\u1EA1o m\u1ED9t n\u1EBFp g\u1EA5p mang l\u1EA1i m\u1ED9t \u0111i\u1EC3m cho m\u1ED9t \u0111\u01B0\u1EDDng v\xE0 \u0111\u01B0a m\u1ED9t \u0111\u01B0\u1EDDng th\u1EE9 hai l\xEAn tr\xEAn ch\xEDnh n\xF3\"\n  ],\n  \"zh\": [null,\n    \"\u901A\u904E\u5169\u9EDE\u6298\u4E00\u689D\u7DDA\",\n    \"\u5C07\u5169\u9EDE\u6298\u758A\u8D77\u4F86\",\n    \"\u5C07\u5169\u689D\u7DDA\u6298\u758A\u5728\u4E00\u8D77\",\n    \"\u901A\u904E\u4E00\u500B\u9EDE\u6298\u758A\u4E00\u689D\u7DDA\u5728\u81EA\u8EAB\u4E0A\u9762\",\n    \"\u5C07\u4E00\u500B\u9EDE\uFF0C\u901A\u904E\u53E6\u4E00\u500B\u9EDE\u6298\u758A\u6210\u4E00\u689D\u7DDA\uFF0C\",\n    \"\u5C07\u4E00\u500B\u9EDE\u6298\u758A\u70BA\u4E00\u689D\u7DDA\uFF0C\u518D\u5C07\u53E6\u4E00\u500B\u9EDE\u6298\u758A\u5230\u53E6\u4E00\u689D\u7DDA\",\n    \"\u5C07\u4E00\u500B\u9EDE\u6298\u758A\u6210\u4E00\u689D\u7DDA\uFF0C\u53E6\u4E00\u689D\u7DDA\u6298\u758A\u5230\u5B83\u81EA\u8EAB\u4E0A\"\n  ]\n}\n",io=JSON.parse(to),no=function(e){if(!(isNaN(e)||null==e||1>e||7<e)){var t={};return Object.keys(io).forEach(function(i){t[i]=io[i][e]}),t}},ro=function(e){var t=e.axiom||0;return!isNaN(t)&&null!=t&&0<t&&8>t?no(t):"assignment"in e?{en:"".concat(Ai[e.assignment]," fold")}:{en:""}},so=function(e,t){var i=e.axiom||0,n=e.edge,r=e.direction,s=e;if(2===i)return[s.parameters.points[1],s.parameters.points[0]];if(5===i)return[s.parameters.points[1],s.test.points_reflected[1]];if(7===i)return[s.parameters.points[0],s.test.points_reflected[0]];var a=[n[1][0]-n[0][0],n[1][1]-n[0][1]],c;c=4===i?yi.core.nearest_point_on_line(n[0],a,s.parameters.lines[0][0],function(e){return e}):7===i?yi.core.nearest_point_on_line(n[0],a,s.parameters.points[0],function(e){return e}):yi.core.average(n[0],n[1]);var o=tc(t).vertices.map(function(e){return t.vertices_coords[e]}),d=yi.core.intersection.convex_poly_line(o,c,r);if(void 0===d)return[];var l=[d[0],d[1]].map(function(e){return yi.core.distance2(e,c)}).sort(function(e,t){return e-t}).shift();7===i&&(l=yi.core.distance2(e.parameters.points[0],c));var g=r.map(function(e){return e*l});return[c.map(function(e,t){return e-g[t]}),c.map(function(e,t){return e+g[t]})]},ao=function(e){var t=e["re:construction"];if(null==t)return console.warn("couldn't build diagram. construction info doesn't exist"),{};switch(t.type){case"flip":return{"re:diagram_arrows":[{"re:diagram_arrow_classes":["flip"],"re:diagram_arrow_coords":[]}],"re:diagram_instructions":{en:"flip over"}};case"fold":return{"re:diagram_lines":[{"re:diagram_line_classes":[Ai[t.assignment]],"re:diagram_line_coords":t.edge}],"re:diagram_arrows":[{"re:diagram_arrowClasses":[],"re:diagram_arrow_coords":so(t,e)}],"re:diagram_instructions":ro(t)};case"squash":case"sink":case"pleat":default:return{error:"construction type (".concat(t.type,") not yet defined")};}},co=function(e,t){var n={vertices:Ra(e),edges:qa(e),faces:Xa(e)};return t["new"]&&Object.keys(t["new"]).forEach(function(r){return t["new"][r].forEach(function(t,s){return Object.keys(t).forEach(function(i){e[i][n[r]+s]=t[i]})})}),t.update&&Object.keys(t.update).forEach(function(n){return Object.keys(t.update[n]).forEach(function(i){e[i][n]=t.update[n][i]})}),t.remove&&(t.remove.faces&&Ja(e,"faces",t.remove.faces),t.remove.edges&&Ja(e,"edges",t.remove.edges),t.remove.vertices&&Ja(e,"vertices",t.remove.vertices)),t},oo=function(e,t,i){var n=ji(e,t),r={};return n.forEach(function(t){r[t]=e[t][i]}),r},lo=function(t){return null==t||null==t.frame_classes||"object"!==e(t.frame_classes)?void 0:!!t.frame_classes.includes(Ni)||!t.frame_classes.includes(Li)&&void 0},go="undefined"!=typeof window&&"undefined"!=typeof window.document,fo="undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,po=function(){var e={};if(fo){var t=require("xmldom"),i=t.DOMParser,n=t.XMLSerializer;e.DOMParser=i,e.XMLSerializer=n,e.document=new i().parseFromString("<!DOCTYPE html><title> </title>","text/html")}else go&&(e=window);return e}(),_o="http://www.w3.org/2000/svg",uo=function(e,t){var i=new po.Blob([t],{type:"text/plain"}),n=po.document.createElement("a");n.setAttribute("href",po.URL.createObjectURL(i)),n.setAttribute("download",e),po.document.body.appendChild(n),n.click(),po.document.body.removeChild(n)},ho=function(){for(var e=[],t=0,i;t<po.document.styleSheets.length;t+=1){i=po.document.styleSheets[t];try{for(var n=("cssRules"in i)?i.cssRules:i.rules,a=0,c;a<n.length;a+=1)c=n[a],"cssText"in c?e.push(c.cssText):e.push("".concat(c.selectorText," {\n").concat(c.style.cssText,"\n}\n"))}catch(e){console.warn(e)}}return e.join("\n")},mo=function(){return{output:"string",windowStyle:!1,filename:"image.svg"}},vo=function(t,i){if("string"==typeof i||i instanceof String){var n=i;i=mo(),i.filename=n}else if("object"!==e(i)||null===i)i=mo();else{var r=mo();Object.keys(i).forEach(function(e){r[e]=i[e]}),i=r}if(i.windowStyle){var s=po.document.createElementNS(_o,"style");s.setAttribute("type","text/css"),s.innerHTML=ho(),t.appendChild(s)}var a=new po.XMLSerializer().serializeToString(t),c=H(a);return go&&!fo&&uo(i.filename,c),"svg"===i.output?t:c},yo=function(e,t){if("string"==typeof e||e instanceof String){var i=new po.DOMParser().parseFromString(e,"text/xml"),n=i.getElementsByTagName("parsererror");if(0===n.length){var r=i.documentElement;return null!=t&&t(r),r}fetch(e).then(function(e){return e.text()}).then(function(e){return new po.DOMParser().parseFromString(e,"text/xml")}).then(function(e){var i=e.getElementsByTagName("svg");if(null==i||0===i.length)throw new Error("error, valid XML found, but no SVG element");return null!=t&&t(i[0]),i[0]})}else if(e instanceof Document)return t(e),e},ko=Object.freeze({__proto__:null,save:vo,load:yo}),xo=function(e,t){Object.getOwnPropertyNames(e).filter(function(t){return"function"==typeof e[t]}).forEach(function(i){t[i]=e[i].bind(e)});var i=["svg","style","setPoints","setArc","setEllipticalArc","setBezier"];Object.keys(po.SVG).filter(function(e){return void 0===t[e]}).filter(function(e){return-1===i.indexOf(e)}).forEach(function(e){t[e]=po.SVG[e]}),Object.defineProperty(po,"mousePressed",{set:function(t){e.mousePressed=t},get:function(){return e.mousePressed}}),Object.defineProperty(po,"mouseReleased",{set:function(t){e.mouseReleased=t},get:function(){return e.mouseReleased}}),Object.defineProperty(po,"mouseMoved",{set:function(t){e.mouseMoved=t},get:function(){return e.mouseMoved}}),Object.defineProperty(po,"scroll",{set:function(t){e.scroll=t},get:function(){return e.scroll}}),Object.defineProperty(po,"animate",{set:function(t){e.animate=t},get:function(){return e.animate}}),Object.defineProperty(po,"fps",{set:function(t){e.fps=t},get:function(){return e.fps}})},bo=function(e){var t=e;if(null==t){for(var i=arguments.length,n=Array(1<i?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];t=po.SVG.apply(po,n)}return xo(t,po),t},Eo=function(e){var t=e.getAttribute("viewBox");return null==t?void 0:t.split(" ").map(function(e){return parseFloat(e)})},Po=function(e,t,i,n,r){var s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0,a=n/1-n,c=[t-a-s,i-a-s,n+2*a+2*s,r+2*a+2*s].join(" ");e.setAttributeNS(null,"viewBox",c)},So=function(e){var t=e.getBoundingClientRect(),i=0===t.width?640:t.width,n=0===t.height?480:t.height;Po(e,0,0,i,n)},Ao=function(e,t,i){var n=e.createSVGPoint();n.x=t,n.y=i;var r=n.matrixTransform(e.getScreenCTM().inverse()),s=[r.x,r.y];return s.x=r.x,s.y=r.y,s},wo=Object.freeze({__proto__:null,getViewBox:Eo,setViewBox:Po,convertToViewBox:Ao,translateViewBox:function(e,t,i){var n=Eo(e);null==n&&So(e),n[0]+=t,n[1]+=i,e.setAttributeNS(null,"viewBox",n.join(" "))},scaleViewBox:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;1e-8>ne(t)&&(t=.01);var s=e.createSVGMatrix().translate(n,r).scale(1/t).translate(-n,-r),a=Eo(e);null==a&&So(e);var c=e.createSVGPoint(),o=e.createSVGPoint(),d=i(a,2);c.x=d[0],c.y=d[1],o.x=a[0]+a[2],o.y=a[1]+a[3];var l=c.matrixTransform(s),g=o.matrixTransform(s);Po(e,l.x,l.y,g.x-l.x,g.y-l.y)}}),No=function(t){var n=Object.create(null);Object.assign(n,{isPressed:!1,position:[0,0],pressed:[0,0],drag:[0,0],previous:[0,0],x:0,y:0});var r=[0,0];n.position.x=r[0],n.position.y=r[1];var s=[0,0];n.pressed.x=s[0],n.pressed.y=s[1];var a=[0,0];n.drag.x=a[0],n.drag.y=a[1];var c=[0,0];n.previous.x=c[0],n.previous.y=c[1];var o=function(e,r){n.position=Ao(t,e,r);var s=i(n.position,2);n.x=s[0],n.y=s[1]},d=function(){n.drag=[n.position[0]-n.pressed[0],n.position[1]-n.pressed[1]];var e=i(n.drag,2);n.drag.x=e[0],n.drag.y=e[1]},l={};return Object.defineProperty(l,"release",{value:function(){return n.isPressed=!1,l}}),Object.defineProperty(l,"move",{value:function(e,r){var s=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];if(s&&!n.isPressed&&(n.pressed=Ao(t,e,r)),n.isPressed=s,n.previous=n.position,o(e,r),n.isPressed)d();else{n.drag=[0,0],n.pressed=[0,0];var a=i(n.drag,2);n.drag.x=a[0],n.drag.y=a[1];var c=i(n.pressed,2);n.pressed.x=c[0],n.pressed.y=c[1]}return l}}),Object.defineProperty(l,"get",{value:function(){var t=n.position.slice();return Object.keys(n).filter(function(t){return"object"===e(t)}).forEach(function(e){t[e]=n[e].slice()}),Object.keys(n).filter(function(t){return"object"!==e(t)}).forEach(function(e){t[e]=n[e]}),Object.freeze(t)}}),l},Lo=function(t){var n=No(t),r={mousemove:[],touchmove:[],mousedown:[],touchstart:[],mouseup:[],touchend:[],scroll:[],mouseleave:[],mouseover:[],touchcancel:[]},s=function(t,i){i.preventDefault();var r=n.move(i.clientX,i.clientY,0<i.buttons).get();return t(r),r},a=function(t,i){i.preventDefault();var r=n.move(i.touches[0].clientX,i.touches[0].clientY,!0).get();return t(r),r},c=function(t,i){i.preventDefault();var r=n.move(i.clientX,i.clientY,!0).get();return t(r),r},o=function(t,i){i.preventDefault();var r=n.move(i.touches[0].clientX,i.touches[0].clientY,!0).get();return t(r),r},d=function(t,i){i.preventDefault();var r=n.release().get();return t(r),r},l=function(n,r){var s={deltaX:r.deltaX,deltaY:r.deltaY,deltaZ:r.deltaZ,position:Ao(t,r.clientX,r.clientY)},e=i(s.position,2);return s.x=e[0],s.y=e[1],r.preventDefault(),n(s),s};return Object.defineProperty(t,"mouse",{get:function(){return n.get()},enumerable:!0}),Object.defineProperty(t,"mouseMoved",{set:function(e){var i=function(t){return s(e,t)};r.mousemove.push(i),r.touchmove.push(i),t.addEventListener("mousemove",i),t.addEventListener("touchmove",function(t){return a(e,t)})},enumerable:!0}),Object.defineProperty(t,"mousePressed",{set:function(e){var i=function(t){return c(e,t)},n=function(t){return o(e,t)};r.mousedown.push(i),r.touchstart.push(n),t.addEventListener("mousedown",i),t.addEventListener("touchstart",n)},enumerable:!0}),Object.defineProperty(t,"mouseReleased",{set:function(e){var i=function(t){return d(e,t)},n=function(t){return d(e,t)};r.mouseup.push(i),r.touchend.push(n),t.addEventListener("mouseup",i),t.addEventListener("touchend",n)},enumerable:!0}),Object.defineProperty(t,"scroll",{set:function(e){var i=function(t){return l(e,t)};r.mouseup.push(i),t.addEventListener("scroll",i)},enumerable:!0}),{clear:function(){Object.keys(r).forEach(function(e){return r[e].forEach(function(i){return t.removeEventListener(e,i)})}),Object.keys(r).forEach(function(e){r[e]=[]})},pointer:n}},Oo=1e3/60,jo=function(e){var t=[],i=Oo,n=function(){for(;0<t.length;)clearInterval(t.shift());o=void 0},r=function(){"function"!=typeof o||t.push(setInterval(function(){o({time:e.getCurrentTime(),frame:c+=1})},i))},s=function(e){n(),o=e,"function"==typeof o&&(c=0,r())},a=function(e){var t=parseFloat(e);return!isNaN(t)&&isFinite(t)?t:Oo},c,o;return Object.defineProperty(e,"animate",{set:function(e){return s(e)},enumerable:!0}),Object.defineProperty(e,"clear",{value:function(){return n()},enumerable:!0}),{clear:n,setLoop:s,setFPS:function(e){n(),i=a(1e3/e),r()}}},Co=function(e){var t=jo(e),i=Lo(e);Object.defineProperty(e,"stopAnimations",{value:t.clear,enumerated:!0}),Object.defineProperty(e,"freeze",{value:function(){i.clear(),t.clear()},enumerated:!0}),Object.defineProperty(e,"fps",{set:function(e){return t.setFPS(e)},enumerated:!0})},Mo=function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=[0,0],r=!1,s=function(){null!=o&&(null==o.parentNode&&t.appendChild(o),o.setAttribute("cx",n[0]),o.setAttribute("cy",n[1]))},a=new Proxy(n,{set:function(e,t,i){return e[t]=i,s(),!0}}),c=function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];if(0!==i.length){var c=e(i[0]);"number"===c&&(n[0]=i[0],n[1]=i[1],s()),"object"===c&&("number"==typeof i[0][0]?(n[0]=i[0][0],n[1]=i[0][1],s()):"number"==typeof i[0].x&&(n[0]=i[0].x,n[1]=i[0].y,s())),"function"==typeof n.delegate&&n.delegate.apply(n.pointsContainer,[a,n.pointsContainer])}},o;c(i.position);var d=function(e){return e},l=function(e){r&&c(d(e))};return n.delegate=void 0,n.setPosition=c,n.onMouseMove=l,n.onMouseUp=function(){r=!1},n.distance=function(e){return[0,1].map(function(t){return e[t]-n[t]}).map(function(t){return oe(t,2)}).reduce(function(e,t){return e+t},0)},Object.defineProperty(n,"x",{get:function(){return n[0]},set:function(e){n[0]=e}}),Object.defineProperty(n,"y",{get:function(){return n[1]},set:function(e){n[1]=e}}),Object.defineProperty(n,"svg",{get:function(){return o},set:function(e){o=e}}),Object.defineProperty(n,"positionDidUpdate",{set:function(e){d=e}}),Object.defineProperty(n,"selected",{set:function(e){r=e}}),Object.defineProperty(n,"remove",{value:function(){null!=o&&o.parentNode.removeChild(o)}}),a},To=function(t,i,n){var r=Array.from(Array(i)).map(function(){return Mo(t,n)}),s,a;r.forEach(function(t,r){"object"===e(n)&&"function"==typeof n.position&&t.setPosition(n.position(r))});var c=function(e){"function"==typeof a&&a.call(r,r,e)};r.forEach(function(e){e.delegate=c,e.pointsContainer=r});var o=function(e){0<r.length&&(s=r.map(function(t,n){return{i:n,d:t.distance(e)}}).sort(function(e,t){return e.d-t.d}).shift().i,r[s].selected=!0)};return t.mousePressed=o,t.mouseMoved=function(e){r.forEach(function(t){return t.onMouseMove(e)})},t.mouseReleased=function(){r.forEach(function(e){return e.onMouseUp()}),s=void 0},Object.defineProperty(r,"selectedIndex",{get:function(){return s}}),Object.defineProperty(r,"selected",{get:function(){return r[s]}}),Object.defineProperty(r,"add",{value:function(e){r.push(Mo(t,e))}}),r.removeAll=function(){for(;0<r.length;)r.pop().remove()},r.onChange=function(e,t){return"function"==typeof e&&(a=e,!0===t&&e.call(r,r,void 0)),r},r.position=function(e){return"function"==typeof e&&r.forEach(function(t,n){return t.setPosition(e.call(r,n))}),r},r.svg=function(e){return"function"==typeof e&&r.forEach(function(t,n){t.svg=e.call(r,n)}),r},r.parent=function(e){return null!=e&&null!=e.appendChild&&r.forEach(function(t){e.appendChild(t.svg)}),r},r},Io=function(e){return null!=e&&"function"==typeof e[Symbol.iterator]},zo=function e(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];switch(i.length){case void 0:case 0:return i;case 1:return Io(i[0])&&"string"!=typeof i[0]?e.apply(void 0,n(i[0])):[i[0]];default:return Array.from(i).map(function(t){return Io(t)?n(e(t)):t}).reduce(function(e,t){return e.concat(t)},[]);}},Fo=function(t){for(var i=arguments.length,n=Array(1<i?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];var s=zo.apply(void 0,n),a="";return"number"==typeof s[0]&&(a=Array.from(Array(Q(s.length/2))).reduce(function(e,t,n){return"".concat(e).concat(s[2*n],",").concat(s[2*n+1]," ")},"")),"object"===e(s[0])&&("number"==typeof s[0].x&&(a=s.reduce(function(e,t){return"".concat(e).concat(t.x,",").concat(t.y," ")},"")),"number"==typeof s[0][0]&&(a=s.reduce(function(e,t){return"".concat(e).concat(t[0],",").concat(t[1]," ")},""))),t.setAttributeNS(null,"points",a),t},Bo=function(t){for(var i=arguments.length,n=Array(1<i?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];var s=zo.apply(void 0,n),a=[];return"number"==typeof s[0]&&(a=s),"object"===e(s[0])&&("number"==typeof s[0].x&&(a=s.map(function(e){return[e[0],e[1]]}).reduce(function(e,t){return e.concat(t)},[])),"number"==typeof s[0][0]&&(a=s.reduce(function(e,t){return e.concat(t)},[]))),null!=a[0]&&t.setAttributeNS(null,"x1",a[0]),null!=a[1]&&t.setAttributeNS(null,"y1",a[1]),null!=a[2]&&t.setAttributeNS(null,"x2",a[2]),null!=a[3]&&t.setAttributeNS(null,"y2",a[3]),t},Vo=function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var r=zo.apply(void 0,i);return"number"==typeof r[0]&&(null!=r[0]&&e.setAttributeNS(null,"cx",r[0]),null!=r[1]&&e.setAttributeNS(null,"cy",r[1])),"number"==typeof r.x&&(null!=r.x&&e.setAttributeNS(null,"cx",r.x),null!=r.y&&e.setAttributeNS(null,"cy",r.y)),e},Do=function(e,t,i,n,r,s){var a=!!(6<arguments.length&&void 0!==arguments[6])&&arguments[6];if(null!=s){var c=[t+se(r)*n,i+re(r)*n],o=[se(r)*n,re(r)*n],l=[se(s)*n,re(s)*n],g=[l[0]-o[0],l[1]-o[1]],f=o[0]*l[1]-o[1]*l[0],p=o[0]*l[0]+o[1]*l[1],_=0<ae(f,p)?0:1,u=a?"M ".concat(t,",").concat(i," l ").concat(o[0],",").concat(o[1]," "):"M ".concat(c[0],",").concat(c[1]," ");return u+=["a ",n,n,0,_,1,g[0],g[1]].join(" "),a&&(u+=" Z"),e.setAttributeNS(null,"d",u),e}},Ro=function(e,t,i,n,r,s,a){var c=!!(7<arguments.length&&void 0!==arguments[7])&&arguments[7];if(null!=a){var o=[t+se(s)*n,i+re(s)*r],l=[se(s)*n,re(s)*r],g=[se(a)*n,re(a)*r],f=[g[0]-l[0],g[1]-l[1]],p=l[0]*g[1]-l[1]*g[0],_=l[0]*g[0]+l[1]*g[1],u=0<ae(p,_)?0:1,h=c?"M ".concat(t,",").concat(i," l ").concat(l[0],",").concat(l[1]," "):"M ".concat(o[0],",").concat(o[1]," ");return h+=["a ",n,r,0,u,1,f[0],f[1]].join(" "),c&&(h+=" Z"),e.setAttributeNS(null,"d",h),e}},qo=function(e,t,i,n,r,s,a,c,o){if(null!=o){var l=[[t,i],[n,r],[s,a],[c,o]].map(function(e){return e.join(",")}),g="M ".concat(l[0]," C ").concat(l[1]," ").concat(l[2]," ").concat(l[3]);return e.setAttributeNS(null,"d",g),e}},Xo=function(t){for(var i=Array.from(t.childNodes),n=i.filter(function(e){return"path"===e.tagName}).shift(),r=["svg-arrow-head","svg-arrow-tail"].map(function(e){return i.filter(function(t){return t.getAttribute("class")===e}).shift()}),s=arguments.length,a=Array(1<s?s-1:0),c=1;c<s;c++)a[c-1]=arguments[c];var d=zo.apply(void 0,a),l=[];if("number"==typeof d[0]&&(l=d),"object"===e(d[0])&&("number"==typeof d[0].x&&(l=d.map(function(e){return[e[0],e[1]]}).reduce(function(e,t){return e.concat(t)},[])),"number"==typeof d[0][0]&&(l=d.reduce(function(e,t){return e.concat(t)},[]))),l.length||null==t.endpoints||(l=t.endpoints),!l.length)return t;t.endpoints=l;var g=t.options,o=[l[0],l[1]],f=[l[2],l[3]],p=[f[0]-o[0],f[1]-o[1]],_=[o[0]+p[0]/2,o[1]+p[1]/2],u=ce(oe(p[0],2)+oe(p[1],2)),h=(g.tail.visible?2.5*((1+g.tail.padding)*g.tail.height):0)+(g.head.visible?2.5*((1+g.head.padding)*g.head.height):0);if(u<h){var m=0===u?[h,0]:[p[0]/u*h,p[1]/u*h];o=[_[0]-.5*m[0],_[1]-.5*m[1]],f=[_[0]+.5*m[0],_[1]+.5*m[1]],p=[f[0]-o[0],f[1]-o[1]]}var v=[p[1],-p[0]],y=[_[0]+v[0]*g.curve,_[1]+v[1]*g.curve],k=[y[0]-o[0],y[1]-o[1]],x=[y[0]-f[0],y[1]-f[1]],b=ce(oe(k[0],2)+oe(k[1],2)),E=ce(oe(x[0],2)+oe(x[1],2)),P=0===b?k:[k[0]/b,k[1]/b],S=0===b?x:[x[0]/E,x[1]/E],A=[-P[0],-P[1]],w=[-S[0],-S[1]],N=[A[1],-A[0]],L=[w[1],-w[0]],O=[o[0]+P[0]*g.tail.height*((g.tail.visible?1:0)+g.tail.padding),o[1]+P[1]*g.tail.height*((g.tail.visible?1:0)+g.tail.padding)],j=[f[0]+S[0]*g.head.height*((g.head.visible?1:0)+g.head.padding),f[1]+S[1]*g.head.height*((g.head.visible?1:0)+g.head.padding)];p=[j[0]-O[0],j[1]-O[1]],v=[p[1],-p[0]],_=[O[0]+p[0]/2,O[1]+p[1]/2],y=[_[0]+v[0]*g.curve,_[1]+v[1]*g.curve];var C=[O[0]+(y[0]-O[0])*g.pinch,O[1]+(y[1]-O[1])*g.pinch],M=[j[0]+(y[0]-j[0])*g.pinch,j[1]+(y[1]-j[1])*g.pinch],T=[[O[0]+N[0]*-g.tail.width,O[1]+N[1]*-g.tail.width],[O[0]+N[0]*g.tail.width,O[1]+N[1]*g.tail.width],[O[0]+A[0]*g.tail.height,O[1]+A[1]*g.tail.height]],I=[[j[0]+L[0]*-g.head.width,j[1]+L[1]*-g.head.width],[j[0]+L[0]*g.head.width,j[1]+L[1]*g.head.width],[j[0]+w[0]*g.head.height,j[1]+w[1]*g.head.height]];return n.setAttribute("d","M".concat(O[0],",").concat(O[1],"C").concat(C[0],",").concat(C[1],",").concat(M[0],",").concat(M[1],",").concat(j[0],",").concat(j[1])),g.head.visible?(r[0].removeAttribute("display"),Fo(r[0],I)):r[0].setAttribute("display","none"),g.tail.visible?(r[1].removeAttribute("display"),Fo(r[1],T)):r[1].setAttribute("display","none"),t},Uo=Object.freeze({__proto__:null,setPoints:Fo,setLinePoints:Bo,setCenter:Vo,setArc:Do,setEllipticalArc:Ro,setBezier:qo,setArrowPoints:Xo}),Yo=["accumulate","additive","alignment-baseline","amplitude","attributeName","azimuth","baseFrequency","baseline-shift","baseProfile","bbox","begin","bias","by","CSection","calcMode","cap-height","clip","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","contentScriptType","contentStyleType","cursor","DSection","decelerate","descent","diffuseConstant","direction","display","divisor","dominant-baseline","dur","ESection","edgeMode","elevation","enable-background","end","exponent","externalResourcesRequired","FSection","fill","fill-opacity","fill-rule","filter","filterRes","filterUnits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","format","from","fr","fx","fy","GSection","g1","g2","glyph-name","glyph-orientation-horizontal","glyph-orientation-vertical","glyphRef","gradientTransform","gradientUnits","HSection","hanging","href","hreflang","horiz-adv-x","horiz-origin-x","ISection","image-rendering","in","in2","intercept","k1","k2","k3","k4","kernelMatrix","keyPoints","keySplines","keyTimes","LSection","lang","letter-spacing","lighting-color","limitingConeAngle","local","MSection","marker-end","marker-mid","marker-start","markerHeight","markerUnits","markerWidth","mathematical","max","media","method","min","mode","NSection","name","numOctaves","OSection","opacity","operator","order","orient","overflow","overline-position","overline-thickness","PSection","paint-order","patternContentUnits","patternTransform","patternUnits","pointer-events","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","RSection","radius","refX","refY","rendering-intent","repeatCount","repeatDur","requiredFeatures","restart","result","SSection","seed","shape-rendering","spacing","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stop-color","stop-opacity","strikethrough-position","strikethrough-thickness","stroke","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","surfaceScale","TSection","tabindex","tableValues","target","targetX","targetY","text-anchor","text-decoration","text-rendering","to","transform-origin","type","USection","u1","u2","underline-position","underline-thickness","unicode","unicode-range","units-per-em","user-select","VSection","v-alphabetic","v-hanging","v-ideographic","v-mathematical","values","vector-effect","version","vert-adv-y","vert-origin-x","vert-origin-y","viewTarget","visibility","WSection","widths","word-spacing","writing-mode","XSection","xChannelSelector","YSection","yChannelSelector","ZSection"],Go=function(e){for(;e.lastChild;)e.removeChild(e.lastChild)},Zo=function(e,t){return null!=t&&t.appendChild(e),e},Ko=function(e){return e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z])([A-Z])(?=[a-z])/g,"$1-$2").toLowerCase()},Wo=function(e){var t=e.getAttribute("class");return null==t?[]:t.split(" ").filter(function(e){return""!==e})},Ho=Object.freeze({__proto__:null,removeChildren:Go,appendTo:Zo,setAttributes:function(e,t){return Object.keys(t).forEach(function(i){e.setAttribute(Ko(i),t[i])}),e},addClass:function(e,t){if(null==e)return e;var i=Wo(e).filter(function(e){return e!==t});return i.push(t),e.setAttributeNS(null,"class",i.join(" ")),e},removeClass:function(e,t){if(null==e)return e;var i=Wo(e).filter(function(e){return e!==t});return e.setAttributeNS(null,"class",i.join(" ")),e},setClass:function(e,t){return e.setAttributeNS(null,"class",t),e},setID:function(e,t){return e.setAttributeNS(null,"id",t),e}}),$o=function(t,i){"object"===e(i)?t.setAttribute("transform",i.join(" ")):"string"==typeof i&&t.setAttribute("transform",i)},Qo=function(e){var t=e.getAttribute("transform");return null==t?void 0:t.split(" ")},Jo=Object.freeze({__proto__:null,translate:function(e,t,i){var n=Qo(e)||[];return n.push("translate(".concat(t,", ").concat(i,")")),$o(e,n),e},rotate:function(e,t){var i=Qo(e)||[];return i.push("rotate(".concat(t,")")),$o(e,i),e},scale:function(e,t,i){var n=Qo(e)||[];return n.push("scale(".concat(t,", ").concat(i,")")),$o(e,n),e},clearTransforms:function(e){return e.setAttribute("transform",""),e}}),ed=function(e){var t=e.getAttribute("d");return null==t&&(t=""),t},d=function(e,t){for(var i=arguments.length,n=Array(2<i?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];var s=zo(n).join(",");return e.setAttribute("d","".concat(ed(e)).concat(t).concat(s)),e},td=Object.freeze({__proto__:null,command:function(e,t){for(var i=arguments.length,n=Array(2<i?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];return d.apply(void 0,[e,t].concat(n))},moveTo:function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return d.apply(void 0,[e,"M"].concat(i))},_moveTo:function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return d.apply(void 0,[e,"m"].concat(i))},lineTo:function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return d.apply(void 0,[e,"L"].concat(i))},_lineTo:function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return d.apply(void 0,[e,"l"].concat(i))},verticalLineTo:function(e,t){return d(e,"V",t)},_verticalLineTo:function(e,t){return d(e,"v",t)},horizontalLineTo:function(e,t){return d(e,"H",t)},_horizontalLineTo:function(e,t){return d(e,"h",t)},ellipseTo:function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return d.apply(void 0,[e,"A"].concat(i))},_ellipseTo:function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return d.apply(void 0,[e,"a"].concat(i))},curveTo:function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return d.apply(void 0,[e,"C"].concat(i))},_curveTo:function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return d.apply(void 0,[e,"c"].concat(i))},smoothCurveTo:function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return d.apply(void 0,[e,"S"].concat(i))},_smoothCurveTo:function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return d.apply(void 0,[e,"s"].concat(i))},quadCurveTo:function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return d.apply(void 0,[e,"Q"].concat(i))},_quadCurveTo:function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return d.apply(void 0,[e,"q"].concat(i))},smoothQuadCurveTo:function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return d.apply(void 0,[e,"T"].concat(i))},_smoothQuadCurveTo:function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return d.apply(void 0,[e,"t"].concat(i))},close:function(e){return d(e,"Z")},clear:function(e){return e.setAttribute("d",""),e}}),id=function(e){e.appendTo=function(t){return Zo(e,t)}},nd=function(e,t){Object.keys(t).filter(function(t){return void 0===e[t]}).forEach(function(i){e[i]=function(){var n=t[i].apply(t,arguments);return e.appendChild(n),n}})},rd=function(t){t.head=function(i){return"object"===e(i)?(Object.assign(t.options.head,i),void 0===i.visible&&(t.options.head.visible=!0)):"boolean"==typeof i?t.options.head.visible=i:null==i&&(t.options.head.visible=!0),Xo(t),t},t.tail=function(i){return"object"===e(i)?(Object.assign(t.options.tail,i),void 0===i.visible&&(t.options.tail.visible=!0),t.options.tail.visible=!0):"boolean"==typeof i?t.options.tail.visible=i:null==i&&(t.options.tail.visible=!0),Xo(t),t},t.curve=function(e){return t.options.curve=e,Xo(t),t},t.pinch=function(e){return t.options.pinch=e,Xo(t),t}},sd=function(e){Object.keys(td).filter(function(t){return void 0===e[t]}).forEach(function(t){e[t]=function(){for(var i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];return td[t].apply(td,[e].concat(n))}})},ad=function(e){Object.keys(Ho).filter(function(t){return void 0===e[t]}).forEach(function(t){e[t]=function(){for(var i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];return Ho[t].apply(Ho,[e].concat(n))}})},cd=function(e){Object.keys(Jo).filter(function(t){return void 0===e[t]}).forEach(function(t){e[t]=function(){for(var i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];return Jo[t].apply(Jo,[e].concat(n))}})},od=function(e){Object.keys(wo).filter(function(t){return void 0===e[t]}).forEach(function(t){e[t]=function(){for(var i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];return wo[t].apply(wo,[e].concat(n))}})},dd=function(e){return e.replace(/([-_][a-z])/ig,function(e){return e.toUpperCase().replace("-","").replace("_","")})},ld=function(e){Yo.filter(function(t){return void 0===e[dd(t)]}).forEach(function(t){e[dd(t)]=function(){for(var i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];return e.setAttribute.apply(e,[t].concat(n)),e}})},gd=function(e,t){void 0===e.clipPath&&(e.clipPath=function(){var i=t.clipPath.apply(t,arguments);return e.appendChild(i),i}),void 0===e.mask&&(e.mask=function(){var i=t.mask.apply(t,arguments);return e.appendChild(i),i})},fd=function(e){if(null!=e){if("string"==typeof e)return"url"===e.slice(0,3)?e:"url(#".concat(e,")");if(null!=e.getAttribute){var t=e.getAttribute("id");return"url(#".concat(t,")")}return"url(#)"}},pd=function(e){void 0===e.clipPath&&(e.clipPath=function(t){var i=fd(t);return void 0===i?e:(e.setAttribute("clip-path",i),e)}),void 0===e.mask&&(e.mask=function(t){var i=fd(t);return void 0===i?e:(e.setAttribute("mask",i),e)})},_d=function(e){ld(e),ad(e),cd(e),pd(e),"path"===e.tagName&&sd(e)},ud=function(e){ld(e),ad(e),cd(e),pd(e),rd(e)},hd=function(e){ld(e),ad(e),cd(e),pd(e)},md=function(e,t){ad(e),cd(e),od(e),ld(e),gd(e,t),nd(e,t)},vd=function(e,t){ld(e),ad(e),cd(e),pd(e),nd(e,t)},yd=function(e,t){ld(e),ad(e),cd(e),pd(e),nd(e,t)},kd=function(e){id(e)},xd=function(e,t,i){"svg"===e?md(t,i):"primitive"===e?_d(t):"arrow"===e?ud(t):"defs"===e||"group"===e?vd(t,i):"text"===e?hd(t):"clipPath"===e||"mask"===e?yd(t,i):"style"===e?kd(t):console.warn("prepare missing valid type (svg, group..")},bd=function(e,t,i,n){var r=po.document.createElementNS(_o,"rect");return null!=e&&r.setAttributeNS(null,"x",e),null!=t&&r.setAttributeNS(null,"y",t),null!=i&&r.setAttributeNS(null,"width",i),null!=n&&r.setAttributeNS(null,"height",n),xd("primitive",r),r},Ed=function(){for(var e=po.document.createElementNS(_o,"polygon"),t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return Fo.apply(void 0,[e].concat(i)),xd("primitive",e),e.setPoints=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return Fo.apply(void 0,[e].concat(i))},e},Pd=function(){for(var e=po.document.createElementNS(_o,"polyline"),t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return Fo.apply(void 0,[e].concat(i)),xd("primitive",e),e.setPoints=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return Fo.apply(void 0,[e].concat(i))},e},Sd=function(e){var t=po.document.createElementNS(_o,"path");return null!=e&&t.setAttributeNS(null,"d",e),xd("primitive",t),t},Ad=Object.freeze({__proto__:null,line:function(){for(var e=po.document.createElementNS(_o,"line"),t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return Bo.apply(void 0,[e].concat(i)),xd("primitive",e),e.setPoints=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return Bo.apply(void 0,[e].concat(i))},e},circle:function(e,t,i){var n=po.document.createElementNS(_o,"circle");return Vo(n,e,t),null!=i&&n.setAttributeNS(null,"r",i),xd("primitive",n),n.setCenter=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return Vo.apply(void 0,[n].concat(t))},n.setRadius=function(e){return n.setAttributeNS(null,"r",e),n},n.radius=function(e){return n.setAttributeNS(null,"r",e),n},n},ellipse:function(e,t,i,n){var r=po.document.createElementNS(_o,"ellipse");return null!=e&&r.setAttributeNS(null,"cx",e),null!=t&&r.setAttributeNS(null,"cy",t),null!=i&&r.setAttributeNS(null,"rx",i),null!=n&&r.setAttributeNS(null,"ry",n),xd("primitive",r),r},rect:bd,polygon:Ed,polyline:Pd,path:Sd,bezier:function(e,t,i,n,r,s,a,c){var o=po.document.createElementNS(_o,"path");return qo(o,e,t,i,n,r,s,a,c),xd("primitive",o),o.setBezier=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return qo.apply(void 0,[o].concat(t))},o},text:function(e,t,i){var n=po.document.createElementNS(_o,"text");return n.innerHTML=e,t&&n.setAttributeNS(null,"x",t),i&&n.setAttributeNS(null,"y",i),xd("text",n),n},arc:function(e,t,i,n,r){var s=po.document.createElementNS(_o,"path");return Do(s,e,t,i,n,r,!1),xd("primitive",s),s.setArc=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return Do.apply(void 0,[s].concat(t))},s},wedge:function(e,t,i,n,r){var s=po.document.createElementNS(_o,"path");return Do(s,e,t,i,n,r,!0),xd("primitive",s),s.setArc=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return Do.apply(void 0,[s].concat(t))},s},arcEllipse:function(e,t,i,n,r,s){var a=po.document.createElementNS(_o,"path");return Ro(a,e,t,i,n,r,s,!1),xd("primitive",a),a.setArc=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return Ro.apply(void 0,[a].concat(t))},a},wedgeEllipse:function(e,t,i,n,r,s){var a=po.document.createElementNS(_o,"path");return Ro(a,e,t,i,n,r,s,!0),xd("primitive",a),a.setArc=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return Ro.apply(void 0,[a].concat(t))},a},parabola:function(e,t,n,r){var s=Array.from(Array(129)).map(function(e,t){return 2*((t-128)/128)+1}),a=s.map(function(t){return e+.5*((t+1)*n)}),c=s.map(function(e){return t+oe(e,2)*r}),o=s.map(function(e,t){return[a[t],c[t]]});return Pd(o)},regularPolygon:function(e,t,i,n){var s=.5*(2*ie/n),c=se(s)*i,r=Array.from(Array(n)).map(function(r,o){var i=-2*ie*o/n+s,a=e+c*re(i),d=t+c*se(i);return[a,d]});return Ed(r)},roundRect:function(e,t,i,n){var r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0;r>i/2&&(r=i/2),r>n/2&&(r=n/2);var s=i-2*r,a=n-2*r,c="M".concat(e+(i-s)/2," ").concat(t," h").concat(s," A").concat(r," ").concat(r," 0 0 1 ").concat(e+i," ").concat(t+(n-a)/2," v").concat(a," A").concat(r," ").concat(r," 0 0 1 ").concat(e+i-r," ").concat(t+n," h").concat(-s," A").concat(r," ").concat(r," 0 0 1 ").concat(e," ").concat(t+n-r," v").concat(-a," A").concat(r," ").concat(r," 0 0 1 ").concat(e+r," ").concat(t," ");return Sd(c)},arrow:function(){var e=po.document.createElementNS(_o,"g"),t=po.document.createElementNS(_o,"polygon"),i=po.document.createElementNS(_o,"polygon"),n=po.document.createElementNS(_o,"path");t.setAttributeNS(null,"class","svg-arrow-tail"),i.setAttributeNS(null,"class","svg-arrow-head"),n.setAttributeNS(null,"class","svg-arrow-path"),t.setAttributeNS(null,"style","stroke: none; pointer-events: none;"),i.setAttributeNS(null,"style","stroke: none; pointer-events: none;"),n.setAttributeNS(null,"style","fill: none;"),e.appendChild(n),e.appendChild(t),e.appendChild(i),e.options={head:{width:.5,height:2,visible:!1,padding:0},tail:{width:.5,height:2,visible:!1,padding:0},curve:0,pinch:.618,endpoints:[]};for(var r=arguments.length,s=Array(r),a=0;a<r;a++)s[a]=arguments[a];return Xo.apply(void 0,[e].concat(s)),xd("arrow",e),e.setPoints=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return Xo.apply(void 0,[e].concat(i))},e}}),wd={},Nd={},Ld="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Od=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return Array.from(Array(e)).map(function(){return Q(Math.random()*Ld.length)}).map(function(e){return Ld[e]}).reduce(function(e,t){return"".concat(e).concat(t)},"")},jd=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:16,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";return t+Od(e)},Cd=function(){var e=po.document.createElementNS(_o,"svg");return e.setAttribute("version","1.1"),e.setAttribute("xmlns",_o),xd("svg",e,wd),e},Md=function(e){var t=new po.DOMParser().parseFromString("<root></root>","text/xml").createCDATASection("".concat(e));return t},Td=function(e){var t=po.document.createElementNS(_o,"style");return t.setAttribute("type","text/css"),xd("style",t),t.setTextContent=function(e){t.textContent="",t.appendChild(Md(e))},t.appendChild(Md(e)),t},Id=function(e){Object.keys(e).filter(function(e){return"svg"!==e}).forEach(function(t){wd[t]=e[t]}),Object.keys(e).filter(function(e){return"svg"!==e}).filter(function(e){return"defs"!==e}).filter(function(e){return"style"!==e}).filter(function(e){return"clipPath"!==e}).filter(function(e){return"mask"!==e}).forEach(function(t){Nd[t]=e[t]})},zd=Object.freeze({__proto__:null,setConstructors:Id,svg:Cd,group:function(){var e=po.document.createElementNS(_o,"g");return xd("group",e,Nd),e},defs:function(){var e=po.document.createElementNS(_o,"defs");return xd("defs",e,Nd),e},clipPath:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:jd(8,"clip-"),t=po.document.createElementNS(_o,"clipPath");return t.setAttribute("id",e),xd("clipPath",t,Nd),t},mask:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:jd(8,"mask-"),t=po.document.createElementNS(_o,"mask");return t.setAttribute("id",e),xd("mask",t,Nd),t},style:Td,createElement:function(e){return po.document.createElementNS(_o,e)}}),Fd=new po.DOMParser().parseFromString("<div />","text/xml").documentElement.constructor,Bd=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=i.filter(function(t){return"object"===e(t)}).filter(function(e){return"boolean"==typeof e.window});return r.reduce(function(e,t){return e.window||t.window},!1)},Vd=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=t.filter(function(e){return e instanceof Fd}).shift(),r=t.filter(function(e){return"string"==typeof e||e instanceof String}).map(function(e){return po.document.getElementById(e)}).shift();return null==n?null==r?po.document.body:r:n},Dd=function(e,t){var i=t.filter(function(e){return!isNaN(e)}),n=e.getAttribute("viewBox");if(4<=i.length)e.setAttributeNS(null,"width",i[2]),e.setAttributeNS(null,"height",i[3]),Po(e,i[0],i[1],i[2],i[3]);else if(2<=i.length)e.setAttributeNS(null,"width",i[0]),e.setAttributeNS(null,"height",i[1]),Po(e,0,0,i[0],i[1]);else if(null==n){var r=e.getBoundingClientRect();Po(e,0,0,r.width,r.height)}else if(4===n.split(" ").filter(function(e){return"0"===e||0===e}).length){var s=e.getBoundingClientRect();Po(e,0,0,s.width,s.height)}},Rd=function(e){var t=Eo(e);return null==t?void 0:t[2]},qd=function(e){var t=Eo(e);return null==t?void 0:t[3]},Xd=function(e,t){var i=Eo(e);return i[2]=t,Po.apply(void 0,[e].concat(n(i)))},Ud=function(e,t){var i=Eo(e);return i[3]=t,Po.apply(void 0,[e].concat(n(i)))},Yd=function(t){for(var i=arguments.length,n=Array(1<i?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];2===n.length&&"number"==typeof n[0]&&"number"==typeof n[1]?Po.apply(void 0,[t,0,0].concat(n)):4===n.length&&e(n.map(function(e){return"number"==typeof e}).reduce(function(e,t){return e&&t},!0))&&Po.apply(void 0,[t].concat(n))},Gd=function(e){var t=Eo(e);if(void 0!==t)return t;if("function"==typeof e.getBoundingClientRect){var i=e.getBoundingClientRect();return[i.x,i.y,i.width,i.height]}return[0,0,0,0]},Zd=function(e,t){var i=!!(2<arguments.length&&void 0!==arguments[2])&&arguments[2];if(!0===i){var r=e.parentElement;null!=r&&r.setAttribute("style","background-color: ".concat(t))}var s=Array.from(e.childNodes).filter(function(e){return"svg-background-rectangle"===e.getAttribute("class")}).shift();null==s?(s=bd.apply(void 0,n(Gd(e))).fill(t).setClass("svg-background-rectangle"),e.insertBefore(s,e.firstChild)):s.setAttribute("fill",t)},Kd=function(e){var t=Array.from(e.childNodes),i=t.filter(function(e){return"style"===e.getAttribute("tagName")}).shift();if(i)return i;var n=t.filter(function(e){return"defs"===e.getAttribute("tagName")}).shift();if(null==n)return n;var r=Array.from(n.childNodes).filter(function(e){return"style"===e.getAttribute("tagName")}).shift();return null==r?void 0:r},Wd=function(e,t){var i=Kd(e);return null==i?(i=Td(t),e.insertBefore(i,e.firstChild)):i.setTextContent(t),i},Hd=function(e,t){Array.from(e.attributes).forEach(function(t){return e.removeAttribute(t.name)}),Go(e),Array.from(t.childNodes).forEach(function(i){t.removeChild(i),e.appendChild(i)}),Array.from(t.attributes).forEach(function(t){return e.setAttribute(t.name,t.value)})},$d=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=Cd();Co(n),n.controls=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return To.apply(void 0,[n].concat(t))},n.getWidth=function(){return Rd(n)},n.getHeight=function(){return qd(n)},n.setWidth=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return Xd.apply(void 0,[n].concat(t))},n.setHeight=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return Ud.apply(void 0,[n].concat(t))},n.background=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return Zd.apply(void 0,[n].concat(t))},n.size=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return Yd.apply(void 0,[n].concat(t))},n.save=function(e){return vo(n,e)},n.load=function(e,t){yo(e,function(e,i){null!=e&&Hd(n,e),null!=t&&t(n,i)})},n.stylesheet=function(e){return Wd(n,e)};var r=function(){var e=Vd.apply(void 0,t);null!=e&&e.appendChild(n),Dd(n,t),Bd.apply(void 0,t)&&bo(n),t.filter(function(e){return"function"==typeof e}).forEach(function(e){return e.call(n,n)})};return"loading"===po.document.readyState?po.document.addEventListener("DOMContentLoaded",r):r(),n},Qd={};Object.assign(Qd,zd,Ad),delete Qd.setConstructors,Id(Qd);var Jd={};Object.keys(Ad).forEach(function(e){Jd[e]=Ad[e]}),Object.keys(zd).filter(function(e){return"setConstructors"!==e}).forEach(function(e){Jd[e]=zd[e]}),delete Jd.svg,Object.keys(Jd).forEach(function(e){$d[e]=Jd[e]}),Object.keys(Uo).forEach(function(e){$d[e]=Uo[e]}),Object.keys(wo).forEach(function(e){$d[e]=wo[e]}),Object.keys(ko).forEach(function(e){$d[e]=ko[e]}),$d.NS=_o;var el=function(e,t){var i=e.parameters.points;e.valid=yi.core.point_in_convex_poly(i[0],t)&&yi.core.point_in_convex_poly(i[1],t),e.valid_solutions=[e.valid]},tl=[null,el,el,function(e,t){var i=yi.core.intersection,n=e.parameters.lines,r=i.convex_poly_line(t,n[0][0],n[0][1]),s=i.convex_poly_line(t,n[1][0],n[1][1]);e.valid=void 0!==r&&void 0!==s,e.valid_solutions=e.solutions.map(function(e){return void 0!==e&&void 0!==i.convex_poly_line(t,e[0],e[1])})},function(e,t){var i=e.parameters,n=yi.core.intersection.line_line(i.lines[0][0],i.lines[0][1],i.points[0],[i.lines[0][1][1],-i.lines[0][1][0]]);void 0===n&&(e.valid=!1,e.valid_solutions=[!1]),e.valid=yi.core.point_in_convex_poly(n,t)&&yi.core.point_in_convex_poly(i.points[0],t),e.valid_solutions=[e.valid]},function(e,t){if(0===e.solutions.length)return e.valid=!1,void(e.valid_solutions=[!1,!1]);var i=e.parameters;e.test={},e.test.points_reflected=e.solutions.map(function(e){return yi.core.make_matrix2_reflection(e[1],e[0])}).map(function(e){return yi.core.multiply_matrix2_vector2(e,i.points[1])}),e.valid=yi.core.point_in_convex_poly(i.points[0],t)&&yi.core.point_in_convex_poly(i.points[1],t),e.valid_solutions=e.test.points_reflected.map(function(e){return yi.core.point_in_convex_poly(e,t)})},function(e,t){var i=yi.core.intersection,n=e.solutions.map(function(e){return i.convex_poly_line(t,e[0],e[1])}).filter(function(e){return void 0!==e});if(0===n.length)return e.valid=!1,void(e.valid_solutions=[!1,!1,!1]);var r=e.parameters.lines,s=i.convex_poly_line(t,r[0][0],r[0][1]),a=i.convex_poly_line(t,r[1][0],r[1][1]),c=e.parameters;for(e.test={},e.test.points_reflected=e.solutions.map(function(e){return yi.core.make_matrix2_reflection(e[1],e[0])}).map(function(e){return c.points.map(function(t){return yi.core.multiply_matrix2_vector2(e,t)})}).reduce(function(e,t){return e.concat(t)},[]),e.valid=void 0!==s&&void 0!==a&&yi.core.point_in_convex_poly(c.points[0],t)&&yi.core.point_in_convex_poly(c.points[1],t),e.valid_solutions=e.solutions.map(function(t,n){return[e.test.points_reflected[2*n],e.test.points_reflected[2*n+1]]}).map(function(e){return yi.core.point_in_convex_poly(e[0],t)&&yi.core.point_in_convex_poly(e[1],t)});3>e.valid_solutions.length;)e.valid_solutions.push(!1)},function(e,t){0===e.solutions.length&&(e.valid=!1,e.valid_solutions=[!1]);var i=e.solutions[0],n=e.parameters,r=yi.core.make_matrix2_reflection(i[1],i[0]),s=yi.core.multiply_matrix2_vector2(r,n.points[0]),a=yi.core.intersection.line_line(n.lines[1][0],n.lines[1][1],i[0],i[1]);e.test={points_reflected:[s]},e.valid=yi.core.point_in_convex_poly(n.points[0],t)&&yi.core.point_in_convex_poly(s,t)&&yi.core.point_in_convex_poly(a,t),e.valid_solutions=[e.valid]}],il=function(e,t){return tl[e.axiom].call(null,e,t),e},nl=function(e,t,i){var n={axiom:e,parameters:i,solutions:t};return Object.defineProperty(n,"apply",{value:function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return il.apply(void 0,[n].concat(t))}}),n},rl=function(t){for(var i=arguments.length,n=Array(1<i?i-1:0),r=1,s;r<i;r++)n[r-1]=arguments[r];var a=(s=yi.core).semi_flatten_input.apply(s,n);switch(t){case 1:case 2:{if(1===a.length&&"object"===e(a[0])&&null!==a[0]){if(null==a[0].points)throw new Error("axiom .points property needed");return a[0].points.map(function(e){return yi.core.get_vector(e)})}if(2===a.length)return a.map(function(e){return yi.core.get_vector(e)});if(4===a.length&&"number"==typeof a[0])return[[a[0],a[1]],[a[2],a[3]]]}break;case 3:if(1===a.length&&"object"===e(a[0])&&null!==a[0]){if(null!=a[0].lines&&0<a[0].lines.length){var c=a[0].lines.map(function(e){return yi.core.get_line(e)});return[c[0].origin,c[0].vector,c[1].origin,c[1].vector]}if(null!=a[0].points&&null!=a[0].vectors){var o=a[0].points.map(function(e){return yi.core.get_vector(e)}),d=a[0].vectors.map(function(e){return yi.core.get_vector(e)});return[o[0],d[0],o[1],d[1]]}}break;case 4:if(1===a.length&&"object"===e(a[0])&&null!==a[0]&&null!=a[0].lines&&0<a[0].lines.length&&null!=a[0].points&&0<a[0].points.length){var l=a[0].lines.map(function(e){return yi.core.get_line(e)}),g=a[0].points.map(function(e){return yi.core.get_vector(e)});return[l[0].origin,l[0].vector,g[0]]}break;case 5:if(1===a.length&&"object"===e(a[0])&&null!==a[0]&&null!=a[0].lines&&0<a[0].lines.length&&null!=a[0].points&&0<a[0].points.length){var f=a[0].lines.map(function(e){return yi.core.get_line(e)}),p=a[0].points.map(function(e){return yi.core.get_vector(e)});return[f[0].origin,f[0].vector,p[0],p[1]]}break;case 6:if(1===a.length&&"object"===e(a[0])&&null!==a[0]&&null!=a[0].lines&&0<a[0].lines.length&&null!=a[0].points&&0<a[0].points.length){var _=a[0].lines.map(function(e){return yi.core.get_line(e)}),u=a[0].points.map(function(e){return yi.core.get_vector(e)});return[_[0].origin,_[0].vector,_[1].origin,_[1].vector,u[0],u[1]]}break;case 7:if(1===a.length&&"object"===e(a[0])&&null!==a[0]&&null!=a[0].lines&&0<a[0].lines.length&&null!=a[0].points&&0<a[0].points.length){var h=a[0].lines.map(function(e){return yi.core.get_line(e)}),m=a[0].points.map(function(e){return yi.core.get_vector(e)});return[h[0].origin,h[0].vector,h[1].origin,h[1].vector,m[0]]}}return n},sl=function(e,t){var i=ee(e.length,t.length),n=Array.from(Array(i)).map(function(n,r){return t[r]-e[r]}),r=yi.core.normalize(n),s=yi.line(e,r),a={points:[yi.vector(e),yi.vector(t)]};return nl(1,[s],a)},al=function(e,t){var i=[(e[0]+t[0])/2,(e[1]+t[1])/2],n=Array.from([,,]).map(function(n,r){return t[r]-e[r]}),r=yi.core.normalize(n),s=yi.line(i,[r[1],-r[0]]),a={points:[yi.vector(e),yi.vector(t)]};return nl(2,[s],a)},cl=function(e,t,i,n){var r={lines:[yi.line(e,t),yi.line(i,n)]},s=yi.core.bisect_lines2(e,t,i,n).map(function(e){return yi.line(e[0],e[1])});return nl(3,s,r)},ol=function(e,t,i){var r=yi.core.normalize(t),s=yi.line(n(i),[r[1],-r[0]]),a={points:[yi.vector(i)],lines:[yi.line(e,t)]};return nl(4,[s],a)},dl=function(e,t,i,n){var r=ce(oe(i[0]-n[0],2)+oe(i[1]-n[1],2)),s=[e[0]+t[0],e[1]+t[1]],a=yi.core.intersection.circle_line(i,r,e,s)||[],c=a.map(function(e){var t=yi.core.midpoint2(n,e),i=yi.core.normalize(e.map(function(t,r){return e[r]-n[r]}));return yi.line(t,[-i[1],i[0]])}),o={points:[yi.vector(i),yi.vector(n)],lines:[yi.line(e,t)]};return nl(5,c,o)},ll=function(e,t,i,n,r){var s={points:[yi.vector(r)],lines:[yi.line(e,t),yi.line(i,n)]},a=yi.core.intersection.line_line(i,n,r,t);if(void 0===a)return nl(7,s,[]);var c=yi.core.midpoint2(r,a),o=yi.core.normalize(r.map(function(e,t){return a[t]-r[t]})),d=yi.line(c,[-o[1],o[0]]);return nl(7,[d],s)},gl=function(e){var t=oe(ne(e),1/3);return 0>e?-t:t},fl=function(e,n,r,s){if(1e-8>ne(e)){if(e=n,n=r,r=s,1e-8>ne(e))return e=n,n=r,1e-8>ne(e)?[]:[-n/e];var o=n*n-4*e*r;return 1e-8>ne(o)?[-n/(2*e)]:0<o?[(-n+ce(o))/(2*e),(-n-ce(o))/(2*e)]:[]}var d=(3*e*r-n*n)/(3*e*e),l=(2*n*n*n-9*e*n*r+27*e*e*s)/(27*e*e*e),g;if(1e-8>ne(d))g=[gl(-l)];else if(1e-8>ne(l))g=[0].concat(0>d?[ce(-d),-ce(-d)]:[]);else{var f=l*l/4+d*d*d/27;if(1e-8>ne(f))g=[-1.5*l/d,3*l/d];else if(0<f){var p=gl(-l/2-ce(f));g=[p-d/(3*p)]}else{var _=2*ce(-d/3),u=J(3*l/d/_)/3,t=2*ie/3;g=[_*se(u),_*se(u-t),_*se(u-2*t)]}}for(var h=0;h<g.length;h+=1)g[h]-=n/(3*e);return g},pl=function(e,t,n,r,s,a){var c=s[0],o=s[1];if(ne(t[0])>yi.core.EPSILON)var d=t[1]/t[0],l=e[1]-d*e[0];else var g=e[0];var f=a[0],p=a[1];if(ne(r[0])>yi.core.EPSILON)var _=r[1]/r[0],u=n[1]-_*n[0];else var h=n[0];if(void 0!==d&&void 0!==_)var m=d*d+1,v=2*d*l,y=l*l-c*c-o*o,k=_*_+1,x=2*_*u,b=u*u-f*f-p*p,E=_*c+(l-o),P=c*(u-p)-f*(l-o),S=_-d,A=d*f+(u-p),w=d*c+(l-o);else if(void 0===d&&void 0===_)m=1,v=0,y=g*g-c*c-o*o,k=1,x=0,b=h*h-f*f-p*p,E=g-c,P=o*(h-f)-p*(g-c),S=0,A=h-f,w=E;else{if(void 0===d){var N=c;c=f,f=N;var L=o;o=p,p=L,d=_,_=void 0,l=u,u=void 0,h=g,g=void 0}m=d*d+1,v=2*d*l,y=l*l-c*c-o*o,k=1,x=0,b=h*h-f*f-p*p,E=c,P=(l-o)*(h-f)-c*p,S=1,A=-d*(h-f)-p,w=d*c+(l-o)}var O=m*E*E+v*E*S+y*S*S,j=2*m*E*P+v*(E*A+P*S)+2*y*S*A,C=m*P*P+v*P*A+y*A*A,M=k*S*w,T=(k*A+x*S)*w-O,I=(x*A+b*S)*w-j,F=b*A*w-C,B=fl(M,T,I,F),V=[];if(null!=B&&0<B.length)for(var D=0;D<B.length;++D){if(void 0!==d&&void 0!==_)var R=B[D],q=_*R+u;else void 0===d&&void 0===_?(q=B[D],R=h):(q=B[D],R=h);if(q!=p){var X=-1*(R-f)/(q-p),U=(q*q-p*p+R*R-f*f)/(2*(q-p));V.push(yi.line([0,U],[1,X]))}else{var Y=(R+f)/2;V.push(yi.line([Y,0],[0,1]))}}var G={points:[yi.vector(s),yi.vector(a)],lines:[yi.line(e,t),yi.line(n,r)]};return nl(6,V,G)},_l=function(e){return 0<=e?oe(e,1/3):-oe(-e,1/3)},ul=function(e,t,i,n,r,s,o){var l=yi.core.get_vector(e),g=yi.core.get_vector(i),f=yi.core.get_vector(r),p=yi.core.get_vector(s),_=yi.core.get_vector(t),u=yi.core.get_vector(n),h=f,m=yi.line(l,_),v=[-_[1],_[0]],y=m.nearestPoint(0,0).magnitude,k=p,x=yi.line(g,u),E=[-u[1],u[0]],P=x.nearestPoint(0,0).magnitude;0>yi.core.dot(v,m.nearestPoint(0,0))&&(v=[_[1],-_[0]]),0>yi.core.dot(E,x.nearestPoint(0,0))&&(E=[u[1],-u[0]]);var S=[v[1],-v[0]];if(!(ne(h[0]-k[0])<yi.core.EPSILON&&ne(h[1]-k[1])<yi.core.EPSILON)){var A=0;switch(o){case 0:var w=[h[0]+y*v[0]-2*k[0],h[1]+y*v[1]-2*k[1]],N=[y*v[0]-h[0],y*v[1]-h[1]],L=yi.core.dot(k,E)-P,O=2*yi.core.dot(N,S),j=yi.core.dot(N,N),C=yi.core.dot(w.map(function(e,t){return w[t]+N[t]}),S),M=yi.core.dot(w,N),I=yi.core.dot(S,E),z=yi.core.dot(N,E),F=I,a=L+C*I+z,b=L*O+M*I+C*z,c=L*j+M*z;switch(Ql=ne(F)>yi.core.EPSILON?3:ne(a)>yi.core.EPSILON?2:ne(b)>yi.core.EPSILON?1:0,Ql){case 0:return;case 1:A=-c/b;break;case 2:var d=oe(b,2)-4*a*c;if(eg=-b/(2*a),0>d)return void(Jl=-1);ne(d)<yi.core.EPSILON?(Jl=0,A=eg):(Jl=1,tg=ce(d)/(2*a),A=eg+tg);break;case 3:var B=a/F,V=b/F,q=(3*V-oe(B,2))/9,X=(9*B*V-27*(c/F)-2*oe(B,3))/54,R=oe(q,3)+oe(X,2);if(sg=-B/3,0<R){Jl=0;var D=ce(R);ig=_l(X+D);var U=_l(X-D);A=sg+ig+U}else if(ne(R)<yi.core.EPSILON)Jl=1,ig=oe(X,1/3),A=sg+2*ig;else{Jl=2;var T=ce(-R),Y=ae(T,X)/3,G=oe(oe(X,2)-R,1/6);ng=G*se(Y),rg=G*re(Y),A=sg+2*ng}}break;case 1:if(1>Jl)return;2===Ql?A=eg-tg:3===Ql?A=1===Jl?sg-ig:sg-ng-ce(3)*rg:void 0;break;case 2:if(2>Jl)return;3===Ql?A=sg-ng+ce(3)*rg:void 0;}var Z=[y*v[0]+A*S[0],y*v[1]+A*S[1]],K=yi.core.normalize([Z[0]-h[0],Z[1]-h[1]]),W=yi.core.dot(K,yi.core.midpoint2(Z,h)),H=[W*K[0],W*K[1]],$=[-K[1],K[0]];return[H,$]}},hl=function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];var s=rl.apply(void 0,[e].concat(i));return 1===e?sl.apply(void 0,n(s)):2===e?al.apply(void 0,n(s)):3===e?cl.apply(void 0,n(s)):4===e?ol.apply(void 0,n(s)):5===e?dl.apply(void 0,n(s)):6===e?pl.apply(void 0,n(s)):7===e?ll.apply(void 0,n(s)):void 0},ml=/*#__PURE__*/Object.freeze({__proto__:null,axiom1:sl,axiom2:al,axiom3:cl,axiom4:ol,axiom5:dl,axiom7:ll,axiom6:pl,axiom6RefFinder:function(e,t,i,n,r,s){Ql=0,Jl=0,eg=0,tg=0,ig=0,ng=0,rg=0,sg=0;var a=[ul(e,t,i,n,r,s,0),ul(e,t,i,n,r,s,1),ul(e,t,i,n,r,s,2)];return a.filter(function(e){return null!=e})},axiom6RefFinderFunc:ul,axiom:hl}),vl=function(e){!1=="faces_re:matrix"in e&&(e["faces_re:matrix"]=Ta(e,0))},yl=function(e,t){vl(e);var i=0,r=ba(e),s=e.isFolded,a=t.getViewBox();t.mouseReleased=function(){},t.mousePressed=function(n){a=t.getViewBox(),s=e.isFolded,r=ba(e);var c={faces_vertices:e.faces_vertices,"faces_re:layer":e["faces_re:layer"],vertices_coords:s?e["vertices_re:foldedCoords"]||e.vertices_coords:e["vertices_re:unfoldedCoords"]||e.vertices_coords},o=Ka(c,n),d=Wa(c,o);i=null==d?0:d,s&&(r.vertices_coords=e["vertices_re:unfoldedCoords"].slice())},t.mouseMoved=function(c){if(c.isPressed){e.load(r);var o=al([c.position[0],c.position[1]],[c.pressed[0],c.pressed[1]]);e.fold(o.solutions[0],i),s&&(e["vertices_re:unfoldedCoords"]=e.vertices_coords,e.vertices_coords=e["vertices_re:foldedCoords"],delete e["vertices_re:foldedCoords"],e.draw(),t.setViewBox.apply(t,n(a)))}}},kl=["input","output","padding","file_frame","stylesheet","shadows","boundaries","faces","edges","vertices","attributes"],xl=function(t){if("object"!==e(t)||null===t)return 0;var i=Object.keys(t);return 0===i.length?0:i.map(function(e){return kl.includes(e)}).reduce(function(e,t){return e+(t?1:0)},0)/i.length},bl=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.filter(function(e){return .1<xl(e)}).sort(function(e,t){return xl(t)-xl(e)}).shift()},El={gl:"webgl",GL:"webgl",webGL:"webgl",WebGL:"webgl",webgl:"webgl",Webgl:"webgl",svg:"svg",SVG:"svg","2d":"svg","2D":"svg","3d":"webgl","3D":"webgl"},Pl=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=i.filter(function(t){return"object"===e(t)}).filter(function(e){return!0=="view"in e}).shift();if(void 0===r){if(le)return;if(de)return"svg"}return El[r.view]},Sl=function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];var s=i.filter(function(e){return"function"!=typeof e}),a=$d.apply(void 0,n(s)),c=bl.apply(void 0,i),o=null==c?{output:"svg"}:Object.assign(c,{output:"svg"}),d=["boundaries","edges","faces","vertices"],l=function(e){var t=Array.from(a.childNodes).filter(function(t){return e===t.getAttribute("class")}).shift();return void 0===t?[]:Array.from(t.childNodes)},g=function(t){var i=null==t?o:Object.assign(t,{output:"svg"}),n=Br(e,JSON.parse(JSON.stringify(i))),r=Array.from(n.childNodes),s=d.map(function(e){return r.filter(function(t){return e===t.getAttribute("class")}).shift()}).filter(function(e){return void 0!==e}),c=Array.from(a.childNodes),l=d.map(function(e){return c.filter(function(t){return e===t.getAttribute("class")}).shift()}).filter(function(e){return void 0!==e});0<l.length?s.forEach(function(e){return a.insertBefore(e,l[0])}):s.forEach(function(e){return a.appendChild(e)}),l.forEach(function(e){return a.removeChild(e)}),s.forEach(function(e){return e.setAttribute("pointer-events","none")}),Array.from(n.attributes).forEach(function(e){return a.setAttribute(e.name,e.value)})};(function(){var t=ec(e);a.setViewBox.apply(a,n(t))})(),g(),e.changed.handlers.push(function(){return g()}),Object.defineProperty(e,"draw",{value:g}),Object.defineProperty(e,"svg",{get:function(){return a}}),Object.defineProperty(a,"vertices",{get:function(){return l("vertices")}}),Object.defineProperty(a,"edges",{get:function(){return l("edges")}}),Object.defineProperty(a,"faces",{get:function(){return l("faces")}}),Object.defineProperty(a,"boundaries",{get:function(){return l("boundaries")}}),!0===o.touchFold&&yl(e,e.svg);var f=function(){i.filter(function(e){return"function"==typeof e}).forEach(function(t){return t.call(e,e)})};"loading"===Xi.document.readyState?Xi.document.addEventListener("DOMContentLoaded",f):f()},Al=function(e){for(var t=arguments.length,i=Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];switch(Pl.apply(void 0,i)){case"svg":Sl.apply(void 0,[e].concat(i));}},wl=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.filter(function(e){return"string"==typeof e}).filter(function(e){return 1===e.length}).shift()},Nl=function(e){var t=this;Object.defineProperty(e,"clipLine",{value:function(){var i,n;return[yi.core.intersection.convex_poly_line(e.vertices.map(function(e){return t.vertices_coords[e]}),(i=yi.core).get_line.apply(i,arguments).origin,(n=yi.core).get_line.apply(n,arguments).vector)]}}),Object.defineProperty(e,"clipRay",{value:function(){var i,n;return[yi.core.intersection.convex_poly_ray(e.vertices.map(function(e){return t.vertices_coords[e]}),(i=yi.core).get_line.apply(i,arguments).origin,(n=yi.core).get_line.apply(n,arguments).vector)]}}),Object.defineProperty(e,"clipSegment",{value:function(){var i,r;return[(i=yi.core.intersection).convex_poly_segment.apply(i,[e.vertices.map(function(e){return t.vertices_coords[e]})].concat(n((r=yi.core).get_vector_of_vectors.apply(r,arguments))))]}})},Ll=function(e){var t=this;Object.defineProperty(e,"coords",{get:function(){return e.vertices&&t.vertices_coords?e.vertices.map(function(e){return t.vertices_coords[e]}):void 0}})},Ol=function(e,t){Ll.call(this,e,t),Nl.call(this,e,t)},jl=function(){var e=[tc(this)];return e.forEach(Ol.bind(this)),e},Cl="faces_re:matrix",Ml="faces_re:layer",Tl=function(e){e[Ml]&&delete e[Ml],e[Cl]&&delete e[Cl]},Il=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return t.filter(function(e){return"string"==typeof e}).filter(function(e){return 1===e.length}).shift()},zl=new Date().getTime(),Fl=function e(){var t=new Date().getTime();100>t-zl&&(zl=t,ag=setTimeout(e,200),clearTimeout(ag))},Bl=function(e,t){for(var i=this,n=arguments.length,r=Array(2<n?n-2:0),s=2;s<n;s++)r[s-2]=arguments[s];var a=e.apply(void 0,r),o=Il.apply(void 0,r)||"F",d=tc(this).vertices.map(function(e){return i.vertices_coords[e]}),l=t(d,a);return void 0!==l&&(this.vertices_coords.push(l[0],l[1]),this.edges_vertices.push([this.vertices_coords.length-2,this.vertices_coords.length-1]),this.edges_assignment.push(o),!Fl())&&(oc(this),Sc(this),Tl(this),!0)},Vl=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return Bl.call.apply(Bl,[this,yi.core.get_segment,function(e,t){return yi.core.intersection.convex_poly_segment(e,t[0],t[1])}].concat(t))},Dl=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return Bl.call.apply(Bl,[this,yi.core.get_line,function(e,t){return yi.core.intersection.convex_poly_ray(e,t.origin,t.vector)}].concat(t))},Rl=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return Bl.call.apply(Bl,[this,yi.core.get_line,function(e,t){return yi.core.intersection.convex_poly_line(e,t.origin,t.vector)}].concat(t))},ql="vertices_re:foldedCoords",Xl="vertices_re:unfoldedCoords",Ul="faces_re:matrix",Yl=function(e,t){null==e.frame_classes&&(e.frame_classes=[]);var i=lo(e);if(t!==i)if(e.frame_classes=e.frame_classes.filter(function(e){return![Li,Ni].includes(e)}).concat([t?Ni:Li]),t)ql in e||(null==e.faces_vertices&&Sc(e),e[Ul]=Ta(e,0),e[ql]=za(e,null,e[Ul])),e[Xl]=e.vertices_coords,e.vertices_coords=e[ql],delete e[ql];else{if(null==e[Xl])return;e[ql]=e.vertices_coords,e.vertices_coords=e[Xl],delete e[Xl]}},Gl=function(e,t){if(!le){var i=Xi.document.createElement("canvas");i.setAttribute("width","2048"),i.setAttribute("height","2048");var n=i.getContext("2d"),r=Xi.URL||Xi.webkitURL;e.setAttribute("width","2048"),e.setAttribute("height","2048");var s=new Xi.XMLSerializer().serializeToString(e),a=new Xi.Blob([s],{type:"image/svg+xml;charset=utf-8"}),c=new Xi.Image,o=r.createObjectURL(a);c.onload=function(){n.drawImage(c,0,0),i.toBlob(function(e){"function"==typeof t&&t(e),r.revokeObjectURL(o)},"image/png")},c.src=o}},Zl=function(e){var t=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];if(0===i.length)return JSON.stringify(e);switch(i[0]){case"oripa":return pa(e,"fold").oripa();case"svg":return pa(e,"fold").svg();case"png":return function(){var t=void 0,n={then:function(e){le&&e("png rendering requires running in the browser. unsupported in node js"),t=e}};return Gl.apply(void 0,[pa(e,"fold").svg({output:"svg"}),function(e){void 0===e||(n.data=e,"function"==typeof t&&t(e))}].concat(i)),n}();default:return JSON.stringify(e);}};return t.json=function(){return JSON.stringify(e)},t.fold=function(){return JSON.stringify(e)},t.svg=function(){return pa(e,"fold").svg()},t.oripa=function(){return pa(e,"fold").oripa()},t.png=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];return function(){var t=void 0,n={then:function(e){le&&e("png rendering requires running in the browser. unsupported in node js"),t=e}};return Gl.apply(void 0,[pa(e,"fold").svg({output:"svg"}),function(e){void 0===e||(n.data=e,"function"==typeof t&&t(e))}].concat(i)),n}()},t},Kl=["faces_re:matrix","faces_re:layer"],Wl=Object.freeze({touchFold:!1}),Hl=function(){var t=Object.keys(Wl),i={};return Array.apply(void 0,arguments).filter(function(t){return"object"===e(t)}).forEach(function(e){return Object.keys(e).filter(function(e){return t.includes(e)}).forEach(function(t){i[t]=e[t]})}),i},$l=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var r=Object.assign(Object.create(Dc()),i.filter(function(e){return 0<Di(e)}).sort(function(e,t){return Di(t)-Di(e)}).shift()||ya()),s=function(){for(var t=arguments.length,i=Array(t),n=0;n<t;n++)i[n]=arguments[n];var s=i.filter(function(t){return"object"===e(t)}),a=yi.core.get_line(i),c=wl.apply(void 0,i)||"V",o=i.filter(function(e){return null!==e&&!isNaN(e)}).shift();if(!yi.core.is_vector(a.origin)||!yi.core.is_vector(a.vector))return void console.warn("fold was not supplied the correct parameters");var d=eo(r,a.origin,a.vector,o,c);Object.keys(d).forEach(function(e){r[e]=d[e]}),!0=="re:construction"in r&&(0<s.length&&!0=="axiom"in s[0]&&(r["re:construction"].axiom=s[0].axiom,r["re:construction"].parameters=s[0].parameters),r["re:diagrams"]=[ao(r)])},a={};Object.assign(a,Wl);var c=Hl.apply(void 0,i);return Object.keys(c).forEach(function(e){a[e]=c[e]}),Object.defineProperty(r,"boundaries",{get:function(){return jl.call(r)}}),Object.defineProperty(r,"load",{value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=pa(e).fold();!0!==t.append&&(Ei.forEach(function(e){return delete r[e]}),Kl.forEach(function(e){return delete r[e]})),Object.assign(r,{file_spec:ki,file_creator:xi},ba(i)),r.changed.update(r.load)}}),Object.defineProperty(r,"isFolded",{get:function(){return lo(r)}}),Object.defineProperty(r,"fold",{value:function(){return 0<arguments.length?(s.apply(void 0,arguments),r.changed.update(r.fold),r):(Yl(r,!0),r.changed.update(r.fold),r)}}),Object.defineProperty(r,"unfold",{value:function(){return Yl(r,!1),r.changed.update(r.unfold),r}}),Object.defineProperty(r,"export",{get:function(){return Zl(r)}}),Object.defineProperty(r,"line",{value:function e(){for(var t=arguments.length,i=Array(t),n=0,s;n<t;n++)i[n]=arguments[n];(s=Rl).call.apply(s,[r].concat(i))&&r.changed.update(e)}}),Object.defineProperty(r,"ray",{value:function e(){for(var t=arguments.length,i=Array(t),n=0,s;n<t;n++)i[n]=arguments[n];(s=Dl).call.apply(s,[r].concat(i))&&r.changed.update(e)}}),Object.defineProperty(r,"segment",{value:function e(){for(var t=arguments.length,i=Array(t),n=0,s;n<t;n++)i[n]=arguments[n];(s=Vl).call.apply(s,[r].concat(i))&&r.changed.update(e)}}),Al.apply(void 0,[r].concat(i)),r},Ql,Jl,eg,tg,ig,ng,rg,sg,ag;$l.empty=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return $l.apply(void 0,[va()].concat(t))},$l.square=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return $l.apply(void 0,[ya()].concat(t))},$l.rectangle=function(e,t){for(var i=arguments.length,n=Array(2<i?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];return $l.apply(void 0,[ka(e,t)].concat(n))},$l.regularPolygon=function(){for(var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:3,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length,n=Array(2<i?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];return $l.apply(void 0,[xa(e,t)].concat(n))};var cg=function(e,t){if(!1=="file_frames"in e||e.file_frames.length<t)return e;var i=["frame_parent","frame_inherit"],n={visited_frames:[]};return function e(t,i,r){if(-1!==n.visited_frames.indexOf(i))throw new Error("encountered a cycle in file_frames. can't flatten.");return n.visited_frames.push(i),r=[i].concat(r),0===i?r:t.file_frames[i-1].frame_inherit&&null!=t.file_frames[i-1].frame_parent?e(t,t.file_frames[i-1].frame_parent,r):r}(e,t,[]).map(function(t){if(0===t){var n=e.file_frames;e.file_frames=null;var r=ba(e);return e.file_frames=n,delete r.file_frames,i.forEach(function(e){return delete r[e]}),r}var s=ba(e.file_frames[t-1]);return i.forEach(function(e){return delete s[e]}),s}).reduce(function(e,t){return Object.assign(e,t)},{})},og=/*#__PURE__*/Object.freeze({__proto__:null,flatten_frame:cg,merge_frame:function(e,t){var i=ba(t);["frame_parent","frame_inherit"].forEach(function(e){return delete i[e]});var n=e.file_frames;e.file_frames=null;var r=ba(e);return e.file_frames=n,delete r.file_frames,Object.assign(r,t),r}}),dg=/*#__PURE__*/Object.freeze({__proto__:null,copy_without_marks:function(e){var t=e.edges_vertices.filter(function(t,n){return"F"!==e.edges_assignment[n]&&"f"!==e.edges_assignment[n]}),i=e.edges_assignment.filter(function(e){return"F"!==e&&"f"!==e}),n=ba(e);Object.keys(n).filter(function(e){return"vertices_"===e.substring(0,9)}).forEach(function(e){return delete n[e]}),Object.keys(n).filter(function(e){return"edges_"===e.substring(0,6)}).forEach(function(e){return delete n[e]}),Object.keys(n).filter(function(e){return"faces_"===e.substring(0,6)}).forEach(function(e){return delete n[e]});var r=Object.assign(n,{vertices_coords:e.vertices_coords,edges_vertices:t,edges_assignment:i});return Ur.edges_vertices_to_vertices_vertices_sorted(r),Ur.vertices_vertices_to_faces_vertices(r),Ur.faces_vertices_to_faces_edges(r),r.edges_faces=wa(r),r.vertices_faces=ja(r),r}}),lg=/*#__PURE__*/Object.freeze({__proto__:null,select_vertices:function(e,t){var i=yi.convexPolygon(t),n=e.vertices_coords.map(function(e){return i.contains(e)});return e.vertices_coords.map(function(e,t){return t}).filter(function(e){return n[e]})},select_edges:function(e,t){var i=e.edges_vertices.map(function(t){return t.map(function(t){return e.vertices_coords[t]})}),n=yi.convexPolygon(t),r=i.map(function(e){return n.overlaps(e)});return i.map(function(e,t){return t}).filter(function(e){return r[e]})}}),gg=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return[0,1].map(function(e){return t.filter(function(t,n){return n%2===e}).reduce(function(e,t){return e+t},0)})},fg=function(){return gg.apply(void 0,arguments).map(function(e){return 0>e?e+2*ie:e}).map(function(e){return ie-e}).map(function(e){return yi.core.clean_number(e,14)})},pg=function(e,t){return e.vertices_vertices[t].map(function(i){return[e.vertices_coords[i][0]-e.vertices_coords[t][0],e.vertices_coords[i][1]-e.vertices_coords[t][1]]})},_g=function(e,t){return pg(e,t).map(function(e,t,i){return yi.core.counter_clockwise_angle2(i[t],i[(t+1)%i.length])})},ug=function(e,t){return fg.apply(void 0,n(_g(e,t)))},hg=function(e){var t=Fa(e),i=Array.from(Array(e.vertices_coords.length)).map(function(n,r){return t[r]?[0,0]:ug(e,r)});return i},mg=function(e){var t=Array.from(Array(e.vertices_coords.length)),i=hg(e),n=e.vertices_vertices,r=t.map(function(t,n){return pg(e,n)}),s=t.map(function(){return[]});return i.forEach(function(e,t){0===e[0]||n[t].forEach(function(i,n){s[t][i]=[-r[t][n][1]*e[n%2],r[t][n][0]*e[n%2]]})}),s},vg=function(e){return e.map(function(e,t,i){return yi.core.counter_clockwise_angle2_radians(e,i[(t+1)%i.length])}).map(function(e,t,i){return i.slice(t+1,i.length).concat(i.slice(0,t))}).map(function(e){return fg.apply(void 0,n(e))}).map(function(t,n){return e[n]+t[0]}).map(function(t,n){return yi.core.is_counter_clockwise_between(t,e[n],e[(n+1)%e.length])?t:void 0})},yg=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];var r=t.map(function(e){return ae(e[1],e[0])});return vg.apply(void 0,n(r)).map(function(e){return void 0===e?void 0:[yi.core.clean_number(se(e),14),yi.core.clean_number(re(e),14)]})},kg=/*#__PURE__*/Object.freeze({__proto__:null,alternating_sum:gg,kawasaki_flatness:fg,vertex_adjacent_vectors:pg,vertex_sectorAngles:_g,vertex_kawasaki_flatness:ug,make_vertices_sectorAngles:function(e){return Array.from(Array(e.vertices_coords.length)).map(function(t,n){return _g(e,n)})},make_vertices_kawasaki_flatness:function(e){return Array.from(Array(e.vertices_coords.length)).map(function(t,n){return ug(e,n)})},make_vertices_kawasaki:hg,make_vertices_nudge_matrix:mg,kawasaki_test:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:yi.core.EPSILON;if(null==e.vertices_coords)return!1;if(null==e.vertices_vertices);return hg(e).map(function(e){return e.map(function(e){return ne(e)<t}).reduce(function(e,t){return e&&t},!0)}).reduce(function(e,t){return e&&t},!0)},make_vertices_nudge:function(e){var t=mg(e),n=t.map(function(e){return e.reduce(function(e,t){var i=0===t.length?0:yi.core.magnitude(t);return e>i?e:i},0)}),r=t.map(function(e,t){return e.map(function(e){return yi.core.magnitude(e)/n[t]})}),s=r.map(function(e){return e.map(function(e){return 1/e})}),a=t.map(function(e,t){return e.map(function(e,i){return e.map(function(e){return e*s[t][i]})})}),c=a.map(function(e){return e.reduce(function(e,t){return[e[0]+t[0],e[1]+t[1]]},[0,0])});return c},kawasaki_solutions_radians:vg,kawasaki_solutions:yg,kawasaki_collapse:function(e,t,i){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"F",r=yg(e,t),s=e.vertices_coords[t];Uc(e,i,s,r[i],n)}}),xg=function(e,t){for(var i=arguments.length,n=Array(2<i?i-2:0),r=2;r<i;r++)n[r-2]=arguments[r];var s=Object.keys(e).map(function(e){return"edges_"===e.substring(0,6)?e:void 0}).filter(function(e){return void 0!==e}),a=Array.from(Array(n.length)).map(function(){return{}});return n.forEach(function(n,r){return s.filter(function(i){return void 0!==e[i][t]}).forEach(function(i){a[r][i]=e[i][t]})}),n.forEach(function(e,t){return Object.keys(e).forEach(function(e){a[t][e]=n[t][e]})}),a},bg=function(e,t,r){var s=[];t.forEach(function(e){s[e]={}});var a=[1,0].map(function(e){return t[e]});t.forEach(function(t,r){s[t].vertices_vertices=void 0===e.vertices_vertices[t]?[a[r]]:n(e.vertices_vertices[t])});var c=t.map(function(e,t){return s[e].vertices_vertices.indexOf(a[t])});return t.forEach(function(e,t){s[e].vertices_vertices[c[t]]=r}),s},Eg=function(e,t,n){for(var r=e.length,s=e.map(function(e,n,i){return e===t[0]&&i[(n+1)%r]===t[1]||e===t[1]&&i[(n+1)%r]===t[0]?(n+1)%r:void 0}).filter(function(e){return void 0!==e}),a=[],c=0,o=0;o<r+s.length;o+=1)s.includes(o)?(c-=1,a[o]=n):a[o]=e[o+c];return a},Pg=function(t){for(var i=arguments.length,n=Array(1<i?i-1:0),r=1;r<i;r++)n[r-1]=arguments[r];var s=n.map(function(i){return t.edges_vertices[i]});return s[0][0]===s[1][0]||s[0][0]===s[1][1]?s[0][0]:s[0][1]},Sg=function(e,t,i,n,r,s,a){var c=t.length,o=t.indexOf(i),d=[t[(o+c-1)%c],i,t[(o+1)%c]],l=[0,1].map(function(t){return Pg(e,d[t],d[t+1])}),g=a[0]===l[0]||a[1]===l[0]?[r,s]:[s,r],f=t.slice();return o===c-1?(f.splice(o,1,g[0]),f.unshift(g[1])):f.splice.apply(f,[o,1].concat(g)),f},Ag=Object.create(null);Object.assign(Ag,og,Ea,_c,hc,Ii,jc,qi,Pc,Va,dg,lg,Ha,kg,ml),Ag.build_diagram_frame=ao,Ag.add_edge=function(t,i,e,n,r){var s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:"U",a=yi.segment(i,e,n,r),c=[0,1].map(function(e){return t.vertices_coords.map(function(t){return ce(oe(a[e][0]-t[0],2)+oe(a[e][1]-t[1],2))}).map(function(e,t){return e<yi.core.EPSILON?t:void 0}).filter(function(e){return void 0!==e}).shift()}),o=t.edges_vertices.map(function(e){return e.map(function(e){return t.vertices_coords[e]})}),d=[0,1].map(function(t){return o.map(function(i){return yi.core.point_on_segment(i[0],i[1],a[t])}).map(function(e,t){return e?t:void 0}).filter(function(t){return void 0!==t}).shift()}),l=[0,1].map(function(e){return void 0===c[e]?void 0===d[e]?"new":"edge":"vertex"}),g={new:{vertices:[],edges:[{edges_vertices:[]}]},remove:{edges:[]}},f=Ra(t),p=function(e){g["new"].vertices.push({vertices_coords:[a[e][0],a[e][1]]}),f+=1,g["new"].edges[0].edges_vertices[e]=f-1};return[0,1].forEach(function(n){switch(l[n]){case"vertex":g["new"].edges[0].edges_vertices[n]=c[n];break;case"edge":{p(n);var i=oo(t,"edges",d[n]);[ba(i),ba(i)].forEach(function(e,i){e.edges_vertices=[t.edges_vertices[d[n]][i],f-1],g["new"].edges.push(e)}),g.remove.edges.push(d[n])}break;default:p(n);}}),g["new"].edges.filter(function(t){return void 0===t.edges_assignment}).forEach(function(t){t.edges_assignment=s}),g.apply=function(){return co(t,g)},g},Ag.split_edge_run=function(e,t,i,r){var s=e.vertices_coords.length,a=e.edges_vertices.length;if(!(a<r)){var c={remove:{edges:[r]},update:bg(e,e.edges_vertices[r],s),new:{vertices:[{vertices_coords:[t,i],vertices_vertices:n(e.edges_vertices[r]),vertices_faces:e.edges_faces?e.edges_faces[r]:void 0}],edges:xg.apply(void 0,[e,r].concat(n(e.edges_vertices[r].map(function(e){return{edges_vertices:[e,s]}})))),faces:[]}};return e.edges_faces&&e.edges_faces[r].forEach(function(t){void 0===c.update[t]&&(c.update[t]={}),c.update[t].faces_vertices=Eg(e.faces_vertices[t],e.edges_vertices[r],s),c.update[t].faces_edges=Sg(e,e.faces_edges[t],r,s,a,a+1,c["new"].edges[0].edges_vertices,c["new"].edges[1].edges_vertices)}),c}},Ag.apply_run=co,Ag.merge_run=function(e,t,r){var s=Ra(e),a=qa(e),c=Xa(e),o=0,d=0,l=0;void 0!==t["new"]&&(void 0!==t["new"].vertices&&(o=t["new"].vertices.length),void 0!==t["new"].edges&&(d=t["new"].edges.length),void 0!==t["new"].faces&&(l=t["new"].faces.length));var g={vertices:{length:s,change:o},edges:{length:a,change:d},faces:{length:c,change:l}},f=[];void 0!==r["new"]&&Object.keys(r["new"]).forEach(function(e){r["new"][e].forEach(function(t,s){["vertices","edges","faces"].forEach(function(i){var n="_".concat(i),a=Object.keys(t).map(function(e){return e.substring(e.length-n.length,e.length)===n?e:void 0}).filter(function(e){return void 0!==e});a.forEach(function(t){r["new"][e][s][t].forEach(function(i,n){r["new"][e][s][t][n]>=g[e].length&&(r["new"][e][s][t][n]+=g[e].change)})})})}),f=f.concat(r["new"].vertices)});var p={};void 0!==t["new"]&&(p["new"]=t["new"]),void 0!==t.update&&(p.update=t.update),void 0!==t.remove&&(p.remove=t.remove),void 0!==r["new"]&&(void 0!==r["new"].vertices&&(void 0===p["new"].vertices&&(p["new"].vertices=[]),p["new"].vertices=p["new"].vertices.concat(r["new"].vertices)),void 0!==r["new"].edges&&(void 0===p["new"].edges&&(p["new"].edges=[]),p["new"].edges=p["new"].edges.concat(r["new"].edges)),void 0!==r["new"].faces&&(void 0===p["new"].faces&&(p["new"].faces=[]),p["new"].faces=p["new"].faces.concat(r["new"].faces))),void 0!==r.update&&Object.keys(r.update).forEach(function(e){if(null==p.update[e])p.update[e]=r.update[e];else{var t=Object.keys(p.update[e]),i=Object.keys(r.update[e]),n=t.filter(function(e){return i.includes(e)});if(0<n.length){var s=n.join(", ");return void console.warn("cannot merge. two diffs contain overlap at ".concat(s))}Object.assign(p.update[e],r.update[e])}}),void 0!==r.remove&&(void 0!==r.remove.vertices&&(void 0===p.remove.vertices&&(p.remove.vertices=[]),p.remove.vertices=p.remove.vertices.concat(r.remove.vertices)),void 0!==r.remove.edges&&(void 0===p.remove.edges&&(p.remove.edges=[]),p.remove.edges=p.remove.edges.concat(r.remove.edges)),void 0!==r.remove.faces&&(void 0===p.remove.faces&&(p.remove.faces=[]),p.remove.faces=p.remove.faces.concat(r.remove.faces))),Object.assign(t,r)},Ag.apply_axiom=nl,Ag.fragment=oc,Ag.clean=xc,Ag.join=Ac,Ag.remove=Ja,Ag.rebuild=wc,Ag.populate=Sc,Ag.validate=Vi;var wg={empty:JSON.parse("{\n  \"file_spec\": 1.1,\n  \"file_creator\": \"\",\n  \"file_author\": \"\",\n  \"file_title\": \"\",\n  \"file_description\": \"\",\n  \"file_classes\": [],\n  \"file_frames\": [],\n\n  \"frame_author\": \"\",\n  \"frame_title\": \"\",\n  \"frame_description\": \"\",\n  \"frame_attributes\": [],\n  \"frame_classes\": [],\n  \"frame_unit\": \"\",\n\n  \"vertices_coords\": [],\n  \"vertices_vertices\": [],\n  \"vertices_faces\": [],\n\n  \"edges_vertices\": [],\n  \"edges_faces\": [],\n  \"edges_assignment\": [],\n  \"edges_foldAngle\": [],\n  \"edges_length\": [],\n\n  \"faces_vertices\": [],\n  \"faces_edges\": [],\n\n  \"edgeOrders\": [],\n  \"faceOrders\": []\n}\n"),square:JSON.parse("{\n  \"file_spec\": 1.1,\n  \"file_creator\": \"Rabbit Ear\",\n  \"file_classes\": [\"singleModel\"],\n  \"frame_attributes\": [\"2D\"],\n  \"frame_classes\": [\"creasePattern\"],\n  \"vertices_coords\": [[0,0], [1,0], [1,1], [0,1]],\n  \"vertices_vertices\": [[1,3], [2,0], [3,1], [0,2]],\n  \"vertices_faces\": [[0], [0], [0], [0]],\n  \"edges_vertices\": [[0,1], [1,2], [2,3], [3,0]],\n  \"edges_faces\": [[0], [0], [0], [0]],\n  \"edges_assignment\": [\"B\",\"B\",\"B\",\"B\"],\n  \"edges_foldAngle\": [0, 0, 0, 0],\n  \"edges_length\": [1, 1, 1, 1],\n  \"faces_vertices\": [[0,1,2,3]],\n  \"faces_edges\": [[0,1,2,3]]\n}"),book:JSON.parse("{\n  \"file_spec\": 1.1,\n  \"file_creator\": \"Rabbit Ear\",\n  \"file_classes\": [\"singleModel\"],\n  \"frame_attributes\": [\"2D\"],\n  \"frame_classes\": [\"creasePattern\"],\n  \"vertices_coords\": [[0,0], [0.5,0], [1,0], [1,1], [0.5,1], [0,1]],\n  \"vertices_vertices\": [[1,5], [2,4,0], [3,1], [4,2], [5,1,3], [0,4]],\n  \"vertices_faces\": [[0], [0,1], [1], [1], [1,0], [0]],\n  \"edges_vertices\": [[0,1], [1,2], [2,3], [3,4], [4,5], [5,0], [1,4]],\n  \"edges_faces\": [[0], [1], [1], [1], [0], [0], [0,1]],\n  \"edges_assignment\": [\"B\",\"B\",\"B\",\"B\",\"B\",\"B\",\"V\"],\n  \"edges_foldAngle\": [0, 0, 0, 0, 0, 0, 180],\n  \"edges_length\": [0.5, 0.5, 1, 0.5, 0.5, 1, 1],\n  \"faces_vertices\": [[1,4,5,0], [4,1,2,3]],\n  \"faces_edges\": [[6,4,5,0], [6,1,2,3]]\n}"),blintz:JSON.parse("{\n  \"file_spec\": 1.1,\n  \"file_creator\": \"Rabbit Ear\",\n  \"file_classes\": [\"singleModel\"],\n  \"frame_attributes\": [\"2D\"],\n  \"frame_classes\": [\"creasePattern\"],\n  \"vertices_coords\": [[0,0], [0.5,0], [1,0], [1,0.5], [1,1], [0.5,1], [0,1], [0,0.5]],\n  \"vertices_vertices\": [[1,7], [2,3,7,0], [3,1], [4,5,1,2], [5,3], [6,7,3,4], [7,5], [0,1,5,6]],\n  \"vertices_faces\": [[0], [1,4,0], [1], [2,4,1], [2], [3,4,2], [3], [0,4,3]],\n  \"edges_vertices\": [[0,1], [1,2], [2,3], [3,4], [4,5], [5,6], [6,7], [7,0], [1,3], [3,5], [5,7], [7,1]],\n  \"edges_faces\": [[0], [1], [1], [2], [2], [3], [3], [0], [1,4], [2,4], [3,4], [0,4]],\n  \"edges_assignment\": [\"B\",\"B\",\"B\",\"B\",\"B\",\"B\",\"B\",\"B\",\"V\",\"V\",\"V\",\"V\"],\n  \"edges_foldAngle\": [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n  \"edges_length\": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.7071067811865476, 0.7071067811865476, 0.7071067811865476, 0.7071067811865476],\n  \"faces_vertices\": [[0,1,7], [2,3,1], [4,5,3], [6,7,5], [1,3,5,7]],\n  \"faces_edges\": [[0,11,7], [2,8,1], [4,9,3], [6,10,5], [8,9,10,11]],\n  \"file_frames\": [{\n    \"frame_classes\": [\"foldedForm\"],\n    \"frame_parent\": 0,\n    \"frame_inherit\": true,\n    \"vertices_coords\": [[0.5,0.5], [0.5,0.0], [0.5,0.5], [1.0,0.5], [0.5,0.5], [0.5,1.0], [0.5,0.5], [0.0,0.5]],\n    \"edges_foldAngle\": [0, 0, 0, 0, 0, 0, 0, 0, 180, 180, 180, 180],\n    \"faceOrders\": [[0,4,1], [1,4,1], [2,4,1], [3,4,1]]\n  }]\n}"),kite:JSON.parse("{\n  \"file_spec\": 1.1,\n  \"file_creator\": \"Rabbit Ear\",\n  \"file_classes\": [\"singleModel\"],\n  \"frame_attributes\": [\"2D\"],\n  \"frame_classes\": [\"creasePattern\"],\n  \"vertices_coords\": [\n    [0,0],\n    [0.414213562373095,0],\n    [1,0],\n    [1,0.585786437626905],\n    [1,1],\n    [0,1]\n  ],\n  \"vertices_vertices\": [ [1,5], [2,5,0], [3,5,1], [4,5,2], [5,3], [0,1,2,3,4] ],\n  \"vertices_faces\": [ [0], [1,0], [2,1], [3,2], [3], [0,1,2,3] ],\n  \"edges_vertices\": [\n    [0,1],\n    [1,2],\n    [2,3],\n    [3,4],\n    [4,5],\n    [5,0],\n    [5,1],\n    [3,5],\n    [5,2]\n  ],\n  \"edges_faces\": [[0], [1], [2], [3], [3], [0], [0,1], [3,2], [1,2]],\n  \"edges_assignment\": [\"B\", \"B\", \"B\", \"B\", \"B\", \"B\", \"V\", \"V\", \"F\"],\n  \"edges_foldAngle\": [0, 0, 0, 0, 0, 0, 180, 180, 0],\n  \"edges_length\": [0.414213562373095, 0.585786437626905, 0.585786437626905, 0.414213562373095, 1, 1, 1.082392200292394, 1.082392200292394, 1.414213562373095],\n  \"faces_vertices\": [\n    [0,1,5],\n    [1,2,5],\n    [2,3,5],\n    [3,4,5]\n  ],\n  \"faces_edges\": [\n    [0,6,5],\n    [1,8,6],\n    [2,7,8],\n    [3,4,7]\n  ],\n  \"file_frames\": [{\n    \"frame_classes\": [\"foldedForm\"],\n    \"frame_parent\": 0,\n    \"frame_inherit\": true,\n    \"vertices_coords\": [\n      [0.707106781186548,0.292893218813452],\n      [1,0],\n      [0.707106781186548,0.292893218813452],\n      [0,1],\n      [0.414213562373095,0],\n      [1,0.585786437626905]\n    ],\n    \"edges_foldAngle\": [0, 0, 0, 0, 0, 0, 180, 180, 0],\n    \"faceOrders\": [[0,1,1], [3,2,1]]\n  }]\n}"),fish:JSON.parse("{\n  \"file_spec\": 1.1,\n  \"file_creator\": \"Rabbit Ear\",\n  \"file_classes\": [\"singleModel\"],\n  \"frame_attributes\": [\"2D\"],\n  \"frame_classes\": [\"creasePattern\"],\n  \"vertices_coords\": [\n    [0,0],\n    [1,0],\n    [1,1],\n    [0,1],\n    [0.292893218813452,0.292893218813452],\n    [0.707106781186548,0.707106781186548],\n    [0.292893218813452,0],\n    [1,0.707106781186548]\n  ],\n  \"edges_vertices\": [\n  \t[2,3], [3,0], [3,1], [0,4], [1,4], [3,4], [1,5], [2,5], [3,5], [4,6], [0,6], [6,1], [5,7], [1,7], [7,2]\n  ],\n  \"edges_assignment\": [\n  \t\"B\", \"B\", \"F\", \"M\", \"M\", \"M\", \"M\", \"M\", \"M\", \"V\", \"B\", \"B\", \"V\", \"B\", \"B\"\n  ],\n  \"file_frames\": [{\n    \"frame_classes\": [\"foldedForm\"],\n    \"frame_parent\": 0,\n    \"frame_inherit\": true,\n    \"vertices_coords\":[[0.707106781186548,0.292893218813452],[1,0],[0.707106781186548,0.292893218813452],[0,1],[0.292893218813452,0.292893218813452],[0.707106781186548,0.707106781186548],[0.5,0.5],[0.5,0.5]]\n  }],\n  \"vertices_vertices\": [\n    [6,4,3],\n    [7,5,3,4,6],\n    [5,7,3],\n    [0,4,1,5,2],\n    [0,6,1,3],\n    [1,7,2,3],\n    [1,4,0],\n    [1,2,5]\n  ],\n  \"faces_vertices\": [\n    [4,0,6],\n    [3,0,4],\n    [5,1,7],\n    [3,1,5],\n    [4,1,3],\n    [6,1,4],\n    [5,2,3],\n    [7,2,5]\n  ],\n  \"faces_edges\": [\n    [3,10,9],\n    [1,3,5],\n    [6,13,12],\n    [2,6,8],\n    [4,2,5],\n    [11,4,9],\n    [7,0,8],\n    [14,7,12]\n  ],\n  \"edges_faces\": [[6], [1], [3,4], [0,1], [4,5], [1,4], [2,3], [6,7], [3,6], [0,5], [0], [5], [2,7], [2], [7]],\n  \"vertices_faces\": [[0,1], [2,3,4,5], [6,7], [1,3,4,6], [0,1,4,5], [2,3,6,7], [0,5], [2,7]],\n  \"edges_length\": [1, 1, 1.4142135623730951, 0.41421356237309437, 0.7653668647301798, 0.7653668647301798, 0.7653668647301798, 0.41421356237309437, 0.7653668647301798, 0.292893218813452, 0.292893218813452, 0.707106781186548, 0.292893218813452, 0.707106781186548, 0.292893218813452],\n  \"edges_foldAngle\": [0, 0, 0, -180, -180, -180, -180, -180, -180, 180, 0, 0, 180, 0, 0],\n  \"faces_faces\": [\n  \t[1,5], [0,4], [3,7], [2,4,6], [3,1,5], [4,0], [3,7], [6,2]\n  ],\n  \"vertices_edges\": [\n    [1,3,10],\n    [2,4,6,11,13],\n    [0,7,14],\n    [0,1,2,5,8],\n    [3,4,5,9],\n    [6,7,8,12],\n    [9,10,11],\n    [12,13,14]\n  ]\n}\n"),bird:JSON.parse("{\n  \"file_spec\": 1.1,\n  \"file_creator\": \"Rabbit Ear\",\n  \"file_classes\": [\"singleModel\"],\n  \"frame_attributes\": [\"2D\"],\n  \"frame_classes\": [\"creasePattern\"],\n  \"vertices_coords\": [\n    [0,0],[1,0],[1,1],[0,1],[0.5,0.5],[0.207106781186548,0.5],[0.5,0.207106781186548],[0.792893218813452,0.5],[0.5,0.792893218813452],[0.353553390593274,0.646446609406726],[0.646446609406726,0.646446609406726],[0.646446609406726,0.353553390593274],[0.353553390593274,0.353553390593274],[0,0.5],[0.5,0],[1,0.5],[0.5,1]\n  ],\n  \"edges_vertices\": [\n    [3,5],[5,9],[3,9],[3,13],[5,13],[0,5],[0,13],[0,12],[5,12],[4,5],[4,12],[4,9],[0,6],[6,12],[0,14],[6,14],[1,6],[1,14],[1,11],[6,11],[4,6],[4,11],[1,7],[7,11],[1,15],[7,15],[2,7],[2,15],[2,10],[7,10],[4,7],[4,10],[2,8],[8,10],[2,16],[8,16],[3,8],[3,16],[8,9],[4,8]\n  ],\n  \"edges_faces\": [\n    [0,1],[0,5],[21,0],[1],[2,1],[2,3],[2],[3,6],[4,3],[4,5],[11,4],[5,22],[6,7],[6,11],[7],[8,7],[8,9],[8],[9,12],[10,9],[10,11],[17,10],[12,13],[12,17],[13],[14,13],[14,15],[14],[15,18],[16,15],[16,17],[23,16],[18,19],[18,23],[19],[20,19],[20,21],[20],[22,21],[22,23]\n  ],\n  \"edges_assignment\": [\n    \"M\",\"F\",\"V\",\"B\",\"V\",\"M\",\"B\",\"F\",\"F\",\"M\",\"F\",\"V\",\"M\",\"F\",\"B\",\"V\",\"M\",\"B\",\"V\",\"F\",\"M\",\"V\",\"M\",\"F\",\"B\",\"V\",\"M\",\"B\",\"F\",\"F\",\"M\",\"F\",\"M\",\"F\",\"B\",\"V\",\"M\",\"B\",\"F\",\"M\"\n  ],\n  \"faces_vertices\": [\n    [3,5,9],[5,3,13],[0,5,13],[5,0,12],[4,5,12],[5,4,9],[0,6,12],[6,0,14],[1,6,14],[6,1,11],[4,6,11],[6,4,12],[1,7,11],[7,1,15],[2,7,15],[7,2,10],[4,7,10],[7,4,11],[2,8,10],[8,2,16],[3,8,16],[8,3,9],[4,8,9],[8,4,10]\n  ],\n  \"faces_edges\": [\n    [0,1,2],[0,3,4],[5,4,6],[5,7,8],[9,8,10],[9,11,1],[12,13,7],[12,14,15],[16,15,17],[16,18,19],[20,19,21],[20,10,13],[22,23,18],[22,24,25],[26,25,27],[26,28,29],[30,29,31],[30,21,23],[32,33,28],[32,34,35],[36,35,37],[36,2,38],[39,38,11],[39,31,33]\n  ],\n  \"vertices_vertices\": [\n    [14,6,12,5,13],[15,7,11,6,14],[8,10,7,15,16],[13,5,9,8,16],[12,6,11,7,10,8,9,5],[0,12,4,9,3,13],[0,14,1,11,4,12],[11,1,15,2,10,4],[9,4,10,2,16,3],[5,4,8,3],[4,7,2,8],[6,1,7,4],[0,6,4,5],[0,5,3],[1,6,0],[1,2,7],[8,2,3]\n  ],\n  \"vertices_faces\": [\n    [2,3,6,7],[8,9,12,13],[14,15,18,19],[0,1,20,21],[4,5,10,11,16,17,22,23],[0,1,2,3,4,5],[6,7,8,9,10,11],[12,13,14,15,16,17],[18,19,20,21,22,23],[0,5,21,22],[15,16,18,23],[9,10,12,17],[3,4,6,11],[1,2],[7,8],[13,14],[19,20]\n  ],\n  \"edges_length\": [\n    0.5411961001461971,0.20710678118654724,0.5,0.5,0.207106781186548,0.5411961001461971,0.5,0.5,0.2071067811865472,0.292893218813452,0.20710678118654718,0.2071067811865472,0.5411961001461971,0.2071067811865472,0.5,0.207106781186548,0.5411961001461971,0.5,0.5,0.20710678118654724,0.292893218813452,0.2071067811865472,0.5411961001461971,0.20710678118654713,0.5,0.20710678118654802,0.5411961001461971,0.5,0.5,0.20710678118654718,0.292893218813452,0.20710678118654727,0.5411961001461971,0.20710678118654718,0.5,0.20710678118654802,0.5411961001461971,0.5,0.20710678118654713,0.292893218813452\n  ],\n  \"edges_foldAngle\": [\n    -180,0,180,0,180,-180,0,0,0,-180,0,180,-180,0,0,180,-180,0,180,0,-180,180,-180,0,0,180,-180,0,0,0,-180,0,-180,0,0,180,-180,0,0,-180\n  ],\n  \"faces_faces\": [\n    [1,5,21],[0,2],[1,3],[2,4,6],[3,5,11],[4,0,22],[3,7,11],[6,8],[7,9],[8,10,12],[9,11,17],[10,4,6],[9,13,17],[12,14],[13,15],[14,16,18],[15,17,23],[16,10,12],[15,19,23],[18,20],[19,21],[20,0,22],[21,5,23],[22,16,18]\n  ],\n  \"vertices_edges\": [\n    [5,6,7,12,14],[16,17,18,22,24],[26,27,28,32,34],[0,2,3,36,37],[9,10,11,20,21,30,31,39],[0,1,4,5,8,9],[12,13,15,16,19,20],[22,23,25,26,29,30],[32,33,35,36,38,39],[1,2,11,38],[28,29,31,33],[18,19,21,23],[7,8,10,13],[3,4,6],[14,15,17],[24,25,27],[34,35,37]\n  ],\n  \"edges_edges\": [\n    [2,3,36,37,1,4,5,8,9],[0,4,5,8,9,2,11,38],[0,3,36,37,1,11,38],[0,2,36,37,4,6],[0,1,5,8,9,3,6],[6,7,12,14,0,1,4,8,9],[5,7,12,14,3,4],[5,6,12,14,8,10,13],[0,1,4,5,9,7,10,13],[10,11,20,21,30,31,39,0,1,4,5,8],[9,11,20,21,30,31,39,7,8,13],[9,10,20,21,30,31,39,1,2,38],[5,6,7,14,13,15,16,19,20],[12,15,16,19,20,7,8,10],[5,6,7,12,15,17],[12,13,16,19,20,14,17],[17,18,22,24,12,13,15,19,20],[16,18,22,24,14,15],[16,17,22,24,19,21,23],[12,13,15,16,20,18,21,23],[9,10,11,21,30,31,39,12,13,15,16,19],[9,10,11,20,30,31,39,18,19,23],[16,17,18,24,23,25,26,29,30],[22,25,26,29,30,18,19,21],[16,17,18,22,25,27],[22,23,26,29,30,24,27],[27,28,32,34,22,23,25,29,30],[26,28,32,34,24,25],[26,27,32,34,29,31,33],[22,23,25,26,30,28,31,33],[9,10,11,20,21,31,39,22,23,25,26,29],[9,10,11,20,21,30,39,28,29,33],[26,27,28,34,33,35,36,38,39],[32,35,36,38,39,28,29,31],[26,27,28,32,35,37],[32,33,36,38,39,34,37],[0,2,3,37,32,33,35,38,39],[0,2,3,36,34,35],[32,33,35,36,39,1,2,11],[9,10,11,20,21,30,31,32,33,35,36,38]\n  ]\n}"),frog:JSON.parse("{\n  \"file_spec\": 1.1,\n  \"file_creator\": \"Rabbit Ear\",\n  \"file_classes\": [\"singleModel\"],\n  \"frame_attributes\": [\"2D\"],\n  \"frame_classes\": [\"creasePattern\"],\n  \"vertices_coords\": [\n    [0,0],[1,0],[1,1],[0,1],[0.5,0.5],[0,0.5],[0.5,0],[1,0.5],[0.5,1],[0.146446609406726,0.353553390593274],[0.353553390593274,0.146446609406726],[0.646446609406726,0.146446609406726],[0.853553390593274,0.353553390593274],[0.853553390593274,0.646446609406726],[0.646446609406726,0.853553390593274],[0.353553390593274,0.853553390593274],[0.146446609406726,0.646446609406726],[0,0.353553390593274],[0,0.646446609406726],[0.353553390593274,0],[0.646446609406726,0],[1,0.353553390593274],[1,0.646446609406726],[0.646446609406726,1],[0.353553390593274,1]\n  ],\n  \"edges_vertices\": [\n    [0,4],[4,9],[0,9],[0,10],[4,10],[2,4],[2,14],[4,14],[4,13],[2,13],[3,4],[4,15],[3,15],[3,16],[4,16],[1,4],[1,12],[4,12],[4,11],[1,11],[4,5],[5,9],[5,16],[4,6],[6,11],[6,10],[4,7],[7,13],[7,12],[4,8],[8,15],[8,14],[9,17],[0,17],[5,17],[0,19],[10,19],[6,19],[11,20],[1,20],[6,20],[1,21],[12,21],[7,21],[13,22],[2,22],[7,22],[2,23],[14,23],[8,23],[15,24],[3,24],[8,24],[3,18],[16,18],[5,18]\n  ],\n  \"edges_faces\": [\n    [0,1],[0,8],[16,0],[1,18],[11,1],[3,2],[2,26],[15,2],[3,12],[24,3],[4,5],[4,14],[28,4],[5,30],[9,5],[7,6],[6,22],[13,6],[7,10],[20,7],[8,9],[8,17],[31,9],[10,11],[10,21],[19,11],[12,13],[12,25],[23,13],[14,15],[14,29],[27,15],[16,17],[16],[17],[18],[19,18],[19],[20,21],[20],[21],[22],[23,22],[23],[24,25],[24],[25],[26],[27,26],[27],[28,29],[28],[29],[30],[31,30],[31]\n  ],\n  \"edges_assignment\": [\n    \"F\",\"M\",\"M\",\"M\",\"M\",\"F\",\"M\",\"M\",\"M\",\"M\",\"V\",\"M\",\"M\",\"M\",\"M\",\"V\",\"M\",\"M\",\"M\",\"M\",\"V\",\"M\",\"M\",\"V\",\"M\",\"M\",\"V\",\"M\",\"M\",\"V\",\"M\",\"M\",\"V\",\"B\",\"B\",\"B\",\"V\",\"B\",\"V\",\"B\",\"B\",\"B\",\"V\",\"B\",\"V\",\"B\",\"B\",\"B\",\"V\",\"B\",\"V\",\"B\",\"B\",\"B\",\"V\",\"B\"\n  ],\n  \"faces_vertices\": [\n    [0,4,9],[4,0,10],[4,2,14],[2,4,13],[3,4,15],[4,3,16],[4,1,12],[1,4,11],[4,5,9],[5,4,16],[4,6,11],[6,4,10],[4,7,13],[7,4,12],[4,8,15],[8,4,14],[0,9,17],[9,5,17],[10,0,19],[6,10,19],[1,11,20],[11,6,20],[12,1,21],[7,12,21],[2,13,22],[13,7,22],[14,2,23],[8,14,23],[3,15,24],[15,8,24],[16,3,18],[5,16,18]\n  ],\n  \"faces_edges\": [\n    [0,1,2],[0,3,4],[5,6,7],[5,8,9],[10,11,12],[10,13,14],[15,16,17],[15,18,19],[20,21,1],[20,14,22],[23,24,18],[23,4,25],[26,27,8],[26,17,28],[29,30,11],[29,7,31],[2,32,33],[21,34,32],[3,35,36],[25,36,37],[19,38,39],[24,40,38],[16,41,42],[28,42,43],[9,44,45],[27,46,44],[6,47,48],[31,48,49],[12,50,51],[30,52,50],[13,53,54],[22,54,55]\n  ],\n  \"vertices_vertices\": [\n    [19,10,4,9,17],[21,12,4,11,20],[14,4,13,22,23],[18,16,4,15,24],[9,0,10,6,11,1,12,7,13,2,14,8,15,3,16,5],[17,9,4,16,18],[20,11,4,10,19],[12,21,22,13,4],[15,4,14,23,24],[0,4,5,17],[0,19,6,4],[6,20,1,4],[1,21,7,4],[4,7,22,2],[4,2,23,8],[4,8,24,3],[5,4,3,18],[0,9,5],[5,16,3],[6,10,0],[1,11,6],[1,7,12],[7,2,13],[14,2,8],[15,8,3]\n  ],\n  \"vertices_faces\": [\n    [0,1,16,18],[6,7,20,22],[2,3,24,26],[4,5,28,30],[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],[8,9,17,31],[10,11,19,21],[12,13,23,25],[14,15,27,29],[0,8,16,17],[1,11,18,19],[7,10,20,21],[6,13,22,23],[3,12,24,25],[2,15,26,27],[4,14,28,29],[5,9,30,31],[16,17],[30,31],[18,19],[20,21],[22,23],[24,25],[26,27],[28,29]\n  ],\n  \"edges_length\": [\n    0.7071067811865476,0.3826834323650899,0.3826834323650899,0.3826834323650899,0.3826834323650899,0.7071067811865476,0.3826834323650899,0.3826834323650899,0.3826834323650899,0.3826834323650899,0.7071067811865476,0.38268343236508984,0.38268343236508995,0.38268343236508984,0.38268343236508995,0.7071067811865476,0.38268343236508995,0.38268343236508984,0.38268343236508995,0.38268343236508984,0.5,0.20710678118654718,0.2071067811865472,0.5,0.2071067811865472,0.20710678118654718,0.5,0.20710678118654727,0.2071067811865472,0.5,0.2071067811865472,0.20710678118654727,0.146446609406726,0.353553390593274,0.146446609406726,0.353553390593274,0.146446609406726,0.146446609406726,0.146446609406726,0.35355339059327395,0.14644660940672605,0.353553390593274,0.14644660940672605,0.146446609406726,0.14644660940672605,0.35355339059327395,0.14644660940672605,0.35355339059327395,0.14644660940672605,0.14644660940672605,0.14644660940672605,0.353553390593274,0.146446609406726,0.35355339059327395,0.146446609406726,0.14644660940672605\n  ],\n  \"edges_foldAngle\": [\n    0,-180,-180,-180,-180,0,-180,-180,-180,-180,180,-180,-180,-180,-180,180,-180,-180,-180,-180,180,-180,-180,180,-180,-180,180,-180,-180,180,-180,-180,180,0,0,0,180,0,180,0,0,0,180,0,180,0,0,0,180,0,180,0,0,0,180,0\n  ],\n  \"faces_faces\": [\n    [1,8,16],[0,11,18],[3,15,26],[2,12,24],[5,14,28],[4,9,30],[7,13,22],[6,10,20],[0,9,17],[8,5,31],[7,11,21],[10,1,19],[3,13,25],[12,6,23],[4,15,29],[14,2,27],[0,17],[8,16],[1,19],[11,18],[7,21],[10,20],[6,23],[13,22],[3,25],[12,24],[2,27],[15,26],[4,29],[14,28],[5,31],[9,30]\n  ],\n  \"vertices_edges\": [\n    [0,2,3,33,35],[15,16,19,39,41],[5,6,9,45,47],[10,12,13,51,53],[0,1,4,5,7,8,10,11,14,15,17,18,20,23,26,29],[20,21,22,34,55],[23,24,25,37,40],[26,27,28,43,46],[29,30,31,49,52],[1,2,21,32],[3,4,25,36],[18,19,24,38],[16,17,28,42],[8,9,27,44],[6,7,31,48],[11,12,30,50],[13,14,22,54],[32,33,34],[53,54,55],[35,36,37],[38,39,40],[41,42,43],[44,45,46],[47,48,49],[50,51,52]\n  ],\n  \"edges_edges\": [\n    [2,3,33,35,1,4,5,7,8,10,11,14,15,17,18,20,23,26,29],[0,4,5,7,8,10,11,14,15,17,18,20,23,26,29,2,21,32],[0,3,33,35,1,21,32],[0,2,33,35,4,25,36],[0,1,5,7,8,10,11,14,15,17,18,20,23,26,29,3,25,36],[6,9,45,47,0,1,4,7,8,10,11,14,15,17,18,20,23,26,29],[5,9,45,47,7,31,48],[0,1,4,5,8,10,11,14,15,17,18,20,23,26,29,6,31,48],[0,1,4,5,7,10,11,14,15,17,18,20,23,26,29,9,27,44],[5,6,45,47,8,27,44],[12,13,51,53,0,1,4,5,7,8,11,14,15,17,18,20,23,26,29],[0,1,4,5,7,8,10,14,15,17,18,20,23,26,29,12,30,50],[10,13,51,53,11,30,50],[10,12,51,53,14,22,54],[0,1,4,5,7,8,10,11,15,17,18,20,23,26,29,13,22,54],[16,19,39,41,0,1,4,5,7,8,10,11,14,17,18,20,23,26,29],[15,19,39,41,17,28,42],[0,1,4,5,7,8,10,11,14,15,18,20,23,26,29,16,28,42],[0,1,4,5,7,8,10,11,14,15,17,20,23,26,29,19,24,38],[15,16,39,41,18,24,38],[0,1,4,5,7,8,10,11,14,15,17,18,23,26,29,21,22,34,55],[20,22,34,55,1,2,32],[20,21,34,55,13,14,54],[0,1,4,5,7,8,10,11,14,15,17,18,20,26,29,24,25,37,40],[23,25,37,40,18,19,38],[23,24,37,40,3,4,36],[0,1,4,5,7,8,10,11,14,15,17,18,20,23,29,27,28,43,46],[26,28,43,46,8,9,44],[26,27,43,46,16,17,42],[0,1,4,5,7,8,10,11,14,15,17,18,20,23,26,30,31,49,52],[29,31,49,52,11,12,50],[29,30,49,52,6,7,48],[1,2,21,33,34],[0,2,3,35,32,34],[20,21,22,55,32,33],[0,2,3,33,36,37],[3,4,25,35,37],[23,24,25,40,35,36],[18,19,24,39,40],[15,16,19,41,38,40],[23,24,25,37,38,39],[15,16,19,39,42,43],[16,17,28,41,43],[26,27,28,46,41,42],[8,9,27,45,46],[5,6,9,47,44,46],[26,27,28,43,44,45],[5,6,9,45,48,49],[6,7,31,47,49],[29,30,31,52,47,48],[11,12,30,51,52],[10,12,13,53,50,52],[29,30,31,49,50,51],[10,12,13,51,54,55],[13,14,22,53,55],[20,21,22,34,53,54]\n  ]\n}")},b=Object.create(null);Object.defineProperty(b,"empty",{get:function(){return Ag.clone(wg.empty)}}),Object.defineProperty(b,"square",{get:function(){return Ag.clone(wg.square)}}),Object.defineProperty(b,"book",{get:function(){return Ag.clone(wg.book)}}),Object.defineProperty(b,"blintz",{get:function(){return Ag.clone(wg.blintz)}}),Object.defineProperty(b,"kite",{get:function(){return Ag.clone(wg.kite)}}),Object.defineProperty(b,"fish",{get:function(){return Ag.clone(wg.fish)}}),Object.defineProperty(b,"bird",{get:function(){return Ag.clone(wg.bird)}}),Object.defineProperty(b,"frog",{get:function(){return Ag.clone(wg.frog)}});var Ng={origami:$l,graph:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(Object.create(Dc()),va(),e,{file_spec:ki,file_creator:xi})},svg:$d,fold:eo,convert:pa,core:Ag,bases:b,text:{axioms:JSON.parse(to)},math:yi.core,axiom:hl,equivalent:yi.core.equivalent};return Object.keys(yi).filter(function(e){return"core"!==e}).forEach(function(e){Ng[e]=yi[e]}),Ng});
